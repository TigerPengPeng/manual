<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Chapter 22 MySQL Performance Schema</title>
<link rel="stylesheet" href="mvl.css" type="text/css" />
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2" />
<link rel="start" href="index.html" title="{book-title}" />
<link rel="up" href="" title="" />
<link rel="prev" href="information-schema.html" title="Chapter 21 INFORMATION_SCHEMA Tables" />
<link rel="next" href="connectors-apis.html" title="Chapter 23 Connectors and APIs" />
<script language="javascript" type="text/javascript">
  function addOnload(theFunc)
  {
    var previous = window.onload;
    if (typeof window.onload != 'function')
    {
      window.onload = theFunc;
    }
    else
    {
      window.onload = function()
      {
        previous();
        theFunc();
      }
    }
  }

  addOnload(function()
  {
    var base = new Date(1438557954*1000);
    var now = new Date();
    var diff = ((now-base)/1000)/(24*3600);

    if (diff > 90) {
      var nodes = document.getElementsByClassName('titlepage');
      nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
        'This copy of the manual is more than 90 days old. We encourage you to download a ' +
        'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
    }
  });
</script>
<noscript></noscript>
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter 22 MySQL Performance Schema</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="information-schema.html">Prev</a> </td>
<th width="60%" align="center"></th>
<td width="20%" align="right"> <a accesskey="n" href="connectors-apis.html">Next</a></td>
</tr>
</table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="performance-schema"></a>Chapter 22 MySQL Performance Schema</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-quick-start">22.1 Performance Schema Quick Start</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-configuration">22.2 Performance Schema Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-build-configuration">22.2.1 Performance Schema Build Configuration</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-startup-configuration">22.2.2 Performance Schema Startup Configuration</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-runtime-configuration">22.2.3 Performance Schema Runtime Configuration</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-queries">22.3 Performance Schema Queries</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrument-naming">22.4 Performance Schema Instrument Naming Conventions</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-monitoring">22.5 Performance Schema Status Monitoring</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-atom-molecule-events">22.6 Performance Schema Atom and Molecule Events</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-digests">22.7 Performance Schema Statement Digests</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-characteristics">22.8 Performance Schema General Table Characteristics</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-table-descriptions">22.9 Performance Schema Table Descriptions</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">22.9.1 Performance Schema Table Index</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">22.9.2 Performance Schema Setup Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">22.9.3 Performance Schema Instance Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">22.9.4 Performance Schema Wait Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">22.9.5 Performance Schema Stage Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">22.9.6 Performance Schema Statement Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">22.9.7 Performance Schema Connection Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">22.9.8 Performance Schema Connection Attribute Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">22.9.9 Performance Schema Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">22.9.10 Performance Schema Miscellaneous Tables</a></span></dt></dl></dd><dt><span class="section"><a href="performance-schema.html#performance-schema-option-variable-reference">22.10 Performance Schema Option and Variable Reference</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-options">22.11 Performance Schema Command Options</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-system-variables">22.12 Performance Schema System Variables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-status-variables">22.13 Performance Schema Status Variables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-and-plugins">22.14 Performance Schema and Plugins</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-examples">22.15 Using the Performance Schema to Diagnose Problems</a></span></dt><dd><dl><dt><span class="section"><a href="performance-schema.html#performance-schema-query-profiling">22.15.1 Query Profiling Using Performance Schema</a></span></dt></dl></dd></dl>
</div>
<a class="indexterm" name="idm139737074419616"></a><a class="indexterm" name="idm139737074418576"></a><a class="indexterm" name="idm139737074417488"></a><a class="indexterm" name="idm139737074416000"></a><p>
    The MySQL Performance Schema is a feature for monitoring MySQL
    Server execution at a low level. The Performance Schema has these
    characteristics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        The Performance Schema provides a way to inspect internal
        execution of the server at runtime. It is implemented using the
        <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a> storage engine
        and the <code class="literal">performance_schema</code> database. The
        Performance Schema focuses primarily on performance data. This
        differs from <code class="literal">INFORMATION_SCHEMA</code>, which serves
        for inspection of metadata.
      </p></li><li class="listitem"><p>
        The Performance Schema monitors server events. An
        <span class="quote">“<span class="quote">event</span>”</span> is anything the server does that takes time
        and has been instrumented so that timing information can be
        collected. In general, an event could be a function call, a wait
        for the operating system, a stage of an SQL statement execution
        such as parsing or sorting, or an entire statement or group of
        statements. Currently, event collection provides access to
        information about synchronization calls (such as for mutexes)
        file and table I/O, table locks, and so forth for the server and
        for several storage engines.
      </p></li><li class="listitem"><p>
        Performance Schema events are distinct from events written to
        the server's binary log (which describe data modifications) and
        Event Scheduler events (which are a type of stored program).
      </p></li><li class="listitem"><p>
        Performance Schema events are specific to a given instance of
        the MySQL Server. In MySQL 5.6.9 and later, Performance Schema
        tables are considered local to the server, and changes to them
        are not replicated or written to the binary log. (Bug #14741537)
      </p></li><li class="listitem"><p>
        Current events are available, as well as event histories and
        summaries. This enables you to determine how many times
        instrumented activities were performed and how much time they
        took. Event information is available to show the activities of
        specific threads, or activity associated with particular objects
        such as a mutex or file.
      </p></li><li class="listitem"><p>
        The <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a> storage
        engine collects event data using <span class="quote">“<span class="quote">instrumentation
        points</span>”</span> in server source code.
      </p></li><li class="listitem"><p>
        Collected events are stored in tables in the
        <code class="literal">performance_schema</code> database. These tables can
        be queried using <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        statements like other tables.
      </p></li><li class="listitem"><p>
        Performance Schema configuration can be modified dynamically by
        updating tables in the <code class="literal">performance_schema</code>
        database through SQL statements. Configuration changes affect
        data collection immediately.
      </p></li><li class="listitem"><p>
        Tables in the <code class="literal">performance_schema</code> database are
        views or temporary tables that use no persistent on-disk
        storage.
      </p></li><li class="listitem"><p>
        Monitoring is available on all platforms supported by MySQL.
      </p><p>
        Some limitations might apply: The types of timers might vary per
        platform. Instruments that apply to storage engines might not be
        implemented for all storage engines. Instrumentation of each
        third-party engine is the responsibility of the engine
        maintainer. See also
        <a class="xref" href="restrictions.html#performance-schema-restrictions" title="D.8 Restrictions on Performance Schema">Section D.8, “Restrictions on Performance Schema”</a>.
      </p></li><li class="listitem"><p>
        Data collection is implemented by modifying the server source
        code to add instrumentation. There are no separate threads
        associated with the Performance Schema, unlike other features
        such as replication or the Event Scheduler.
</p></li></ul>
</div>
<p>
    The Performance Schema is intended to provide access to useful
    information about server execution while having minimal impact on
    server performance. The implementation follows these design goals:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Activating the Performance Schema causes no changes in server
        behavior. For example, it does not cause thread scheduling to
        change, and it does not cause query execution plans (as shown by
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>) to change.
      </p></li><li class="listitem"><p>
        No memory allocation is done beyond that which occurs during
        server startup. By using early allocation of structures with a
        fixed size, it is never necessary to resize or reallocate them,
        which is critical for achieving good runtime performance.
      </p></li><li class="listitem"><p>
        Server monitoring occurs continuously and unobtrusively with
        very little overhead. Activating the Performance Schema does not
        make the server unusable.
      </p></li><li class="listitem"><p>
        The parser is unchanged. There are no new keywords or
        statements.
      </p></li><li class="listitem"><p>
        Execution of server code proceeds normally even if the
        Performance Schema fails internally.
      </p></li><li class="listitem"><p>
        When there is a choice between performing processing during
        event collection initially or during event retrieval later,
        priority is given to making collection faster. This is because
        collection is ongoing whereas retrieval is on demand and might
        never happen at all.
      </p></li><li class="listitem"><p>
        It is easy to add new instrumentation points.
      </p></li><li class="listitem"><p>
        Instrumentation is versioned. If the instrumentation
        implementation changes, previously instrumented code will
        continue to work. This benefits developers of third-party
        plugins because it is not necessary to upgrade each plugin to
        stay synchronized with the latest Performance Schema changes.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-quick-start"></a>22.1 Performance Schema Quick Start</h2>

</div>

</div>

</div>
<p>
      This section briefly introduces the Performance Schema with
      examples that show how to use it. For additional examples, see
      <a class="xref" href="performance-schema.html#performance-schema-examples" title="22.15 Using the Performance Schema to Diagnose Problems">Section 22.15, “Using the Performance Schema to Diagnose Problems”</a>.
    </p><p>
      For the Performance Schema to be available, support for it must
      have been configured when MySQL was built. You can verify whether
      this is the case by checking the server's help output. If the
      Performance Schema is available, the output will mention several
      variables with names that begin with
      <code class="literal">performance_schema</code>:
    </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysqld --verbose --help</code></strong>
...
  --performance_schema
                      Enable the performance schema.
  --performance_schema_events_waits_history_long_size=#
                      Number of rows in events_waits_history_long.
...
</pre><p>
      If such variables do not appear in the output, your server has not
      been built to support the Performance Schema. In this case, see
      <a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 Performance Schema Configuration">Section 22.2, “Performance Schema Configuration”</a>.
    </p><p>
      Assuming that the Performance Schema is available, it is enabled
      by default as of MySQL 5.6.6. Before 5.6.6, it is disabled by
      default. To enable or disable it explicitly, start the server with
      the <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a> variable
      set to an appropriate value. For example, use these lines in your
      <code class="filename">my.cnf</code> file:
    </p><pre class="programlisting">
[mysqld]
performance_schema=ON
</pre><p>
      When the server starts, it sees
      <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a> and attempts
      to initialize the Performance Schema. To verify successful
      initialization, use this statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'performance_schema';</code></strong>
+--------------------+-------+
| Variable_name      | Value |
+--------------------+-------+
| performance_schema | ON    |
+--------------------+-------+
</pre><p>
      A value of <code class="literal">ON</code> means that the Performance Schema
      initialized successfully and is ready for use. A value of
      <code class="literal">OFF</code> means that some error occurred. Check the
      server error log for information about what went wrong.
    </p><p>
      The Performance Schema is implemented as a storage engine. If this
      engine is available (which you should already have checked
      earlier), you should see it listed with a
      <code class="literal">SUPPORT</code> value of <code class="literal">YES</code> in the
      output from the
      <a class="link" href="information-schema.html#engines-table" title="21.6 The INFORMATION_SCHEMA ENGINES Table"><code class="literal">INFORMATION_SCHEMA.ENGINES</code></a> table or
      the <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM INFORMATION_SCHEMA.ENGINES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE ENGINE='PERFORMANCE_SCHEMA'\G</code></strong>
*************************** 1. row ***************************
      ENGINE: PERFORMANCE_SCHEMA
     SUPPORT: YES
     COMMENT: Performance Schema
TRANSACTIONS: NO
          XA: NO
  SAVEPOINTS: NO

mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
...
</pre><p>
      The <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a> storage engine
      operates on tables in the <code class="literal">performance_schema</code>
      database. You can make <code class="literal">performance_schema</code> the
      default database so that references to its tables need not be
      qualified with the database name:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE performance_schema;</code></strong>
</pre><p>
      Many examples in this chapter assume that
      <code class="literal">performance_schema</code> is the default database.
    </p><p>
      Performance Schema tables are stored in the
      <code class="literal">performance_schema</code> database. Information about
      the structure of this database and its tables can be obtained, as
      for any other database, by selecting from the
      <code class="literal">INFORMATION_SCHEMA</code> database or by using
      <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> statements. For example, use
      either of these statements to see what Performance Schema tables
      exist:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema';</code></strong>
+----------------------------------------------------+
| TABLE_NAME                                         |
+----------------------------------------------------+
| accounts                                           |
| cond_instances                                     |
| events_stages_current                              |
| events_stages_history                              |
| events_stages_history_long                         |
| events_stages_summary_by_account_by_event_name     |
| events_stages_summary_by_host_by_event_name        |
| events_stages_summary_by_thread_by_event_name      |
| events_stages_summary_by_user_by_event_name        |
| events_stages_summary_global_by_event_name         |
| events_statements_current                          |
| events_statements_history                          |
| events_statements_history_long                     |
...
| file_instances                                     |
| file_summary_by_event_name                         |
| file_summary_by_instance                           |
| host_cache                                         |
| hosts                                              |
| mutex_instances                                    |
| objects_summary_global_by_type                     |
| performance_timers                                 |
| rwlock_instances                                   |
| session_account_connect_attrs                      |
| session_connect_attrs                              |
| setup_actors                                       |
| setup_consumers                                    |
| setup_instruments                                  |
| setup_objects                                      |
| setup_timers                                       |
| socket_instances                                   |
| socket_summary_by_event_name                       |
| socket_summary_by_instance                         |
| table_io_waits_summary_by_index_usage              |
| table_io_waits_summary_by_table                    |
| table_lock_waits_summary_by_table                  |
| threads                                            |
| users                                              |
+----------------------------------------------------+

mysql&gt; <strong class="userinput"><code>SHOW TABLES FROM performance_schema;</code></strong>
+----------------------------------------------------+
| Tables_in_performance_schema                       |
+----------------------------------------------------+
| accounts                                           |
| cond_instances                                     |
| events_stages_current                              |
| events_stages_history                              |
| events_stages_history_long                         |
...
</pre><p>
      The number of Performance Schema tables is expected to increase
      over time as implementation of additional instrumentation
      proceeds.
    </p><p>
      The name of the <code class="literal">performance_schema</code> database is
      lowercase, as are the names of tables within it. Queries should
      specify the names in lowercase.
    </p><p>
      To see the structure of individual tables, use <code class="literal">SHOW
      CREATE TABLE</code>:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE setup_timers\G</code></strong>
*************************** 1. row ***************************
       Table: setup_timers
Create Table: CREATE TABLE `setup_timers` (
  `NAME` varchar(64) NOT NULL,
  `TIMER_NAME` enum('CYCLE','NANOSECOND','MICROSECOND','MILLISECOND','TICK')
   NOT NULL
) ENGINE=PERFORMANCE_SCHEMA DEFAULT CHARSET=utf8
</pre><p>
      Table structure is also available by selecting from tables such as
      <a class="link" href="information-schema.html#columns-table" title="21.4 The INFORMATION_SCHEMA COLUMNS Table"><code class="literal">INFORMATION_SCHEMA.COLUMNS</code></a> or by
      using statements such as <code class="literal">SHOW COLUMNS</code>.
    </p><p>
      Tables in the <code class="literal">performance_schema</code> database can
      be grouped according to the type of information in them: Current
      events, event histories and summaries, object instances, and setup
      (configuration) information. The following examples illustrate a
      few uses for these tables. For detailed information about the
      tables in each group, see
      <a class="xref" href="performance-schema.html#performance-schema-table-descriptions" title="22.9 Performance Schema Table Descriptions">Section 22.9, “Performance Schema Table Descriptions”</a>.
    </p><p>
      Initially, not all instruments and consumers are enabled, so the
      performance schema does not collect all events. To turn all of
      these on and enable event timing, execute two statements (the row
      counts may differ depending on MySQL version):
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES';</code></strong>
Query OK, 338 rows affected (0.12 sec)
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES';</code></strong>
Query OK, 8 rows affected (0.00 sec)
</pre><p>
      To see what the server is doing at the moment, examine the
      <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table. It
      contains one row per thread showing each thread's most recent
      monitored event:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_waits_current\G</code></strong>
*************************** 1. row ***************************
            THREAD_ID: 0
             EVENT_ID: 5523
           EVENT_NAME: wait/synch/mutex/mysys/THR_LOCK::mutex
               SOURCE: thr_lock.c:525
          TIMER_START: 201660494489586
            TIMER_END: 201660494576112
           TIMER_WAIT: 86526
                SPINS: NULL
        OBJECT_SCHEMA: NULL
          OBJECT_NAME: NULL
          OBJECT_TYPE: NULL
OBJECT_INSTANCE_BEGIN: 142270668
     NESTING_EVENT_ID: NULL
            OPERATION: lock
      NUMBER_OF_BYTES: NULL
                FLAGS: 0
...
</pre><p>
      This event indicates that thread 0 was waiting for 86,526
      picoseconds to acquire a lock on
      <code class="literal">THR_LOCK::mutex</code>, a mutex in the
      <code class="literal">mysys</code> subsystem. The first few columns provide
      the following information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The ID columns indicate which thread the event comes from and
          the event number.
        </p></li><li class="listitem"><p>
          <code class="literal">EVENT_NAME</code> indicates what was instrumented
          and <code class="literal">SOURCE</code> indicates which source file
          contains the instrumented code.
        </p></li><li class="listitem"><p>
          The timer columns show when the event started and stopped and
          how long it took. If an event is still in progress, the
          <code class="literal">TIMER_END</code> and <code class="literal">TIMER_WAIT</code>
          values are <code class="literal">NULL</code>. Timer values are
          approximate and expressed in picoseconds. For information
          about timers and event time collection, see
          <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
</p></li></ul>
</div>
<p>
      The history tables contain the same kind of rows as the
      current-events table but have more rows and show what the server
      has been doing <span class="quote">“<span class="quote">recently</span>”</span> rather than
      <span class="quote">“<span class="quote">currently.</span>”</span> The
      <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> and
      <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a> tables
      contain the most recent 10 events per thread and most recent
      10,000 events, respectively. For example, to see information for
      recent events produced by thread 13, do this:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EVENT_ID, EVENT_NAME, TIMER_WAIT</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_history WHERE THREAD_ID = 13</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY EVENT_ID;</code></strong>
+----------+-----------------------------------------+------------+
| EVENT_ID | EVENT_NAME                              | TIMER_WAIT |
+----------+-----------------------------------------+------------+
|       86 | wait/synch/mutex/mysys/THR_LOCK::mutex  |     686322 |
|       87 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     320535 |
|       88 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     339390 |
|       89 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     377100 |
|       90 | wait/synch/mutex/sql/LOCK_plugin        |     614673 |
|       91 | wait/synch/mutex/sql/LOCK_open          |     659925 |
|       92 | wait/synch/mutex/sql/THD::LOCK_thd_data |     494001 |
|       93 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     222489 |
|       94 | wait/synch/mutex/mysys/THR_LOCK_malloc  |     214947 |
|       95 | wait/synch/mutex/mysys/LOCK_alarm       |     312993 |
+----------+-----------------------------------------+------------+
</pre><p>
      As new events are added to a history table, older events are
      discarded if the table is full.
    </p><p>
      Summary tables provide aggregated information for all events over
      time. The tables in this group summarize event data in different
      ways. To see which instruments have been executed the most times
      or have taken the most wait time, sort the
      <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_global_by_event_name</code></a>
      table on the <code class="literal">COUNT_STAR</code> or
      <code class="literal">SUM_TIMER_WAIT</code> column, which correspond to a
      <code class="literal">COUNT(*)</code> or <code class="literal">SUM(TIMER_WAIT)</code>
      value, respectively, calculated over all events:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, COUNT_STAR</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_summary_global_by_event_name</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY COUNT_STAR DESC LIMIT 10;</code></strong>
+---------------------------------------------------+------------+
| EVENT_NAME                                        | COUNT_STAR |
+---------------------------------------------------+------------+
| wait/synch/mutex/mysys/THR_LOCK_malloc            |       6419 |
| wait/io/file/sql/FRM                              |        452 |
| wait/synch/mutex/sql/LOCK_plugin                  |        337 |
| wait/synch/mutex/mysys/THR_LOCK_open              |        187 |
| wait/synch/mutex/mysys/LOCK_alarm                 |        147 |
| wait/synch/mutex/sql/THD::LOCK_thd_data           |        115 |
| wait/io/file/myisam/kfile                         |        102 |
| wait/synch/mutex/sql/LOCK_global_system_variables |         89 |
| wait/synch/mutex/mysys/THR_LOCK::mutex            |         89 |
| wait/synch/mutex/sql/LOCK_open                    |         88 |
+---------------------------------------------------+------------+

mysql&gt; <strong class="userinput"><code>SELECT EVENT_NAME, SUM_TIMER_WAIT</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_summary_global_by_event_name</code></strong>
    -&gt; <strong class="userinput"><code>ORDER BY SUM_TIMER_WAIT DESC LIMIT 10;</code></strong>
+----------------------------------------+----------------+
| EVENT_NAME                             | SUM_TIMER_WAIT |
+----------------------------------------+----------------+
| wait/io/file/sql/MYSQL_LOG             |     1599816582 |
| wait/synch/mutex/mysys/THR_LOCK_malloc |     1530083250 |
| wait/io/file/sql/binlog_index          |     1385291934 |
| wait/io/file/sql/FRM                   |     1292823243 |
| wait/io/file/myisam/kfile              |      411193611 |
| wait/io/file/myisam/dfile              |      322401645 |
| wait/synch/mutex/mysys/LOCK_alarm      |      145126935 |
| wait/io/file/sql/casetest              |      104324715 |
| wait/synch/mutex/sql/LOCK_plugin       |       86027823 |
| wait/io/file/sql/pid                   |       72591750 |
+----------------------------------------+----------------+
</pre><p>
      These results show that the <code class="literal">THR_LOCK_malloc</code>
      mutex is <span class="quote">“<span class="quote">hot,</span>”</span> both in terms of how often it is used
      and amount of time that threads wait attempting to acquire it.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <code class="literal">THR_LOCK_malloc</code> mutex is used only in
        debug builds. In production builds it is not hot because it is
        nonexistent.
</p>
</div>
<p>
      Instance tables document what types of objects are instrumented.
      An instrumented object, when used by the server, produces an
      event. These tables provide event names and explanatory notes or
      status information. For example, the
      <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a> table lists instances
      of instruments for file I/O operations and their associated files:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_instances\G</code></strong>
*************************** 1. row ***************************
 FILE_NAME: /opt/mysql-log/60500/binlog.000007
EVENT_NAME: wait/io/file/sql/binlog
OPEN_COUNT: 0
*************************** 2. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/tables_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
*************************** 3. row ***************************
 FILE_NAME: /opt/mysql/60500/data/mysql/columns_priv.MYI
EVENT_NAME: wait/io/file/myisam/kfile
OPEN_COUNT: 1
...
</pre><p>
      Setup tables are used to configure and display monitoring
      characteristics. For example, to see which event timers are
      selected, query the <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a>
      tables:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
      <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> lists the set of
      instruments for which events can be collected and shows which of
      them are enabled:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
      To understand how to interpret instrument names, see
      <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
    </p><p>
      To control whether events are collected for an instrument, set its
      <code class="literal">ENABLED</code> value to <code class="literal">YES</code> or
      <code class="literal">NO</code>. For example:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/sql/LOCK_mysql_create_db';</code></strong>
</pre><p>
      The Performance Schema uses collected events to update tables in
      the <code class="literal">performance_schema</code> database, which act as
      <span class="quote">“<span class="quote">consumers</span>”</span> of event information. The
      <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table lists the
      available consumers and which are enabled:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
      To control whether the Performance Schema maintains a consumer as
      a destination for event information, set its
      <code class="literal">ENABLED</code> value.
    </p><p>
      For more information about the setup tables and how to use them to
      control event collection, see
      <a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 Performance Schema Event Filtering">Section 22.2.3.2, “Performance Schema Event Filtering”</a>.
    </p><p>
      There are some miscellaneous tables that do not fall into any of
      the previous groups. For example,
      <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a> lists the
      available event timers and their characteristics. For information
      about timers, see <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-configuration"></a>22.2 Performance Schema Configuration</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-build-configuration">22.2.1 Performance Schema Build Configuration</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-startup-configuration">22.2.2 Performance Schema Startup Configuration</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-runtime-configuration">22.2.3 Performance Schema Runtime Configuration</a></span></dt></dl>
</div>
<p>
      To use the MySQL Performance Schema, these configuration
      considerations apply:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The Performance Schema must be configured into MySQL Server at
          build time to make it available. Performance Schema support is
          included in binary MySQL distributions. If you are building
          from source, you must ensure that it is configured into the
          build as described in
          <a class="xref" href="performance-schema.html#performance-schema-build-configuration" title="22.2.1 Performance Schema Build Configuration">Section 22.2.1, “Performance Schema Build Configuration”</a>.
        </p></li><li class="listitem"><p>
          The Performance Schema must be enabled at server startup to
          enable event collection to occur. Specific Performance Schema
          features can be enabled at server startup or at runtime to
          control which types of event collection occur. See
          <a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 Performance Schema Startup Configuration">Section 22.2.2, “Performance Schema Startup Configuration”</a>,
          <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="22.2.3 Performance Schema Runtime Configuration">Section 22.2.3, “Performance Schema Runtime Configuration”</a>,
          and <a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 Performance Schema Event Filtering">Section 22.2.3.2, “Performance Schema Event Filtering”</a>.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-build-configuration"></a>22.2.1 Performance Schema Build Configuration</h3>

</div>

</div>

</div>
<p>
        For the Performance Schema to be available, it must be
        configured into the MySQL server at build time. Binary MySQL
        distributions provided by Oracle Corporation are configured to
        support the Performance Schema. If you use a binary MySQL
        distribution from another provider, check with the provider
        whether the distribution has been appropriately configured.
      </p><p>
        If you build MySQL from a source distribution, enable the
        Performance Schema by running <span class="command"><strong>CMake</strong></span> with the
        <a class="link" href="installing.html#option_cmake_storage_engine_options" title="Storage Engine Options"><code class="option">WITH_PERFSCHEMA_STORAGE_ENGINE</code></a>
        option enabled:
      </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>cmake . -DWITH_PERFSCHEMA_STORAGE_ENGINE=1</code></strong>
</pre><p>
        Configuring MySQL with the
        <a class="link" href="installing.html#option_cmake_storage_engine_options" title="Storage Engine Options"><code class="option">-DWITHOUT_PERFSCHEMA_STORAGE_ENGINE=1</code></a>
        option prevents inclusion of the Performance Schema, so if you
        want it included, do not use this option. See
        <a class="xref" href="installing.html#source-configuration-options" title="2.9.4 MySQL Source-Configuration Options">Section 2.9.4, “MySQL Source-Configuration Options”</a>.
      </p><p>
        If you install MySQL over a previous installation that was
        configured without the Performance Schema (or with an older
        version of the Performance Schema that may not have all the
        current tables), run <a class="link" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables"><span class="command"><strong>mysql_upgrade</strong></span></a> after
        starting the server to ensure that the
        <code class="literal">performance_schema</code> database exists with all
        current tables. Then restart the server. One indication that you
        need to do this is the presence of messages such as the
        following in the error log:
      </p><pre class="programlisting">
[ERROR] Native table 'performance_schema'.'events_waits_history'
has the wrong structure
[ERROR] Native table 'performance_schema'.'events_waits_history_long'
has the wrong structure
...
</pre><p>
        To verify whether a server was built with Performance Schema
        support, check its help output. If the Performance Schema is
        available, the output will mention several variables with names
        that begin with <code class="literal">performance_schema</code>:
      </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysqld --verbose --help</code></strong>
...
  --performance_schema
                      Enable the performance schema.
  --performance_schema_events_waits_history_long_size=#
                      Number of rows in events_waits_history_long.
...
</pre><p>
        You can also connect to the server and look for a line that
        names the <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a>
        storage engine in the output from <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW
        ENGINES</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
...
      Engine: PERFORMANCE_SCHEMA
     Support: YES
     Comment: Performance Schema
Transactions: NO
          XA: NO
  Savepoints: NO
...
</pre><p>
        If the Performance Schema was not configured into the server at
        build time, no row for
        <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a> will appear in
        the output from <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a>. You
        might see <code class="literal">performance_schema</code> listed in the
        output from <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a>, but
        it will have no tables and you will not be able to use it.
      </p><p>
        A line for <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema"><code class="literal">PERFORMANCE_SCHEMA</code></a> in
        the <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> output means
        that the Performance Schema is available, not that it is
        enabled. To enable it, you must do so at server startup, as
        described in the next section.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-startup-configuration"></a>22.2.2 Performance Schema Startup Configuration</h3>

</div>

</div>

</div>
<p>
        Assuming that the Performance Schema is available, it is enabled
        by default as of MySQL 5.6.6. Before 5.6.6, it is disabled by
        default. To enable or disable it explicitly, start the server
        with the <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a>
        variable set to an appropriate value. For example, use these
        lines in your <code class="filename">my.cnf</code> file:
      </p><pre class="programlisting">
[mysqld]
performance_schema=ON
</pre><p>
        If the server is unable to allocate any internal buffer during
        Performance Schema initialization, the Performance Schema
        disables itself and sets
        <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a> to
        <code class="literal">OFF</code>, and the server runs without
        instrumentation.
      </p><p>
        As of MySQL 5.6.4, the Performance Schema permits instrument and
        consumer configuration at server startup, which previously was
        possible only at runtime using
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements for the
        <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> and
        <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> tables. This change
        was made because configuration at runtime is too late to disable
        instruments that have already been initialized during server
        startup. For example, the
        <code class="literal">wait/synch/mutex/sql/LOCK_open</code> mutex is
        initialized once during server startup, so attempts to disable
        the corresponding instrument at runtime have no effect.
      </p><p>
        To control an instrument at server startup, use an option of
        this form:
      </p><pre class="programlisting">
--performance-schema-instrument='<em class="replaceable"><code>instrument_name</code></em>=<em class="replaceable"><code>value</code></em>'
</pre><p>
        Here, <em class="replaceable"><code>instrument_name</code></em> is an
        instrument name such as
        <code class="literal">wait/synch/mutex/sql/LOCK_open</code>, and
        <em class="replaceable"><code>value</code></em> is one of these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">OFF</code>, <code class="literal">FALSE</code>, or
            <code class="literal">0</code>: Disable the instrument
          </p></li><li class="listitem"><p>
            <code class="literal">ON</code>, <code class="literal">TRUE</code>, or
            <code class="literal">1</code>: Enable and time the instrument
          </p></li><li class="listitem"><p>
            <code class="literal">COUNTED</code>: Enable and count (rather than
            time) the instrument
</p></li></ul>
</div>
<p>
        Each
        <a class="link" href="performance-schema.html#option_mysqld_performance-schema-instrument"><code class="option">--performance-schema-instrument</code></a>
        option can specify only one instrument name, but multiple
        instances of the option can be given to configure multiple
        instruments. In addition, patterns are permitted in instrument
        names to configure instruments that match the pattern. To
        configure all condition synchronization instruments as enabled
        and counted, use this option:
      </p><pre class="programlisting">
--performance-schema-instrument='wait/synch/cond/%=COUNTED'
</pre><p>
        To disable all instruments, use this option:
      </p><pre class="programlisting">
--performance-schema-instrument='%=OFF'
</pre><p>
        Longer instrument name strings take precedence over shorter
        pattern names, regardless of order. For information about
        specifying patterns to select instruments, see
        <a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="22.2.3.4 Naming Instruments or Consumers for Filtering Operations">Section 22.2.3.4, “Naming Instruments or Consumers for Filtering Operations”</a>.
      </p><p>
        An unrecognized instrument name is ignored. It is possible that
        a plugin installed later may create the instrument, at which
        time the name is recognized and configured.
      </p><p>
        To control a consumer at server startup, use an option of this
        form:
      </p><pre class="programlisting">
--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<em class="replaceable"><code>value</code></em>
</pre><p>
        Here, <em class="replaceable"><code>consumer_name</code></em> is a consumer
        name such as <code class="literal">events_waits_history</code>, and
        <em class="replaceable"><code>value</code></em> is one of these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">OFF</code>, <code class="literal">FALSE</code>, or
            <code class="literal">0</code>: Do not collect events for the consumer
          </p></li><li class="listitem"><p>
            <code class="literal">ON</code>, <code class="literal">TRUE</code>, or
            <code class="literal">1</code>: Collect events for the consumer
</p></li></ul>
</div>
<p>
        For example, to enable the
        <code class="literal">events_waits_history</code> consumer, use this
        option:
      </p><pre class="programlisting">
--performance-schema-consumer-events-waits-history=ON
</pre><p>
        The permitted consumer names can be found by examining the
        <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table. Patterns are
        not permitted. Consumer names in the
        <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table use
        underscores, but for consumers set at startup, dashes and
        underscores within the name are equivalent.
      </p><p>
        The Performance Schema includes several system variables that
        provide configuration information:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+--------------------------------------------------------+---------+
| Variable_name                                          | Value   |
+--------------------------------------------------------+---------+
| performance_schema                                     | ON      |
| performance_schema_accounts_size                       | 100     |
| performance_schema_digests_size                        | 200     |
| performance_schema_events_stages_history_long_size     | 10000   |
| performance_schema_events_stages_history_size          | 10      |
| performance_schema_events_statements_history_long_size | 10000   |
| performance_schema_events_statements_history_size      | 10      |
| performance_schema_events_waits_history_long_size      | 10000   |
| performance_schema_events_waits_history_size           | 10      |
| performance_schema_hosts_size                          | 100     |
| performance_schema_max_cond_classes                    | 80      |
| performance_schema_max_cond_instances                  | 1000    |
...
</pre><p>
        The <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a> variable
        is <code class="literal">ON</code> or <code class="literal">OFF</code> to indicate
        whether the Performance Schema is enabled or disabled. The other
        variables indicate table sizes (number of rows) or memory
        allocation values.
</p><a class="indexterm" name="idm139737074176912"></a><a class="indexterm" name="idm139737074175424"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          With the Performance Schema enabled, the number of Performance
          Schema instances affects the server memory footprint, perhaps
          to a large extent. It may be necessary to tune the values of
          Performance Schema system variables to find the number of
          instances that balances insufficient instrumentation against
          excessive memory consumption.
</p>
</div>
<p>
        To change the value of Performance Schema system variables, set
        them at server startup. For example, put the following lines in
        a <code class="filename">my.cnf</code> file to change the sizes of the
        history tables for wait events:
      </p><pre class="programlisting">
[mysqld]
performance_schema
performance_schema_events_waits_history_size=20
performance_schema_events_waits_history_long_size=15000
</pre><p>
        As of MySQL 5.6.6, the Performance Schema automatically sizes
        the values of several of its parameters at server startup if
        they are not set explicitly. For example, it sizes the
        parameters that control the sizes of the events waits tables
        this way. To see which parameters are autosized under this
        policy, use <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld --verbose --help</strong></span></a> and look
        for those with a default value of −1, or see
        <a class="xref" href="performance-schema.html#performance-schema-system-variables" title="22.12 Performance Schema System Variables">Section 22.12, “Performance Schema System Variables”</a>.
      </p><p>
        For each autosized parameter that is not set at server startup
        (or is set to −1), the Performance Schema determines how
        to set its value based on the value of the following system
        values, which are considered as <span class="quote">“<span class="quote">hints</span>”</span> about how
        you have configured your MySQL server:
      </p><pre class="programlisting">
max_connections
open_files_limit
table_definition_cache
table_open_cache
</pre><p>
        To override autosizing for a given parameter, set it to a value
        other than −1 at startup. In this case, the Performance
        Schema assigns it the specified value.
      </p><p>
        At runtime, <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a>
        displays the actual values that autosized parameters were set
        to.
      </p><p>
        If the Performance Schema is disabled, its autosized parameters
        remain set to −1 and <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW
        VARIABLES</code></a> displays −1.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-runtime-configuration"></a>22.2.3 Performance Schema Runtime Configuration</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-timing">22.2.3.1 Performance Schema Event Timing</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering">22.2.3.2 Performance Schema Event Filtering</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-pre-filtering">22.2.3.3 Event Pre-Filtering</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-filtering-names">22.2.3.4 Naming Instruments or Consumers for Filtering Operations</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instrumentation-checking">22.2.3.5 Determining What Is Instrumented</a></span></dt></dl>
</div>
<p>
        Performance Schema setup tables contain information about
        monitoring configuration:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT TABLE_NAME FROM INFORMATION_SCHEMA.TABLES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLE_SCHEMA = 'performance_schema'</code></strong>
    -&gt; <strong class="userinput"><code>AND TABLE_NAME LIKE 'setup%';</code></strong>
+-------------------+
| TABLE_NAME        |
+-------------------+
| setup_actors      |
| setup_consumers   |
| setup_instruments |
| setup_objects     |
| setup_timers      |
+-------------------+
</pre><p>
        You can examine the contents of these tables to obtain
        information about Performance Schema monitoring characteristics.
        If you have the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege,
        you can change Performance Schema operation by modifying setup
        tables to affect how monitoring occurs. For additional details
        about these tables, see
        <a class="xref" href="performance-schema.html#performance-schema-setup-tables" title="22.9.2 Performance Schema Setup Tables">Section 22.9.2, “Performance Schema Setup Tables”</a>.
      </p><p>
        To see which event timers are selected, query the
        <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> tables:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
        The <code class="literal">NAME</code> value indicates the type of
        instrument to which the timer applies, and
        <code class="literal">TIMER_NAME</code> indicates which timer applies to
        those instruments. The timer applies to instruments where their
        name begins with a component matching the
        <code class="literal">NAME</code> value.
      </p><p>
        To change the timer, update the <code class="literal">NAME</code> value.
        For example, to use the <code class="literal">NANOSECOND</code> timer for
        the <code class="literal">wait</code> timer:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'NANOSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | NANOSECOND  |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
        For discussion of timers, see
        <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
      </p><p>
        The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> and
        <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> tables list the
        instruments for which events can be collected and the types of
        consumers for which event information actually is collected,
        respectively. Other setup tables enable further modification of
        the monitoring configuration.
        <a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 Performance Schema Event Filtering">Section 22.2.3.2, “Performance Schema Event Filtering”</a>, discusses how
        you can modify these tables to affect event collection.
      </p><p>
        If there are Performance Schema configuration changes that must
        be made at runtime using SQL statements and you would like these
        changes to take effect each time the server starts, put the
        statements in a file and start the server with the
        <a class="link" href="server-administration.html#option_mysqld_init-file"><code class="option">--init-file=<em class="replaceable"><code>file_name</code></em></code></a>
        option. This strategy can also be useful if you have multiple
        monitoring configurations, each tailored to produce a different
        kind of monitoring, such as casual server health monitoring,
        incident investigation, application behavior troubleshooting,
        and so forth. Put the statements for each monitoring
        configuration into their own file and specify the appropriate
        file as the <a class="link" href="server-administration.html#option_mysqld_init-file"><code class="option">--init-file</code></a> argument
        when you start the server.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-schema-timing"></a>22.2.3.1 Performance Schema Event Timing</h4>
</div>
</div>
</div>
<p>
          Events are collected by means of instrumentation added to the
          server source code. Instruments time events, which is how the
          Performance Schema provides an idea of how long events take.
          It is also possible to configure instruments not to collect
          timing information. This section discusses the available
          timers and their characteristics, and how timing values are
          represented in events.
</p>
<div class="simplesect">

<div class="titlepage">
<div>

<div class="simple">
<h5 class="title"><a name="performance-schema-timers"></a>Performance Schema Timers</h5>
</div>
</div>
</div>
<p>
            Two Performance Schema tables provide timer information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a> lists
                the available timers and their characteristics.
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> indicates
                which timers are used for which instruments.
</p></li></ul>
</div>
<p>
            Each timer row in <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a>
            must refer to one of the timers listed in
            <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a>.
          </p><p>
            Timers vary in precision and amount of overhead. To see what
            timers are available and their characteristics, check the
            <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a> table:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |      1000000000 |                1 |            112 |
| MICROSECOND |         1000000 |                1 |            136 |
| MILLISECOND |            1036 |                1 |            168 |
| TICK        |             105 |                1 |           2416 |
+-------------+-----------------+------------------+----------------+
</pre><p>
            The columns have these meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                The <code class="literal">TIMER_NAME</code> column shows the names
                of the available timers. <code class="literal">CYCLE</code> refers
                to the timer that is based on the CPU (processor) cycle
                counter. The timers in
                <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> that you can
                use are those that do not have <code class="literal">NULL</code>
                in the other columns. If the values associated with a
                given timer name are <code class="literal">NULL</code>, that timer
                is not supported on your platform.
              </p></li><li class="listitem"><p>
                <code class="literal">TIMER_FREQUENCY</code> indicates the number
                of timer units per second. For a cycle timer, the
                frequency is generally related to the CPU speed. The
                value shown was obtained on a system with a 2.4GHz
                processor. The other timers are based on fixed fractions
                of seconds. For <code class="literal">TICK</code>, the frequency
                may vary by platform (for example, some use 100
                ticks/second, others 1000 ticks/second).
              </p></li><li class="listitem"><p>
                <code class="literal">TIMER_RESOLUTION</code> indicates the number
                of timer units by which timer values increase at a time.
                If a timer has a resolution of 10, its value increases
                by 10 each time.
              </p></li><li class="listitem"><p>
                <code class="literal">TIMER_OVERHEAD</code> is the minimal number
                of cycles of overhead to obtain one timing with the
                given timer. The overhead per event is twice the value
                displayed because the timer is invoked at the beginning
                and end of the event.
</p></li></ul>
</div>
<p>
            To see which timers are in effect or to change timers,
            access the <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+

mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'idle';</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
            By default, the Performance Schema uses the best timer
            available for each instrument type, but you can select a
            different one.
          </p><p>
            To time wait events, the most important criterion is to
            reduce overhead, at the possible expense of the timer
            accuracy, so using the <code class="literal">CYCLE</code> timer is the
            best.
          </p><p>
            The time a statement (or stage) takes to execute is in
            general orders of magnitude larger than the time it takes to
            execute a single wait. To time statements, the most
            important criterion is to have an accurate measure, which is
            not affected by changes in processor frequency, so using a
            timer which is not based on cycles is the best. The default
            timer for statements is <code class="literal">NANOSECOND</code>. The
            extra <span class="quote">“<span class="quote">overhead</span>”</span> compared to the
            <code class="literal">CYCLE</code> timer is not significant, because
            the overhead caused by calling a timer twice (once when the
            statement starts, once when it ends) is orders of magnitude
            less compared to the CPU time used to execute the statement
            itself. Using the <code class="literal">CYCLE</code> timer has no
            benefit here, only drawbacks.
          </p><p>
            The precision offered by the cycle counter depends on
            processor speed. If the processor runs at 1 GHz (one billion
            cycles/second) or higher, the cycle counter delivers
            sub-nanosecond precision. Using the cycle counter is much
            cheaper than getting the actual time of day. For example,
            the standard <code class="literal">gettimeofday()</code> function can
            take hundreds of cycles, which is an unacceptable overhead
            for data gathering that may occur thousands or millions of
            times per second.
          </p><p>
            Cycle counters also have disadvantages:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                End users expect to see timings in wall-clock units,
                such as fractions of a second. Converting from cycles to
                fractions of seconds can be expensive. For this reason,
                the conversion is a quick and fairly rough
                multiplication operation.
              </p></li><li class="listitem"><p>
                Processor cycle rate might change, such as when a laptop
                goes into power-saving mode or when a CPU slows down to
                reduce heat generation. If a processor's cycle rate
                fluctuates, conversion from cycles to real-time units is
                subject to error.
              </p></li><li class="listitem"><p>
                Cycle counters might be unreliable or unavailable
                depending on the processor or the operating system. For
                example, on Pentiums, the instruction is
                <code class="literal">RDTSC</code> (an assembly-language rather
                than a C instruction) and it is theoretically possible
                for the operating system to prevent user-mode programs
                from using it.
              </p></li><li class="listitem"><p>
                Some processor details related to out-of-order execution
                or multiprocessor synchronization might cause the
                counter to seem fast or slow by up to 1000 cycles.
</p></li></ul>
</div>
<p>
            Currently, MySQL works with cycle counters on x386 (Windows,
            OS X, Linux, Solaris, and other Unix flavors), PowerPC, and
            IA-64.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="performance-schema-timing-in-events"></a>Performance Schema Timer Representation in Events</h5>

</div>

</div>

</div>
<p>
            Rows in Performance Schema tables that store current events
            and historical events have three columns to represent timing
            information: <code class="literal">TIMER_START</code> and
            <code class="literal">TIMER_END</code> indicate when an event started
            and finished, and <code class="literal">TIMER_WAIT</code> indicates
            event duration.
          </p><p>
            The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table has
            an <code class="literal">ENABLED</code> column to indicate the
            instruments for which to collect events. The table also has
            a <code class="literal">TIMED</code> column to indicate which
            instruments are timed. If an instrument is not enabled, it
            produces no events. If an enabled instrument is not timed,
            events produced by the instrument have
            <code class="literal">NULL</code> for the
            <code class="literal">TIMER_START</code>,
            <code class="literal">TIMER_END</code>, and
            <code class="literal">TIMER_WAIT</code> timer values. This in turn
            causes those values to be ignored when calculating the sum,
            minimum, maximum, and average time values in summary tables.
          </p><p>
            Internally, times within events are stored in units given by
            the timer in effect when event timing begins. For display
            when events are retrieved from Performance Schema tables,
            times are shown in picoseconds (trillionths of a second) to
            normalize them to a standard unit, regardless of which timer
            is selected.
          </p><p>
            Modifications to the
            <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table affect
            monitoring immediately. Events already in progress may use
            the original timer for the begin time and the new timer for
            the end time. To avoid unpredictable results after you make
            timer changes, use <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
            TABLE</code></a> to reset Performance Schema statistics.
          </p><p>
            The timer baseline (<span class="quote">“<span class="quote">time zero</span>”</span>) occurs at
            Performance Schema initialization during server startup.
            <code class="literal">TIMER_START</code> and
            <code class="literal">TIMER_END</code> values in events represent
            picoseconds since the baseline.
            <code class="literal">TIMER_WAIT</code> values are durations in
            picoseconds.
          </p><p>
            Picosecond values in events are approximate. Their accuracy
            is subject to the usual forms of error associated with
            conversion from one unit to another. If the
            <code class="literal">CYCLE</code> timer is used and the processor
            rate varies, there might be drift. For these reasons, it is
            not reasonable to look at the <code class="literal">TIMER_START</code>
            value for an event as an accurate measure of time elapsed
            since server startup. On the other hand, it is reasonable to
            use <code class="literal">TIMER_START</code> or
            <code class="literal">TIMER_WAIT</code> values in <code class="literal">ORDER
            BY</code> clauses to order events by start time or
            duration.
          </p><p>
            The choice of picoseconds in events rather than a value such
            as microseconds has a performance basis. One implementation
            goal was to show results in a uniform time unit, regardless
            of the timer. In an ideal world this time unit would look
            like a wall-clock unit and be reasonably precise; in other
            words, microseconds. But to convert cycles or nanoseconds to
            microseconds, it would be necessary to perform a division
            for every instrumentation. Division is expensive on many
            platforms. Multiplication is not expensive, so that is what
            is used. Therefore, the time unit is an integer multiple of
            the highest possible <code class="literal">TIMER_FREQUENCY</code>
            value, using a multiplier large enough to ensure that there
            is no major precision loss. The result is that the time unit
            is <span class="quote">“<span class="quote">picoseconds.</span>”</span> This precision is spurious,
            but the decision enables overhead to be minimized.
          </p><p>
            Before MySQL 5.6.26, while a wait, stage, or statement event
            is executing, the respective current-event tables display
            the event with <code class="literal">TIMER_START</code> populated, but
            with <code class="literal">TIMER_END</code> and
            <code class="literal">TIMER_WAIT</code> set to
            <code class="literal">NULL</code>:
          </p><pre class="programlisting">
events_waits_current
events_stages_current
events_statements_current
</pre><p>
            As of MySQL 5.6.26, current-event timing provides more
            information. To make it possible to determine how how long a
            not-yet-completed event has been running, the timer columns
            are set as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">TIMER_START</code> is populated (unchanged
                from previous behavior)
              </p></li><li class="listitem"><p>
                <code class="literal">TIMER_END</code> is populated with the
                current timer value
              </p></li><li class="listitem"><p>
                <code class="literal">TIMER_WAIT</code> is populated with the time
                elapsed so far (<code class="literal">TIMER_END</code> −
                <code class="literal">TIMER_START</code>)
</p></li></ul>
</div>
<p>
            Events that have not yet completed have an
            <code class="literal">END_EVENT_ID</code> value of
            <code class="literal">NULL</code>. To assess time elapsed so far for
            an event, use the <code class="literal">TIMER_WAIT</code> column.
            Therefore, to identify events that have not yet completed
            and have taken longer than <em class="replaceable"><code>N</code></em>
            picoseconds thus far, monitoring applications can use this
            expression in queries:
          </p><pre class="programlisting">
WHERE END_EVENT_ID IS NULL AND TIMER_WAIT &gt; <em class="replaceable"><code>N</code></em>
</pre><p>
            Event identification as just described assumes that the
            corresponding instruments have <code class="literal">ENABLED</code>
            and <code class="literal">TIMED</code> set to <code class="literal">YES</code>
            and that the relevent consumers are enabled.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-schema-filtering"></a>22.2.3.2 Performance Schema Event Filtering</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737074040240"></a><a class="indexterm" name="idm139737074038752"></a><a class="indexterm" name="idm139737074037264"></a><p>
          Events are processed in a producer/consumer fashion:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Instrumented code is the source for events and produces
              events to be collected. The
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table lists
              the instruments for which events can be collected, whether
              they are enabled, and (for enabled instruments) whether to
              collect timing information:
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
</pre><p>
              The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
              provides the most basic form of control over event
              production. To further refine event production based on
              the type of object or thread being monitored, other tables
              may be used as described in
              <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 Event Pre-Filtering">Section 22.2.3.3, “Event Pre-Filtering”</a>.
            </p></li><li class="listitem"><p>
              Performance Schema tables are the destinations for events
              and consume events. The
              <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table lists
              the types of consumers to which event information can be
              sent and whether they are enabled:
            </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre></li></ul>
</div>
<p>
          Filtering can be done at different stages of performance
          monitoring:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <span class="bold"><strong>Pre-filtering.</strong></span> This is
              done by modifying Performance Schema configuration so that
              only certain types of events are collected from producers,
              and collected events update only certain consumers. To do
              this, enable or disable instruments or consumers.
              Pre-filtering is done by the Performance Schema and has a
              global effect that applies to all users.
            </p><p>
              Reasons to use pre-filtering:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  To reduce overhead. Performance Schema overhead should
                  be minimal even with all instruments enabled, but
                  perhaps you want to reduce it further. Or you do not
                  care about timing events and want to disable the
                  timing code to eliminate timing overhead.
                </p></li><li class="listitem"><p>
                  To avoid filling the current-events or history tables
                  with events in which you have no interest.
                  Pre-filtering leaves more <span class="quote">“<span class="quote">room</span>”</span> in these
                  tables for instances of rows for enabled instrument
                  types. If you enable only file instruments with
                  pre-filtering, no rows are collected for nonfile
                  instruments. With post-filtering, nonfile events are
                  collected, leaving fewer rows for file events.
                </p></li><li class="listitem"><p>
                  To avoid maintaining some kinds of event tables. If
                  you disable a consumer, the server does not spend time
                  maintaining destinations for that consumer. For
                  example, if you do not care about event histories, you
                  can disable the history table consumers to improve
                  performance.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              <span class="bold"><strong>Post-filtering.</strong></span> This
              involves the use of <code class="literal">WHERE</code> clauses in
              queries that select information from Performance Schema
              tables, to specify which of the available events you want
              to see. Post-filtering is performed on a per-user basis
              because individual users select which of the available
              events are of interest.
            </p><p>
              Reasons to use post-filtering:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  To avoid making decisions for individual users about
                  which event information is of interest.
                </p></li><li class="listitem"><p>
                  To use the Performance Schema to investigate a
                  performance issue when the restrictions to impose
                  using pre-filtering are not known in advance.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
          The following sections provide more detail about pre-filtering
          and provide guidelines for naming instruments or consumers in
          filtering operations. For information about writing queries to
          retrieve information (post-filtering), see
          <a class="xref" href="performance-schema.html#performance-schema-queries" title="22.3 Performance Schema Queries">Section 22.3, “Performance Schema Queries”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-schema-pre-filtering"></a>22.2.3.3 Event Pre-Filtering</h4>

</div>

</div>

</div>
<p>
          Pre-filtering is done by the Performance Schema and has a
          global effect that applies to all users. Pre-filtering can be
          applied to either the producer or consumer stage of event
          processing:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              To configure pre-filtering at the producer stage, several
              tables can be used:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a>
                  indicates which instruments are available. An
                  instrument disabled in this table produces no events
                  regardless of the contents of the other
                  production-related setup tables. An instrument enabled
                  in this table is permitted to produce events, subject
                  to the contents of the other tables.
                </p></li><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> controls
                  whether the Performance Schema monitors particular
                  table objects.
                </p></li><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> indicates whether
                  monitoring is enabled for each server thread.
                </p></li><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> determines
                  the initial monitoring state for new foreground
                  threads.
</p></li></ul>
</div>
</li><li class="listitem"><p>
              To configure pre-filtering at the consumer stage, modify
              the <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table.
              This determines the destinations to which events are sent.
              <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> also
              implicitly affects event production. If a given event will
              not be sent to any destination (that is, will not be
              consumed), the Performance Schema does not produce it.
</p></li></ul>
</div>
<p>
          Modifications to any of these tables affect monitoring
          immediately, with some exceptions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Modifications to some instruments in the
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table are
              effective only at server startup; changing them at runtime
              has no effect. This affects primarily mutexes, conditions,
              and rwlocks in the server, although there may be other
              instruments for which this is true.
            </p></li><li class="listitem"><p>
              Modifications to the
              <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table affect
              only foreground threads created subsequent to the
              modification, not existing threads.
</p></li></ul>
</div>
<p>
          When you change the monitoring configuration, the Performance
          Schema does not flush the history tables. Events already
          collected remain in the current-events and history tables
          until displaced by newer events. If you disable instruments,
          you might need to wait a while before events for them are
          displaced by newer events of interest. Alternatively, use
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> to empty the
          history tables.
        </p><p>
          After making instrumentation changes, you might want to
          truncate the summary tables to clear aggregate information for
          previously collected events. Except for
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>,
          the effect of <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>
          for summary tables is to reset the summary columns to 0 or
          <code class="literal">NULL</code>, not to remove rows.
        </p><p>
          The following sections describe how to use specific tables to
          control Performance Schema pre-filtering.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="performance-schema-instrument-filtering"></a>22.2.3.3.1 Pre-Filtering by Instrument</h5>
</div>
</div>
</div>
<p>
            The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
            lists the available instruments:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
            To control whether an instrument is enabled, set its
            <code class="literal">ENABLED</code> column to <code class="literal">YES</code>
            or <code class="literal">NO</code>. To configure whether to collect
            timing information for an enabled instrument, set its
            <code class="literal">TIMED</code> value to <code class="literal">YES</code> or
            <code class="literal">NO</code>. Setting the <code class="literal">TIMED</code>
            column affects Performance Schema table contents as
            described in <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
          </p><p>
            Modifications to most
            <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> rows affect
            monitoring immediately. For some instruments, modifications
            are effective only at server startup; changing them at
            runtime has no effect. This affects primarily mutexes,
            conditions, and rwlocks in the server, although there may be
            other instruments for which this is true.
          </p><p>
            The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
            provides the most basic form of control over event
            production. To further refine event production based on the
            type of object or thread being monitored, other tables may
            be used as described in
            <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 Event Pre-Filtering">Section 22.2.3.3, “Event Pre-Filtering”</a>.
          </p><p>
            The following examples demonstrate possible operations on
            the <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
            These changes, like other pre-filtering operations, affect
            all users. Some of these queries use the
            <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> operator and a pattern
            match instrument names. For additional information about
            specifying patterns to select instruments, see
            <a class="xref" href="performance-schema.html#performance-schema-filtering-names" title="22.2.3.4 Naming Instruments or Consumers for Filtering Operations">Section 22.2.3.4, “Naming Instruments or Consumers for Filtering Operations”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Disable all instruments:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO';</code></strong>
</pre><p>
                Now no events will be collected.
              </p></li><li class="listitem"><p>
                Disable all file instruments, adding them to the current
                set of disabled instruments:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/file/%';</code></strong>
</pre></li><li class="listitem"><p>
                Disable only file instruments, enable all other
                instruments:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = IF(NAME LIKE 'wait/io/file/%', 'NO', 'YES');</code></strong>
</pre></li><li class="listitem"><p>
                Enable all but those instruments in the
                <code class="literal">mysys</code> library:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = CASE WHEN NAME LIKE '%/mysys/%' THEN 'YES' ELSE 'NO' END;</code></strong>
</pre></li><li class="listitem"><p>
                Disable a specific instrument:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';</code></strong>
</pre></li><li class="listitem"><p>
                To toggle the state of an instrument,
                <span class="quote">“<span class="quote">flip</span>”</span> its <code class="literal">ENABLED</code>
                value:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = IF(ENABLED = 'YES', 'NO', 'YES')</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/mysys/TMPDIR_mutex';</code></strong>
</pre></li><li class="listitem"><p>
                Disable timing for all events:
              </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET TIMED = 'NO';</code></strong>
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="performance-schema-object-filtering"></a>22.2.3.3.2 Pre-Filtering by Object</h5>

</div>

</div>

</div>
<p>
            The <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table
            controls whether the Performance Schema monitors particular
            table objects. The initial
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> contents look
            like this:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
            Modifications to the
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table affect
            object monitoring immediately.
          </p><p>
            The <code class="literal">OBJECT_TYPE</code> column indicates the type
            of object to which a row applies. <code class="literal">TABLE</code>
            filtering affects table I/O events
            (<code class="literal">wait/io/table/sql/handler</code> instrument)
            and table lock events
            (<code class="literal">wait/lock/table/sql/handler</code> instrument).
          </p><p>
            The <code class="literal">OBJECT_SCHEMA</code> and
            <code class="literal">OBJECT_NAME</code> columns should contain a
            literal schema or table name, or <code class="literal">'%'</code> to
            match any name.
          </p><p>
            The <code class="literal">ENABLED</code> column indicates whether
            matching objects are monitored, and <code class="literal">TIMED</code>
            indicates whether to collect timing information. Setting the
            <code class="literal">TIMED</code> column affects Performance Schema
            table contents as described in
            <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
          </p><p>
            The effect of the default object configuration is to
            instrument all tables except those in the
            <code class="literal">mysql</code>,
            <code class="literal">INFORMATION_SCHEMA</code>, and
            <code class="literal">performance_schema</code> databases. (Tables in
            the <code class="literal">INFORMATION_SCHEMA</code> database are not
            instrumented regardless of the contents of
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>; the row for
            <code class="literal">information_schema.%</code> simply makes this
            default explicit.)
          </p><p>
            When the Performance Schema checks for a match in
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>, it tries to find
            more specific matches first. For rows that match a given
            <code class="literal">OBJECT_TYPE</code>, the Performance Schema
            checks rows in this order:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Rows with
                <code class="literal">OBJECT_SCHEMA='<em class="replaceable"><code>literal</code></em>'</code>
                and
                <code class="literal">OBJECT_NAME='<em class="replaceable"><code>literal</code></em>'</code>.
              </p></li><li class="listitem"><p>
                Rows with
                <code class="literal">OBJECT_SCHEMA='<em class="replaceable"><code>literal</code></em>'</code>
                and <code class="literal">OBJECT_NAME='%'</code>.
              </p></li><li class="listitem"><p>
                Rows with <code class="literal">OBJECT_SCHEMA='%'</code> and
                <code class="literal">OBJECT_NAME='%'</code>.
</p></li></ul>
</div>
<p>
            For example, with a table <code class="literal">db1.t1</code>, the
            Performance Schema looks in <code class="literal">TABLE</code> rows
            for a match for <code class="literal">'db1'</code> and
            <code class="literal">'t1'</code>, then for <code class="literal">'db1'</code>
            and <code class="literal">'%'</code>, then for <code class="literal">'%'</code>
            and <code class="literal">'%'</code>. The order in which matching
            occurs matters because different matching
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> rows can have
            different <code class="literal">ENABLED</code> and
            <code class="literal">TIMED</code> values.
          </p><p>
            For table-related events, the Performance Schema combines
            the contents of <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>
            with <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> to
            determine whether to enable instruments and whether to time
            enabled instruments:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                For tables that match a row in
                <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>, table
                instruments produce events only if
                <code class="literal">ENABLED</code> is <code class="literal">YES</code> in
                both <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> and
                <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>.
              </p></li><li class="listitem"><p>
                The <code class="literal">TIMED</code> values in the two tables
                are combined, so that timing information is collected
                only when both values are <code class="literal">YES</code>.
</p></li></ul>
</div>
<p>
            Suppose that <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>
            contains the following <code class="literal">TABLE</code> rows that
            apply to <code class="literal">db1</code>, <code class="literal">db2</code>, and
            <code class="literal">db3</code>:
          </p><pre class="programlisting">
+-------------+---------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA | OBJECT_NAME | ENABLED | TIMED |
+-------------+---------------+-------------+---------+-------+
| TABLE       | db1           | t1          | YES     | YES   |
| TABLE       | db1           | t2          | NO      | NO    |
| TABLE       | db2           | %           | YES     | YES   |
| TABLE       | db3           | %           | NO      | NO    |
| TABLE       | %             | %           | YES     | YES   |
+-------------+---------------+-------------+---------+-------+
</pre><p>
            If a table-related instrument in
            <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> has an
            <code class="literal">ENABLED</code> value of <code class="literal">NO</code>,
            events for the object are not monitored. If the
            <code class="literal">ENABLED</code> value is <code class="literal">YES</code>,
            event monitoring occurs according to the
            <code class="literal">ENABLED</code> value in the relevant
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> row:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">db1.t1</code> events are monitored
              </p></li><li class="listitem"><p>
                <code class="literal">db1.t2</code> events are not monitored
              </p></li><li class="listitem"><p>
                <code class="literal">db2.t3</code> events are monitored
              </p></li><li class="listitem"><p>
                <code class="literal">db3.t4</code> events are not monitored
              </p></li><li class="listitem"><p>
                <code class="literal">db4.t5</code> events are monitored
</p></li></ul>
</div>
<p>
            Similar logic applies for combining the
            <code class="literal">TIMED</code> columns from the
            <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> and
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> tables to
            determine whether to collect event timing information.
          </p><p>
            If a persistent table and a temporary table have the same
            name, matching against
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> rows occurs the
            same way for both. It is not possible to enable monitoring
            for one table but not the other. However, each table is
            instrumented separately.
          </p><p>
            The <code class="literal">ENABLED</code> column was added in MySQL
            5.6.3. For earlier versions that have no
            <code class="literal">ENABLED</code> column,
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> is used only to
            enable monitoring for objects that match some row in the
            table. There is no way to explicitly disable instrumentation
            with the table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="performance-schema-thread-filtering"></a>22.2.3.3.3 Pre-Filtering by Thread</h5>

</div>

</div>

</div>
<p>
            The <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table contains a
            row for each server thread. Each row contains information
            about a thread and indicates whether monitoring is enabled
            for it. For the Performance Schema to monitor a thread,
            these things must be true:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                The <code class="literal">thread_instrumentation</code> consumer
                in the <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>
                table must be <code class="literal">YES</code>.
              </p></li><li class="listitem"><p>
                The <code class="literal">threads.INSTRUMENTED</code> column must
                be <code class="literal">YES</code>.
              </p></li><li class="listitem"><p>
                Monitoring occurs only for those thread events produced
                from instruments that are enabled in the
                <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p></li></ul>
</div>
<p>
            The <code class="literal">INSTRUMENTED</code> column in the
            <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table indicates the
            monitoring state for each thread. For foreground threads
            (resulting from client connections), the initial
            <code class="literal">INSTRUMENTED</code> value is determined by
            whether the user account associated with the thread matches
            any row in the <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>
            table.
          </p><p>
            For background threads, there is no associated user.
            <code class="literal">INSTRUMENTED</code> is <code class="literal">YES</code> by
            default and <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> is not
            consulted.
          </p><p>
            The initial <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>
            contents look like this:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_actors;</code></strong>
+------+------+------+
| HOST | USER | ROLE |
+------+------+------+
| %    | %    | %    |
+------+------+------+
</pre><p>
            The <code class="literal">HOST</code> and <code class="literal">USER</code>
            columns should contain a literal host or user name, or
            <code class="literal">'%'</code> to match any name.
          </p><p>
            The Performance Schema uses the <code class="literal">HOST</code> and
            <code class="literal">USER</code> columns to match each new foreground
            thread. (<code class="literal">ROLE</code> is unused.) The
            <code class="literal">INSTRUMENTED</code> value for the thread becomes
            <code class="literal">YES</code> if any row matches,
            <code class="literal">NO</code> otherwise. This enables instrumenting
            to be applied selectively per host, user, or combination of
            host and user.
          </p><p>
            By default, monitoring is enabled for all new foreground
            threads because the
            <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table initially
            contains a row with <code class="literal">'%'</code> for both
            <code class="literal">HOST</code> and <code class="literal">USER</code>. To
            perform more limited matching such as to enable monitoring
            only for some foreground threads, you must delete this row
            because it matches any connection.
          </p><p>
            Suppose that you modify
            <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> as follows:
          </p><pre class="programlisting">
TRUNCATE TABLE setup_actors;
</pre><p>
            Now <code class="literal">setup_actors</code> is empty and there are
            no rows that could match incoming connections. Consequently,
            the Performance Schema sets the
            <code class="literal">INSTRUMENTED</code> column to
            <code class="literal">NO</code> for all new foreground threads.
          </p><p>
            Suppose that you further modify
            <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>:
          </p><pre class="programlisting">
INSERT INTO setup_actors (HOST,USER,ROLE) VALUES('localhost','joe','%');
INSERT INTO setup_actors (HOST,USER,ROLE) VALUES('%','sam','%');
</pre><p>
            Now the Performance Schema determines how to set the
            <code class="literal">INSTRUMENTED</code> value for new connection
            threads as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                If <code class="literal">joe</code> connects from the local host,
                the connection matches the first inserted row.
              </p></li><li class="listitem"><p>
                If <code class="literal">joe</code> connects from any other host,
                there is no match.
              </p></li><li class="listitem"><p>
                If <code class="literal">sam</code> connects from any host, the
                connection matches the second inserted row.
              </p></li><li class="listitem"><p>
                For any other connection, there is no match.
</p></li></ul>
</div>
<p>
            Modifications to the
            <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table affect only
            foreground threads created subsequent to the modification,
            not existing threads. To affect existing threads, modify the
            <code class="literal">INSTRUMENTED</code> column of
            <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table rows.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="performance-schema-consumer-filtering"></a>22.2.3.3.4 Pre-Filtering by Consumer</h5>

</div>

</div>

</div>
<p>
            The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table lists
            the available consumer types and which are enabled:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
            Modify the <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>
            table to affect pre-filtering at the consumer stage and
            determine the destinations to which events are sent. To
            enable or disable a consumer, set its
            <code class="literal">ENABLED</code> value to <code class="literal">YES</code>
            or <code class="literal">NO</code>.
          </p><p>
            Modifications to the
            <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table affect
            monitoring immediately.
          </p><p>
            If you disable a consumer, the server does not spend time
            maintaining destinations for that consumer. For example, if
            you do not care about historical event information, disable
            the history consumers:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME LIKE '%history%';</code></strong>
</pre><p>
            The consumer settings in the
            <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table form a
            hierarchy from higher levels to lower. The following
            principles apply:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Destinations associated with a consumer receive no
                events unless the Performance Schema checks the consumer
                and the consumer is enabled.
              </p></li><li class="listitem"><p>
                A consumer is checked only if all consumers it depends
                on (if any) are enabled.
              </p></li><li class="listitem"><p>
                If a consumer is not checked, or is checked but is
                disabled, other consumers that depend on it are not
                checked.
              </p></li><li class="listitem"><p>
                Dependent consumers may have their own dependent
                consumers.
              </p></li><li class="listitem"><p>
                If an event would not be sent to any destination, the
                Performance Schema does not produce it.
</p></li></ul>
</div>
<p>
            The following lists describe the available consumer values.
            For discussion of several representative consumer
            configurations and their effect on instrumentation, see
            <a class="xref" href="performance-schema.html#performance-schema-consumer-configurations" title="22.2.3.3.5 Example Consumer Configurations">Section 22.2.3.3.5, “Example Consumer Configurations”</a>.
          </p><p>
            <span class="bold"><strong>Global and Thread Consumers</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">global_instrumentation</code> is the highest
                level consumer. If
                <code class="literal">global_instrumentation</code> is
                <code class="literal">NO</code>, it disables global
                instrumentation. All other settings are lower level and
                are not checked; it does not matter what they are set
                to. No global or per thread information is maintained
                and no individual events are collected in the
                current-events or event-history tables. If
                <code class="literal">global_instrumentation</code> is
                <code class="literal">YES</code>, the Performance Schema maintains
                information for global states and also checks the
                <code class="literal">thread_instrumentation</code> consumer.
              </p></li><li class="listitem"><p>
                <code class="literal">thread_instrumentation</code> is checked
                only if <code class="literal">global_instrumentation</code> is
                <code class="literal">YES</code>. Otherwise, if
                <code class="literal">thread_instrumentation</code> is
                <code class="literal">NO</code>, it disables thread-specific
                instrumentation and all lower-level settings are
                ignored. No information is maintained per thread and no
                individual events are collected in the current-events or
                event-history tables. If
                <code class="literal">thread_instrumentation</code> is
                <code class="literal">YES</code>, the Performance Schema maintains
                thread-specific information and also checks
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>
                consumers.
</p></li></ul>
</div>
<p>
            <span class="bold"><strong>Wait Event Consumers</strong></span>
          </p><p>
            These consumers require both
            <code class="literal">global_instrumentation</code> and
            <code class="literal">thread_instrumentation</code> to be
            <code class="literal">YES</code> or they are not checked. If checked,
            they act as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_waits_current</code>, if
                <code class="literal">NO</code>, disables collection of individual
                wait events in the
                <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table.
                If <code class="literal">YES</code>, it enables wait event
                collection and the Performance Schema checks the
                <code class="literal">events_waits_history</code> and
                <code class="literal">events_waits_history_long</code> consumers.
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_history</code> is not checked
                if <code class="literal">event_waits_current</code> is
                <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_waits_history</code> value of
                <code class="literal">NO</code> or <code class="literal">YES</code> disables
                or enables collection of wait events in the
                <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> table.
              </p></li><li class="listitem"><p>
                <code class="literal">events_waits_history_long</code> is not
                checked if <code class="literal">event_waits_current</code> is
                <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_waits_history_long</code> value of
                <code class="literal">NO</code> or <code class="literal">YES</code> disables
                or enables collection of wait events in the
                <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
                table.
</p></li></ul>
</div>
<p>
            <span class="bold"><strong>Stage Event Consumers</strong></span>
          </p><p>
            These consumers require both
            <code class="literal">global_instrumentation</code> and
            <code class="literal">thread_instrumentation</code> to be
            <code class="literal">YES</code> or they are not checked. If checked,
            they act as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_stages_current</code>, if
                <code class="literal">NO</code>, disables collection of individual
                stage events in the
                <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a>
                table. If <code class="literal">YES</code>, it enables stage event
                collection and the Performance Schema checks the
                <code class="literal">events_stages_history</code> and
                <code class="literal">events_stages_history_long</code> consumers.
              </p></li><li class="listitem"><p>
                <code class="literal">events_stages_history</code> is not checked
                if <code class="literal">event_stages_current</code> is
                <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_stages_history</code> value of
                <code class="literal">NO</code> or <code class="literal">YES</code> disables
                or enables collection of stage events in the
                <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a>
                table.
              </p></li><li class="listitem"><p>
                <code class="literal">events_stages_history_long</code> is not
                checked if <code class="literal">event_stages_current</code> is
                <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_stages_history_long</code> value of
                <code class="literal">NO</code> or <code class="literal">YES</code> disables
                or enables collection of stage events in the
                <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
                table.
</p></li></ul>
</div>
<p>
            <span class="bold"><strong>Statement Event Consumers</strong></span>
          </p><p>
            These consumers require both
            <code class="literal">global_instrumentation</code> and
            <code class="literal">thread_instrumentation</code> to be
            <code class="literal">YES</code> or they are not checked. If checked,
            they act as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_statements_current</code>, if
                <code class="literal">NO</code>, disables collection of individual
                statement events in the
                <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
                table. If <code class="literal">YES</code>, it enables statement
                event collection and the Performance Schema checks the
                <code class="literal">events_statements_history</code> and
                <code class="literal">events_statements_history_long</code>
                consumers.
              </p></li><li class="listitem"><p>
                <code class="literal">events_statements_history</code> is not
                checked if <code class="literal">events_statements_current</code>
                is <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_statements_history</code> value of
                <code class="literal">NO</code> or <code class="literal">YES</code> disables
                or enables collection of statement events in the
                <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>
                table.
              </p></li><li class="listitem"><p>
                <code class="literal">events_statements_history_long</code> is not
                checked if <code class="literal">events_statements_current</code>
                is <code class="literal">NO</code>. Otherwise, an
                <code class="literal">events_statements_history_long</code> value
                of <code class="literal">NO</code> or <code class="literal">YES</code>
                disables or enables collection of statement events in
                the
                <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
                table.
</p></li></ul>
</div>
<p>
            <span class="bold"><strong>Statement Digest Consumer</strong></span>
          </p><p>
            This consumer requires
            <code class="literal">global_instrumentation</code> to be
            <code class="literal">YES</code> or it is not checked. There is no
            dependency on the statement event consumers, so you can
            obtain statistics per digest without having to collect
            statistics in
            <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>,
            which is advantageous in terms of overhead. Conversely, you
            can get detailed statements in
            <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
            without digests (the <code class="literal">DIGEST</code> and
            <code class="literal">DIGEST_TEXT</code> columns will be
            <code class="literal">NULL</code>).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="performance-schema-consumer-configurations"></a>22.2.3.3.5 Example Consumer Configurations</h5>

</div>

</div>

</div>
<p>
            The consumer settings in the
            <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table form a
            hierarchy from higher levels to lower. The following
            discussion describes how consumers work, showing specific
            configurations and their effects as consumer settings are
            enabled progressively from high to low. The consumer values
            shown are representative. The general principles described
            here apply to other consumer values that may be available.
          </p><p>
            The configuration descriptions occur in order of increasing
            functionality and overhead. If you do not need the
            information provided by enabling lower-level settings,
            disable them and the Performance Schema will execute less
            code on your behalf and you will have less information to
            sift through.
          </p><p>
            The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table
            contains the following hierarchy of values:
          </p><pre class="programlisting">
global_instrumentation
 thread_instrumentation
   events_waits_current
     events_waits_history
     events_waits_history_long
   events_stages_current
     events_stages_history
     events_stages_history_long
   events_statements_current
     events_statements_history
     events_statements_history_long
 statements_digest
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              In the consumer hierarchy, the consumers for waits,
              stages, and statements are all at the same level. This
              differs from the event nesting hierarchy, for which wait
              events nest within stage events, which nest within
              statement events.
</p>
</div>
<p>
            If a given consumer setting is <code class="literal">NO</code>, the
            Performance Schema disables the instrumentation associated
            with the consumer and ignores all lower-level settings. If a
            given setting is <code class="literal">YES</code>, the Performance
            Schema enables the instrumentation associated with it and
            checks the settings at the next lowest level. For a
            description of the rules for each consumer, see
            <a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="22.2.3.3.4 Pre-Filtering by Consumer">Section 22.2.3.3.4, “Pre-Filtering by Consumer”</a>.
          </p><p>
            For example, if <code class="literal">global_instrumentation</code> is
            enabled, <code class="literal">thread_instrumentation</code> is
            checked. If <code class="literal">thread_instrumentation</code> is
            enabled, the
            <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>
            consumers are checked. If of these
            <code class="literal">events_waits_current</code> is enabled,
            <code class="literal">events_waits_history</code> and
            <code class="literal">events_waits_history_long</code> are checked.
          </p><p>
            Each of the following configuration descriptions indicates
            which setup elements the Performance Schema checks and which
            output tables it maintains (that is, for which tables it
            collects information).
          </p><h6><a name="idm139737073667952"></a>No Instrumentation</h6><p>
            Server configuration state:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
            In this configuration, nothing is instrumented.
          </p><p>
            Setup elements checked:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>,
                consumer <code class="literal">global_instrumentation</code>
</p></li></ul>
</div>
<p>
            Output tables maintained:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                None
</p></li></ul>
</div>
<h6><a name="idm139737073659520"></a>Global Instrumentation Only</h6><p>
            Server configuration state:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| global_instrumentation    | YES     |
| thread_instrumentation    | NO      |
...
+---------------------------+---------+
</pre><p>
            In this configuration, instrumentation is maintained only
            for global states. Per-thread instrumentation is disabled.
          </p><p>
            Additional setup elements checked, relative to the preceding
            configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>,
                consumer <code class="literal">thread_instrumentation</code>
              </p></li><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a>
              </p></li><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>
              </p></li><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a>
</p></li></ul>
</div>
<p>
            Additional output tables maintained, relative to the
            preceding configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#cond-instances-table" title="22.9.3.1 The cond_instances Table"><code class="literal">cond_instances</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_event_name</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_instance</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_event_name</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#objects-summary-global-by-type-table" title="22.9.9.4 Object Wait Summary Table"><code class="literal">objects_summary_global_by_type</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_instance</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_global_by_event_name</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_global_by_event_name</code></a>
              </p></li><li class="listitem"><p>
                <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_global_by_event_name</code></a>
</p></li></ul>
</div>
<h6><a name="idm139737073608464"></a>Global and Thread Instrumentation Only</h6><p>
            Server configuration state:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | NO      |
...
| events_stages_current          | NO      |
...
| events_statements_current      | YES     |
...
+--------------------------------+---------+
</pre><p>
            In this configuration, instrumentation is maintained
            globally and per thread. No individual events are collected
            in the current-events or event-history tables.
          </p><p>
            Additional setup elements checked, relative to the preceding
            configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>,
                consumers
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
              </p></li><li class="listitem"><p>
                Table <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>
              </p></li><li class="listitem"><p>
                Column <code class="literal">threads.instrumented</code>
</p></li></ul>
</div>
<p>
            Additional output tables maintained, relative to the
            preceding configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_by_<em class="replaceable"><code>yyy</code></em>_by_event_name</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>; and
                <em class="replaceable"><code>yyy</code></em> is
                <code class="literal">thread</code>, <code class="literal">user</code>,
                <code class="literal">host</code>, <code class="literal">account</code>
</p></li></ul>
</div>
<h6><a name="idm139737073585808"></a>Global, Thread, and Current-Event Instrumentation</h6><p>
            Server configuration state:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| events_stages_current          | YES     |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
...
+--------------------------------+---------+
</pre><p>
            In this configuration, instrumentation is maintained
            globally and per thread. Individual events are collected in
            the current-events table, but not in the event-history
            tables.
          </p><p>
            Additional setup elements checked, relative to the preceding
            configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                Consumers
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
              </p></li><li class="listitem"><p>
                Consumers
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
</p></li></ul>
</div>
<p>
            Additional output tables maintained, relative to the
            preceding configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_current</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
</p></li></ul>
</div>
<h6><a name="idm139737073566656"></a>Global, Thread, Current-Event, and Event-History instrumentation</h6><p>
            The preceding configuration collects no event history
            because the
            <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>
            and
            <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>
            consumers are disabled. Those consumers can be enabled
            separately or together to collect event history per thread,
            globally, or both.
          </p><p>
            This configuration collects event history per thread, but
            not globally:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | YES     |
| events_waits_history_long      | NO      |
| events_stages_current          | YES     |
| events_stages_history          | YES     |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | YES     |
| events_statements_history_long | NO      |
...
+--------------------------------+---------+
</pre><p>
            Event-history tables maintained for this configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
</p></li></ul>
</div>
<p>
            This configuration collects event history globally, but not
            per thread:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | NO      |
| events_waits_history_long      | YES     |
| events_stages_current          | YES     |
| events_stages_history          | NO      |
| events_stages_history_long     | YES     |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | YES     |
...
+--------------------------------+---------+
</pre><p>
            Event-history tables maintained for this configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
</p></li></ul>
</div>
<p>
            This configuration collects event history per thread and
            globally:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| events_waits_current           | YES     |
| events_waits_history           | YES     |
| events_waits_history_long      | YES     |
| events_stages_current          | YES     |
| events_stages_history          | YES     |
| events_stages_history_long     | YES     |
| events_statements_current      | YES     |
| events_statements_history      | YES     |
| events_statements_history_long | YES     |
...
+--------------------------------+---------+
</pre><p>
            Event-history tables maintained for this configuration:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
              </p></li><li class="listitem"><p>
                <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_history_long</code>,
                where <em class="replaceable"><code>xxx</code></em> is
                <code class="literal">waits</code>, <code class="literal">stages</code>,
                <code class="literal">statements</code>
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-schema-filtering-names"></a>22.2.3.4 Naming Instruments or Consumers for Filtering Operations</h4>

</div>

</div>

</div>
<p>
          Names given for filtering operations can be as specific or
          general as required. To indicate a single instrument or
          consumer, specify its name in full:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait/synch/mutex/myisammrg/MYRG_INFO::mutex';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME = 'events_waits_current';</code></strong>
</pre><p>
          To specify a group of instruments or consumers, use a pattern
          that matches the group members:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/synch/mutex/%';</code></strong>

mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers</code></strong>
    -&gt; <strong class="userinput"><code>SET ENABLED = 'NO' WHERE NAME LIKE '%history%';</code></strong>
</pre><p>
          If you use a pattern, it should be chosen so that it matches
          all the items of interest and no others. For example, to
          select all file I/O instruments, it is better to use a pattern
          that includes the entire instrument name prefix:
        </p><pre class="programlisting">
... WHERE NAME LIKE 'wait/io/file/%';
</pre><p>
          A pattern of <code class="literal">'%/file/%'</code> will match other
          instruments that have a component of
          <code class="literal">'/file/'</code> anywhere in the name. Even less
          suitable is the pattern <code class="literal">'%file%'</code> because it
          will match instruments with <code class="literal">'file'</code> anywhere
          in the name, such as
          <code class="literal">wait/synch/mutex/sql/LOCK_des_key_file</code>.
        </p><p>
          To check which instrument or consumer names a pattern matches,
          perform a simple test:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NAME FROM setup_instruments WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';</code></strong>

mysql&gt; <strong class="userinput"><code>SELECT NAME FROM setup_consumers WHERE NAME LIKE '<em class="replaceable"><code>pattern</code></em>';</code></strong>
</pre><p>
          For information about the types of names that are supported,
          see <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-schema-instrumentation-checking"></a>22.2.3.5 Determining What Is Instrumented</h4>

</div>

</div>

</div>
<p>
          It is always possible to determine what instruments the
          Performance Schema includes by checking the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table. For
          example, to see what file-related events are instrumented for
          the <code class="literal">InnoDB</code> storage engine, use this query:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'wait/io/file/innodb/%';</code></strong>
+--------------------------------------+---------+-------+
| NAME                                 | ENABLED | TIMED |
+--------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_data_file | YES     | YES   |
| wait/io/file/innodb/innodb_log_file  | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file | YES     | YES   |
+--------------------------------------+---------+-------+
</pre><p>
          An exhaustive description of precisely what is instrumented is
          not given in this documentation, for several reasons:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              What is instrumented is the server code. Changes to this
              code occur often, which also affects the set of
              instruments.
            </p></li><li class="listitem"><p>
              It is not practical to list all the instruments because
              there are hundreds of them.
            </p></li><li class="listitem"><p>
              As described earlier, it is possible to find out by
              querying the
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table. This
              information is always up to date for your version of
              MySQL, also includes instrumentation for instrumented
              plugins you might have installed that are not part of the
              core server, and can be used by automated tools.
</p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-queries"></a>22.3 Performance Schema Queries</h2>

</div>

</div>

</div>
<p>
      Pre-filtering limits which event information is collected and is
      independent of any particular user. By contrast, post-filtering is
      performed by individual users through the use of queries with
      appropriate <code class="literal">WHERE</code> clauses that restrict what
      event information to select from the events available after
      pre-filtering has been applied.
    </p><p>
      In <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 Event Pre-Filtering">Section 22.2.3.3, “Event Pre-Filtering”</a>, an example
      showed how to pre-filter for file instruments. If the event tables
      contain both file and nonfile information, post-filtering is
      another way to see information only for file events. Add a
      <code class="literal">WHERE</code> clause to queries to restrict event
      selection appropriately:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT THREAD_ID, NUMBER_OF_BYTES</code></strong>
    -&gt; <strong class="userinput"><code>FROM events_waits_history</code></strong>
    -&gt; <strong class="userinput"><code>WHERE EVENT_NAME LIKE 'wait/io/file/%'</code></strong>
    -&gt; <strong class="userinput"><code>AND NUMBER_OF_BYTES IS NOT NULL;</code></strong>
+-----------+-----------------+
| THREAD_ID | NUMBER_OF_BYTES |
+-----------+-----------------+
|        11 |              66 |
|        11 |              47 |
|        11 |             139 |
|         5 |              24 |
|         5 |             834 |
+-----------+-----------------+
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-instrument-naming"></a>22.4 Performance Schema Instrument Naming Conventions</h2>

</div>

</div>

</div>
<p>
      An instrument name consists of a sequence of components separated
      by <code class="literal">'/'</code> characters. Example names:
    </p><pre class="programlisting">
wait/io/file/myisam/log
wait/io/file/mysys/charset
wait/lock/table/sql/handler
wait/synch/cond/mysys/COND_alarm
wait/synch/cond/sql/BINLOG::update_cond
wait/synch/mutex/mysys/BITMAP_mutex
wait/synch/mutex/sql/LOCK_delete
wait/synch/rwlock/sql/Query_cache_query::lock
stage/sql/closing tables
stage/sql/Sorting result
statement/com/Execute
statement/com/Query
statement/sql/create_table
statement/sql/lock_tables
</pre><p>
      The instrument name space has a tree-like structure. The
      components of an instrument name from left to right provide a
      progression from more general to more specific. The number of
      components a name has depends on the type of instrument.
    </p><p>
      The interpretation of a given component in a name depends on the
      components to the left of it. For example,
      <code class="literal">myisam</code> appears in both of the following names,
      but <code class="literal">myisam</code> in the first name is related to file
      I/O, whereas in the second it is related to a synchronization
      instrument:
    </p><pre class="programlisting">
wait/io/file/myisam/log
wait/synch/cond/myisam/MI_SORT_INFO::cond
</pre><p>
      Instrument names consist of a prefix with a structure defined by
      the Performance Schema implementation and a suffix defined by the
      developer implementing the instrument code. The top-level
      component of an instrument prefix indicates the type of
      instrument. This component also determines which event timer in
      the <code class="literal">setup_timers</code> table applies to the
      instrument. For the prefix part of instrument names, the top level
      indicates the type of instrument.
    </p><p>
      The suffix part of instrument names comes from the code for the
      instruments themselves. Suffixes may include levels such as these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A name for the major component (a server module such as
          <code class="literal">myisam</code>, <code class="literal">innodb</code>,
          <code class="literal">mysys</code>, or <code class="literal">sql</code>) or a
          plugin name.
        </p></li><li class="listitem"><p>
          The name of a variable in the code, in the form
          <em class="replaceable"><code>XXX</code></em> (a global variable) or
          <code class="literal"><em class="replaceable"><code>CCC</code></em>::<em class="replaceable"><code>MMM</code></em></code>
          (a member <em class="replaceable"><code>MMM</code></em> in class
          <em class="replaceable"><code>CCC</code></em>). Examples:
          <code class="literal">COND_thread_cache</code>,
          <code class="literal">THR_LOCK_myisam</code>,
          <code class="literal">BINLOG::LOCK_index</code>.
</p></li></ul>
</div>
<p>
      <span class="bold"><strong>Top-Level Instrument Components</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">idle</code>: An instrumented idle event. This
          instrument has no further components.
        </p></li><li class="listitem"><p>
          <code class="literal">stage</code>: An instrumented stage event.
        </p></li><li class="listitem"><p>
          <code class="literal">statement</code>: An instrumented statement event.
        </p></li><li class="listitem"><p>
          <code class="literal">wait</code>: An instrumented wait event.
</p></li></ul>
</div>
<p>
      <span class="bold"><strong>Idle Instrument Components</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">idle</code>
        </p><p>
          The idle instrument. The Performance Schema generates idle
          events as discussed in the description of the
          <code class="literal">socket_instances.STATE</code> column in
          <a class="xref" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table">Section 22.9.3.5, “The socket_instances Table”</a>.
</p></li></ul>
</div>
<p>
      <span class="bold"><strong>Stage Instrument Components</strong></span>
    </p><p>
      Stage instruments have names of the form
      <code class="literal">stage/<em class="replaceable"><code>code_area</code></em>/<em class="replaceable"><code>stage_name</code></em></code>,
      where <em class="replaceable"><code>code_area</code></em> is a value such as
      <code class="literal">sql</code> or <code class="literal">myisam</code>, and
      <em class="replaceable"><code>stage_name</code></em> indicates the stage of
      statement processing, such as <code class="literal">Sorting result</code> or
      <code class="literal">Sending data</code>. Stages correspond to the thread
      states displayed by <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a> or that are visible in the
      <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a> table.
    </p><p>
      <span class="bold"><strong>Statement Instrument Components</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">statement/abstract/*</code>: An abstract
          instrument for statement operations. Abstract instruments are
          used during the early stages of statement classification
          before the exact statement type is known, then changed to a
          more specific statement instrument when the type is known. For
          a description of this process, see
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">statement/com</code>: An instrumented command
          operation. These have names corresponding to
          <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
          operations (see the <code class="filename">mysql_com.h</code> header
          file and <code class="filename">sql/sql_parse.cc</code>. For example,
          the <code class="literal">statement/com/Connect</code> and
          <code class="literal">statement/com/Init DB</code> instruments
          correspond to the <code class="literal">COM_CONNECT</code> and
          <code class="literal">COM_INIT_DB</code> commands.
        </p></li><li class="listitem"><p>
          <code class="literal">statement/sql</code>: An instrumented SQL
          statement operation. For example, the
          <code class="literal">statement/sql/create_db</code> and
          <code class="literal">statement/sql/select</code> instruments are used
          for <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> and
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
</p></li></ul>
</div>
<p>
      <span class="bold"><strong>Wait Instrument Components</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">wait/io</code>
        </p><p>
          An instrumented I/O operation.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/io/file</code>
            </p><p>
              An instrumented file I/O operation. For files, the wait is
              the time waiting for the file operation to complete (for
              example, a call to <code class="literal">fwrite()</code>). Due to
              caching, the physical file I/O on the disk might not
              happen within this call.
            </p></li><li class="listitem"><p>
              <code class="literal">wait/io/socket</code>
            </p><p>
              An instrumented socket operation. Socket instruments have
              names of the form
              <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code>.
              The server has a listening socket for each network
              protocol that it supports. The instruments associated with
              listening sockets for TCP/IP or Unix socket file
              connections have a <em class="replaceable"><code>socket_type</code></em>
              value of <code class="literal">server_tcpip_socket</code> or
              <code class="literal">server_unix_socket</code>, respectively. When
              a listening socket detects a connection, the server
              transfers the connection to a new socket managed by a
              separate thread. The instrument for the new connection
              thread has a <em class="replaceable"><code>socket_type</code></em> value
              of <code class="literal">client_connection</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">wait/io/table</code>
            </p><p>
              An instrumented table I/O operation. These include
              row-level accesses to persistent base tables or temporary
              tables. Operations that affect rows are fetch, insert,
              update, and delete. For a view, waits are associated with
              base tables referenced by the view.
            </p><p>
              Unlike most waits, a table I/O wait can include other
              waits. For example, table I/O might include file I/O or
              memory operations. Thus,
              <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> for a
              table I/O wait usually has two rows. For more information,
              see
              <a class="xref" href="performance-schema.html#performance-schema-atom-molecule-events" title="22.6 Performance Schema Atom and Molecule Events">Section 22.6, “Performance Schema Atom and Molecule Events”</a>.
            </p><p>
              Some row operations might cause multiple table I/O waits.
              For example, an insert might activate a trigger that
              causes an update.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">wait/lock</code>
        </p><p>
          An instrumented lock operation.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/lock/table</code>
            </p><p>
              An instrumented table lock operation.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">wait/synch</code>
        </p><p>
          An instrumented synchronization object. For synchronization
          objects, the <code class="literal">TIMER_WAIT</code> time includes the
          amount of time blocked while attempting to acquire a lock on
          the object, if any.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">wait/synch/cond</code>
            </p><p>
              A condition is used by one thread to signal to other
              threads that something they were waiting for has happened.
              If a single thread was waiting for a condition, it can
              wake up and proceed with its execution. If several threads
              were waiting, they can all wake up and compete for the
              resource for which they were waiting.
            </p></li><li class="listitem"><p>
              <code class="literal">wait/synch/mutex</code>
            </p><p>
              A mutual exclusion object used to permit access to a
              resource (such as a section of executable code) while
              preventing other threads from accessing the resource.
            </p></li><li class="listitem"><p>
              <code class="literal">wait/synch/rwlock</code>
            </p><p>
              A read/write lock object used to lock a specific variable
              for access while preventing its use by other threads. A
              shared read lock can be acquired simultaneously by
              multiple threads. An exclusive write lock can be acquired
              by only one thread at a time.
</p></li></ul>
</div>
</li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-status-monitoring"></a>22.5 Performance Schema Status Monitoring</h2>

</div>

</div>

</div>
<p>
      There are several status variables associated with the Performance
      Schema:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-----------------------------------------------+-------+
| Variable_name                                 | Value |
+-----------------------------------------------+-------+
| Performance_schema_accounts_lost              | 0     |
| Performance_schema_cond_classes_lost          | 0     |
| Performance_schema_cond_instances_lost        | 0     |
| Performance_schema_digest_lost                | 0     |
| Performance_schema_file_classes_lost          | 0     |
| Performance_schema_file_handles_lost          | 0     |
| Performance_schema_file_instances_lost        | 0     |
| Performance_schema_hosts_lost                 | 0     |
| Performance_schema_locker_lost                | 0     |
| Performance_schema_mutex_classes_lost         | 0     |
| Performance_schema_mutex_instances_lost       | 0     |
| Performance_schema_rwlock_classes_lost        | 0     |
| Performance_schema_rwlock_instances_lost      | 0     |
| Performance_schema_session_connect_attrs_lost | 0     |
| Performance_schema_socket_classes_lost        | 0     |
| Performance_schema_socket_instances_lost      | 0     |
| Performance_schema_stage_classes_lost         | 0     |
| Performance_schema_statement_classes_lost     | 0     |
| Performance_schema_table_handles_lost         | 0     |
| Performance_schema_table_instances_lost       | 0     |
| Performance_schema_thread_classes_lost        | 0     |
| Performance_schema_thread_instances_lost      | 0     |
| Performance_schema_users_lost                 | 0     |
+-----------------------------------------------+-------+
</pre><p>
      The Performance Schema status variables provide information about
      instrumentation that could not be loaded or created due to memory
      constraints. Names for these variables have several forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_classes_lost</code>
          indicates how many instruments of type
          <em class="replaceable"><code>xxx</code></em> could not be loaded.
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_instances_lost</code>
          indicates how many instances of object type
          <em class="replaceable"><code>xxx</code></em> could not be created.
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_handles_lost</code>
          indicates how many instances of object type
          <em class="replaceable"><code>xxx</code></em> could not be opened.
        </p></li><li class="listitem"><p>
          <code class="literal">Performance_schema_locker_lost</code> indicates
          how many events are <span class="quote">“<span class="quote">lost</span>”</span> or not recorded.
</p></li></ul>
</div>
<p>
      For example, if a mutex is instrumented in the server source but
      the server cannot allocate memory for the instrumentation at
      runtime, it increments
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost"><code class="literal">Performance_schema_mutex_classes_lost</code></a>.
      The mutex still functions as a synchronization object (that is,
      the server continues to function normally), but performance data
      for it will not be collected. If the instrument can be allocated,
      it can be used for initializing instrumented mutex instances. For
      a singleton mutex such as a global mutex, there will be only one
      instance. Other mutexes have an instance per connection, or per
      page in various caches and data buffers, so the number of
      instances varies over time. Increasing the maximum number of
      connections or the maximum size of some buffers will increase the
      maximum number of instances that might be allocated at once. If
      the server cannot create a given instrumented mutex instance, it
      increments
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost"><code class="literal">Performance_schema_mutex_instances_lost</code></a>.
    </p><p>
      Suppose that the following conditions hold:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The server was started with the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="option">--performance_schema_max_mutex_classes=200</code></a>
          option and thus has room for 200 mutex instruments.
        </p></li><li class="listitem"><p>
          150 mutex instruments have been loaded already.
        </p></li><li class="listitem"><p>
          The plugin named <code class="literal">plugin_a</code> contains 40 mutex
          instruments.
        </p></li><li class="listitem"><p>
          The plugin named <code class="literal">plugin_b</code> contains 20 mutex
          instruments.
</p></li></ul>
</div>
<p>
      The server allocates mutex instruments for the plugins depending
      on how many they need and how many are available, as illustrated
      by the following sequence of statements:
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_a
</pre><p>
      The server now has 150+40 = 190 mutex instruments.
    </p><pre class="programlisting">
UNINSTALL PLUGIN plugin_a;
</pre><p>
      The server still has 190 instruments. All the historical data
      generated by the plugin code is still available, but new events
      for the instruments are not collected.
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_a;
</pre><p>
      The server detects that the 40 instruments are already defined, so
      no new instruments are created, and previously assigned internal
      memory buffers are reused. The server still has 190 instruments.
    </p><pre class="programlisting">
INSTALL PLUGIN plugin_b;
</pre><p>
      The server has room for 200-190 = 10 instruments (in this case,
      mutex classes), and sees that the plugin contains 20 new
      instruments. 10 instruments are loaded, and 10 are discarded or
      <span class="quote">“<span class="quote">lost.</span>”</span> The
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost"><code class="literal">Performance_schema_mutex_classes_lost</code></a>
      indicates the number of instruments (mutex classes) lost:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE "perf%mutex_classes_lost";</code></strong>
+---------------------------------------+-------+
| Variable_name                         | Value |
+---------------------------------------+-------+
| Performance_schema_mutex_classes_lost | 10    |
+---------------------------------------+-------+
1 row in set (0.10 sec)
</pre><p>
      The instrumentation still works and collects (partial) data for
      <code class="literal">plugin_b</code>.
    </p><p>
      When the server cannot create a mutex instrument, these results
      occur:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          No row for the instrument is inserted into the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
        </p></li><li class="listitem"><p>
          <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost"><code class="literal">Performance_schema_mutex_classes_lost</code></a>
          increases by 1.
        </p></li><li class="listitem"><p>
          <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost"><code class="literal">Performance_schema_mutex_instances_lost</code></a>
          does not change. (When the mutex instrument is not created, it
          cannot be used to create instrumented mutex instances later.)
</p></li></ul>
</div>
<p>
      The pattern just described applies to all types of instruments,
      not just mutexes.
    </p><p>
      A value of
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost"><code class="literal">Performance_schema_mutex_classes_lost</code></a>
      greater than 0 can happen in two cases:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To save a few bytes of memory, you start the server with
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code></a>,
          where <em class="replaceable"><code>N</code></em> is less than the default
          value. The default value is chosen to be sufficient to load
          all the plugins provided in the MySQL distribution, but this
          can be reduced if some plugins are never loaded. For example,
          you might choose not to load some of the storage engines in
          the distribution.
        </p></li><li class="listitem"><p>
          You load a third-party plugin that is instrumented for the
          Performance Schema but do not allow for the plugin's
          instrumentation memory requirements when you start the server.
          Because it comes from a third party, the instrument memory
          consumption of this engine is not accounted for in the default
          value chosen for
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="literal">performance_schema_max_mutex_classes</code></a>.
        </p><p>
          If the server has insufficient resources for the plugin's
          instruments and you do not explicitly allocate more using
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="option">--performance_schema_max_mutex_classes=<em class="replaceable"><code>N</code></em></code></a>,
          loading the plugin leads to starvation of instruments.
</p></li></ul>
</div>
<p>
      If the value chosen for
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="literal">performance_schema_max_mutex_classes</code></a>
      is too small, no error is reported in the error log and there is
      no failure at runtime. However, the content of the tables in the
      <code class="literal">performance_schema</code> database will miss events.
      The
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost"><code class="literal">Performance_schema_mutex_classes_lost</code></a>
      status variable is the only visible sign to indicate that some
      events were dropped internally due to failure to create
      instruments.
    </p><p>
      If an instrument is not lost, it is known to the Performance
      Schema, and is used when instrumenting instances. For example,
      <code class="literal">wait/synch/mutex/sql/LOCK_delete</code> is the name of
      a mutex instrument in the
      <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table. This single
      instrument is used when creating a mutex in the code (in
      <code class="literal">THD::LOCK_delete</code>) however many instances of the
      mutex are needed as the server runs. In this case,
      <code class="literal">LOCK_delete</code> is a mutex that is per connection
      (<code class="literal">THD</code>), so if a server has 1000 connections,
      there are 1000 threads, and 1000 instrumented
      <code class="literal">LOCK_delete</code> mutex instances
      (<code class="literal">THD::LOCK_delete</code>).
    </p><p>
      If the server does not have room for all these 1000 instrumented
      mutexes (instances), some mutexes are created with
      instrumentation, and some are created without instrumentation. If
      the server can create only 800 instances, 200 instances are lost.
      The server continues to run, but increments
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost"><code class="literal">Performance_schema_mutex_instances_lost</code></a>
      by 200 to indicate that instances could not be created.
    </p><p>
      A value of
      <a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost"><code class="literal">Performance_schema_mutex_instances_lost</code></a>
      greater than 0 can happen when the code initializes more mutexes
      at runtime than were allocated for
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances"><code class="option">--performance_schema_max_mutex_instances=<em class="replaceable"><code>N</code></em></code></a>.
    </p><p>
      The bottom line is that if
      <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW STATUS LIKE
      'perf%'</code></a> says that nothing was lost (all values are
      zero), the Performance Schema data is accurate and can be relied
      upon. If something was lost, the data is incomplete, and the
      Performance Schema could not record everything given the
      insufficient amount of memory it was given to use. In this case,
      the specific
      <code class="literal">Performance_schema_<em class="replaceable"><code>xxx</code></em>_lost</code>
      variable indicates the problem area.
    </p><p>
      It might be appropriate in some cases to cause deliberate
      instrument starvation. For example, if you do not care about
      performance data for file I/O, you can start the server with all
      Performance Schema parameters related to file I/O set to 0. No
      memory will be allocated for file-related classes, instances, or
      handles, and all file events will be lost.
    </p><p>
      Use <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
      PERFORMANCE_SCHEMA STATUS</code></a> to inspect the internal
      operation of the Performance Schema code:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE PERFORMANCE_SCHEMA STATUS\G</code></strong>
...
*************************** 3. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_size
Status: 76
*************************** 4. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_count
Status: 10000
*************************** 5. row ***************************
  Type: performance_schema
  Name: events_waits_history.memory
Status: 760000
...
*************************** 57. row ***************************
  Type: performance_schema
  Name: performance_schema.memory
Status: 26459600
...
</pre><p>
      This statement is intended to help the DBA understand the effects
      that different Performance Schema options have on memory
      requirements. For a description of the field meanings, see
      <a class="xref" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax">Section 13.7.5.16, “SHOW ENGINE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-atom-molecule-events"></a>22.6 Performance Schema Atom and Molecule Events</h2>

</div>

</div>

</div>
<p>
      For a table I/O event, there are usually two rows in
      <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>, not one. For
      example, a row fetch might result in rows like this:
    </p><pre class="programlisting">
Row# EVENT_NAME                 TIMER_START TIMER_END
---- ----------                 ----------- ---------
   1 wait/io/file/myisam/dfile        10001 10002
   2 wait/io/table/sql/handler        10000 NULL
</pre><p>
      The row fetch causes a file read. In the example, the table I/O
      fetch event started before the file I/O event but has not finished
      (its <code class="literal">TIMER_END</code> value is
      <code class="literal">NULL</code>). The file I/O event is
      <span class="quote">“<span class="quote">nested</span>”</span> within the table I/O event.
    </p><p>
      This occurs because, unlike other <span class="quote">“<span class="quote">atomic</span>”</span> wait
      events such as for mutexes or file I/O, table I/O events are
      <span class="quote">“<span class="quote">molecular</span>”</span> and include (overlap with) other events.
      In <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>, the table
      I/O event usually has two rows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          One row for the most recent table I/O wait event
        </p></li><li class="listitem"><p>
          One row for the most recent wait event of any kind
</p></li></ul>
</div>
<p>
      Usually, but not always, the <span class="quote">“<span class="quote">of any kind</span>”</span> wait event
      differs from the table I/O event. As each subsidiary event
      completes, it disappears from
      <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>. At this point,
      and until the next subsidiary event begins, the table I/O wait is
      also the most recent wait of any kind.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-statement-digests"></a>22.7 Performance Schema Statement Digests</h2>

</div>

</div>

</div>
<p>
      As of MySQL 5.6.5, the MySQL server is capable of maintaining
      statement digest information. The digesting process converts a SQL
      statement to normalized form and computes a hash value for the
      result. Normalization permits statements that are similar to be
      grouped and summarized to expose information about the types of
      statements the server is executing and how often they occur. This
      section describes how statement normalizing occurs and how it can
      be useful.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Before MySQL 5.6.24, statement digesting was a function of the
        Performance Schema. As of 5.6.24, digesting occurs at the SQL
        level regardless of whether the Performance Schema is available,
        so that other server functions such as MySQL Enterprise Firewall have access to
        statement digests.
</p>
</div>
<p>
      In the Performance Schema, statement digesting involves these
      components:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A <code class="literal">statement_digest</code> consumer in the
          <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table controls
          whether the Performance Schema maintains digest information.
        </p></li><li class="listitem"><p>
          The statement event tables
          (<a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>,
          <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>, and
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>)
          have columns that contain digests and the corresponding digest
          hash values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">DIGEST_TEXT</code> is the text of the
              normalized statement digest.
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST</code> is the digest MD5 hash value.
</p></li></ul>
</div>
<p>
          The maximum space available for digest computation is 1024
          bytes by default. As of MySQL 5.6.26, this value can be
          changed at server startup by setting the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
          system variable. In MySQL 5.6.24 and 5.6.25, use
          <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a> instead.
          Before 5.6.24, the value cannot be changed.
        </p></li><li class="listitem"><p>
          The statement event tables also have a
          <code class="literal">SQL_TEXT</code> column that contains the original
          SQL statement. The maximum space available for statement
          display is 1024 bytes.
        </p></li><li class="listitem"><p>
          An
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
          table provides aggregated statement digest information.
</p></li></ul>
</div>
<p>
      Normalizing a statement transforms the statement text to a more
      standardized digest string representation that preserves the
      general statement structure while removing information not
      essential to the structure:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Object identifiers such as database and table names are
          preserved.
        </p></li><li class="listitem"><p>
          Literal values are converted to parameter markers. A
          normalized statement does not retain information such as
          names, passwords, dates, and so forth.
        </p></li><li class="listitem"><p>
          Comments are removed and whitespace is adjusted.
</p></li></ul>
</div>
<p>
      Consider these statements:
    </p><pre class="programlisting">
SELECT * FROM orders WHERE customer_id=10 AND quantity&gt;20
SELECT * FROM orders WHERE customer_id = 20 AND quantity &gt; 100
</pre><p>
      To normalize these statements, the Performance Schema replaces
      data values by <code class="literal">?</code> and adjusts whitespace. Both
      statements yield the same normalized form and thus are considered
      <span class="quote">“<span class="quote">the same</span>”</span>:
    </p><pre class="programlisting">
SELECT * FROM orders WHERE customer_id = ? AND quantity &gt; ?
</pre><p>
      The normalized statement contains less information but is still
      representative of the original statement. Other similar statements
      that have different comparison values have the same normalized
      form.
    </p><p>
      Now consider these statements:
    </p><pre class="programlisting">
SELECT * FROM customers WHERE customer_id = 1000
SELECT * FROM orders WHERE customer_id = 1000
</pre><p>
      In this case, the statements are not <span class="quote">“<span class="quote">the same.</span>”</span> The
      object identifiers differ, so the statements yield different
      normalized forms:
    </p><pre class="programlisting">
SELECT * FROM customers WHERE customer_id = ?
SELECT * FROM orders WHERE customer_id = ?
</pre><p>
      If normalization produces a statement that exceeds the space
      available in the digest buffer, the text ends with
      <span class="quote">“<span class="quote">...</span>”</span>. Long statements that differ only in the part
      that occurs following the <span class="quote">“<span class="quote">...</span>”</span> are considered to be
      the same. Consider these statements:
    </p><pre class="programlisting">
SELECT * FROM mytable WHERE cola = 10 AND colb = 20
SELECT * FROM mytable WHERE cola = 10 AND colc = 20
</pre><p>
      If the cutoff happened to be right after the
      <code class="literal">AND</code>, both statements would have this normalized
      form:
    </p><pre class="programlisting">
SELECT * FROM mytable WHERE cola = ? AND ...
</pre><p>
      In this case, the difference in the second column name is lost and
      both statements are considered the same.
    </p><p>
      For each normalized statement, the Performance Schema computes a
      hash digest value and stores the statement and its MD5 hash value
      in the <code class="literal">DIGEST_TEXT</code> and
      <code class="literal">DIGEST</code> columns of the statement event tables
      (<a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>,
      <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>, and
      <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>). In
      addition, information for statements with the same
      <code class="literal">SCHEMA_NAME</code> and <code class="literal">DIGEST</code>
      values are aggregated in the
      <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
      summary table. The Performance Schema uses MD5 hash values because
      they are fast to compute and have a favorable statistical
      distribution that minimizes collisions.
    </p><p>
      The statement digest summary table provides a profile of the
      statements executed by the server. It shows what kinds of
      statements an application is executing and how often. An
      application developer can use this information together with other
      information in the table to assess the application's performance
      characteristics. For example, table columns that show wait times,
      lock times, or index use may highlight types of queries that are
      inefficient. This gives the developer insight into which parts of
      the application need attention.
    </p><p>
      The
      <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
      summary table has a fixed size, so when it becomes full,
      statements that have <code class="literal">SCHEMA_NAME</code> and
      <code class="literal">DIGEST</code> values not matching existing values in
      the table are grouped in a special row with
      <code class="literal">SCHEMA_NAME</code> and <code class="literal">DIGEST</code> set
      to <code class="literal">NULL</code>. This permits all statements to be
      counted. However, if the special row accounts for a significant
      percentage of the statements executed, it might be desirable to
      increase the size of the summary table by setting the
      <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
      system variable to a larger value at server startup. If no
      <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
      value is given, the server estimates the value to use at startup.
      (Before MySQL 5.6.9, there is no <code class="literal">SCHEMA_NAME</code>
      column and the special row has <code class="literal">DIGEST</code> set to
      <code class="literal">NULL</code>.)
    </p><p>
      The
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
      system variable determines the maximum number of bytes available
      in the digest buffer for digest computation. However, the display
      length of statement digests may be longer than the available
      buffer size due to encoding of statement components such as
      keywords and literal values in digest buffer. Consequently, values
      selected from the <code class="literal">DIGEST_TEXT</code> column of
      statement event tables may appear to exceed the
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
      value.
    </p><p>
      For applications that generate very long statements that differ
      only at the end, increasing
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
      enables computation of digests that distinguish statements that
      would otherwise aggregate to the same digest. Conversely,
      decreasing
      <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
      causes the server to devote less memory to digest storage but
      increases the likelihood of longer statements aggregating to the
      same digest. Administrators should keep in mind that larger values
      result in correspondingly increased memory requirements,
      particularly for workloads that involve large numbers of
      simultaneous sessions
      (<a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
      bytes are allocated per session).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-table-characteristics"></a>22.8 Performance Schema General Table Characteristics</h2>

</div>

</div>

</div>
<p>
      The name of the <code class="literal">performance_schema</code> database is
      lowercase, as are the names of tables within it. Queries should
      specify the names in lowercase.
    </p><a class="indexterm" name="idm139737073240448"></a><a class="indexterm" name="idm139737073238944"></a><p>
      Most tables in the <code class="literal">performance_schema</code> database
      are read only and cannot be modified. Some of the setup tables
      have columns that can be modified to affect Performance Schema
      operation; some also permit rows to be inserted or deleted.
      Truncation is permitted to clear collected events, so
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> can be used on
      tables containing those kinds of information, such as tables named
      with a prefix of <code class="literal">events_waits_</code>.
    </p><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> can also be used
      with summary tables, but except for
      <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>,
      the effect is to reset the summary columns to 0 or
      <code class="literal">NULL</code>, not to remove rows.
    </p><p>
      Privileges are as for other databases and tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To retrieve from <code class="literal">performance_schema</code> tables,
          you must have the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
          privilege.
        </p></li><li class="listitem"><p>
          To change those columns that can be modified, you must have
          the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege.
        </p></li><li class="listitem"><p>
          To truncate tables that can be truncated, you must have the
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-table-descriptions"></a>22.9 Performance Schema Table Descriptions</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-table-index">22.9.1 Performance Schema Table Index</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-setup-tables">22.9.2 Performance Schema Setup Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-instance-tables">22.9.3 Performance Schema Instance Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-wait-tables">22.9.4 Performance Schema Wait Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-stage-tables">22.9.5 Performance Schema Stage Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-statement-tables">22.9.6 Performance Schema Statement Event Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-tables">22.9.7 Performance Schema Connection Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-connection-attribute-tables">22.9.8 Performance Schema Connection Attribute Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-summary-tables">22.9.9 Performance Schema Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-schema-miscellaneous-tables">22.9.10 Performance Schema Miscellaneous Tables</a></span></dt></dl>
</div>
<p>
      Tables in the <code class="literal">performance_schema</code> database can
      be grouped as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Setup tables. These tables are used to configure and display
          monitoring characteristics.
        </p></li><li class="listitem"><p>
          Current events tables. The
          <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table
          contains the most recent event for each thread. Other similar
          tables contain current events at different levels of the event
          hierarchy: <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a>
          for stage events, and
          <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a> for
          statement events.
        </p></li><li class="listitem"><p>
          History tables. These tables have the same structure as the
          current events tables, but contain more rows. For example, for
          wait events, <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a>
          table contains the most recent 10 events per thread.
          <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
          contains the most recent 10,000 events. Other similar tables
          exist for stage and statement histories.
        </p><p>
          To change the sizes of the history tables, set the appropriate
          system variables at server startup. For example, to set the
          sizes of the wait event history tables, set
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size"><code class="literal">performance_schema_events_waits_history_size</code></a>
          and
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size"><code class="literal">performance_schema_events_waits_history_long_size</code></a>.
        </p></li><li class="listitem"><p>
          Summary tables. These tables contain information aggregated
          over groups of events, including those that have been
          discarded from the history tables.
        </p></li><li class="listitem"><p>
          Instance tables. These tables document what types of objects
          are instrumented. An instrumented object, when used by the
          server, produces an event. These tables provide event names
          and explanatory notes or status information.
        </p></li><li class="listitem"><p>
          Miscellaneous tables. These do not fall into any of the other
          table groups.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-table-index"></a>22.9.1 Performance Schema Table Index</h3>

</div>

</div>

</div>
<p>
        The following table lists each Performance Schema table and
        provides a short description of each one.
</p>
<div class="table">
<a name="performance-schema-tables-table"></a><p class="title"><b>Table 22.1 Performance Schema Tables</b></p>
<div class="table-contents">
<table summary="Performance Schema Tables" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Table Name</th><th scope="col">Description</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a></td><td>Connection statistics per client account</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#cond-instances-table" title="22.9.3.1 The cond_instances Table"><code class="literal">cond_instances</code></a></td><td>synchronization object instances</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a></td><td>Current stage events</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a></td><td>Most recent stage events for each thread</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a></td><td>Most recent stage events overall</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_account_by_event_name</code></a></td><td>Stage events per account and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_host_by_event_name</code></a></td><td>Stage events per host name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_by_thread_by_event_name</code></a></td><td>Stage waits per thread and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_user_by_event_name</code></a></td><td>Stage events per user name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_global_by_event_name</code></a></td><td>Stage waits per event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a></td><td>Current statement events</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a></td><td>Most recent statement events for each thread</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a></td><td>Most recent statement events overall</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_account_by_event_name</code></a></td><td>Statement events per account and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a></td><td>Statement events per schema and digest value</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_host_by_event_name</code></a></td><td>Statement events per host name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_thread_by_event_name</code></a></td><td>Statement events per thread and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_user_by_event_name</code></a></td><td>Statement events per user name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_global_by_event_name</code></a></td><td>Statement events per event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a></td><td>Current wait events</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a></td><td>Most recent wait events for each thread</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a></td><td>Most recent wait events overall</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_account_by_event_name</code></a></td><td>Wait events per account and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_host_by_event_name</code></a></td><td>Wait events per host name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_instance</code></a></td><td>Wait events per instance</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_thread_by_event_name</code></a></td><td>Wait events per thread and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_user_by_event_name</code></a></td><td>Wait events per user name and event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_global_by_event_name</code></a></td><td>Wait events per event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a></td><td>File instances</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_event_name</code></a></td><td>File events per event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_instance</code></a></td><td>File events per file instance</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a></td><td>Information from the internal host cache</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a></td><td>Connection statistics per client host name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a></td><td>Mutex synchronization object instances</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#objects-summary-global-by-type-table" title="22.9.9.4 Object Wait Summary Table"><code class="literal">objects_summary_global_by_type</code></a></td><td>Object summaries</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a></td><td>Which event timers are available</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a></td><td>Lock synchronization object instances</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="22.9.8.1 The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a></td><td>Connection attributes per for the current session</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#session-connect-attrs-table" title="22.9.8.2 The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a></td><td>Connection attributes for all sessions</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a></td><td>How to initialize monitoring for new foreground threads</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a></td><td>Consumers for which event information can be stored</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a></td><td>Classes of instrumented objects for which events can be collected</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a></td><td>Which objects should be monitored</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a></td><td>Current event timer</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a></td><td>Active connection instances</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_event_name</code></a></td><td>Socket waits and I/O per event name</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a></td><td>Socket waits and I/O per instance</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a></td><td>Table I/O waits per index</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a></td><td>Table I/O waits per table</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a></td><td>Table lock waits per table</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a></td><td>Information about server threads</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a></td><td>Connection statistics per client user name</td></tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-setup-tables"></a>22.9.2 Performance Schema Setup Tables</h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#setup-actors-table">22.9.2.1 The setup_actors Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-consumers-table">22.9.2.2 The setup_consumers Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-instruments-table">22.9.2.3 The setup_instruments Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-objects-table">22.9.2.4 The setup_objects Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#setup-timers-table">22.9.2.5 The setup_timers Table</a></span></dt></dl>
</div>
<p>
        The setup tables provide information about the current
        instrumentation and enable the monitoring configuration to be
        changed. For this reason, some columns in these tables can be
        changed if you have the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>
        privilege.
      </p><p>
        The use of tables rather than individual variables for setup
        information provides a high degree of flexibility in modifying
        Performance Schema configuration. For example, you can use a
        single statement with standard SQL syntax to make multiple
        simultaneous configuration changes.
      </p><p>
        These setup tables are available:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>: How to initialize
            monitoring for new foreground threads
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>: The
            destinations to which event information can be sent and
            stored
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a>: The classes
            of instrumented objects for which events can be collected
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>: Which objects
            should be monitored
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a>: The current event
            timer
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="setup-actors-table"></a>22.9.2.1 The setup_actors Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737073066832"></a><a class="indexterm" name="idm139737073065344"></a><p>
          The <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table contains
          information that determines whether to enable monitoring for
          new foreground server threads (threads associated with client
          connections). This table has a maximum size of 100 rows by
          default. To change the table size, modify the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size"><code class="literal">performance_schema_setup_actors_size</code></a>
          system variable at server startup.
        </p><p>
          For each new foreground thread, the Performance Schema matches
          the user and host for the thread against the rows of the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table. If a row from
          that table matches, its <code class="literal">ENABLED</code> column
          value is used to set the the <code class="literal">INSTRUMENTED</code>
          column of the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table row
          for the thread. This enables instrumenting to be applied
          selectively per host, user, or account (combination of host
          and user). If there is no match, the
          <code class="literal">INSTRUMENTED</code> column for the thread is set
          to <code class="literal">NO</code>.
        </p><p>
          For background threads, there is no associated user.
          <code class="literal">INSTRUMENTED</code> is <code class="literal">YES</code> by
          default and <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> is not
          consulted.
        </p><p>
          The initial contents of the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table match any user
          and host combination, so monitoring is enabled by default for
          all foreground threads:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_actors;</code></strong>
+------+------+------+
| HOST | USER | ROLE |
+------+------+------+
| %    | %    | %    |
+------+------+------+
</pre><p>
          For information about how to use the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table to affect
          event monitoring, see
          <a class="xref" href="performance-schema.html#performance-schema-thread-filtering" title="22.2.3.3.3 Pre-Filtering by Thread">Section 22.2.3.3.3, “Pre-Filtering by Thread”</a>.
        </p><p>
          Modifications to the <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a>
          table affect only foreground threads created subsequent to the
          modification, not existing threads. To affect existing
          threads, modify the <code class="literal">INSTRUMENTED</code> column of
          <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table rows.
        </p><p>
          The <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table has these
          columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              The host name. This should be a literal name, or
              <code class="literal">'%'</code> to mean <span class="quote">“<span class="quote">any host.</span>”</span>
            </p></li><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              The user name. This should be a literal name, or
              <code class="literal">'%'</code> to mean <span class="quote">“<span class="quote">any user.</span>”</span>
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              Unused.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="setup-consumers-table"></a>22.9.2.2 The setup_consumers Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737073030272"></a><a class="indexterm" name="idm139737073028816"></a><p>
          The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table lists
          the types of consumers for which event information can be
          stored and which are enabled:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers;</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_stages_current          | NO      |
| events_stages_history          | NO      |
| events_stages_history_long     | NO      |
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| events_waits_current           | NO      |
| events_waits_history           | NO      |
| events_waits_history_long      | NO      |
| global_instrumentation         | YES     |
| thread_instrumentation         | YES     |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
          The consumer settings in the
          <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table form a
          hierarchy from higher levels to lower. For detailed
          information about the effect of enabling different consumers,
          see <a class="xref" href="performance-schema.html#performance-schema-consumer-filtering" title="22.2.3.3.4 Pre-Filtering by Consumer">Section 22.2.3.3.4, “Pre-Filtering by Consumer”</a>.
        </p><p>
          Modifications to the
          <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table affect
          monitoring immediately.
        </p><p>
          The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The consumer name.
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              Whether the consumer is enabled. The value is
              <code class="literal">YES</code> or <code class="literal">NO</code>. This
              column can be modified. If you disable a consumer, the
              server does not spend time adding event information to it.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="setup-instruments-table"></a>22.9.2.3 The setup_instruments Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737073010480"></a><a class="indexterm" name="idm139737073009024"></a><p>
          The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table lists
          classes of instrumented objects for which events can be
          collected:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments;</code></strong>
+------------------------------------------------------------+---------+-------+
| NAME                                                       | ENABLED | TIMED |
+------------------------------------------------------------+---------+-------+
...
| wait/synch/mutex/sql/LOCK_global_read_lock                 | YES     | YES   |
| wait/synch/mutex/sql/LOCK_global_system_variables          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_lock_db                          | YES     | YES   |
| wait/synch/mutex/sql/LOCK_manager                          | YES     | YES   |
...
| wait/synch/rwlock/sql/LOCK_grant                           | YES     | YES   |
| wait/synch/rwlock/sql/LOGGER::LOCK_logger                  | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_connect                | YES     | YES   |
| wait/synch/rwlock/sql/LOCK_sys_init_slave                  | YES     | YES   |
...
| wait/io/file/sql/binlog                                    | YES     | YES   |
| wait/io/file/sql/binlog_index                              | YES     | YES   |
| wait/io/file/sql/casetest                                  | YES     | YES   |
| wait/io/file/sql/dbopt                                     | YES     | YES   |
...
</pre><p>
          Each instrument added to the source code provides a row for
          this table, even when the instrumented code is not executed.
          When an instrument is enabled and executed, instrumented
          instances are created, which are visible in the
          <code class="literal">*_instances</code> tables.
        </p><p>
          Modifications to most
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> rows affect
          monitoring immediately. For some instruments, modifications
          are effective only at server startup; changing them at runtime
          has no effect. This affects primarily mutexes, conditions, and
          rwlocks in the server, although there may be other instruments
          for which this is true.
        </p><p>
          For more information about the role of the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table in event
          filtering, see
          <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 Event Pre-Filtering">Section 22.2.3.3, “Event Pre-Filtering”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The instrument name. Instrument names may have multiple
              parts and form a hierarchy, as discussed in
              <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
              Events produced from execution of an instrument have an
              <code class="literal">EVENT_NAME</code> value that is taken from the
              instrument <code class="literal">NAME</code> value. (Events do not
              really have a <span class="quote">“<span class="quote">name,</span>”</span> but this provides a way
              to associate events with instruments.)
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              Whether the instrument is enabled. The value is
              <code class="literal">YES</code> or <code class="literal">NO</code>. This
              column can be modified. A disabled instrument produces no
              events.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              Whether the instrument is timed. This column can be
              modified.
            </p><p>
              If an enabled instrument is not timed, the instrument code
              is enabled, but the timer is not. Events produced by the
              instrument have <code class="literal">NULL</code> for the
              <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>, and
              <code class="literal">TIMER_WAIT</code> timer values. This in turn
              causes those values to be ignored when calculating the
              sum, minimum, maximum, and average time values in summary
              tables.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="setup-objects-table"></a>22.9.2.4 The setup_objects Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072980160"></a><a class="indexterm" name="idm139737072978672"></a><p>
          The <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table controls
          whether the Performance Schema monitors particular objects.
          This table has a maximum size of 100 rows by default. To
          change the table size, modify the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size"><code class="literal">performance_schema_setup_objects_size</code></a>
          system variable at server startup.
        </p><p>
          The initial <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>
          contents look like this:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_objects;</code></strong>
+-------------+--------------------+-------------+---------+-------+
| OBJECT_TYPE | OBJECT_SCHEMA      | OBJECT_NAME | ENABLED | TIMED |
+-------------+--------------------+-------------+---------+-------+
| TABLE       | mysql              | %           | NO      | NO    |
| TABLE       | performance_schema | %           | NO      | NO    |
| TABLE       | information_schema | %           | NO      | NO    |
| TABLE       | %                  | %           | YES     | YES   |
+-------------+--------------------+-------------+---------+-------+
</pre><p>
          Modifications to the
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table affect object
          monitoring immediately.
        </p><p>
          For object types listed in
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>, the Performance
          Schema uses the table to how to monitor them. Object matching
          is based on the <code class="literal">OBJECT_SCHEMA</code> and
          <code class="literal">OBJECT_NAME</code> columns. Objects for which
          there is no match are not monitored.
        </p><p>
          The effect of the default object configuration is to
          instrument all tables except those in the
          <code class="literal">mysql</code>,
          <code class="literal">INFORMATION_SCHEMA</code>, and
          <code class="literal">performance_schema</code> databases. (Tables in
          the <code class="literal">INFORMATION_SCHEMA</code> database are not
          instrumented regardless of the contents of
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>; the row for
          <code class="literal">information_schema.%</code> simply makes this
          default explicit.)
        </p><p>
          When the Performance Schema checks for a match in
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a>, it tries to find
          more specific matches first. For example, with a table
          <code class="literal">db1.t1</code>, it looks for a match for
          <code class="literal">'db1'</code> and <code class="literal">'t1'</code>, then for
          <code class="literal">'db1'</code> and <code class="literal">'%'</code>, then for
          <code class="literal">'%'</code> and <code class="literal">'%'</code>. The order
          in which matching occurs matters because different matching
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> rows can have
          different <code class="literal">ENABLED</code> and
          <code class="literal">TIMED</code> values.
        </p><p>
          Rows can be inserted into or deleted from
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> by users with the
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> or
          <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege on the table.
          For existing rows, only the <code class="literal">ENABLED</code> and
          <code class="literal">TIMED</code> columns can be modified, by users
          with the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege on
          the table.
        </p><p>
          For more information about the role of the
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table in event
          filtering, see
          <a class="xref" href="performance-schema.html#performance-schema-pre-filtering" title="22.2.3.3 Event Pre-Filtering">Section 22.2.3.3, “Event Pre-Filtering”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table has these
          columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              The type of object to instrument. Currently, this is
              always <code class="literal">'TABLE'</code> (base table).
            </p><p>
              <code class="literal">TABLE</code> filtering affects table I/O
              events (<code class="literal">wait/io/table/sql/handler</code>
              instrument) and table lock events
              (<code class="literal">wait/lock/table/sql/handler</code>
              instrument).
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>
            </p><p>
              The schema that contains the object. This should be a
              literal name, or <code class="literal">'%'</code> to mean <span class="quote">“<span class="quote">any
              schema.</span>”</span>
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_NAME</code>
            </p><p>
              The name of the instrumented object. This should be a
              literal name, or <code class="literal">'%'</code> to mean <span class="quote">“<span class="quote">any
              object.</span>”</span>
            </p></li><li class="listitem"><p>
              <code class="literal">ENABLED</code>
            </p><p>
              Whether events for the object are instrumented. The value
              is <code class="literal">YES</code> or <code class="literal">NO</code>. This
              column can be modified.
            </p><p>
              This column was added in MySQL 5.6.3. For earlier versions
              in which it is not present, the Performance Schema enables
              monitoring only for objects matched by some row in the
              table; monitoring is implicitly disabled for nonmatching
              objects.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMED</code>
            </p><p>
              Whether events for the object are timed. This column can
              be modified.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="setup-timers-table"></a>22.9.2.5 The setup_timers Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072919328"></a><a class="indexterm" name="idm139737072917840"></a><p>
          The <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table shows the
          currently selected event timers:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers;</code></strong>
+-----------+-------------+
| NAME      | TIMER_NAME  |
+-----------+-------------+
| idle      | MICROSECOND |
| wait      | CYCLE       |
| stage     | NANOSECOND  |
| statement | NANOSECOND  |
+-----------+-------------+
</pre><p>
          The <code class="literal">setup_timers.TIMER_NAME</code> value can be
          changed to select a different timer. The value can be any of
          the values in the
          <code class="literal">performance_timers.TIMER_NAME</code> column. For
          an explanation of how event timing occurs, see
          <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
        </p><p>
          Modifications to the <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a>
          table affect monitoring immediately. Events already in
          progress may use the original timer for the begin time and the
          new timer for the end time. To avoid unpredictable results
          after you make timer changes, use
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> to reset
          Performance Schema statistics.
        </p><p>
          The <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table has these
          columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The type of instrument the timer is used for.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code>
            </p><p>
              The timer that applies to the instrument type. This column
              can be modified.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-instance-tables"></a>22.9.3 Performance Schema Instance Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#cond-instances-table">22.9.3.1 The cond_instances Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#file-instances-table">22.9.3.2 The file_instances Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#mutex-instances-table">22.9.3.3 The mutex_instances Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#rwlock-instances-table">22.9.3.4 The rwlock_instances Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#socket-instances-table">22.9.3.5 The socket_instances Table</a></span></dt></dl>
</div>
<p>
        Instance tables document what types of objects are instrumented.
        They provide event names and explanatory notes or status
        information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#cond-instances-table" title="22.9.3.1 The cond_instances Table"><code class="literal">cond_instances</code></a>: Condition
            synchronization object instances
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a>: File instances
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a>: Mutex
            synchronization object instances
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a>: Lock
            synchronization object instances
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a>: Active
            connection instances
</p></li></ul>
</div>
<p>
        These tables list instrumented synchronization objects, files,
        and connections. There are three types of synchronization
        objects: <code class="literal">cond</code>, <code class="literal">mutex</code>, and
        <code class="literal">rwlock</code>. Each instance table has an
        <code class="literal">EVENT_NAME</code> or <code class="literal">NAME</code> column
        to indicate the instrument associated with each row. Instrument
        names may have multiple parts and form a hierarchy, as discussed
        in <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
      </p><p>
        The <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> and
        <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code>
        columns are extremely important for investigating performance
        bottlenecks or deadlocks. For examples of how to use them for
        this purpose, see <a class="xref" href="performance-schema.html#performance-schema-examples" title="22.15 Using the Performance Schema to Diagnose Problems">Section 22.15, “Using the Performance Schema to Diagnose Problems”</a>
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="cond-instances-table"></a>22.9.3.1 The cond_instances Table</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737072879776"></a><a class="indexterm" name="idm139737072878320"></a><p>
          The <a class="link" href="performance-schema.html#cond-instances-table" title="22.9.3.1 The cond_instances Table"><code class="literal">cond_instances</code></a> table lists
          all the conditions seen by the Performance Schema while the
          server executes. A condition is a synchronization mechanism
          used in the code to signal that a specific event has happened,
          so that a thread waiting for this condition can resume work.
        </p><p>
          When a thread is waiting for something to happen, the
          condition name is an indication of what the thread is waiting
          for, but there is no immediate way to tell which other thread,
          or threads, will cause the condition to happen.
        </p><p>
          The <a class="link" href="performance-schema.html#cond-instances-table" title="22.9.3.1 The cond_instances Table"><code class="literal">cond_instances</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The instrument name associated with the condition.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              The address in memory of the instrumented condition.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file-instances-table"></a>22.9.3.2 The file_instances Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072867008"></a><a class="indexterm" name="idm139737072865552"></a><p>
          The <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a> table lists
          all the files seen by the Performance Schema when executing
          file I/O instrumentation. If a file on disk has never been
          opened, it will not be in
          <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a>. When a file is
          deleted from the disk, it is also removed from the
          <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a> table.
        </p><p>
          The <a class="link" href="performance-schema.html#file-instances-table" title="22.9.3.2 The file_instances Table"><code class="literal">file_instances</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FILE_NAME</code>
            </p><p>
              The file name.
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              The instrument name associated with the file.
            </p></li><li class="listitem"><p>
              <code class="literal">OPEN_COUNT</code>
            </p><p>
              The count of open handles on the file. If a file was
              opened and then closed, it was opened 1 time, but
              <code class="literal">OPEN_COUNT</code> will be 0. To list all the
              files currently opened by the server, use <code class="literal">WHERE
              OPEN_COUNT &gt; 0</code>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="mutex-instances-table"></a>22.9.3.3 The mutex_instances Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072848960"></a><a class="indexterm" name="idm139737072847504"></a><p>
          The <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a> table lists
          all the mutexes seen by the Performance Schema while the
          server executes. A mutex is a synchronization mechanism used
          in the code to enforce that only one thread at a given time
          can have access to some common resource. The resource is said
          to be <span class="quote">“<span class="quote">protected</span>”</span> by the mutex.
        </p><p>
          When two threads executing in the server (for example, two
          user sessions executing a query simultaneously) do need to
          access the same resource (a file, a buffer, or some piece of
          data), these two threads will compete against each other, so
          that the first query to obtain a lock on the mutex will cause
          the other query to wait until the first is done and unlocks
          the mutex.
        </p><p>
          The work performed while holding a mutex is said to be in a
          <span class="quote">“<span class="quote">critical section,</span>”</span> and multiple queries do
          execute this critical section in a serialized way (one at a
          time), which is a potential bottleneck.
        </p><p>
          The <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The instrument name associated with the mutex.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              The address in memory of the instrumented mutex.
            </p></li><li class="listitem"><p>
              <code class="literal">LOCKED_BY_THREAD_ID</code>
            </p><p>
              When a thread currently has a mutex locked,
              <code class="literal">LOCKED_BY_THREAD_ID</code> is the
              <code class="literal">THREAD_ID</code> of the locking thread,
              otherwise it is <code class="literal">NULL</code>.
</p></li></ul>
</div>
<p>
          For every mutex instrumented in the code, the Performance
          Schema provides the following information.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
              lists the name of the instrumentation point, with the
              prefix <code class="literal">wait/synch/mutex/</code>.
            </p></li><li class="listitem"><p>
              When some code creates a mutex, a row is added to the
              <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a> table. The
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> column is a
              property that uniquely identifies the mutex.
            </p></li><li class="listitem"><p>
              When a thread attempts to lock a mutex, the
              <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table
              shows a row for that thread, indicating that it is waiting
              on a mutex (in the <code class="literal">EVENT_NAME</code> column),
              and indicating which mutex is waited on (in the
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> column).
            </p></li><li class="listitem"><p>
              When a thread succeeds in locking a mutex:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>
                  shows that the wait on the mutex is completed (in the
                  <code class="literal">TIMER_END</code> and
                  <code class="literal">TIMER_WAIT</code> columns)
                </p></li><li class="listitem"><p>
                  The completed wait event is added to the
                  <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> and
                  <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
                  tables
                </p></li><li class="listitem"><p>
                  <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a> shows
                  that the mutex is now owned by the thread (in the
                  <code class="literal">THREAD_ID</code> column).
</p></li></ul>
</div>
</li><li class="listitem"><p>
              When a thread unlocks a mutex,
              <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a> shows that
              the mutex now has no owner (the
              <code class="literal">THREAD_ID</code> column is
              <code class="literal">NULL</code>).
            </p></li><li class="listitem"><p>
              When a mutex object is destroyed, the corresponding row is
              removed from <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a>.
</p></li></ul>
</div>
<p>
          By performing queries on both of the following tables, a
          monitoring application or a DBA can detect bottlenecks or
          deadlocks between threads that involve mutexes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>, to see
              what mutex a thread is waiting for
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#mutex-instances-table" title="22.9.3.3 The mutex_instances Table"><code class="literal">mutex_instances</code></a>, to see which
              other thread currently owns a mutex
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="rwlock-instances-table"></a>22.9.3.4 The rwlock_instances Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072798096"></a><a class="indexterm" name="idm139737072796640"></a><p>
          The <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a> table lists
          all the <code class="literal">rwlock</code> instances (read write locks)
          seen by the Performance Schema while the server executes. An
          <code class="literal">rwlock</code> is a synchronization mechanism used
          in the code to enforce that threads at a given time can have
          access to some common resource following certain rules. The
          resource is said to be <span class="quote">“<span class="quote">protected</span>”</span> by the
          <code class="literal">rwlock</code>. The access is either shared (many
          threads can have a read lock at the same time) or exclusive
          (only one thread can have a write lock at a given time).
        </p><p>
          Depending on how many threads are requesting a lock, and the
          nature of the locks requested, access can be either granted in
          shared mode, granted in exclusive mode, or not granted at all,
          waiting for other threads to finish first.
        </p><p>
          The <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The instrument name associated with the lock.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              The address in memory of the instrumented lock.
            </p></li><li class="listitem"><p>
              <code class="literal">WRITE_LOCKED_BY_THREAD_ID</code>
            </p><p>
              When a thread currently has an <code class="literal">rwlock</code>
              locked in exclusive (write) mode,
              <code class="literal">WRITE_LOCKED_BY_THREAD_ID</code> is the
              <code class="literal">THREAD_ID</code> of the locking thread,
              otherwise it is <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">READ_LOCKED_BY_COUNT</code>
            </p><p>
              When a thread currently has an <code class="literal">rwlock</code>
              locked in shared (read) mode,
              <code class="literal">READ_LOCKED_BY_COUNT</code> is incremented by
              1. This is a counter only, so it cannot be used directly
              to find which thread holds a read lock, but it can be used
              to see whether there is a read contention on an
              <code class="literal">rwlock</code>, and see how many readers are
              currently active.
</p></li></ul>
</div>
<p>
          By performing queries on both of the following tables, a
          monitoring application or a DBA may detect some bottlenecks or
          deadlocks between threads that involve locks:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>, to see
              what <code class="literal">rwlock</code> a thread is waiting for
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a>, to see
              which other thread currently owns an
              <code class="literal">rwlock</code>
</p></li></ul>
</div>
<p>
          There is a limitation: The
          <a class="link" href="performance-schema.html#rwlock-instances-table" title="22.9.3.4 The rwlock_instances Table"><code class="literal">rwlock_instances</code></a> can be used only
          to identify the thread holding a write lock, but not the
          threads holding a read lock.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="socket-instances-table"></a>22.9.3.5 The socket_instances Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072764928"></a><a class="indexterm" name="idm139737072763472"></a><a class="indexterm" name="idm139737072761984"></a><a class="indexterm" name="idm139737072760912"></a><p>
          The <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a> table
          provides a real-time snapshot of the active connections to the
          MySQL server. The table contains one row per TCP/IP or Unix
          socket file connection. Information available in this table
          provides a real-time snapshot of the active connections to the
          server. (Additional information is available in socket summary
          tables, including network activity such as socket operations
          and number of bytes transmitted and received; see
          <a class="xref" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables">Section 22.9.9.8, “Socket Summary Tables”</a>).
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM socket_instances\G</code></strong>
*************************** 1. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_unix_socket
OBJECT_INSTANCE_BEGIN: 4316619408
            THREAD_ID: 1
            SOCKET_ID: 16
                   IP: 
                 PORT: 0
                STATE: ACTIVE
*************************** 2. row ***************************
           EVENT_NAME: wait/io/socket/sql/client_connection
OBJECT_INSTANCE_BEGIN: 4316644608
            THREAD_ID: 21
            SOCKET_ID: 39
                   IP: 127.0.0.1
                 PORT: 55233
                STATE: ACTIVE
*************************** 3. row ***************************
           EVENT_NAME: wait/io/socket/sql/server_tcpip_socket
OBJECT_INSTANCE_BEGIN: 4316699040
            THREAD_ID: 1
            SOCKET_ID: 14
                   IP: 0.0.0.0
                 PORT: 50603
                STATE: ACTIVE
</pre><p>
          Socket instruments have names of the form
          <code class="literal">wait/io/socket/sql/<em class="replaceable"><code>socket_type</code></em></code>
          and are used like this:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              The server has a listening socket for each network
              protocol that it supports. The instruments associated with
              listening sockets for TCP/IP or Unix socket file
              connections have a <em class="replaceable"><code>socket_type</code></em>
              value of <code class="literal">server_tcpip_socket</code> or
              <code class="literal">server_unix_socket</code>, respectively.
            </p></li><li class="listitem"><p>
              When a listening socket detects a connection, the server
              transfers the connection to a new socket managed by a
              separate thread. The instrument for the new connection
              thread has a <em class="replaceable"><code>socket_type</code></em> value
              of <code class="literal">client_connection</code>.
            </p></li><li class="listitem"><p>
              When a connection terminates, the row in
              <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a>
              corresponding to it is deleted.
</p></li></ol>
</div>
<p>
          The <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              The name of the <code class="literal">wait/io/socket/*</code>
              instrument that produced the event. This is a
              <code class="literal">NAME</code> value from the
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
              Instrument names may have multiple parts and form a
              hierarchy, as discussed in
              <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              This column uniquely identifies the socket. The value is
              the address of an object in memory.
            </p></li><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              The internal thread identifier assigned by the server.
              Each socket is managed by a single thread, so each socket
              can be mapped to a thread which can be mapped to a server
              process.
            </p></li><li class="listitem"><p>
              <code class="literal">SOCKET_ID</code>
            </p><p>
              The internal file handle assigned to the socket.
            </p></li><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              The client IP address. The value may be either an IPv4 or
              IPv6 address, or blank to indicate a Unix socket file
              connection.
            </p></li><li class="listitem"><p>
              <code class="literal">PORT</code>
            </p><p>
              The TCP/IP port number, in the range from 0 to 65535.
            </p></li><li class="listitem"><p>
              <code class="literal">STATE</code>
            </p><p>
              The socket status, either <code class="literal">IDLE</code> or
              <code class="literal">ACTIVE</code>. Wait times for active sockets
              are tracked using the corresponding socket instrument.
              Wait times for idle sockets are tracked using the
              <code class="literal">idle</code> instrument.
            </p><p>
              A socket is idle if it is waiting for a request from the
              client. When a socket becomes idle, the event row in
              <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a> that is
              tracking the socket switches from a status of
              <code class="literal">ACTIVE</code> to <code class="literal">IDLE</code>. The
              <code class="literal">EVENT_NAME</code> value remains
              <code class="literal">wait/io/socket/*</code>, but timing for the
              instrument is suspended. Instead, an event is generated in
              the <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>
              table with an <code class="literal">EVENT_NAME</code> value of
              <code class="literal">idle</code>.
            </p><p>
              When the next request is received, the
              <code class="literal">idle</code> event terminates, the socket
              instance switches from <code class="literal">IDLE</code> to
              <code class="literal">ACTIVE</code>, and timing of the socket
              instrument resumes.
</p></li></ul>
</div>
<p>
          The <code class="literal">IP:PORT</code> column combination value
          identifies the connection. This combination value is used in
          the <code class="literal">OBJECT_NAME</code> column of the
          <code class="literal">events_waits_<em class="replaceable"><code>xxx</code></em></code>
          tables, to identify the connection from which socket events
          come:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              For the Unix domain listener socket
              (<code class="literal">server_unix_socket</code>), the port is 0,
              and the IP is <code class="literal">''</code>.
            </p></li><li class="listitem"><p>
              For client connections via the Unix domain listener
              (<code class="literal">client_connection</code>), the port is 0, and
              the IP is <code class="literal">''</code>.
            </p></li><li class="listitem"><p>
              For the TCP/IP server listener socket
              (<code class="literal">server_tcpip_socket</code>), the port is
              always the master port (for example, 3306), and the IP is
              always <code class="literal">0.0.0.0</code>.
            </p></li><li class="listitem"><p>
              For client connections via the TCP/IP listener
              (<code class="literal">client_connection</code>), the port is
              whatever the server assigns, but never 0. The IP is the IP
              of the originating host (<code class="literal">127.0.0.1</code> or
              <code class="literal">::1</code> for the local host)
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#socket-instances-table" title="22.9.3.5 The socket_instances Table"><code class="literal">socket_instances</code></a> table was
          added in MySQL 5.6.3.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-wait-tables"></a>22.9.4 Performance Schema Wait Event Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-waits-current-table">22.9.4.1 The events_waits_current Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-waits-history-table">22.9.4.2 The events_waits_history Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-waits-history-long-table">22.9.4.3 The events_waits_history_long Table</a></span></dt></dl>
</div>
<p>
        These tables store wait events:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>: Current
            wait events
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a>: The most
            recent wait events for each thread
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>: The
            most recent wait events overall
</p></li></ul>
</div>
<p>
        The following sections describe those tables. There are also
        summary tables that aggregate information about wait events; see
        <a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables">Section 22.9.9.1, “Event Wait Summary Tables”</a>.
</p>
<h4><a name="wait-event-configuration"></a>Wait Event Configuration</h4>
<p>
        To enable collection of wait events, enable the relevant
        instruments and consumers.
      </p><p>
        The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
        contains instruments with names that begin with
        <code class="literal">wait</code>. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/file/innodb%';</code></strong>
+--------------------------------------+---------+-------+
| NAME                                 | ENABLED | TIMED |
+--------------------------------------+---------+-------+
| wait/io/file/innodb/innodb_data_file | YES     | YES   |
| wait/io/file/innodb/innodb_log_file  | YES     | YES   |
| wait/io/file/innodb/innodb_temp_file | YES     | YES   |
+--------------------------------------+---------+-------+
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE</code></strong>
    -&gt; <strong class="userinput"><code>NAME LIKE 'wait/io/socket/%';</code></strong>
+----------------------------------------+---------+-------+
| NAME                                   | ENABLED | TIMED |
+----------------------------------------+---------+-------+
| wait/io/socket/sql/server_tcpip_socket | NO      | NO    |
| wait/io/socket/sql/server_unix_socket  | NO      | NO    |
| wait/io/socket/sql/client_connection   | NO      | NO    |
+----------------------------------------+---------+-------+
</pre><p>
        To modify collection of wait events, change the
        <code class="literal">ENABLED</code> and <code class="literal">TIMING</code> columns
        of the relevant instruments. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'wait/io/socket/sql/%';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table contains
        consumer values with names corresponding to the current and
        recent wait event table names. These consumers may be used to
        filter collection of wait events. The wait consumers are
        disabled by default:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%waits%';</code></strong>
+---------------------------+---------+
| NAME                      | ENABLED |
+---------------------------+---------+
| events_waits_current      | NO      |
| events_waits_history      | NO      |
| events_waits_history_long | NO      |
+---------------------------+---------+
</pre><p>
        To enable all wait consumers, do this:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%waits%';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table contains a
        row with a <code class="literal">NAME</code> value of
        <code class="literal">wait</code> that indicates the unit for wait event
        timing. The default unit is <code class="literal">CYCLE</code>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'wait';</code></strong>
+------+------------+
| NAME | TIMER_NAME |
+------+------------+
| wait | CYCLE      |
+------+------------+
</pre><p>
        To change the timing unit, modify the
        <code class="literal">TIMER_NAME</code> value:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'NANOSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'wait';</code></strong>
</pre><p>
        For additional information about configuring event collection,
        see <a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 Performance Schema Configuration">Section 22.2, “Performance Schema Configuration”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-waits-current-table"></a>22.9.4.1 The events_waits_current Table</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737072657664"></a><a class="indexterm" name="idm139737072656160"></a><p>
          The <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table
          contains current wait events, one row per thread showing the
          current status of the thread's most recent monitored wait
          event.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table
          can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          Of the tables that contain wait event rows,
          <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> is the most
          fundamental. Other tables that contain wait event rows are
          logically derived from the current events. For example, the
          <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> and
          <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a> tables
          are collections of the most recent wait events, up to a fixed
          number of rows.
        </p><p>
          For information about configuration of wait event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 Performance Schema Wait Event Tables">Section 22.9.4, “Performance Schema Wait Event Tables”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table
          has these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>, <code class="literal">EVENT_ID</code>
            </p><p>
              The thread associated with the event and the thread
              current event number when the event starts. The
              <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_ID</code> values taken together form a
              primary key that uniquely identifies the row. No two rows
              will have the same pair of values.
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              This column is set to <code class="literal">NULL</code> when the
              event starts and updated to the thread current event
              number when the event ends. This column was added in MySQL
              5.6.4.
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              The name of the instrument that produced the event. This
              is a <code class="literal">NAME</code> value from the
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
              Instrument names may have multiple parts and form a
              hierarchy, as discussed in
              <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              The name of the source file containing the instrumented
              code that produced the event and the line number in the
              file at which the instrumentation occurs. This enables you
              to check the source to determine exactly what code is
              involved. For example, if a mutex or lock is being
              blocked, you can check the context in which this occurs.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>,
              <code class="literal">TIMER_WAIT</code>
            </p><p>
              Timing information for the event. The unit for these
              values is picoseconds (trillionths of a second). The
              <code class="literal">TIMER_START</code> and
              <code class="literal">TIMER_END</code> values indicate when event
              timing started and ended. <code class="literal">TIMER_WAIT</code> is
              the event elapsed time (duration).
            </p><p>
              If an event has not finished, <code class="literal">TIMER_END</code>
              and <code class="literal">TIMER_WAIT</code> are
              <code class="literal">NULL</code> before MySQL 5.6.26. As of 5.6.26,
              <code class="literal">TIMER_END</code> is the current timer value
              and <code class="literal">TIMER_WAIT</code> is the time elapsed so
              far (<code class="literal">TIMER_END</code> −
              <code class="literal">TIMER_START</code>).
            </p><p>
              If an event is produced from an instrument that has
              <code class="literal">TIMED = NO</code>, timing information is not
              collected, and <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>, and
              <code class="literal">TIMER_WAIT</code> are all
              <code class="literal">NULL</code>.
            </p><p>
              For discussion of picoseconds as the unit for event times
              and factors that affect time values, see
              <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">SPINS</code>
            </p><p>
              For a mutex, the number of spin rounds. If the value is
              <code class="literal">NULL</code>, the code does not use spin rounds
              or spinning is not instrumented.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>,
              <code class="literal">OBJECT_NAME</code>,
              <code class="literal">OBJECT_TYPE</code>,
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              These columns identify the object <span class="quote">“<span class="quote">being acted
              on.</span>”</span> What that means depends on the object type.
            </p><p>
              For a synchronization object (<code class="literal">cond</code>,
              <code class="literal">mutex</code>, <code class="literal">rwlock</code>):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code>,
                  <code class="literal">OBJECT_NAME</code>, and
                  <code class="literal">OBJECT_TYPE</code> are
                  <code class="literal">NULL</code>.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> is the
                  address of the synchronization object in memory.
</p></li></ul>
</div>
<p>
              For a file I/O object:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> is
                  <code class="literal">NULL</code>.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> is the file name.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> is
                  <code class="literal">FILE</code>.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> is an address
                  in memory.
</p></li></ul>
</div>
<p>
              For a socket object:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> is the
                  <code class="literal">IP:PORT</code> value for the socket.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> is an address
                  in memory.
</p></li></ul>
</div>
<p>
              For a table I/O object:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  <code class="literal">OBJECT_SCHEMA</code> is the name of the
                  schema that contains the table.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_NAME</code> is the table name.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_TYPE</code> is
                  <code class="literal">TABLE</code> for a persistent base table
                  or <code class="literal">TEMPORARY TABLE</code> for a temporary
                  table.
                </p></li><li class="listitem"><p>
                  <code class="literal">OBJECT_INSTANCE_BEGIN</code> is an address
                  in memory.
</p></li></ul>
</div>
<p>
              An <code class="literal">OBJECT_INSTANCE_BEGIN</code> value itself
              has no meaning, except that different values indicate
              different objects.
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> can be used for
              debugging. For example, it can be used with <code class="literal">GROUP
              BY OBJECT_INSTANCE_BEGIN</code> to see whether the load
              on 1,000 mutexes (that protect, say, 1,000 pages or blocks
              of data) is spread evenly or just hitting a few
              bottlenecks. This can help you correlate with other
              sources of information if you see the same object address
              in a log file or another debugging or performance tool.
            </p></li><li class="listitem"><p>
              <code class="literal">INDEX_NAME</code>
            </p><p>
              The name of the index used. <code class="literal">PRIMARY</code>
              indicates the table primary index. <code class="literal">NULL</code>
              means that no index was used.
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              The <code class="literal">EVENT_ID</code> value of the event within
              which this event is nested. Before MySQL 5.6.3, this
              column is always <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              The nesting event type. The value is
              <code class="literal">STATEMENT</code>, <code class="literal">STAGE</code>, or
              <code class="literal">WAIT</code>. This column was added in MySQL
              5.6.3.
            </p></li><li class="listitem"><p>
              <code class="literal">OPERATION</code>
            </p><p>
              The type of operation performed, such as
              <code class="literal">lock</code>, <code class="literal">read</code>, or
              <code class="literal">write</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">NUMBER_OF_BYTES</code>
            </p><p>
              The number of bytes read or written by the operation. For
              table I/O waits (events for the
              <code class="literal">wait/io/table/sql/handler</code> instrument),
              <code class="literal">NUMBER_OF_BYTES</code> is
              <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">FLAGS</code>
            </p><p>
              Reserved for future use.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-waits-history-table"></a>22.9.4.2 The events_waits_history Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072549056"></a><a class="indexterm" name="idm139737072547552"></a><p>
          The <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> table
          contains the most recent <em class="replaceable"><code>N</code></em> wait
          events per thread. The value of <em class="replaceable"><code>N</code></em>
          is autosized at server startup. To set the table size
          explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size"><code class="literal">performance_schema_events_waits_history_size</code></a>
          system variable at server startup. Wait events are not added
          to the table until they have ended. As new events are added,
          older events are discarded if the table is full.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> table
          has the same structure as
          <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table">Section 22.9.4.1, “The events_waits_current Table”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> table
          can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          For information about configuration of wait event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 Performance Schema Wait Event Tables">Section 22.9.4, “Performance Schema Wait Event Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-waits-history-long-table"></a>22.9.4.3 The events_waits_history_long Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072532768"></a><a class="indexterm" name="idm139737072531264"></a><p>
          The <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
          table contains the most recent <em class="replaceable"><code>N</code></em>
          wait events. The value of <em class="replaceable"><code>N</code></em> is
          autosized at server startup. To set the table size explicitly,
          set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size"><code class="literal">performance_schema_events_waits_history_long_size</code></a>
          system variable at server startup. Wait events are not added
          to the table until they have ended. As new events are added,
          older events are discarded if the table is full. When a thread
          ends, its rows are removed from the table.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
          table has the same structure as
          <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table">Section 22.9.4.1, “The events_waits_current Table”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
          table can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          For information about configuration of wait event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 Performance Schema Wait Event Tables">Section 22.9.4, “Performance Schema Wait Event Tables”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-stage-tables"></a>22.9.5 Performance Schema Stage Event Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-stages-current-table">22.9.5.1 The events_stages_current Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-stages-history-table">22.9.5.2 The events_stages_history Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-stages-history-long-table">22.9.5.3 The events_stages_history_long Table</a></span></dt></dl>
</div>
<p>
        As of MySQL 5.6.3, the Performance Schema instruments stages,
        which are steps during the statement-execution process, such as
        parsing a statement, opening a table, or performing a
        <code class="literal">filesort</code> operation. Stages correspond to the
        thread states displayed by <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
        PROCESSLIST</code></a> or that are visible in the
        <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
        table. Stages begin and end when state values change.
      </p><p>
        Within the event hierarchy, wait events nest within stage
        events, which nest within statement events.
      </p><p>
        These tables store stage events:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a>: Current
            stage events
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a>: The most
            recent stage events for each thread
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>: The
            most recent stage events overall
</p></li></ul>
</div>
<p>
        The following sections describe those tables. There are also
        summary tables that aggregate information about stage events;
        see <a class="xref" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables">Section 22.9.9.2, “Stage Summary Tables”</a>.
</p>
<h4><a name="stage-event-configuration"></a>Stage Event Configuration</h4>
<p>
        To enable collection of stage events, enable the relevant
        instruments and consumers.
      </p><p>
        The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
        contains instruments with names that begin with
        <code class="literal">stage</code>. These instruments are disabled by
        default. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME RLIKE 'stage/sql/[a-c]';</code></strong>
+----------------------------------------------------+---------+-------+
| NAME                                               | ENABLED | TIMED |
+----------------------------------------------------+---------+-------+
| stage/sql/After create                             | NO      | NO    |
| stage/sql/allocating local table                   | NO      | NO    |
| stage/sql/altering table                           | NO      | NO    |
| stage/sql/committing alter table to storage engine | NO      | NO    |
| stage/sql/Changing master                          | NO      | NO    |
| stage/sql/Checking master version                  | NO      | NO    |
| stage/sql/checking permissions                     | NO      | NO    |
| stage/sql/checking privileges on cached query      | NO      | NO    |
| stage/sql/checking query cache for query           | NO      | NO    |
| stage/sql/cleaning up                              | NO      | NO    |
| stage/sql/closing tables                           | NO      | NO    |
| stage/sql/Connecting to master                     | NO      | NO    |
| stage/sql/converting HEAP to MyISAM                | NO      | NO    |
| stage/sql/Copying to group table                   | NO      | NO    |
| stage/sql/Copying to tmp table                     | NO      | NO    |
| stage/sql/copy to tmp table                        | NO      | NO    |
| stage/sql/Creating delayed handler                 | NO      | NO    |
| stage/sql/Creating sort index                      | NO      | NO    |
| stage/sql/creating table                           | NO      | NO    |
| stage/sql/Creating tmp table                       | NO      | NO    |
+----------------------------------------------------+---------+-------+
</pre><p>
        To modify collection of stage events, change the
        <code class="literal">ENABLED</code> and <code class="literal">TIMING</code> columns
        of the relevant instruments. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'YES', TIMED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'stage/sql/altering table';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table contains
        consumer values with names corresponding to the current and
        recent stage event table names. These consumers may be used to
        filter collection of stage events. The stage consumers are
        disabled by default:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%stages%';</code></strong>
+----------------------------+---------+
| NAME                       | ENABLED |
+----------------------------+---------+
| events_stages_current      | NO      |
| events_stages_history      | NO      |
| events_stages_history_long | NO      |
+----------------------------+---------+
</pre><p>
        To enable all stage consumers, do this:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%stages%';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table contains a
        row with a <code class="literal">NAME</code> value of
        <code class="literal">stage</code> that indicates the unit for stage event
        timing. The default unit is <code class="literal">NANOSECOND</code>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'stage';</code></strong>
+-------+------------+
| NAME  | TIMER_NAME |
+-------+------------+
| stage | NANOSECOND |
+-------+------------+
</pre><p>
        To change the timing unit, modify the
        <code class="literal">TIMER_NAME</code> value:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'stage';</code></strong>
</pre><p>
        For additional information about configuring event collection,
        see <a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 Performance Schema Configuration">Section 22.2, “Performance Schema Configuration”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-stages-current-table"></a>22.9.5.1 The events_stages_current Table</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737072474624"></a><a class="indexterm" name="idm139737072473120"></a><p>
          The <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> table
          contains current stage events, one row per thread showing the
          current status of the thread's most recent monitored stage
          event.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> table
          can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          Of the tables that contain stage event rows,
          <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> is the most
          fundamental. Other tables that contain stage event rows are
          logically derived from the current events. For example, the
          <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> and
          <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a> tables
          are collections of the most recent stage events, up to a fixed
          number of rows.
        </p><p>
          For information about configuration of stage event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 Performance Schema Stage Event Tables">Section 22.9.5, “Performance Schema Stage Event Tables”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> table
          has these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>, <code class="literal">EVENT_ID</code>
            </p><p>
              The thread associated with the event and the thread
              current event number when the event starts. The
              <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_ID</code> values taken together form a
              primary key that uniquely identifies the row. No two rows
              will have the same pair of values.
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              This column is set to <code class="literal">NULL</code> when the
              event starts and updated to the thread current event
              number when the event ends. This column was added in MySQL
              5.6.4.
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              The name of the instrument that produced the event. This
              is a <code class="literal">NAME</code> value from the
              <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
              Instrument names may have multiple parts and form a
              hierarchy, as discussed in
              <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              The name of the source file containing the instrumented
              code that produced the event and the line number in the
              file at which the instrumentation occurs. This enables you
              to check the source to determine exactly what code is
              involved.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>,
              <code class="literal">TIMER_WAIT</code>
            </p><p>
              Timing information for the event. The unit for these
              values is picoseconds (trillionths of a second). The
              <code class="literal">TIMER_START</code> and
              <code class="literal">TIMER_END</code> values indicate when event
              timing started and ended. <code class="literal">TIMER_WAIT</code> is
              the event elapsed time (duration).
            </p><p>
              If an event has not finished, <code class="literal">TIMER_END</code>
              and <code class="literal">TIMER_WAIT</code> are
              <code class="literal">NULL</code> before MySQL 5.6.26. As of 5.6.26,
              <code class="literal">TIMER_END</code> is the current timer value
              and <code class="literal">TIMER_WAIT</code> is the time elapsed so
              far (<code class="literal">TIMER_END</code> −
              <code class="literal">TIMER_START</code>).
            </p><p>
              If an event is produced from an instrument that has
              <code class="literal">TIMED = NO</code>, timing information is not
              collected, and <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>, and
              <code class="literal">TIMER_WAIT</code> are all
              <code class="literal">NULL</code>.
            </p><p>
              For discussion of picoseconds as the unit for event times
              and factors that affect time values, see
              <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>
            </p><p>
              The <code class="literal">EVENT_ID</code> value of the event within
              which this event is nested. The nesting event for a stage
              event is usually a statement event.
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              The nesting event type. The value is
              <code class="literal">STATEMENT</code>, <code class="literal">STAGE</code>, or
              <code class="literal">WAIT</code>.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> table
          was added in MySQL 5.6.3.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-stages-history-table"></a>22.9.5.2 The events_stages_history Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072418624"></a><a class="indexterm" name="idm139737072417120"></a><p>
          The <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> table
          contains the most recent <em class="replaceable"><code>N</code></em> stage
          events per thread. The value of <em class="replaceable"><code>N</code></em>
          is autosized at server startup. To set the table size
          explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size"><code class="literal">performance_schema_events_stages_history_size</code></a>
          system variable at server startup. Stage events are not added
          to the table until they have ended. As new events are added,
          older events are discarded if the table is full.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> table
          has the same structure as
          <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table">Section 22.9.5.1, “The events_stages_current Table”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> table
          can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> table
          was added in MySQL 5.6.3.
        </p><p>
          For information about configuration of stage event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 Performance Schema Stage Event Tables">Section 22.9.5, “Performance Schema Stage Event Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-stages-history-long-table"></a>22.9.5.3 The events_stages_history_long Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072400608"></a><a class="indexterm" name="idm139737072399104"></a><p>
          The <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
          table contains the most recent <em class="replaceable"><code>N</code></em>
          stage events. The value of <em class="replaceable"><code>N</code></em> is
          autosized at server startup. To set the table size explicitly,
          set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size"><code class="literal">performance_schema_events_stages_history_long_size</code></a>
          system variable at server startup. Stage events are not added
          to the table until they have ended. As new events are added,
          older events are discarded if the table is full. When a thread
          ends, its rows are removed from the table.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
          table has the same structure as
          <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table">Section 22.9.5.1, “The events_stages_current Table”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
          table can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
          table was added in MySQL 5.6.3.
        </p><p>
          For information about configuration of stage event collection,
          see <a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 Performance Schema Stage Event Tables">Section 22.9.5, “Performance Schema Stage Event Tables”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-statement-tables"></a>22.9.6 Performance Schema Statement Event Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#events-statements-current-table">22.9.6.1 The events_statements_current Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-statements-history-table">22.9.6.2 The events_statements_history Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#events-statements-history-long-table">22.9.6.3 The events_statements_history_long Table</a></span></dt></dl>
</div>
<p>
        As of MySQL 5.6.3, the Performance Schema instruments statement
        execution. Statement events occur at a high level of the event
        hierarchy: Wait events nest within stage events, which nest
        within statement events.
      </p><p>
        These tables store statement events:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>:
            Current statement events
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>: The
            most recent statement events for each thread
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>:
            The most recent statement events overall
</p></li></ul>
</div>
<p>
        The following sections describe those tables. There are also
        summary tables that aggregate information about statement
        events; see <a class="xref" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables">Section 22.9.9.3, “Statement Summary Tables”</a>.
</p>
<h4><a name="statement-event-configuration"></a>Statement Event Configuration</h4>
<p>
        To enable collection of statement events, enable the relevant
        instruments and consumers.
      </p><p>
        The <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table
        contains instruments with names that begin with
        <code class="literal">statement</code>. These instruments are enabled by
        default:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_instruments WHERE NAME LIKE 'statement/%';</code></strong>
+---------------------------------------------+---------+-------+
| NAME                                        | ENABLED | TIMED |
+---------------------------------------------+---------+-------+
| statement/sql/select                        | YES     | YES   |
| statement/sql/create_table                  | YES     | YES   |
| statement/sql/create_index                  | YES     | YES   |
...
| statement/sp/stmt                           | YES     | YES   |
| statement/sp/set                            | YES     | YES   |
| statement/sp/set_trigger_field              | YES     | YES   |
| statement/scheduler/event                   | YES     | YES   |
| statement/com/Sleep                         | YES     | YES   |
| statement/com/Quit                          | YES     | YES   |
| statement/com/Init DB                       | YES     | YES   |
...
| statement/abstract/Query                    | YES     | YES   |
| statement/abstract/new_packet               | YES     | YES   |
| statement/abstract/relay_log                | YES     | YES   |
+---------------------------------------------+---------+-------+
</pre><p>
        To modify collection of statement events, change the
        <code class="literal">ENABLED</code> and <code class="literal">TIMING</code> columns
        of the relevant instruments. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_instruments SET ENABLED = 'NO'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE 'statement/com/%';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table contains
        consumer values with names corresponding to the current and
        recent statement event table names, and the statement digest
        consumer. These consumers may be used to filter collection of
        statement events and statement digesting. Only
        <code class="literal">events_statements_current</code> and
        <code class="literal">statements_digest</code> are enabled by default:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_consumers WHERE NAME LIKE '%statements%';</code></strong>
+--------------------------------+---------+
| NAME                           | ENABLED |
+--------------------------------+---------+
| events_statements_current      | YES     |
| events_statements_history      | NO      |
| events_statements_history_long | NO      |
| statements_digest              | YES     |
+--------------------------------+---------+
</pre><p>
        To enable all statement consumers, do this:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_consumers SET ENABLED = 'YES'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME LIKE '%statements%';</code></strong>
</pre><p>
        The <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table contains a
        row with a <code class="literal">NAME</code> value of
        <code class="literal">statement</code> that indicates the unit for
        statement event timing. The default unit is
        <code class="literal">NANOSECOND</code>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM setup_timers WHERE NAME = 'statement';</code></strong>
+-----------+------------+
| NAME      | TIMER_NAME |
+-----------+------------+
| statement | NANOSECOND |
+-----------+------------+
</pre><p>
        To change the timing unit, modify the
        <code class="literal">TIMER_NAME</code> value:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>UPDATE setup_timers SET TIMER_NAME = 'MICROSECOND'</code></strong>
    -&gt; <strong class="userinput"><code>WHERE NAME = 'statement';</code></strong>
</pre><p>
        For additional information about configuring event collection,
        see <a class="xref" href="performance-schema.html#performance-schema-configuration" title="22.2 Performance Schema Configuration">Section 22.2, “Performance Schema Configuration”</a>.
</p>
<h4><a name="idm139737072343440"></a>Statement Monitoring</h4>
<p>
        Statement monitoring begins from the moment the server sees that
        activity is requested on a thread, to the moment when all
        activity has ceased. Typically, this means from the time the
        server gets the first packet from the client to the time the
        server has finished sending the response. Monitoring occurs only
        for top-level statements. Statements within stored programs and
        subqueries are not seen separately.
      </p><p>
        When the Performance Schema instruments a request (server
        command or SQL statement), it uses instrument names that proceed
        in stages from more general (or <span class="quote">“<span class="quote">abstract</span>”</span>) to more
        specific until it arrives at a final instrument name.
      </p><p>
        Final instrument names correspond to server commands and SQL
        statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Server commands correspond to the
            <code class="literal">COM_<em class="replaceable"><code>xxx</code></em> codes</code>
            defined in the <code class="filename">mysql_com.h</code> header file
            and processed in <code class="filename">sql/sql_parse.cc</code>.
            Examples are <code class="literal">COM_PING</code> and
            <code class="literal">COM_QUIT</code>. Instruments for commands have
            names that begin with <code class="literal">statement/com</code>, such
            as <code class="literal">statement/com/Ping</code> and
            <code class="literal">statement/com/Quit</code>.
          </p></li><li class="listitem"><p>
            SQL statements are expressed as text, such as
            <code class="literal">DELETE FROM t1</code> or <code class="literal">SELECT * FROM
            t2</code>. Instruments for SQL statements have names that
            begin with <code class="literal">statement/sql</code>, such as
            <code class="literal">statement/sql/delete</code> and
            <code class="literal">statement/sql/select</code>.
</p></li></ul>
</div>
<p>
        Some final instrument names are specific to error handling:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">statement/com/Error</code> accounts for messages
            received by the server that are out of band. It can be used
            to detect commands sent by clients that the server does not
            understand. This may be helpful for purposes such as
            identifying clients that are misconfigured or using a
            version of MySQL more recent than that of the server, or
            clients that are attempting to attack the server.
          </p></li><li class="listitem"><p>
            <code class="literal">statement/sql/error</code> accounts for SQL
            statements that fail to parse. It can be used to detect
            malformed queries sent by clients. A query that fails to
            parse differs from a query that parses but fails due to an
            error during execution. For example, <code class="literal">SELECT *
            FROM</code> is malformed, and the
            <code class="literal">statement/sql/error</code> instrument is used.
            By contrast, <code class="literal">SELECT *</code> parses but fails
            with a <code class="literal">No tables used</code> error. In this
            case, <code class="literal">statement/sql/select</code> is used and
            the statement event contains information to indicate the
            nature of the error.
</p></li></ul>
</div>
<p>
        A request can be obtained from any of these sources:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            As a command or statement request from a client, which sends
            the request as packets
          </p></li><li class="listitem"><p>
            As a statement string read from the relay log on a
            replication slave (as of MySQL 5.6.13)
</p></li></ul>
</div>
<p>
        The details for a request are not initially known and the
        Performance Schema proceeds from abstract to specific instrument
        names in a sequence that depends on the source of the request.
      </p><p>
        For a request received from a client:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            When the server detects a new packet at the socket level, a
            new statement is started with an abstract instrument name of
            <code class="literal">statement/abstract/new_packet</code>.
          </p></li><li class="listitem"><p>
            When the server reads the packet number, it knows more about
            the type of request received, and the Performance Schema
            refines the instrument name. For example, if the request is
            a <code class="literal">COM_PING</code> packet, the instrument name
            becomes <code class="literal">statement/com/Ping</code> and that is
            the final name. If the request is a
            <code class="literal">COM_QUERY</code> packet, it is known to
            correspond to a SQL statement but not the particular type of
            statement. In this case, the instrument changes from one
            abstract name to a more specific but still abstract name,
            <code class="literal">statement/abstract/Query</code>, and the request
            requires further classification.
          </p></li><li class="listitem"><p>
            If the request is a statement, the statement text is read
            and given to the parser. After parsing, the exact statement
            type is known. If the request is, for example, an
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement, the
            Performance Schema refines the instrument name from
            <code class="literal">statement/abstract/Query</code> to
            <code class="literal">statement/sql/insert</code>, which is the final
            name.
</p></li></ol>
</div>
<p>
        For a request read as a statement from the relay log on a
        replication slave:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Statements in the relay log are stored as text and are read
            as such. There is no network protocol, so the
            <code class="literal">statement/abstract/new_packet</code> instrument
            is not used. Instead, the initial instrument is
            <code class="literal">statement/abstract/relay_log</code>.
          </p></li><li class="listitem"><p>
            When the statement is parsed, the exact statement type is
            known. If the request is, for example, an
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement, the
            Performance Schema refines the instrument name from
            <code class="literal">statement/abstract/Query</code> to
            <code class="literal">statement/sql/insert</code>, which is the final
            name.
</p></li></ol>
</div>
<p>
        The preceding description applies only for statement-based
        replication. For row-based replication, table I/O done on the
        slave as it processes row changes can be instrumented, but row
        events in the relay log do not appear as discrete statements.
      </p><p>
        For statistics to be collected for statements, it is not
        sufficient to enable only the final
        <code class="literal">statement/sql/*</code> instruments used for
        individual statement types. The abtract
        <code class="literal">statement/abstract/*</code> instruments must be
        enabled as well. This should not normally be an issue because
        all statement instruments are enabled by default. However, an
        application that enables or disables statement instruments
        selectively must take into account that disabling abstract
        instruments also disables statistics collection for the
        individual statement instruments. For example, to collect
        statistics for <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements,
        <code class="literal">statement/sql/insert</code> must be enabled, but
        also <code class="literal">statement/abstract/new_packet</code> and
        <code class="literal">statement/abstract/Query</code>. Similarly, for
        replicated statements to be instrumented,
        <code class="literal">statement/abstract/relay_log</code> must be enabled.
      </p><p>
        No statistics are aggregated for abstract instruments such as
        <code class="literal">statement/abstract/Query</code> because no statement
        is ever classified with an abstract instrument as the final
        statement name.
      </p><p>
        The abstract instrument names in the preceding discussion are as
        of MySQL 5.6.15. In earlier 5.6 versions, there was some
        renaming before those names were settled on:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">statement/abstract/new_packet</code> was
            <code class="literal">statement/com/</code> in MySQL 5.6.14,
            <code class="literal">statement/com/new_packet</code> in MySQL 5.6.13,
            and <code class="literal">statement/com/</code> before that.
          </p></li><li class="listitem"><p>
            <code class="literal">statement/abstract/Query</code> was
            <code class="literal">statement/com/Query</code> before MySQL 5.6.15.
          </p></li><li class="listitem"><p>
            <code class="literal">statement/abstract/relay_log</code> was
            <code class="literal">statement/rpl/relay_log</code> from MySQL 5.6.13
            to 5.6.14 and did not exist before that.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-statements-current-table"></a>22.9.6.1 The events_statements_current Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072278352"></a><a class="indexterm" name="idm139737072276848"></a><p>
          The <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
          table contains current statement events, one row per thread
          showing the current status of the thread's most recent
          monitored statement event.
        </p><p>
          The <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
          table can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          Of the tables that contain statement event rows,
          <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a> is the
          most fundamental. Other tables that contain statement event
          rows are logically derived from the current events. For
          example, the
          <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a> and
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          tables are collections of the most recent statement events, up
          to a fixed number of rows.
        </p><p>
          For information about configuration of statement event
          collection, see
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
          table has these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>, <code class="literal">EVENT_ID</code>
            </p><p>
              The thread associated with the event and the thread
              current event number when the event starts. The
              <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_ID</code> values taken together form a
              primary key that uniquely identifies the row. No two rows
              will have the same pair of values.
            </p></li><li class="listitem"><p>
              <code class="literal">END_EVENT_ID</code>
            </p><p>
              This column is set to <code class="literal">NULL</code> when the
              event starts and updated to the thread current event
              number when the event ends. This column was added in MySQL
              5.6.4.
            </p></li><li class="listitem"><p>
              <code class="literal">EVENT_NAME</code>
            </p><p>
              The name of the instrument from which the event was
              collected. This is a <code class="literal">NAME</code> value from
              the <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
              Instrument names may have multiple parts and form a
              hierarchy, as discussed in
              <a class="xref" href="performance-schema.html#performance-schema-instrument-naming" title="22.4 Performance Schema Instrument Naming Conventions">Section 22.4, “Performance Schema Instrument Naming Conventions”</a>.
            </p><p>
              For SQL statements, the <code class="literal">EVENT_NAME</code>
              value initially is <code class="literal">statement/com/Query</code>
              until the statement is parsed, then changes to a more
              appropriate value, as described in
              <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">SOURCE</code>
            </p><p>
              The name of the source file containing the instrumented
              code that produced the event and the line number in the
              file at which the instrumentation occurs. This enables you
              to check the source to determine exactly what code is
              involved.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>,
              <code class="literal">TIMER_WAIT</code>
            </p><p>
              Timing information for the event. The unit for these
              values is picoseconds (trillionths of a second). The
              <code class="literal">TIMER_START</code> and
              <code class="literal">TIMER_END</code> values indicate when event
              timing started and ended. <code class="literal">TIMER_WAIT</code> is
              the event elapsed time (duration).
            </p><p>
              If an event has not finished, <code class="literal">TIMER_END</code>
              and <code class="literal">TIMER_WAIT</code> are
              <code class="literal">NULL</code> before MySQL 5.6.26. As of 5.6.26,
              <code class="literal">TIMER_END</code> is the current timer value
              and <code class="literal">TIMER_WAIT</code> is the time elapsed so
              far (<code class="literal">TIMER_END</code> −
              <code class="literal">TIMER_START</code>).
            </p><p>
              If an event is produced from an instrument that has
              <code class="literal">TIMED = NO</code>, timing information is not
              collected, and <code class="literal">TIMER_START</code>,
              <code class="literal">TIMER_END</code>, and
              <code class="literal">TIMER_WAIT</code> are all
              <code class="literal">NULL</code>.
            </p><p>
              For discussion of picoseconds as the unit for event times
              and factors that affect time values, see
              <a class="xref" href="performance-schema.html#performance-schema-timing" title="22.2.3.1 Performance Schema Event Timing">Section 22.2.3.1, “Performance Schema Event Timing”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">LOCK_TIME</code>
            </p><p>
              The time spent waiting for table locks. This value is
              computed in microseconds but normalized to picoseconds for
              easier comparison with other Performance Schema timers.
            </p></li><li class="listitem"><p>
              <code class="literal">SQL_TEXT</code>
            </p><p>
              The text of the SQL statement. For a command not
              associated with a SQL statement, the value is
              <code class="literal">NULL</code>. The maximum space available for
              statement display is 1024 bytes.
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST</code>
            </p><p>
              The statement digest MD5 value as a string of 32
              hexadecimal characters, or <code class="literal">NULL</code> if the
              <code class="literal">statement_digest</code> consumer is
              <code class="literal">no</code>. For more information about
              statement digesting, see
              <a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="22.7 Performance Schema Statement Digests">Section 22.7, “Performance Schema Statement Digests”</a>.
              This column was added in MySQL 5.6.5.
            </p></li><li class="listitem"><p>
              <code class="literal">DIGEST_TEXT</code>
            </p><p>
              The normalized statement digest text, or
              <code class="literal">NULL</code> if the
              <code class="literal">statement_digest</code> consumer is
              <code class="literal">no</code>. For more information about
              statement digesting, see
              <a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="22.7 Performance Schema Statement Digests">Section 22.7, “Performance Schema Statement Digests”</a>.
              This column was added in MySQL 5.6.5.
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_SCHEMA</code>
            </p><p>
              The default database for the statement,
              <code class="literal">NULL</code> if there is none.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_SCHEMA</code>,
              <code class="literal">OBJECT_NAME</code>,
              <code class="literal">OBJECT_TYPE</code>
            </p><p>
              Reserved. Currently <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">OBJECT_INSTANCE_BEGIN</code>
            </p><p>
              This column identifies the statement. The value is the
              address of an object in memory.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code>
            </p><p>
              The statement error number, from the statement diagnostics
              area.
            </p></li><li class="listitem"><p>
              <code class="literal">RETURNED_SQLSTATE</code>
            </p><p>
              The statement SQLSTATE value, from the statement
              diagnostics area.
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code>
            </p><p>
              The statement error message, from the statement
              diagnostics area.
            </p></li><li class="listitem"><p>
              <code class="literal">ERRORS</code>
            </p><p>
              Whether an error occurred for the statement. The value is
              0 if the SQLSTATE value begins with <code class="literal">00</code>
              (completion) or <code class="literal">01</code> (warning). The value
              is 1 is the SQLSTATE value is anything else.
            </p></li><li class="listitem"><p>
              <code class="literal">WARNINGS</code>
            </p><p>
              The number of warnings, from the statement diagnostics
              area.
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_AFFECTED</code>
            </p><p>
              The number of rows affected by the statement. For a
              description of the meaning of <span class="quote">“<span class="quote">affected,</span>”</span> see
              <a class="xref" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()">Section 23.8.7.1, “mysql_affected_rows()”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_SENT</code>
            </p><p>
              The number of rows returned by the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">ROWS_EXAMINED</code>
            </p><p>
              The number of rows read from storage engines during
              statement execution.
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_DISK_TABLES</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Created_tmp_disk_tables"><code class="literal">Created_tmp_disk_tables</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">CREATED_TMP_TABLES</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Created_tmp_tables"><code class="literal">Created_tmp_tables</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_JOIN</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Select_full_join"><code class="literal">Select_full_join</code></a> status
              variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_FULL_RANGE_JOIN</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Select_full_range_join"><code class="literal">Select_full_range_join</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE</code>
            </p><p>
              Like the <a class="link" href="server-administration.html#statvar_Select_range"><code class="literal">Select_range</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_RANGE_CHECK</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Select_range_check"><code class="literal">Select_range_check</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SELECT_SCAN</code>
            </p><p>
              Like the <a class="link" href="server-administration.html#statvar_Select_scan"><code class="literal">Select_scan</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_MERGE_PASSES</code>
            </p><p>
              Like the
              <a class="link" href="server-administration.html#statvar_Sort_merge_passes"><code class="literal">Sort_merge_passes</code></a> status
              variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_RANGE</code>
            </p><p>
              Like the <a class="link" href="server-administration.html#statvar_Sort_range"><code class="literal">Sort_range</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_ROWS</code>
            </p><p>
              Like the <a class="link" href="server-administration.html#statvar_Sort_rows"><code class="literal">Sort_rows</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">SORT_SCAN</code>
            </p><p>
              Like the <a class="link" href="server-administration.html#statvar_Sort_scan"><code class="literal">Sort_scan</code></a>
              status variable, but specific to the statement.
            </p></li><li class="listitem"><p>
              <code class="literal">NO_INDEX_USED</code>
            </p><p>
              1 if the statement performed a table scan without using an
              index, 0 otherwise.
            </p></li><li class="listitem"><p>
              <code class="literal">NO_GOOD_INDEX_USED</code>
            </p><p>
              1 if the server found no good index to use for the
              statement, 0 otherwise. For additional information, see
              the description of the <code class="literal">Extra</code> column
              from <code class="literal">EXPLAIN</code> output for the
              <code class="literal">Range checked for each record</code> value in
              <a class="xref" href="optimization.html#explain-output" title="8.8.2 EXPLAIN Output Format">Section 8.8.2, “EXPLAIN Output Format”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">NESTING_EVENT_ID</code>,
              <code class="literal">NESTING_EVENT_TYPE</code>
            </p><p>
              Reserved. Currently <code class="literal">NULL</code>.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
          table was added in MySQL 5.6.3.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-statements-history-table"></a>22.9.6.2 The events_statements_history Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072139232"></a><a class="indexterm" name="idm139737072137728"></a><p>
          The <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>
          table contains the most recent <em class="replaceable"><code>N</code></em>
          statement events per thread. The value of
          <em class="replaceable"><code>N</code></em> is autosized at server startup.
          To set the table size explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size"><code class="literal">performance_schema_events_statements_history_size</code></a>
          system variable at server startup. Statement events are not
          added to the table until they have ended. As new events are
          added, older events are discarded if the table is full.
        </p><p>
          The <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>
          table has the same structure as
          <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table">Section 22.9.6.1, “The events_statements_current Table”</a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>
          table can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          The <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a>
          table was added in MySQL 5.6.3.
        </p><p>
          For information about configuration of statement event
          collection, see
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="events-statements-history-long-table"></a>22.9.6.3 The events_statements_history_long Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072120960"></a><a class="indexterm" name="idm139737072119504"></a><p>
          The
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          table contains the most recent <em class="replaceable"><code>N</code></em>
          statement events. The value of <em class="replaceable"><code>N</code></em> is
          autosized at server startup. To set the table size explicitly,
          set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size"><code class="literal">performance_schema_events_statements_history_long_size</code></a>
          system variable at server startup. Statement events are not
          added to the table until they have ended. As new events are
          added, older events are discarded if the table is full. When a
          thread ends, its rows are removed from the table.
        </p><p>
          The
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          table has the same structure as
          <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>. See
          <a class="xref" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table">Section 22.9.6.1, “The events_statements_current Table”</a>.
        </p><p>
          The
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          table can be truncated with <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE</code></a>.
        </p><p>
          The
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          table was added in MySQL 5.6.3.
        </p><p>
          For information about configuration of statement event
          collection, see
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-connection-tables"></a>22.9.7 Performance Schema Connection Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#accounts-table">22.9.7.1 The accounts Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#hosts-table">22.9.7.2 The hosts Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#users-table">22.9.7.3 The users Table</a></span></dt></dl>
</div>
<p>
        As of MySQL 5.6.3, the Performance Schema provides statistics
        about connections to the server. When a client connects, it does
        so under a particular user name and from a particular host. The
        Performance Schema tracks connections per account (user name
        plus host name) and separately per user name and per host name,
        using these tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a>: Connection statistics
            per client account
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a>: Connection statistics
            per client host name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a>: Connection statistics
            per client user name
</p></li></ul>
</div>
<p>
        There are also summary tables that aggregate information about
        connections. See <a class="xref" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables">Section 22.9.9.7, “Connection Summary Tables”</a>.
      </p><p>
        The meaning of <span class="quote">“<span class="quote">account</span>”</span> in the connection tables
        is similar to its meaning in the MySQL grant tables in the
        <code class="literal">mysql</code> database, in the sense that the term
        refers to a combination of user and host values. Where they
        differ is that in the grant tables, the host part of an account
        can be a pattern, whereas in the Performance Schema tables the
        host value is always a specific nonpattern host name.
      </p><p>
        The connection tables all have
        <code class="literal">CURRENT_CONNECTIONS</code> and
        <code class="literal">TOTAL_CONNECTIONS</code> columns to track the
        current and total number of connections per <span class="quote">“<span class="quote">tracking
        value</span>”</span> on which statistics are based. The tables differ
        in what they use for the tracking value. The
        <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table has
        <code class="literal">USER</code> and <code class="literal">HOST</code> columns to
        track connections per user name plus host name combination. The
        <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> and
        <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> tables have a
        <code class="literal">USER</code> and <code class="literal">HOST</code> column,
        respectively, to track connections per user name and per host
        name.
      </p><p>
        Suppose that clients named <code class="literal">user1</code> and
        <code class="literal">user2</code> each connect one time from
        <code class="literal">hosta</code> and <code class="literal">hostb</code>. The
        Performance Schema tracks the connections as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table will have
            four rows, for the
            <code class="literal">user1</code>/<code class="literal">hosta</code>,
            <code class="literal">user1</code>/<code class="literal">hostb</code>,
            <code class="literal">user2</code>/<code class="literal">hosta</code>, and
            <code class="literal">user2</code>/<code class="literal">hostb</code> account
            values, each row counting one connection per account.
          </p></li><li class="listitem"><p>
            The <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table will have two
            rows, for <code class="literal">user1</code> and
            <code class="literal">user2</code>, each row counting two connections
            per user name.
          </p></li><li class="listitem"><p>
            The <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table will have two
            rows, for <code class="literal">hosta</code> and
            <code class="literal">hostb</code>, each row counting two connections
            per host name.
</p></li></ul>
</div>
<p>
        When a client connects, the Performance Schema determines which
        row in each connection table applies to the connection, using
        the tracking value appropriate to each table. If there is no
        such row, one is added. Then the Performance Schema increments
        by one the <code class="literal">CURRENT_CONNECTIONS</code> and
        <code class="literal">TOTAL_CONNECTIONS</code> columns in that row.
      </p><p>
        When a client disconnects, the Performance Schema decrements by
        one the <code class="literal">CURRENT_CONNECTIONS</code> column in the row
        and leaves the <code class="literal">TOTAL_CONNECTIONS</code> column
        unchanged.
      </p><p>
        The Performance Schema also counts threads for internal threads
        and user sessions that failed to authenticate. These are counted
        in rows with <code class="literal">USER</code> and <code class="literal">HOST</code>
        column values of <code class="literal">NULL</code>.
      </p><p>
        Each connection table can be truncated with
        <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, which has this
        effect:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Rows with <code class="literal">CURRENT_CONNECTIONS = 0</code> are
            deleted.
          </p></li><li class="listitem"><p>
            For rows with <code class="literal">CURRENT_CONNECTIONS &gt; 0</code>,
            <code class="literal">TOTAL_CONNECTIONS</code> is reset to
            <code class="literal">CURRENT_CONNECTIONS</code>.
          </p></li><li class="listitem"><p>
            Connection summary tables that depend on the connection
            table are truncated implicitly (summary values are set to
            0). For more information about implicit truncation, see
            <a class="xref" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables">Section 22.9.9.7, “Connection Summary Tables”</a>.
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="accounts-table"></a>22.9.7.1 The accounts Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072047824"></a><a class="indexterm" name="idm139737072046336"></a><p>
          The <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table contains a row
          for each account that has connected to the MySQL server. For
          each account, the table counts the current and total number of
          connections. The table size is autosized at server startup. To
          set the table size explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size"><code class="literal">performance_schema_accounts_size</code></a>
          system variable at server startup. To disable account
          statistics, set this variable to 0.
        </p><p>
          The <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table has the
          following columns. For a description of how the Performance
          Schema maintains rows in this table, including the effect of
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, see
          <a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 Performance Schema Connection Tables">Section 22.9.7, “Performance Schema Connection Tables”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              The client user name for the connection, or
              <code class="literal">NULL</code> for an internal thread or user
              session that failed to authenticate.
            </p><p>
              The
              <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
              system variable determines the maximum number of bytes
              available for computing statement digests. However, the
              display length of statement digests may be longer than the
              available buffer size due to encoding of statement
              components such as keywords and literal values in digest
              buffer. Consequently, values selected from the
              <code class="literal">DIGEST_TEXT</code> column of statement event
              tables may appear to exceed the
              <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
              value.
            </p><p>
              This variable was added in MySQL 5.6.26.
              <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a>. In
              MySQL 5.6.24 and 5.6.25, use
              <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a>
              instead. Before 5.6.24, the value cannot be changed.
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              The host name from which the client connected, or
              <code class="literal">NULL</code> for an internal thread or user
              session that failed to authenticate.
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              The current number of connections for the account.
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              The total number of connections for the account.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table was added in
          MySQL 5.6.3.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="hosts-table"></a>22.9.7.2 The hosts Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737072017712"></a><a class="indexterm" name="idm139737072016224"></a><p>
          The <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table contains a row
          for each host from which clients have connected to the MySQL
          server. For each host name, the table counts the current and
          total number of connections. The table size is autosized at
          server startup. To set the table size explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size"><code class="literal">performance_schema_hosts_size</code></a>
          system variable at server startup. To disable host statistics,
          set this variable to 0.
        </p><p>
          The <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table has the following
          columns. For a description of how the Performance Schema
          maintains rows in this table, including the effect of
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, see
          <a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 Performance Schema Connection Tables">Section 22.9.7, “Performance Schema Connection Tables”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              The host name from which the client connected, or
              <code class="literal">NULL</code> for an internal thread or user
              session that failed to authenticate.
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              The current number of connections for the host.
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              The total number of connections for the host.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table was added in
          MySQL 5.6.3.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="users-table"></a>22.9.7.3 The users Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071997776"></a><a class="indexterm" name="idm139737071996288"></a><p>
          The <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table contains a row
          for each user who has connected to the MySQL server. For each
          user name, the table counts the current and total number of
          connections. The table size is autosized at server startup. To
          set the table size explicitly, set the
          <a class="link" href="performance-schema.html#sysvar_performance_schema_users_size"><code class="literal">performance_schema_users_size</code></a>
          system variable at server startup. To disable user statistics,
          set this variable to 0.
        </p><p>
          The <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table has the following
          columns. For a description of how the Performance Schema
          maintains rows in this table, including the effect of
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, see
          <a class="xref" href="performance-schema.html#performance-schema-connection-tables" title="22.9.7 Performance Schema Connection Tables">Section 22.9.7, “Performance Schema Connection Tables”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">USER</code>
            </p><p>
              The client user name for the connection, or
              <code class="literal">NULL</code> for an internal thread or user
              session that failed to authenticate.
            </p></li><li class="listitem"><p>
              <code class="literal">CURRENT_CONNECTIONS</code>
            </p><p>
              The current number of connections for the user.
            </p></li><li class="listitem"><p>
              <code class="literal">TOTAL_CONNECTIONS</code>
            </p><p>
              The total number of connections for the user.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table was added in
          MySQL 5.6.3.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-connection-attribute-tables"></a>22.9.8 Performance Schema Connection Attribute Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#session-account-connect-attrs-table">22.9.8.1 The session_account_connect_attrs Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#session-connect-attrs-table">22.9.8.2 The session_connect_attrs Table</a></span></dt></dl>
</div>
<p>
        As of MySQL 5.6.6, application programs can provide key/value
        connection attributes to be passed to the server at connect
        time, using the <a class="link" href="connectors-apis.html#mysql-options" title="23.8.7.49 mysql_options()"><code class="literal">mysql_options()</code></a>
        and <a class="link" href="connectors-apis.html#mysql-options4" title="23.8.7.50 mysql_options4()"><code class="literal">mysql_options4()</code></a> C API
        functions. The Performance Schema exposes this information
        through these tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="22.9.8.1 The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>:
            Connection attributes for sessions for the current account
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#session-connect-attrs-table" title="22.9.8.2 The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a>:
            Connection attributes for all sessions
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="session-account-connect-attrs-table"></a>22.9.8.1 The session_account_connect_attrs Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071968624"></a><a class="indexterm" name="idm139737071967120"></a><p>
          As of MySQL 5.6.6, application programs can provide key/value
          connection attributes to be passed to the server at connect
          time, using the
          <a class="link" href="connectors-apis.html#mysql-options" title="23.8.7.49 mysql_options()"><code class="literal">mysql_options()</code></a> and
          <a class="link" href="connectors-apis.html#mysql-options4" title="23.8.7.50 mysql_options4()"><code class="literal">mysql_options4()</code></a> C API
          functions.
        </p><p>
          The <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="22.9.8.1 The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
          table contains connection attributes only for sessions open
          for your own account. To see connection attributes for all
          sessions, look in the
          <a class="link" href="performance-schema.html#session-connect-attrs-table" title="22.9.8.2 The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> table.
        </p><p>
          The <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="22.9.8.1 The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
          table contains these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              The connection identifier for the session.
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              The attribute name.
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              The attribute value.
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              The order in which the attribute was added to the set of
              connection attributes.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="session-connect-attrs-table"></a>22.9.8.2 The session_connect_attrs Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071948336"></a><a class="indexterm" name="idm139737071946832"></a><p>
          As of MySQL 5.6.6, application programs can provide key/value
          connection attributes to be passed to the server at connect
          time, using the
          <a class="link" href="connectors-apis.html#mysql-options" title="23.8.7.49 mysql_options()"><code class="literal">mysql_options()</code></a> and
          <a class="link" href="connectors-apis.html#mysql-options4" title="23.8.7.50 mysql_options4()"><code class="literal">mysql_options4()</code></a> C API
          functions.
        </p><p>
          The <a class="link" href="performance-schema.html#session-connect-attrs-table" title="22.9.8.2 The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> table
          contains connection attributes for all sessions. To see
          connection attributes only for sessions open for your own
          account, look in the
          <a class="link" href="performance-schema.html#session-account-connect-attrs-table" title="22.9.8.1 The session_account_connect_attrs Table"><code class="literal">session_account_connect_attrs</code></a>
          table.
        </p><p>
          The <a class="link" href="performance-schema.html#session-connect-attrs-table" title="22.9.8.2 The session_connect_attrs Table"><code class="literal">session_connect_attrs</code></a> table
          contains these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              The connection identifier for the session.
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_NAME</code>
            </p><p>
              The attribute name.
            </p></li><li class="listitem"><p>
              <code class="literal">ATTR_VALUE</code>
            </p><p>
              The attribute value.
            </p></li><li class="listitem"><p>
              <code class="literal">ORDINAL_POSITION</code>
            </p><p>
              The order in which the attribute was added to the set of
              connection attributes.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-summary-tables"></a>22.9.9 Performance Schema Summary Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#wait-summary-tables">22.9.9.1 Event Wait Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#stage-summary-tables">22.9.9.2 Stage Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#statement-summary-tables">22.9.9.3 Statement Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#objects-summary-global-by-type-table">22.9.9.4 Object Wait Summary Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#file-summary-tables">22.9.9.5 File I/O Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#table-waits-summary-tables">22.9.9.6 Table I/O and Lock Wait Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#connection-summary-tables">22.9.9.7 Connection Summary Tables</a></span></dt><dt><span class="section"><a href="performance-schema.html#socket-summary-tables">22.9.9.8 Socket Summary Tables</a></span></dt></dl>
</div>
<p>
        Summary tables provide aggregated information for terminated
        events over time. The tables in this group summarize event data
        in different ways.
      </p><p>
        <span class="bold"><strong>Event Wait Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_global_by_event_name</code></a>:
            Wait events summarized per event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_instance</code></a>:
            Wait events summarized per instance
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_thread_by_event_name</code></a>:
            Wait events summarized per thread and event name
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Stage Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_by_thread_by_event_name</code></a>:
            Stage waits summarized per thread and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_global_by_event_name</code></a>:
            Stage waits summarized per event name
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Statement Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>:
            Statement events summarized per schema and digest value
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_thread_by_event_name</code></a>:
            Statement events summarized per thread and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_global_by_event_name</code></a>:
            Statement events summarized per event name
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Object Wait Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#objects-summary-global-by-type-table" title="22.9.9.4 Object Wait Summary Table"><code class="literal">objects_summary_global_by_type</code></a>:
            Object summaries
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>File I/O Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_event_name</code></a>:
            File events summarized per event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_instance</code></a>: File
            events summarized per file instance
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Table I/O and Lock Wait
        Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>:
            Table I/O waits per index
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>:
            Table I/O waits per table
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>:
            Table lock waits per table
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Connection Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_account_by_event_name</code></a>:
            Wait events summarized per account and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_user_by_event_name</code></a>:
            Wait events summarized per user name and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_host_by_event_name</code></a>:
            Wait events summarized per host name and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_account_by_event_name</code></a>:
            Stage events summarized per account and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_user_by_event_name</code></a>:
            Stage events summarized per user name and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_host_by_event_name</code></a>:
            Stage events summarized per host name and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>:
            Statement events summarized per schema and digest value
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_account_by_event_name</code></a>:
            Statement events summarized per account and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_user_by_event_name</code></a>:
            Statement events summarized per user name and event name
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_host_by_event_name</code></a>:
            Statement events summarized per host name and event name
</p></li></ul>
</div>
<p>
        <span class="bold"><strong>Socket Summaries:</strong></span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a>:
            Socket waits and I/O summarized per instance
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_event_name</code></a>:
            Socket waits and I/O summarized per event name
</p></li></ul>
</div>
<p>
        Each summary table has grouping columns that determine how to
        group the data to be aggregated, and summary columns that
        contain the aggregated values. Tables that summarize events in
        similar ways often have similar sets of summary columns and
        differ only in the grouping columns used to determine how events
        are aggregated.
      </p><p>
        Summary tables can be truncated with
        <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>. Except for
        <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>,
        the effect is to reset the summary columns to 0 or
        <code class="literal">NULL</code>, not to remove rows. This enables you to
        clear collected values and restart aggregation. That might be
        useful, for example, after you have made a runtime configuration
        change.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="wait-summary-tables"></a>22.9.9.1 Event Wait Summary Tables</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737071855168"></a><a class="indexterm" name="idm139737071853696"></a><a class="indexterm" name="idm139737071852192"></a><a class="indexterm" name="idm139737071850672"></a><a class="indexterm" name="idm139737071849152"></a><a class="indexterm" name="idm139737071847632"></a><p>
          The Performance Schema maintains tables for collecting current
          and recent wait events, and aggregates that information in
          summary tables.
          <a class="xref" href="performance-schema.html#performance-schema-wait-tables" title="22.9.4 Performance Schema Wait Event Tables">Section 22.9.4, “Performance Schema Wait Event Tables”</a> describes the
          events on which wait summaries are based. See that discussion
          for information about the content of wait events, the current
          and recent wait event tables, and how to control wait event
          collection.
        </p><p>
          Each event waits summary table has one or more grouping
          columns to indicate how the table aggregates events. Event
          names refer to names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_global_by_event_name</code></a>
              has an <code class="literal">EVENT_NAME</code> column. Each row
              summarizes events for a given event name. An instrument
              might be used to create multiple instances of the
              instrumented object. For example, if there is an
              instrument for a mutex that is created for each
              connection, there are as many instances as there are
              connections. The summary row for the instrument summarizes
              over all these instances.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_instance</code></a>
              has <code class="literal">EVENT_NAME</code> and
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> columns. Each row
              summarizes events for a given event name and object. If an
              instrument is used to create multiple instances, each
              instance has a unique
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> value, so these
              instances are summarized separately in this table.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables"><code class="literal">events_waits_summary_by_thread_by_event_name</code></a>
              has <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_NAME</code> columns. Each row summarizes
              events for a given thread and event name.
</p></li></ul>
</div>
<p>
          All event waits summary tables have these summary columns
          containing aggregated values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>
            </p><p>
              The number of summarized events. This value includes all
              events, whether timed or nontimed.
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_TIMER_WAIT</code>
            </p><p>
              The total wait time of the summarized timed events. This
              value is calculated only for timed events because nontimed
              events have a wait time of <code class="literal">NULL</code>. The
              same is true for the other
              <code class="literal"><em class="replaceable"><code>xxx</code></em>_TIMER_WAIT</code>
              values.
            </p></li><li class="listitem"><p>
              <code class="literal">MIN_TIMER_WAIT</code>
            </p><p>
              The minimum wait time of the summarized timed events.
            </p></li><li class="listitem"><p>
              <code class="literal">AVG_TIMER_WAIT</code>
            </p><p>
              The average wait time of the summarized timed events.
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              The maximum wait time of the summarized timed events.
</p></li></ul>
</div>
<p>
          Example wait event summary information:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_waits_summary_global_by_event_name\G</code></strong>
...
*************************** 6. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/BINARY_LOG::LOCK_index
    COUNT_STAR: 8
SUM_TIMER_WAIT: 2119302
MIN_TIMER_WAIT: 196092
AVG_TIMER_WAIT: 264912
MAX_TIMER_WAIT: 569421
...
*************************** 9. row ***************************
    EVENT_NAME: wait/synch/mutex/sql/hash_filo::lock
    COUNT_STAR: 69
SUM_TIMER_WAIT: 16848828
MIN_TIMER_WAIT: 0
AVG_TIMER_WAIT: 244185
MAX_TIMER_WAIT: 735345
...
</pre><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          wait summary tables. It resets the summary columns to zero
          rather than removing rows.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="stage-summary-tables"></a>22.9.9.2 Stage Summary Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071813344"></a><a class="indexterm" name="idm139737071811824"></a><a class="indexterm" name="idm139737071810304"></a><a class="indexterm" name="idm139737071808784"></a><p>
          As of MySQL 5.6.3, the Performance Schema maintains tables for
          collecting current and recent stage events, and aggregates
          that information in summary tables.
          <a class="xref" href="performance-schema.html#performance-schema-stage-tables" title="22.9.5 Performance Schema Stage Event Tables">Section 22.9.5, “Performance Schema Stage Event Tables”</a> describes
          the events on which stage summaries are based. See that
          discussion for information about the content of stage events,
          the current and recent stage event tables, and how to control
          stage event collection.
        </p><p>
          Each stage summary table has one or more grouping columns to
          indicate how the table aggregates events. Event names refer to
          names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_by_thread_by_event_name</code></a>
              has <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_NAME</code> columns. Each row summarizes
              events for a given thread and event name.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#stage-summary-tables" title="22.9.9.2 Stage Summary Tables"><code class="literal">events_stages_summary_global_by_event_name</code></a>
              has an <code class="literal">EVENT_NAME</code> column. Each row
              summarizes events for a given event name.
</p></li></ul>
</div>
<p>
          All stage summary tables have these summary columns containing
          aggregated values: <code class="literal">COUNT_STAR</code>,
          <code class="literal">SUM_TIMER_WAIT</code>,
          <code class="literal">MIN_TIMER_WAIT</code>,
          <code class="literal">AVG_TIMER_WAIT</code>, and
          <code class="literal">MAX_TIMER_WAIT</code>. These columns are analogous
          to the columns of the same names in the event wait summary
          tables (see <a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables">Section 22.9.9.1, “Event Wait Summary Tables”</a>), except
          that the stage summary tables aggregate waits from
          <a class="link" href="performance-schema.html#events-stages-current-table" title="22.9.5.1 The events_stages_current Table"><code class="literal">events_stages_current</code></a> rather than
          <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>.
        </p><p>
          Example stage event summary information:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_stages_summary_global_by_event_name\G</code></strong>
...
*************************** 5. row ***************************
    EVENT_NAME: stage/sql/checking permissions
    COUNT_STAR: 57
SUM_TIMER_WAIT: 26501888880
MIN_TIMER_WAIT: 7317456
AVG_TIMER_WAIT: 464945295
MAX_TIMER_WAIT: 12858936792
...
*************************** 9. row ***************************
    EVENT_NAME: stage/sql/closing tables
    COUNT_STAR: 37
SUM_TIMER_WAIT: 662606568
MIN_TIMER_WAIT: 1593864
AVG_TIMER_WAIT: 17907891
MAX_TIMER_WAIT: 437977248
...
</pre><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          stage summary tables. It resets the summary columns to zero
          rather than removing rows.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="statement-summary-tables"></a>22.9.9.3 Statement Summary Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071784288"></a><a class="indexterm" name="idm139737071782768"></a><a class="indexterm" name="idm139737071781248"></a><a class="indexterm" name="idm139737071779728"></a><a class="indexterm" name="idm139737071778208"></a><a class="indexterm" name="idm139737071776688"></a><p>
          As of MySQL 5.6.3, the Performance Schema maintains tables for
          collecting current and recent statement events, and aggregates
          that information in summary tables.
          <a class="xref" href="performance-schema.html#performance-schema-statement-tables" title="22.9.6 Performance Schema Statement Event Tables">Section 22.9.6, “Performance Schema Statement Event Tables”</a>
          describes the events on which statement summaries are based.
          See that discussion for information about the content of
          statement events, the current and recent statement event
          tables, and how to control statement event collection.
        </p><p>
          Each statement summary table has one or more grouping columns
          to indicate how the table aggregates events. Event names refer
          to names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
              has <code class="literal">SCHEMA_NAME</code> and
              <code class="literal">DIGEST</code> columns. Each row summarizes
              events for given schema/digest values. (The
              <code class="literal">DIGEST_TEXT</code> column contains the
              corresponding normalized statement digest text, but is
              neither a grouping nor summary column.)
            </p><p>
              This table was added in 5.6.5. Before MySQL 5.6.9, there
              is no <code class="literal">SCHEMA_NAME</code> column and grouping
              is based on <code class="literal">DIGEST</code> values only.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_thread_by_event_name</code></a>
              has <code class="literal">THREAD_ID</code> and
              <code class="literal">EVENT_NAME</code> columns. Each row summarizes
              events for a given thread and event name.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_global_by_event_name</code></a>
              has an <code class="literal">EVENT_NAME</code> column. Each row
              summarizes events for a given event name.
</p></li></ul>
</div>
<p>
          All statement summary tables have these summary columns
          containing aggregated values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>,
              <code class="literal">SUM_TIMER_WAIT</code>,
              <code class="literal">MIN_TIMER_WAIT</code>,
              <code class="literal">AVG_TIMER_WAIT</code>,
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              These columns are analogous to the columns of the same
              names in the event wait summary tables (see
              <a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables">Section 22.9.9.1, “Event Wait Summary Tables”</a>), except that the
              statement summary tables aggregate events from
              <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
              rather than
              <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a>.
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code>
            </p><p>
              The aggregate of the corresponding
              <em class="replaceable"><code>xxx</code></em> column in the
              <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
              table. For example, the <code class="literal">SUM_LOCK_TIME</code>
              and <code class="literal">SUM_ERRORS</code> columns in statement
              summary tables are the aggregates of the
              <code class="literal">LOCK_TIME</code> and <code class="literal">ERRORS</code>
              columns in
              <a class="link" href="performance-schema.html#events-statements-current-table" title="22.9.6.1 The events_statements_current Table"><code class="literal">events_statements_current</code></a>
              table.
</p></li></ul>
</div>
<p>
          The
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
          table has these additional summary columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">FIRST_SEEN_TIMESTAMP</code>,
              <code class="literal">LAST_SEEN_TIMESTAMP</code>
            </p><p>
              The times at which a statement with the given digest value
              were first seen and most recently seen.
</p></li></ul>
</div>
<p>
          Example statement event summary information:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM events_statements_summary_global_by_event_name\G</code></strong>
*************************** 1. row ***************************
                 EVENT_NAME: statement/sql/select
                 COUNT_STAR: 25
             SUM_TIMER_WAIT: 1535983999000
             MIN_TIMER_WAIT: 209823000
             AVG_TIMER_WAIT: 61439359000
             MAX_TIMER_WAIT: 1363397650000
              SUM_LOCK_TIME: 20186000000
                 SUM_ERRORS: 0
               SUM_WARNINGS: 0
          SUM_ROWS_AFFECTED: 0
              SUM_ROWS_SENT: 388
          SUM_ROWS_EXAMINED: 370
SUM_CREATED_TMP_DISK_TABLES: 0
     SUM_CREATED_TMP_TABLES: 0
       SUM_SELECT_FULL_JOIN: 0
 SUM_SELECT_FULL_RANGE_JOIN: 0
           SUM_SELECT_RANGE: 0
     SUM_SELECT_RANGE_CHECK: 0
            SUM_SELECT_SCAN: 6
      SUM_SORT_MERGE_PASSES: 0
             SUM_SORT_RANGE: 0
              SUM_SORT_ROWS: 0
              SUM_SORT_SCAN: 0
          SUM_NO_INDEX_USED: 6
     SUM_NO_GOOD_INDEX_USED: 0
...
</pre><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          statement summary tables. For
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>,
          it empties the table. For the other statement summary tables,
          it resets the summary columns to zero rather than removing
          rows.
</p>
<h5><a name="idm139737071730464"></a>Statement Digest Aggregation Rules</h5>
<p>
          If the <code class="literal">statement_digest</code> consumer is
          enabled, aggregation into
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
          occurs as follows when a statement completes. Aggregation is
          based on the <code class="literal">DIGEST</code> value computed for the
          statement.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              If a
              <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
              row already exists with the digest value for the statement
              that just completed, statistics for the statement are
              aggregated to that row. The <code class="literal">LAST_SEEN</code>
              column is updated to the current time.
            </p></li><li class="listitem"><p>
              If no row has the digest value for the statement that just
              completed, and the table is not full, a new row is created
              for the statement. The <code class="literal">FIRST_SEEN</code> and
              <code class="literal">LAST_SEEN</code> columns are initialized with
              the current time.
            </p></li><li class="listitem"><p>
              If no row has the statement digest value for the statement
              that just completed, and the table is full, the statistics
              for the statement that just completed are added to a
              special <span class="quote">“<span class="quote">catch-all</span>”</span> row with
              <code class="literal">DIGEST</code> = <code class="literal">NULL</code>, which
              is created if necessary. If the row is created, the
              <code class="literal">FIRST_SEEN</code> and
              <code class="literal">LAST_SEEN</code> columns are initialized with
              the current time. Otherwise, the
              <code class="literal">LAST_SEEN</code> column is updated with the
              current time.
</p></li></ul>
</div>
<p>
          The row with <code class="literal">DIGEST</code> =
          <code class="literal">NULL</code> is maintained because Performance
          Schema tables have a maximum size due to memory constraints.
          The <code class="literal">DIGEST</code> = <code class="literal">NULL</code> row
          permits digests that do not match other rows to be counted
          even if the summary table is full, using a common
          <span class="quote">“<span class="quote">other</span>”</span> bucket. This row helps you estimate
          whether the digest summary is representative:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              A <code class="literal">DIGEST</code> = <code class="literal">NULL</code> row
              that has a <code class="literal">COUNT_STAR</code> value that
              represents 5% of all digests shows that the digest summary
              table is very representative; the other rows cover 95% of
              the statements seen.
            </p></li><li class="listitem"><p>
              A <code class="literal">DIGEST</code> = <code class="literal">NULL</code> row
              that has a <code class="literal">COUNT_STAR</code> value that
              represents 50% of all digests shows that the digest
              summary table is not very representative; the other rows
              cover only half the statements seen. Most likely the DBA
              should increase the maximum table size so that more of the
              rows counted in the <code class="literal">DIGEST</code> =
              <code class="literal">NULL</code> row would be counted using more
              specific rows instead. To do this, set the
              <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
              system variable to a larger value at server startup. The
              default size is 200.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="objects-summary-global-by-type-table"></a>22.9.9.4 Object Wait Summary Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071700272"></a><a class="indexterm" name="idm139737071698768"></a><p>
          The
          <a class="link" href="performance-schema.html#objects-summary-global-by-type-table" title="22.9.9.4 Object Wait Summary Table"><code class="literal">objects_summary_global_by_type</code></a>
          table aggregates object wait events. It has these grouping
          columns to indicate how the table aggregates events:
          <code class="literal">OBJECT_TYPE</code>,
          <code class="literal">OBJECT_SCHEMA</code>, and
          <code class="literal">OBJECT_NAME</code>. Each row summarizes events for
          the given object.
        </p><p>
          <a class="link" href="performance-schema.html#objects-summary-global-by-type-table" title="22.9.9.4 Object Wait Summary Table"><code class="literal">objects_summary_global_by_type</code></a>
          has the same summary columns as the
          <code class="literal">events_waits_summary_by_<em class="replaceable"><code>xxx</code></em></code>
          tables. See <a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables">Section 22.9.9.1, “Event Wait Summary Tables”</a>.
        </p><p>
          Example object wait event summary information:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM objects_summary_global_by_type\G</code></strong>
...
*************************** 3. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: test
   OBJECT_NAME: t
    COUNT_STAR: 3
SUM_TIMER_WAIT: 263126976
MIN_TIMER_WAIT: 1522272
AVG_TIMER_WAIT: 87708678
MAX_TIMER_WAIT: 258428280
...
*************************** 10. row ***************************
   OBJECT_TYPE: TABLE
 OBJECT_SCHEMA: mysql
   OBJECT_NAME: user
    COUNT_STAR: 14
SUM_TIMER_WAIT: 365567592
MIN_TIMER_WAIT: 1141704
AVG_TIMER_WAIT: 26111769
MAX_TIMER_WAIT: 334783032
...
</pre><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          the object summary table. It resets the summary columns to
          zero rather than removing rows.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file-summary-tables"></a>22.9.9.5 File I/O Summary Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071684464"></a><a class="indexterm" name="idm139737071682960"></a><a class="indexterm" name="idm139737071681456"></a><a class="indexterm" name="idm139737071679952"></a><p>
          The file I/O summary tables aggregate information about I/O
          operations.
        </p><p>
          Each file I/O summary table has one or more grouping columns
          to indicate how the table aggregates events. Event names refer
          to names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_event_name</code></a>
              has an <code class="literal">EVENT_NAME</code> column. Each row
              summarizes events for a given event name.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#file-summary-tables" title="22.9.9.5 File I/O Summary Tables"><code class="literal">file_summary_by_instance</code></a> has
              <code class="literal">FILE_NAME</code>,
              <code class="literal">EVENT_NAME</code>, and (as of MySQL 5.6.4)
              <code class="literal">OBJECT_INSTANCE_BEGIN</code> columns. Each row
              summarizes events for a given file and event name.
</p></li></ul>
</div>
<p>
          All file I/O summary tables have the following summary columns
          containing aggregated values. (Before MySQL 5.6.4, the tables
          contain only the <code class="literal">COUNT_READ</code>
          <code class="literal">COUNT_WRITE</code>
          <code class="literal">SUM_NUMBER_OF_BYTES_READ</code>, and
          <code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code> aggregation
          columns.) Some columns are more general and have values that
          are the same as the sum of the values of more fine-grained
          columns. In this way, aggregations at higher levels are
          available directly without the need for user-defined views
          that sum lower-level columns.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>,
              <code class="literal">SUM_TIMER_WAIT</code>,
              <code class="literal">MIN_TIMER_WAIT</code>,
              <code class="literal">AVG_TIMER_WAIT</code>,
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              These columns aggregate all I/O operations.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>,
              <code class="literal">SUM_TIMER_READ</code>,
              <code class="literal">MIN_TIMER_READ</code>,
              <code class="literal">AVG_TIMER_READ</code>,
              <code class="literal">MAX_TIMER_READ</code>,
              <code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              These columns aggregate all read operations, including
              <code class="literal">FGETS</code>, <code class="literal">FGETC</code>,
              <code class="literal">FREAD</code>, and <code class="literal">READ</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>,
              <code class="literal">SUM_TIMER_WRITE</code>,
              <code class="literal">MIN_TIMER_WRITE</code>,
              <code class="literal">AVG_TIMER_WRITE</code>,
              <code class="literal">MAX_TIMER_WRITE</code>,
              <code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              These columns aggregate all write operations, including
              <code class="literal">FPUTS</code>, <code class="literal">FPUTC</code>,
              <code class="literal">FPRINTF</code>, <code class="literal">VFPRINTF</code>,
              <code class="literal">FWRITE</code>, and <code class="literal">PWRITE</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>,
              <code class="literal">SUM_TIMER_MISC</code>,
              <code class="literal">MIN_TIMER_MISC</code>,
              <code class="literal">AVG_TIMER_MISC</code>,
              <code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              These columns aggregate all other I/O operations,
              including <code class="literal">CREATE</code>,
              <code class="literal">DELETE</code>, <code class="literal">OPEN</code>,
              <code class="literal">CLOSE</code>, <code class="literal">STREAM_OPEN</code>,
              <code class="literal">STREAM_CLOSE</code>, <code class="literal">SEEK</code>,
              <code class="literal">TELL</code>, <code class="literal">FLUSH</code>,
              <code class="literal">STAT</code>, <code class="literal">FSTAT</code>,
              <code class="literal">CHSIZE</code>, <code class="literal">RENAME</code>, and
              <code class="literal">SYNC</code>. There are no byte counts for
              these operations.
</p></li></ul>
</div>
<p>
          Example file I/O event summary information:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_summary_by_event_name\G</code></strong>
...
*************************** 2. row ***************************
               EVENT_NAME: wait/io/file/sql/binlog
               COUNT_STAR: 31
           SUM_TIMER_WAIT: 8243784888
           MIN_TIMER_WAIT: 0
           AVG_TIMER_WAIT: 265928484
           MAX_TIMER_WAIT: 6490658832
...
mysql&gt; <strong class="userinput"><code>SELECT * FROM file_summary_by_instance\G</code></strong>
...
*************************** 2. row ***************************
                FILE_NAME: /var/mysql/share/english/errmsg.sys
               EVENT_NAME: wait/io/file/sql/ERRMSG
               EVENT_NAME: wait/io/file/sql/ERRMSG
    OBJECT_INSTANCE_BEGIN: 4686193384
               COUNT_STAR: 5
           SUM_TIMER_WAIT: 13990154448
           MIN_TIMER_WAIT: 26349624
           AVG_TIMER_WAIT: 2798030607
           MAX_TIMER_WAIT: 8150662536
...
</pre><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          file I/O summary tables. It resets the summary columns to zero
          rather than removing rows.
        </p><p>
          The MySQL server uses several techniques to avoid I/O
          operations by caching information read from files, so it is
          possible that statements you might expect to result in I/O
          events will not. You may be able to ensure that I/O does occur
          by flushing caches or restarting the server to reset its
          state.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="table-waits-summary-tables"></a>22.9.9.6 Table I/O and Lock Wait Summary Tables</h4>

</div>

</div>

</div>
<p>
          The following sections describe the table I/O and lock wait
          summary tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>:
              Table I/O waits per index
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>:
              Table I/O waits per table
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>:
              Table lock waits per table
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="table-io-waits-summary-by-table-table"></a>22.9.9.6.1 The table_io_waits_summary_by_table Table</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071610816"></a><a class="indexterm" name="idm139737071609360"></a><p>
            The
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>
            table aggregates all table I/O wait events, as generated by
            the <code class="literal">wait/io/table/sql/handler</code> instrument.
            The grouping is by table.
          </p><p>
            The
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>
            table has these grouping columns to indicate how the table
            aggregates events: <code class="literal">OBJECT_TYPE</code>,
            <code class="literal">OBJECT_SCHEMA</code>, and
            <code class="literal">OBJECT_NAME</code>. These columns have the same
            meaning as in the
            <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table.
            They identify the table to which the row applies.
          </p><p>
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>
            has the following summary columns containing aggregated
            values. As indicated in the column descriptions, some
            columns are more general and have values that are the same
            as the sum of the values of more fine-grained columns. For
            example, columns that aggregate all writes hold the sum of
            the corresponding columns that aggregate inserts, updates,
            and deletes. In this way, aggregations at higher levels are
            available directly without the need for user-defined views
            that sum lower-level columns.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>,
                <code class="literal">SUM_TIMER_WAIT</code>,
                <code class="literal">MIN_TIMER_WAIT</code>,
                <code class="literal">AVG_TIMER_WAIT</code>,
                <code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                These columns aggregate all I/O operations. They are the
                same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code>
                and
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>,
                <code class="literal">SUM_TIMER_READ</code>,
                <code class="literal">MIN_TIMER_READ</code>,
                <code class="literal">AVG_TIMER_READ</code>,
                <code class="literal">MAX_TIMER_READ</code>
              </p><p>
                These columns aggregate all read operations. They are
                the same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_FETCH</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>,
                <code class="literal">SUM_TIMER_WRITE</code>,
                <code class="literal">MIN_TIMER_WRITE</code>,
                <code class="literal">AVG_TIMER_WRITE</code>,
                <code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                These columns aggregate all write operations. They are
                the same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_INSERT</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_UPDATE</code>,
                and
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_DELETE</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_FETCH</code>,
                <code class="literal">SUM_TIMER_FETCH</code>,
                <code class="literal">MIN_TIMER_FETCH</code>,
                <code class="literal">AVG_TIMER_FETCH</code>,
                <code class="literal">MAX_TIMER_FETCH</code>
              </p><p>
                These columns aggregate all fetch operations.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_INSERT</code>,
                <code class="literal">SUM_TIMER_INSERT</code>,
                <code class="literal">MIN_TIMER_INSERT</code>,
                <code class="literal">AVG_TIMER_INSERT</code>,
                <code class="literal">MAX_TIMER_INSERT</code>
              </p><p>
                These columns aggregate all insert operations.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_UPDATE</code>,
                <code class="literal">SUM_TIMER_UPDATE</code>,
                <code class="literal">MIN_TIMER_UPDATE</code>,
                <code class="literal">AVG_TIMER_UPDATE</code>,
                <code class="literal">MAX_TIMER_UPDATE</code>
              </p><p>
                These columns aggregate all update operations.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_DELETE</code>,
                <code class="literal">SUM_TIMER_DELETE</code>,
                <code class="literal">MIN_TIMER_DELETE</code>,
                <code class="literal">AVG_TIMER_DELETE</code>,
                <code class="literal">MAX_TIMER_DELETE</code>
              </p><p>
                These columns aggregate all delete operations.
</p></li></ul>
</div>
<p>
            <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted
            for table I/O summary tables. It resets the summary columns
            to zero rather than removing rows. Truncating this table
            also truncates the
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>
            table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="table-io-waits-summary-by-index-usage-table"></a>22.9.9.6.2 The table_io_waits_summary_by_index_usage Table</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071552960"></a><a class="indexterm" name="idm139737071551440"></a><p>
            The
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>
            table aggregates all table index I/O wait events, as
            generated by the
            <code class="literal">wait/io/table/sql/handler</code> instrument. The
            grouping is by table index.
          </p><p>
            The structure of
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-index-usage-table" title="22.9.9.6.2 The table_io_waits_summary_by_index_usage Table"><code class="literal">table_io_waits_summary_by_index_usage</code></a>
            is nearly identical to
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>.
            The only difference is the additional group column,
            <code class="literal">INDEX_NAME</code>, which corresponds to the name
            of the index that was used when the table I/O wait event was
            recorded:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                A value of <code class="literal">PRIMARY</code> indicates that
                table I/O used the primary index.
              </p></li><li class="listitem"><p>
                A value of <code class="literal">NULL</code> means that table I/O
                used no index.
              </p></li><li class="listitem"><p>
                Inserts are counted against <code class="literal">INDEX_NAME =
                NULL</code>.
</p></li></ul>
</div>
<p>
            <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted
            for table I/O summary tables. It resets the summary columns
            to zero rather than removing rows. This table is also
            truncated by truncation of the
            <a class="link" href="performance-schema.html#table-io-waits-summary-by-table-table" title="22.9.9.6.1 The table_io_waits_summary_by_table Table"><code class="literal">table_io_waits_summary_by_table</code></a>
            table. A DDL operation that changes the index structure of a
            table may cause the per-index statistics to be reset.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="table-lock-waits-summary-by-table-table"></a>22.9.9.6.3 The table_lock_waits_summary_by_table Table</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071533616"></a><a class="indexterm" name="idm139737071532160"></a><p>
            The
            <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>
            table aggregates all table lock wait events, as generated by
            the <code class="literal">wait/lock/table/sql/handler</code>
            instrument. The grouping is by table.
          </p><p>
            This table contains information about internal and external
            locks:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                An internal lock corresponds to a lock in the SQL layer.
                This is currently implemented by a call to
                <code class="literal">thr_lock()</code>. In event rows, these
                locks are distinguished by the
                <code class="literal">OPERATION</code> column, which will have one
                of these values:
              </p><pre class="programlisting">
read normal
read with shared locks
read high priority
read no insert
write allow write
write concurrent insert
write delayed
write low priority
write normal
</pre></li><li class="listitem"><p>
                An external lock corresponds to a lock in the storage
                engine layer. This is currently implemented by a call to
                <code class="literal">handler::external_lock()</code>. In event
                rows, these locks are distinguished by the
                <code class="literal">OPERATION</code> column, which will have one
                of these values:
              </p><pre class="programlisting">
read external
write external
</pre></li></ul>
</div>
<p>
            The
            <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>
            table has these grouping columns to indicate how the table
            aggregates events: <code class="literal">OBJECT_TYPE</code>,
            <code class="literal">OBJECT_SCHEMA</code>, and
            <code class="literal">OBJECT_NAME</code>. These columns have the same
            meaning as in the
            <a class="link" href="performance-schema.html#events-waits-current-table" title="22.9.4.1 The events_waits_current Table"><code class="literal">events_waits_current</code></a> table.
            They identify the table to which the row applies.
          </p><p>
            <a class="link" href="performance-schema.html#table-lock-waits-summary-by-table-table" title="22.9.9.6.3 The table_lock_waits_summary_by_table Table"><code class="literal">table_lock_waits_summary_by_table</code></a>
            has the following summary columns containing aggregated
            values. As indicated in the column descriptions, some
            columns are more general and have values that are the same
            as the sum of the values of more fine-grained columns. For
            example, columns that aggregate all locks hold the sum of
            the corresponding columns that aggregate read and write
            locks. In this way, aggregations at higher levels are
            available directly without the need for user-defined views
            that sum lower-level columns.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <code class="literal">COUNT_STAR</code>,
                <code class="literal">SUM_TIMER_WAIT</code>,
                <code class="literal">MIN_TIMER_WAIT</code>,
                <code class="literal">AVG_TIMER_WAIT</code>,
                <code class="literal">MAX_TIMER_WAIT</code>
              </p><p>
                These columns aggregate all lock operations. They are
                the same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ</code>
                and
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ</code>,
                <code class="literal">SUM_TIMER_READ</code>,
                <code class="literal">MIN_TIMER_READ</code>,
                <code class="literal">AVG_TIMER_READ</code>,
                <code class="literal">MAX_TIMER_READ</code>
              </p><p>
                These columns aggregate all read-lock operations. They
                are the same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NORMAL</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_WITH_SHARED_LOCKS</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_HIGH_PRIORITY</code>,
                and
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_READ_NO_INSERT</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE</code>,
                <code class="literal">SUM_TIMER_WRITE</code>,
                <code class="literal">MIN_TIMER_WRITE</code>,
                <code class="literal">AVG_TIMER_WRITE</code>,
                <code class="literal">MAX_TIMER_WRITE</code>
              </p><p>
                These columns aggregate all write-lock operations. They
                are the same as the sum of the corresponding
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_ALLOW_WRITE</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_CONCURRENT_INSERT</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_DELAYED</code>,
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_LOW_PRIORITY</code>,
                and
                <code class="literal"><em class="replaceable"><code>xxx</code></em>_WRITE_NORMAL</code>
                columns.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NORMAL</code>,
                <code class="literal">SUM_TIMER_READ_NORMAL</code>,
                <code class="literal">MIN_TIMER_READ_NORMAL</code>,
                <code class="literal">AVG_TIMER_READ_NORMAL</code>,
                <code class="literal">MAX_TIMER_READ_NORMAL</code>
              </p><p>
                These columns aggregate internal read locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_WITH_SHARED_LOCKS</code>,
                <code class="literal">SUM_TIMER_READ_WITH_SHARED_LOCKS</code>,
                <code class="literal">MIN_TIMER_READ_WITH_SHARED_LOCKS</code>,
                <code class="literal">AVG_TIMER_READ_WITH_SHARED_LOCKS</code>,
                <code class="literal">MAX_TIMER_READ_WITH_SHARED_LOCKS</code>
              </p><p>
                These columns aggregate internal read locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_HIGH_PRIORITY</code>,
                <code class="literal">SUM_TIMER_READ_HIGH_PRIORITY</code>,
                <code class="literal">MIN_TIMER_READ_HIGH_PRIORITY</code>,
                <code class="literal">AVG_TIMER_READ_HIGH_PRIORITY</code>,
                <code class="literal">MAX_TIMER_READ_HIGH_PRIORITY</code>
              </p><p>
                These columns aggregate internal read locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_NO_INSERT</code>,
                <code class="literal">SUM_TIMER_READ_NO_INSERT</code>,
                <code class="literal">MIN_TIMER_READ_NO_INSERT</code>,
                <code class="literal">AVG_TIMER_READ_NO_INSERT</code>,
                <code class="literal">MAX_TIMER_READ_NO_INSERT</code>
              </p><p>
                These columns aggregate internal read locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_READ_EXTERNAL</code>,
                <code class="literal">SUM_TIMER_READ_EXTERNAL</code>,
                <code class="literal">MIN_TIMER_READ_EXTERNAL</code>,
                <code class="literal">AVG_TIMER_READ_EXTERNAL</code>,
                <code class="literal">MAX_TIMER_READ_EXTERNAL</code>
              </p><p>
                These columns aggregate external read locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_ALLOW_WRITE</code>,
                <code class="literal">SUM_TIMER_WRITE_ALLOW_WRITE</code>,
                <code class="literal">MIN_TIMER_WRITE_ALLOW_WRITE</code>,
                <code class="literal">AVG_TIMER_WRITE_ALLOW_WRITE</code>,
                <code class="literal">MAX_TIMER_WRITE_ALLOW_WRITE</code>
              </p><p>
                These columns aggregate internal write locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_CONCURRENT_INSERT</code>,
                <code class="literal">SUM_TIMER_WRITE_CONCURRENT_INSERT</code>,
                <code class="literal">MIN_TIMER_WRITE_CONCURRENT_INSERT</code>,
                <code class="literal">AVG_TIMER_WRITE_CONCURRENT_INSERT</code>,
                <code class="literal">MAX_TIMER_WRITE_CONCURRENT_INSERT</code>
              </p><p>
                These columns aggregate internal write locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_DELAYED</code>,
                <code class="literal">SUM_TIMER_WRITE_DELAYED</code>,
                <code class="literal">MIN_TIMER_WRITE_DELAYED</code>,
                <code class="literal">AVG_TIMER_WRITE_DELAYED</code>,
                <code class="literal">MAX_TIMER_WRITE_DELAYED</code>
              </p><p>
                These columns aggregate internal write locks.
              </p><p>
                As of MySQL 5.6.6, <code class="literal">DELAYED</code> inserts
                are deprecated, so these columns will be removed in a
                future release.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_LOW_PRIORITY</code>,
                <code class="literal">SUM_TIMER_WRITE_LOW_PRIORITY</code>,
                <code class="literal">MIN_TIMER_WRITE_LOW_PRIORITY</code>,
                <code class="literal">AVG_TIMER_WRITE_LOW_PRIORITY</code>,
                <code class="literal">MAX_TIMER_WRITE_LOW_PRIORITY</code>
              </p><p>
                These columns aggregate internal write locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_NORMAL</code>,
                <code class="literal">SUM_TIMER_WRITE_NORMAL</code>,
                <code class="literal">MIN_TIMER_WRITE_NORMAL</code>,
                <code class="literal">AVG_TIMER_WRITE_NORMAL</code>,
                <code class="literal">MAX_TIMER_WRITE_NORMAL</code>
              </p><p>
                These columns aggregate internal write locks.
              </p></li><li class="listitem"><p>
                <code class="literal">COUNT_WRITE_EXTERNAL</code>,
                <code class="literal">SUM_TIMER_WRITE_EXTERNAL</code>,
                <code class="literal">MIN_TIMER_WRITE_EXTERNAL</code>,
                <code class="literal">AVG_TIMER_WRITE_EXTERNAL</code>,
                <code class="literal">MAX_TIMER_WRITE_EXTERNAL</code>
              </p><p>
                These columns aggregate external write locks.
</p></li></ul>
</div>
<p>
            <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted
            for table lock summary tables. It resets the summary columns
            to zero rather than removing rows.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="connection-summary-tables"></a>22.9.9.7 Connection Summary Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071429216"></a><a class="indexterm" name="idm139737071427696"></a><a class="indexterm" name="idm139737071426176"></a><a class="indexterm" name="idm139737071424656"></a><a class="indexterm" name="idm139737071423136"></a><a class="indexterm" name="idm139737071421616"></a><a class="indexterm" name="idm139737071420096"></a><a class="indexterm" name="idm139737071418576"></a><a class="indexterm" name="idm139737071417056"></a><a class="indexterm" name="idm139737071415536"></a><a class="indexterm" name="idm139737071414016"></a><a class="indexterm" name="idm139737071412496"></a><a class="indexterm" name="idm139737071410976"></a><a class="indexterm" name="idm139737071409440"></a><a class="indexterm" name="idm139737071407904"></a><a class="indexterm" name="idm139737071406384"></a><a class="indexterm" name="idm139737071404864"></a><a class="indexterm" name="idm139737071403344"></a><p>
          The connection summary tables are similar to the corresponding
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_by_thread_by_event_name</code>
          tables, except that aggregation occurs per account, user, or
          host, rather than by thread.
        </p><p>
          The Performance Schema maintains summary tables that aggregate
          connection statistics by event name and account, user, or
          host. Separate groups of tables are available that aggregate
          wait, stage, and statement events, which results in this set
          of connection summary tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_account_by_event_name</code></a>:
              Wait events summarized per account and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_user_by_event_name</code></a>:
              Wait events summarized per user name and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_waits_summary_by_host_by_event_name</code></a>:
              Wait events summarized per host name and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_account_by_event_name</code></a>:
              Stage events summarized per account and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_user_by_event_name</code></a>:
              Stage events summarized per user name and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_stages_summary_by_host_by_event_name</code></a>:
              Stage events summarized per host name and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_account_by_event_name</code></a>:
              Statement events summarized per account and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_user_by_event_name</code></a>:
              Statement events summarized per user name and event name
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#connection-summary-tables" title="22.9.9.7 Connection Summary Tables"><code class="literal">events_statements_summary_by_host_by_event_name</code></a>:
              Statement events summarized per host name and event name
</p></li></ul>
</div>
<p>
          In other words, the connection summary tables have names of
          the form
          <code class="literal">events_<em class="replaceable"><code>xxx</code></em>_summary_<em class="replaceable"><code>yyy</code></em>_by_event_name</code>,
          where <em class="replaceable"><code>xxx</code></em> is
          <code class="literal">waits</code>, <code class="literal">stages</code>, or
          <code class="literal">statements</code>, and
          <em class="replaceable"><code>yyy</code></em> is <code class="literal">account</code>,
          <code class="literal">user</code>, or <code class="literal">host</code>.
        </p><p>
          The connection summary tables provide an intermediate
          aggregation level:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>xxx</code></em>_summary_by_thread_by_event_name</code>
              tables are more detailed than connection summary tables
            </p></li><li class="listitem"><p>
              <code class="literal"><em class="replaceable"><code>xxx</code></em>_summary_global_by_event_name</code>
              tables are less detailed than connection summary tables
</p></li></ul>
</div>
<p>
          Each connection summary table has one or more grouping columns
          to indicate how the table aggregates events. Event names refer
          to names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              For tables with <code class="literal">_by_account</code> in the
              name, the <code class="literal">USER</code>,
              <code class="literal">HOST</code>, and <code class="literal">EVENT_NAME</code>
              columns group events per account and event name.
            </p></li><li class="listitem"><p>
              For tables with <code class="literal">_by_host</code> in the name,
              the <code class="literal">HOST</code> and
              <code class="literal">EVENT_NAME</code> columns group events per
              host name and event name.
            </p></li><li class="listitem"><p>
              For tables with <code class="literal">_by_user</code> in the name,
              the <code class="literal">USER</code> and
              <code class="literal">EVENT_NAME</code> columns group events per
              user name and event name.
</p></li></ul>
</div>
<p>
          All connection summary tables have these summary columns
          containing aggregated values: <code class="literal">COUNT_STAR</code>,
          <code class="literal">SUM_TIMER_WAIT</code>,
          <code class="literal">MIN_TIMER_WAIT</code>,
          <code class="literal">AVG_TIMER_WAIT</code>, and
          <code class="literal">MAX_TIMER_WAIT</code>. These are similar to the
          columns of the same names in the
          <code class="literal">events_waits_summary_by_instance</code> table.
          Connection summary tables for statements have additional
          <code class="literal">SUM_<em class="replaceable"><code>xxx</code></em></code> columns
          that aggregate statement types.
        </p><p>
          The connection summary tables were added in MySQL 5.6.3.
        </p><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          connection summary tables. It resets the summary columns to
          zero rather than removing rows. In addition, connection
          summary tables are implicitly truncated if a connection table
          on which they depend is truncated.
          <a class="xref" href="performance-schema.html#connection-table-implicit-truncation" title="Table 22.2 Effect of Implicit Table Truncation">Table 22.2, “Effect of Implicit Table Truncation”</a>,
          describes the relationship between connection table truncation
          and implicitly truncated tables.
</p>
<div class="table">
<a name="connection-table-implicit-truncation"></a><p class="title"><b>Table 22.2 Effect of Implicit Table Truncation</b></p>
<div class="table-contents">
<table summary="Effect of Implicit Table Truncation" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Truncated Table</th><th scope="col">Implicitly Truncated Summary Tables</th></tr></thead><tbody><tr><td scope="row"><code class="literal">accounts</code></td><td>Tables with names matching <code class="literal">%_by_account%</code>,
                  <code class="literal">%_by_thread%</code></td></tr><tr><td scope="row"><code class="literal">hosts</code></td><td>Tables with names matching <code class="literal">%_by_account%</code>,
                  <code class="literal">%_by_host%</code>,
                  <code class="literal">%_by_thread%</code></td></tr><tr><td scope="row"><code class="literal">users</code></td><td>Tables with names matching <code class="literal">%_by_account%</code>,
                  <code class="literal">%_by_user%</code>,
<code class="literal">%_by_thread%</code></td></tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="socket-summary-tables"></a>22.9.9.8 Socket Summary Tables</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071330416"></a><a class="indexterm" name="idm139737071328912"></a><a class="indexterm" name="idm139737071327408"></a><a class="indexterm" name="idm139737071325904"></a><p>
          These socket summary tables aggregate timer and byte count
          information for socket operations:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a>:
              Aggregate timer and byte count statistics generated by the
              <code class="literal">wait/io/socket/*</code> instruments for all
              socket I/O operations, per socket instance. When a
              connection terminates, the row in
              <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a>
              corresponding to it is deleted.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_event_name</code></a>:
              Aggregate timer and byte count statistics generated by the
              <code class="literal">wait/io/socket/*</code> instruments for all
              socket I/O operations, per socket instrument.
</p></li></ul>
</div>
<p>
          The socket summary tables do not aggregate waits generated by
          <code class="literal">idle</code> events while sockets are waiting for
          the next request from the client. For <code class="literal">idle</code>
          event aggregations, use the wait-event summary tables; see
          <a class="xref" href="performance-schema.html#wait-summary-tables" title="22.9.9.1 Event Wait Summary Tables">Section 22.9.9.1, “Event Wait Summary Tables”</a>.
        </p><p>
          Each socket summary table has one or more grouping columns to
          indicate how the table aggregates events. Event names refer to
          names of event instruments in the
          <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a>
              has an <code class="literal">OBJECT_INSTANCE_BEGIN</code> column.
              Each row summarizes events for a given object.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_event_name</code></a>
              has an <code class="literal">EVENT_NAME</code> column. Each row
              summarizes events for a given event name.
</p></li></ul>
</div>
<p>
          All socket summary tables have these summary columns
          containing aggregated values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">COUNT_STAR</code>,
              <code class="literal">SUM_TIMER_WAIT</code>,
              <code class="literal">MIN_TIMER_WAIT</code>,
              <code class="literal">AVG_TIMER_WAIT</code>,
              <code class="literal">MAX_TIMER_WAIT</code>
            </p><p>
              These columns aggregate all operations.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_READ</code>,
              <code class="literal">SUM_TIMER_READ</code>,
              <code class="literal">MIN_TIMER_READ</code>,
              <code class="literal">AVG_TIMER_READ</code>,
              <code class="literal">MAX_TIMER_READ</code>,
              <code class="literal">SUM_NUMBER_OF_BYTES_READ</code>
            </p><p>
              These columns aggregate all receive operations
              (<code class="literal">RECV</code>, <code class="literal">RECVFROM</code>, and
              <code class="literal">RECVMSG</code>).
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_WRITE</code>,
              <code class="literal">SUM_TIMER_WRITE</code>,
              <code class="literal">MIN_TIMER_WRITE</code>,
              <code class="literal">AVG_TIMER_WRITE</code>,
              <code class="literal">MAX_TIMER_WRITE</code>,
              <code class="literal">SUM_NUMBER_OF_BYTES_WRITE</code>
            </p><p>
              These columns aggregate all send operations
              (<code class="literal">SEND</code>, <code class="literal">SENDTO</code>, and
              <code class="literal">SENDMSG</code>).
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MISC</code>,
              <code class="literal">SUM_TIMER_MISC</code>,
              <code class="literal">MIN_TIMER_MISC</code>,
              <code class="literal">AVG_TIMER_MISC</code>,
              <code class="literal">MAX_TIMER_MISC</code>
            </p><p>
              These columns aggregate all other socket operations, such
              as <code class="literal">CONNECT</code>, <code class="literal">LISTEN</code>,
              <code class="literal">ACCEPT</code>, <code class="literal">CLOSE</code>, and
              <code class="literal">SHUTDOWN</code>. There are no byte counts for
              these operations.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#socket-summary-tables" title="22.9.9.8 Socket Summary Tables"><code class="literal">socket_summary_by_instance</code></a>
          table also has an <code class="literal">EVENT_NAME</code> column that
          indicates the class of the socket:
          <code class="literal">client_connection</code>,
          <code class="literal">server_tcpip_socket</code>,
          <code class="literal">server_unix_socket</code>. This column can be
          grouped on to isolate, for example, client activity from that
          of the server listening sockets.
        </p><p>
          These tables were added in MySQL 5.6.3.
        </p><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is permitted for
          socket summary tables. Except for
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>,
          tt resets the summary columns to zero rather than removing
          rows.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-miscellaneous-tables"></a>22.9.10 Performance Schema Miscellaneous Tables</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#host-cache-table">22.9.10.1 The host_cache Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#performance-timers-table">22.9.10.2 The performance_timers Table</a></span></dt><dt><span class="section"><a href="performance-schema.html#threads-table">22.9.10.3 The threads Table</a></span></dt></dl>
</div>
<p>
        The following sections describe tables that do not fall into the
        table categories discussed in the preceding sections:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a>: Information from
            the internal host cache
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a>: Which event
            timers are available
          </p></li><li class="listitem"><p>
            <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a>: Information about
            server threads
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="host-cache-table"></a>22.9.10.1 The host_cache Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071258464"></a><a class="indexterm" name="idm139737071256976"></a><p>
          The <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table provides
          access to the contents of the host cache, which contains
          client host name and IP address information and is used to
          avoid DNS lookups. (See <a class="xref" href="optimization.html#host-cache" title="8.12.6.2 DNS Lookup Optimization and the Host Cache">Section 8.12.6.2, “DNS Lookup Optimization and the Host Cache”</a>.) The
          <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table exposes the
          contents of the host cache so that it can be examined using
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements. The
          Performance Schema must be enabled or this table is empty.
        </p><p>
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH HOSTS</code></a>
          and <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE
          TABLE host_cache</code></a> have the same effect: They clear
          the host cache. This also empties the
          <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table (because it is
          the visible representation of the cache) and unblocks any
          blocked hosts (see <a class="xref" href="error-handling.html#blocked-host" title="B.5.2.6 Host 'host_name' is blocked">Section B.5.2.6, “Host 'host_name' is blocked”</a>.)
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH HOSTS</code></a>
          requires the <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege.
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> requires the
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege for the
          <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table.
        </p><p>
          The <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table has these
          columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">IP</code>
            </p><p>
              The IP address of the client that connected to the server,
              expressed as a string.
            </p></li><li class="listitem"><p>
              <code class="literal">HOST</code>
            </p><p>
              The resolved DNS host name for that client IP, or
              <code class="literal">NULL</code> if the name is unknown.
            </p></li><li class="listitem"><p>
              <code class="literal">HOST_VALIDATED</code>
            </p><p>
              Whether the IP-to-host name-to-IP DNS resolution was
              performed successfully for the client IP. If
              <code class="literal">HOST_VALIDATED</code> is
              <code class="literal">YES</code>, the <code class="literal">HOST</code> column
              is used as the host name corresponding to the IP so that
              calls to DNS can be avoided. While
              <code class="literal">HOST_VALIDATED</code> is
              <code class="literal">NO</code>, DNS resolution is attempted again
              for each connect, until it eventually completes with
              either a valid result or a permanent error. This
              information enables the server to avoid caching bad or
              missing host names during temporary DNS failures, which
              would affect clients forever.
            </p></li><li class="listitem"><p>
              <code class="literal">SUM_CONNECT_ERRORS</code>
            </p><p>
              The number of connection errors that are deemed
              <span class="quote">“<span class="quote">blocking</span>”</span> (assessed against the
              <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> system
              variable). Currently, only protocol handshake errors are
              counted, and only for hosts that passed validation
              (<code class="literal">HOST_VALIDATED = YES</code>).
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_BLOCKED_ERRORS</code>
            </p><p>
              The number of connections that were blocked because
              <code class="literal">SUM_CONNECT_ERRORS</code> exceeded the value
              of the <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a>
              system variable.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_TRANSIENT_ERRORS</code>
            </p><p>
              The number of transient errors during IP-to-host name DNS
              resolution.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NAMEINFO_PERMANENT_ERRORS</code>
            </p><p>
              The number of permanent errors during IP-to-host name DNS
              resolution.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FORMAT_ERRORS</code>
            </p><p>
              The number of host name format errors. MySQL does not
              perform matching of <code class="literal">Host</code> column values
              in the <code class="literal">mysql.user</code> table against host
              names for which one or more of the initial components of
              the name are entirely numeric, such as
              <code class="literal">1.2.example.com</code>. The client IP address
              is used instead. For the rationale why this type of
              matching does not occur, see
              <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_TRANSIENT_ERRORS</code>
            </p><p>
              The number of transient errors during host name-to-IP
              reverse DNS resolution.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_ADDRINFO_PERMANENT_ERRORS</code>
            </p><p>
              The number of permanent errors during host name-to-IP
              reverse DNS resolution.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_FCRDNS_ERRORS</code>
            </p><p>
              The number of forward-confirmed reverse DNS errors. These
              errors occur when IP-to-host name-to-IP DNS resolution
              produces an IP address that does not match the client
              originating IP address.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HOST_ACL_ERRORS</code>
            </p><p>
              The number of errors that occur because no user from the
              client host can possibly log in. In such cases, the server
              returns
              <a class="link" href="error-handling.html#error_er_host_not_privileged"><code class="literal">ER_HOST_NOT_PRIVILEGED</code></a> and
              does not even ask for a user name or password.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_NO_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              The number of errors due to requests for an unavailable
              authentication plugin. A plugin can be unavailable if, for
              example, it was never loaded or a load attempt failed.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>
            </p><p>
              The number of errors reported by authentication plugins.
            </p><p>
              An authentication plugin can report different error codes
              to indicate the root cause of a failure. Depending on the
              type of error, one of these columns is incremented:
              <code class="literal">COUNT_AUTHENTICATION_ERRORS</code>,
              <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code>,
              <code class="literal">COUNT_HANDSHAKE_ERRORS</code>. New return
              codes are an optional extension to the existing plugin
              API. Unknown or unexpected plugin errors are counted in
              the <code class="literal">COUNT_AUTH_PLUGIN_ERRORS</code> column.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_HANDSHAKE_ERRORS</code>
            </p><p>
              The number of errors detected at the wire protocol level.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ERRORS</code>
            </p><p>
              The number of errors detected when a proxy user A is
              proxied to another user B who does not exist.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_PROXY_USER_ACL_ERRORS</code>
            </p><p>
              The number of errors detected when a proxy user A is
              proxied to another user B who does exist but for whom A
              does not have the <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a>
              privilege.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_AUTHENTICATION_ERRORS</code>
            </p><p>
              The number of errors caused by failed authentication.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_SSL_ERRORS</code>
            </p><p>
              The number of errors due to SSL problems.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_ERRORS</code>
            </p><p>
              The number of errors caused by exceeding per-user
              connection quotas. See <a class="xref" href="security.html#user-resources" title="6.3.4 Setting Account Resource Limits">Section 6.3.4, “Setting Account Resource Limits”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_MAX_USER_CONNECTIONS_PER_HOUR_ERRORS</code>
            </p><p>
              The number of errors caused by exceeding per-user
              connections-per-hour quotas. See
              <a class="xref" href="security.html#user-resources" title="6.3.4 Setting Account Resource Limits">Section 6.3.4, “Setting Account Resource Limits”</a>.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_DEFAULT_DATABASE_ERRORS</code>
            </p><p>
              The number of errors related to the default database. For
              example, the database did not exist or the user had no
              privileges for accessing it.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_INIT_CONNECT_ERRORS</code>
            </p><p>
              The number of errors caused by execution failures of
              statements in the
              <a class="link" href="server-administration.html#sysvar_init_connect"><code class="literal">init_connect</code></a> system
              variable value.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_LOCAL_ERRORS</code>
            </p><p>
              The number of errors local to the server implementation
              and not related to the network, authentication, or
              authorization. For example, out-of-memory conditions fall
              into this category.
            </p></li><li class="listitem"><p>
              <code class="literal">COUNT_UNKNOWN_ERRORS</code>
            </p><p>
              The number of other, unknown errors not accounted for by
              other columns in this table. This column is reserved for
              future use, in case new error conditions must be reported,
              and if preserving the backward compatibility and table
              structure of the <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a>
              table is required.
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_SEEN</code>
            </p><p>
              The timestamp of the first connection attempt seen from
              the client in the <code class="literal">IP</code> column.
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_SEEN</code>
            </p><p>
              The timestamp of the last connection attempt seen from the
              client in the <code class="literal">IP</code> column.
            </p></li><li class="listitem"><p>
              <code class="literal">FIRST_ERROR_SEEN</code>
            </p><p>
              The timestamp of the first error seen from the client in
              the <code class="literal">IP</code> column.
            </p></li><li class="listitem"><p>
              <code class="literal">LAST_ERROR_SEEN</code>
            </p><p>
              The timestamp of the last error seen from the client in
              the <code class="literal">IP</code> column.
</p></li></ul>
</div>
<p>
          The <a class="link" href="performance-schema.html#host-cache-table" title="22.9.10.1 The host_cache Table"><code class="literal">host_cache</code></a> table was added in
          MySQL 5.6.5.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="performance-timers-table"></a>22.9.10.2 The performance_timers Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071150816"></a><a class="indexterm" name="idm139737071149312"></a><p>
          The <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a> table
          shows which event timers are available:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM performance_timers;</code></strong>
+-------------+-----------------+------------------+----------------+
| TIMER_NAME  | TIMER_FREQUENCY | TIMER_RESOLUTION | TIMER_OVERHEAD |
+-------------+-----------------+------------------+----------------+
| CYCLE       |      2389029850 |                1 |             72 |
| NANOSECOND  |      1000000000 |                1 |            112 |
| MICROSECOND |         1000000 |                1 |            136 |
| MILLISECOND |            1036 |                1 |            168 |
| TICK        |             105 |                1 |           2416 |
+-------------+-----------------+------------------+----------------+
</pre><p>
          The timers in <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> that
          you can use are those that do not have <code class="literal">NULL</code>
          in the other columns. If the values associated with a given
          timer name are <code class="literal">NULL</code>, that timer is not
          supported on your platform.
        </p><p>
          The <a class="link" href="performance-schema.html#performance-timers-table" title="22.9.10.2 The performance_timers Table"><code class="literal">performance_timers</code></a> table has
          these columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">TIMER_NAME</code>
            </p><p>
              The name by which to refer to the timer when configuring
              the <a class="link" href="performance-schema.html#setup-timers-table" title="22.9.2.5 The setup_timers Table"><code class="literal">setup_timers</code></a> table.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_FREQUENCY</code>
            </p><p>
              The number of timer units per second. For a cycle timer,
              the frequency is generally related to the CPU speed. For
              example, on a system with a 2.4GHz processor, the
              <code class="literal">CYCLE</code> may be close to 2400000000.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_RESOLUTION</code>
            </p><p>
              Indicates the number of timer units by which timer values
              increase. If a timer has a resolution of 10, its value
              increases by 10 each time.
            </p></li><li class="listitem"><p>
              <code class="literal">TIMER_OVERHEAD</code>
            </p><p>
              The minimal number of cycles of overhead to obtain one
              timing with the given timer. The Performance Schema
              determines this value by invoking the timer 20 times
              during initialization and picking the smallest value. The
              total overhead really is twice this amount because the
              instrumentation invokes the timer at the start and end of
              each event. The timer code is called only for timed
              events, so this overhead does not apply for nontimed
              events.
            </p><p>
              The maximum number of rows in the table is autosized at
              server startup. To set this maximum explicitly, set the
              <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
              system variable at server startup.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="threads-table"></a>22.9.10.3 The threads Table</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737071125072"></a><a class="indexterm" name="idm139737071123584"></a><a class="indexterm" name="idm139737071122096"></a><p>
          The <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table contains a row
          for each server thread. Each row contains information about a
          thread and indicates whether monitoring is enabled for it:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM threads\G</code></strong>
*************************** 1. row ***************************
          THREAD_ID: 1
               NAME: thread/sql/main
               TYPE: BACKGROUND
     PROCESSLIST_ID: NULL
   PROCESSLIST_USER: NULL
   PROCESSLIST_HOST: NULL
     PROCESSLIST_DB: NULL
PROCESSLIST_COMMAND: NULL
   PROCESSLIST_TIME: 80284
  PROCESSLIST_STATE: NULL
   PROCESSLIST_INFO: NULL
   PARENT_THREAD_ID: NULL
               ROLE: NULL
       INSTRUMENTED: YES
...
*************************** 4. row ***************************
          THREAD_ID: 51
               NAME: thread/sql/one_connection
               TYPE: FOREGROUND
     PROCESSLIST_ID: 34
   PROCESSLIST_USER: isabella
   PROCESSLIST_HOST: localhost
     PROCESSLIST_DB: performance_schema
PROCESSLIST_COMMAND: Query
   PROCESSLIST_TIME: 0
  PROCESSLIST_STATE: Sending data
   PROCESSLIST_INFO: SELECT * FROM threads
   PARENT_THREAD_ID: 1
               ROLE: NULL
       INSTRUMENTED: YES
...
</pre><p>
          When the Performance Schema initializes, it populates the
          <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table based on the
          threads in existence then. Thereafter, a new row is added each
          time the server creates a thread.
        </p><p>
          The <code class="literal">INSTRUMENTED</code> column value for new
          threads is determined by the contents of the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table. For
          information about how to use the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table to control
          this column, see
          <a class="xref" href="performance-schema.html#performance-schema-thread-filtering" title="22.2.3.3.3 Pre-Filtering by Thread">Section 22.2.3.3.3, “Pre-Filtering by Thread”</a>.
        </p><a class="indexterm" name="idm139737071110128"></a><p>
          Removal of rows from the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a>
          table occurs when threads end. For a thread associated with a
          client session, removal occurs when the session ends. If a
          client has auto-reconnect enabled and the session reconnects
          after a disconnect, the session becomes associated with a new
          row in the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table that has
          a different <code class="literal">PROCESSLIST_ID</code> value. The
          initial <code class="literal">INSTRUMENTED</code> value for the new
          thread may be different from that of the original thread: The
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table may have
          changed in the meantime, and if the
          <code class="literal">INSTRUMENTED</code> value for the original thread
          was changed after it was initialized, that change does not
          carry over to the new thread.
        </p><p>
          The <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table columns with
          names having a prefix of <code class="literal">PROCESSLIST_</code>
          provide information similar to that available from the
          <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
          table or the <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>
          statement. Thus, all three sources provide thread-monitoring
          information. Use of <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a>
          differs from use of the other two sources in these ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Access to <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> does not
              require a mutex and has minimal impact on server
              performance.
              <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
              and <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> have
              negative performance consequences because they require a
              mutex.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> provides additional
              information for each thread, such as whether it is a
              foreground or background thread, and the location within
              the server associated with the thread.
            </p></li><li class="listitem"><p>
              <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> provides information
              about background threads, so it can be used to monitor
              activity the other thread information sources cannot.
            </p></li><li class="listitem"><p>
              You can enable or disable thread monitoring (that is,
              whether events executed by the thread are instrumented).
              To control the initial <code class="literal">INSTRUMENTED</code>
              value for new foreground threads, use the
              <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table. To
              control monitoring of existing threads, set the
              <code class="literal">INSTRUMENTED</code> column of
              <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table rows. (For more
              information about the conditions under which thread
              monitoring occurs, see the description of the
              <code class="literal">INSTRUMENTED</code> column.)
</p></li></ul>
</div>
<p>
          For these reasons, DBAs who perform server monitoring using
          <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a> or
          <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> may wish to
          monitor using the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table
          instead.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For
            <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
            and <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>,
            information about threads for other users is shown only if
            the current user has the
            <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege. That is
            not true of the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table;
            all rows are shown to any user who has the
            <code class="literal">SELECT</code> privilege for the table. Users who
            should not be able to see threads for other users should not
            be given that privilege.
</p>
</div>
<p>
          The <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table has these
          columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">THREAD_ID</code>
            </p><p>
              A unique thread identifier.
            </p></li><li class="listitem"><p>
              <code class="literal">NAME</code>
            </p><p>
              The name associated with the thread instrumentation code
              in the server. For example,
              <code class="literal">thread/sql/one_connection</code> corresponds
              to the thread function in the code responsible for
              handling a user connection, and
              <code class="literal">thread/sql/main</code> stands for the
              <code class="literal">main()</code> function of the server.
            </p></li><li class="listitem"><p>
              <code class="literal">TYPE</code>
            </p><p>
              The thread type, either <code class="literal">FOREGROUND</code> or
              <code class="literal">BACKGROUND</code>. User connection threads are
              foreground threads. Threads associated with internal
              server activity are background threads. Examples are
              internal <code class="literal">InnoDB</code> threads, <span class="quote">“<span class="quote">binlog
              dump</span>”</span> threads sending information to slaves, and
              slave I/O and SQL threads.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_ID</code>
            </p><p>
              For threads that are displayed in the
              <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
              table, this is the same value displayed in the
              <code class="literal">ID</code> column of that table. It is also the
              value displayed in the <code class="literal">Id</code> column of
              <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> output,
              and the value that
              <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> would
              return within that thread.
            </p><p>
              For background threads (threads not associated with a user
              connection), <code class="literal">PROCESSLIST_ID</code> is
              <code class="literal">NULL</code>, so the values are not unique.
              (Before MySQL 5.6.9, the value is 0 for background
              threads.)
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_USER</code>
            </p><p>
              The user associated with a foreground thread,
              <code class="literal">NULL</code> for a background thread.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_HOST</code>
            </p><p>
              The host name of the client associated with a foreground
              thread, <code class="literal">NULL</code> for a background thread.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_DB</code>
            </p><p>
              The default database for the thread, or
              <code class="literal">NULL</code> if there is none.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_COMMAND</code>
            </p><p>
              For foreground threads, the type of command the thread is
              executing on behalf of the client, or
              <code class="literal">Sleep</code> if the session is idle. For
              descriptions of thread commands, see
              <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>. The value of this
              column corresponds to the
              <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
              commands of the client/server protocol and
              <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code>
              status variables. See
              <a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 Server Status Variables">Section 5.1.6, “Server Status Variables”</a>
            </p><p>
              Background threads do not execute commands on behalf of
              clients, so this column may be <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_TIME</code>
            </p><p>
              The time in seconds that the thread has been in its
              current state.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_STATE</code>
            </p><p>
              An action, event, or state that indicates what the thread
              is doing. For descriptions of
              <code class="literal">PROCESSLIST_STATE</code> values, see
              <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>. If the value if
              <code class="literal">NULL</code>, the thread may correspond to an
              idle client session or the work it is doing is not
              instrumented with stages.
            </p><p>
              Most states correspond to very quick operations. If a
              thread stays in a given state for many seconds, there
              might be a problem that bears investigation.
            </p></li><li class="listitem"><p>
              <code class="literal">PROCESSLIST_INFO</code>
            </p><p>
              The statement the thread is executing, or
              <code class="literal">NULL</code> if it is not executing any
              statement. The statement might be the one sent to the
              server, or an innermost statement if the statement
              executes other statements. For example, if a
              <code class="literal">CALL</code> statement executes a stored
              procedure that is executing a
              <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement, the
              <code class="literal">PROCESSLIST_INFO</code> value shows the
              <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
            </p></li><li class="listitem"><p>
              <code class="literal">PARENT_THREAD_ID</code>
            </p><p>
              If this thread is a subthread (spawned by another thread),
              this is the <code class="literal">THREAD_ID</code> value of the
              spawning thread. Thread spawning occurs, for example, to
              handle insertion of rows from <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
              DELAYED</code></a> statements.
            </p></li><li class="listitem"><p>
              <code class="literal">ROLE</code>
            </p><p>
              Unused.
            </p></li><li class="listitem"><p>
              <code class="literal">INSTRUMENTED</code>
            </p><p>
              Whether events executed by the thread are instrumented.
              The value is <code class="literal">YES</code> or
              <code class="literal">NO</code>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  For foreground threads, the initial
                  <code class="literal">INSTRUMENTED</code> value is determined by
                  whether the user account associated with the thread
                  matches any row in the
                  <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table.
                  Matching is based on the values of the
                  <code class="literal">PROCESSLIST_USER</code> and
                  <code class="literal">PROCESSLIST_HOST</code> columns.
                </p><p>
                  If the thread spawns a subthread, matching occurs
                  again for the subthread.
                </p></li><li class="listitem"><p>
                  For background threads,
                  <code class="literal">INSTRUMENTED</code> is
                  <code class="literal">YES</code> by default.
                  <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> is not
                  consulted because there is no associated user for
                  background threads.
                </p></li><li class="listitem"><p>
                  For any thread, its <code class="literal">INSTRUMENTED</code>
                  value can be changed during the lifetime of the
                  thread. This is the only
                  <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table column that
                  can be modified.
</p></li></ul>
</div>
<p>
              For monitoring of events executed by the thread to occur,
              these things must be true:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                  The <code class="literal">thread_instrumentation</code> consumer
                  in the <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a>
                  table must be <code class="literal">YES</code>.
                </p></li><li class="listitem"><p>
                  The <code class="literal">threads.INSTRUMENTED</code> column
                  must be <code class="literal">YES</code>.
                </p></li><li class="listitem"><p>
                  Monitoring occurs only for those thread events
                  produced from instruments that are enabled in the
                  <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table.
</p></li></ul>
</div>
</li></ul>
</div>

</div>

</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-option-variable-reference"></a>22.10 Performance Schema Option and Variable Reference</h2>

</div>

</div>

</div>

<div class="table">
<a name="idm139737070985904"></a><p class="title"><b>Table 22.3 Performance Schema Variable Reference</b></p>
<div class="table-contents">
<table summary="Performance Schema Variable Reference" border="1"><colgroup><col class="name"><col class="cmd-line"><col class="option_file"><col class="system_var"><col class="status_var"><col class="var_scope"><col class="dynamic"></colgroup><thead><tr><th scope="col">Name</th><th scope="col">Cmd-Line</th><th scope="col">Option File</th><th scope="col">System Var</th><th scope="col">Status Var</th><th scope="col">Var Scope</th><th scope="col">Dynamic</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_accounts_lost">Performance_schema_accounts_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_classes_lost">Performance_schema_cond_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_cond_instances_lost">Performance_schema_cond_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-current">performance-schema-consumer-events-stages-current</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history">performance-schema-consumer-events-stages-history</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history-long">performance-schema-consumer-events-stages-history-long</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-current">performance-schema-consumer-events-statements-current</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history">performance-schema-consumer-events-statements-history</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history-long">performance-schema-consumer-events-statements-history-long</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-current">performance-schema-consumer-events-waits-current</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history">performance-schema-consumer-events-waits-history</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history-long">performance-schema-consumer-events-waits-history-long</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-global-instrumentation">performance-schema-consumer-global-instrumentation</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-statements-digest">performance-schema-consumer-statements-digest</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-thread-instrumentation">performance-schema-consumer-thread-instrumentation</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_digest_lost">Performance_schema_digest_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_classes_lost">Performance_schema_file_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_handles_lost">Performance_schema_file_handles_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_file_instances_lost">Performance_schema_file_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_hosts_lost">Performance_schema_hosts_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#option_mysqld_performance-schema-instrument">performance-schema-instrument</a></td><td>Yes</td><td>Yes</td><td> </td><td> </td><td> </td><td> </td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_locker_lost">Performance_schema_locker_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length">performance_schema_max_digest_length</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_classes_lost">Performance_schema_mutex_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_mutex_instances_lost">Performance_schema_mutex_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_classes_lost">Performance_schema_rwlock_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_rwlock_instances_lost">Performance_schema_rwlock_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_session_connect_attrs_lost">Performance_schema_session_connect_attrs_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_classes_lost">Performance_schema_socket_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_socket_instances_lost">Performance_schema_socket_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_stage_classes_lost">Performance_schema_stage_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_statement_classes_lost">Performance_schema_statement_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_handles_lost">Performance_schema_table_handles_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_table_instances_lost">Performance_schema_table_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_classes_lost">Performance_schema_thread_classes_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_thread_instances_lost">Performance_schema_thread_instances_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#statvar_Performance_schema_users_lost">Performance_schema_users_lost</a></td><td> </td><td> </td><td> </td><td>Yes</td><td>Global</td><td>No</td></tr><tr><td scope="row"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></td><td>Yes</td><td>Yes</td><td>Yes</td><td> </td><td>Global</td><td>No</td></tr></tbody></table>
</div>

</div>
<br class="table-break">
</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-options"></a>22.11 Performance Schema Command Options</h2>

</div>

</div>

</div>
<p>
      Performance Schema parameters can be specified at server startup
      on the command line or in option files to configure Performance
      Schema instruments and consumers. Runtime configuration is also
      possible in many cases (see
      <a class="xref" href="performance-schema.html#performance-schema-runtime-configuration" title="22.2.3 Performance Schema Runtime Configuration">Section 22.2.3, “Performance Schema Runtime Configuration”</a>), but
      startup configuration must be used when runtime configuration is
      too late to affect instruments that have already been initialized
      during the startup process.
    </p><p>
      Performance Schema consumers and instruments can be configured at
      startup using the following syntax. For additional details, see
      <a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 Performance Schema Startup Configuration">Section 22.2.2, “Performance Schema Startup Configuration”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-xxx"></a>
          <a class="indexterm" name="idm139737070754384"></a>

          <a class="indexterm" name="idm139737070752880"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-xxx"><code class="option">--performance-schema-consumer-<em class="replaceable"><code>consumer_name</code></em>=<code class="literal">value</code></code></a>
        </p><p>
          Configure a Performance Schema consumer. Consumer names in the
          <a class="link" href="performance-schema.html#setup-consumers-table" title="22.9.2.2 The setup_consumers Table"><code class="literal">setup_consumers</code></a> table use
          underscores, but for consumers set at startup, dashes and
          underscores within the name are equivalent. Options for
          configuring individual consumers are detailed later in this
          section.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-instrument"></a>
          <a class="indexterm" name="idm139737070746128"></a>

          <a class="indexterm" name="idm139737070744624"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-instrument"><code class="option">--performance-schema-instrument=<em class="replaceable"><code>instrument_name</code></em>=<code class="literal">value</code></code></a>
        </p><p>
          Configure a Performance Schema instrument. The name may be
          given as a pattern to configure instruments that match the
          pattern.
</p></li></ul>
</div>
<p>
      The following items configure individual consumers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-current"></a>
          <a class="indexterm" name="idm139737070738416"></a>

          <a class="indexterm" name="idm139737070736960"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-current"><code class="option">--performance-schema-consumer-events-stages-current=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-stages-current</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history"></a>
          <a class="indexterm" name="idm139737070731232"></a>

          <a class="indexterm" name="idm139737070729776"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history"><code class="option">--performance-schema-consumer-events-stages-history=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-stages-history</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-stages-history-long"></a>
          <a class="indexterm" name="idm139737070724032"></a>

          <a class="indexterm" name="idm139737070722576"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-stages-history-long"><code class="option">--performance-schema-consumer-events-stages-history-long=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-stages-history-long</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-current"></a>
          <a class="indexterm" name="idm139737070716816"></a>

          <a class="indexterm" name="idm139737070715360"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-current"><code class="option">--performance-schema-consumer-events-statements-current=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-statements-current</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history"></a>
          <a class="indexterm" name="idm139737070709600"></a>

          <a class="indexterm" name="idm139737070708144"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history"><code class="option">--performance-schema-consumer-events-statements-history=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-statements-history</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-statements-history-long"></a>
          <a class="indexterm" name="idm139737070702336"></a>

          <a class="indexterm" name="idm139737070700800"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-statements-history-long"><code class="option">--performance-schema-consumer-events-statements-history-long=<code class="literal">value</code></code></a>
        </p><p>
          Configure the
          <code class="literal">events-statements-history-long</code> consumer.
          This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-current"></a>
          <a class="indexterm" name="idm139737070695008"></a>

          <a class="indexterm" name="idm139737070693488"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-current"><code class="option">--performance-schema-consumer-events-waits-current=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-waits-current</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history"></a>
          <a class="indexterm" name="idm139737070687856"></a>

          <a class="indexterm" name="idm139737070686336"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history"><code class="option">--performance-schema-consumer-events-waits-history=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-waits-history</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-events-waits-history-long"></a>
          <a class="indexterm" name="idm139737070680704"></a>

          <a class="indexterm" name="idm139737070679248"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-events-waits-history-long"><code class="option">--performance-schema-consumer-events-waits-history-long=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">events-waits-history-long</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-global-instrumentation"></a>
          <a class="indexterm" name="idm139737070673488"></a>

          <a class="indexterm" name="idm139737070672032"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-global-instrumentation"><code class="option">--performance-schema-consumer-global-instrumentation=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">global-instrumentation</code>
          consumer. This option was added in MySQL 5.6.4.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-statements-digest"></a>
          <a class="indexterm" name="idm139737070666304"></a>

          <a class="indexterm" name="idm139737070664784"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-statements-digest"><code class="option">--performance-schema-consumer-statements-digest=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">statements-digest</code> consumer.
          This option was added in MySQL 5.6.5.
        </p></li><li class="listitem"><p><a name="option_mysqld_performance-schema-consumer-thread-instrumentation"></a>
          <a class="indexterm" name="idm139737070659152"></a>

          <a class="indexterm" name="idm139737070657696"></a>

          <a class="link" href="performance-schema.html#option_mysqld_performance-schema-consumer-thread-instrumentation"><code class="option">--performance-schema-consumer-thread-instrumentation=<code class="literal">value</code></code></a>
        </p><p>
          Configure the <code class="literal">thread-instrumentation</code>
          consumer. This option was added in MySQL 5.6.4.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-system-variables"></a>22.12 Performance Schema System Variables</h2>

</div>

</div>

</div>
<p>
      The Performance Schema implements several system variables that
      provide configuration information:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'perf%';</code></strong>
+--------------------------------------------------------+---------+
| Variable_name                                          | Value   |
+--------------------------------------------------------+---------+
| performance_schema                                     | ON      |
| performance_schema_accounts_size                       | 100     |
| performance_schema_digests_size                        | 200     |
| performance_schema_events_stages_history_long_size     | 10000   |
| performance_schema_events_stages_history_size          | 10      |
| performance_schema_events_statements_history_long_size | 10000   |
| performance_schema_events_statements_history_size      | 10      |
| performance_schema_events_waits_history_long_size      | 10000   |
| performance_schema_events_waits_history_size           | 10      |
| performance_schema_hosts_size                          | 100     |
| performance_schema_max_cond_classes                    | 80      |
| performance_schema_max_cond_instances                  | 1000    |
| performance_schema_max_file_classes                    | 50      |
| performance_schema_max_file_handles                    | 32768   |
| performance_schema_max_file_instances                  | 10000   |
| performance_schema_max_mutex_classes                   | 200     |
| performance_schema_max_mutex_instances                 | 1000000 |
| performance_schema_max_rwlock_classes                  | 30      |
| performance_schema_max_rwlock_instances                | 1000000 |
| performance_schema_max_socket_classes                  | 10      |
| performance_schema_max_socket_instances                | 1000    |
| performance_schema_max_stage_classes                   | 150     |
| performance_schema_max_statement_classes               | 165     |
| performance_schema_max_table_handles                   | 10000   |
| performance_schema_max_table_instances                 | 1000    |
| performance_schema_max_thread_classes                  | 50      |
| performance_schema_max_thread_instances                | 1000    |
| performance_schema_session_connect_attrs_size          | 512     |
| performance_schema_setup_actors_size                   | 100     |
| performance_schema_setup_objects_size                  | 100     |
| performance_schema_users_size                          | 100     |
+--------------------------------------------------------+---------+
</pre><p>
      Performance Schema system variables can be set at server startup
      on the command line or in option files, and many can be set at
      runtime. See
      <a class="xref" href="performance-schema.html#performance-schema-option-variable-reference" title="22.10 Performance Schema Option and Variable Reference">Section 22.10, “Performance Schema Option and Variable Reference”</a>.
    </p><p>
      As of MySQL 5.6.6, the Performance Schema automatically sizes the
      values of several of its parameters at server startup if they are
      not set explicitly. For more information, see
      <a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 Performance Schema Startup Configuration">Section 22.2.2, “Performance Schema Startup Configuration”</a>.
    </p><p>
      Performance Schema system variables have the following meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="sysvar_performance_schema"></a>
          <a class="indexterm" name="idm139737070640496"></a>

          <a class="indexterm" name="idm139737070639456"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema"><code class="literal">performance_schema</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema">performance_schema</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">boolean</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">OFF</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">boolean</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">ON</code></td></tr></tbody></table>
</div>
<p>
          The value of this variable is <code class="literal">ON</code> or
          <code class="literal">OFF</code> to indicate whether the Performance
          Schema is enabled. By default, the value is
          <code class="literal">ON</code> by default as of MySQL 5.6.6 and
          <code class="literal">OFF</code> before that. At server startup, you can
          specify this variable with no value or a value of
          <code class="literal">ON</code> or 1 to enable it, or with a value of
          <code class="literal">OFF</code> or 0 to disable it.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_accounts_size"></a>
          <a class="indexterm" name="idm139737070605824"></a>

          <a class="indexterm" name="idm139737070604720"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size"><code class="literal">performance_schema_accounts_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_accounts_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_accounts_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_accounts_size">performance_schema_accounts_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table. If this variable
          is 0, the Performance Schema does not maintain connection
          statistics in the <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table.
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_digests_size"></a>
          <a class="indexterm" name="idm139737070561952"></a>

          <a class="indexterm" name="idm139737070560848"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_digests_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.5</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_digests_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size">performance_schema_digests_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of rows in the
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
          table. This variable was added in MySQL 5.6.5. If this maximum
          is exceeded such that a digest cannot be instrumented, the
          Performance Schema increments the
          <a class="link" href="performance-schema.html#statvar_Performance_schema_digest_lost"><code class="literal">Performance_schema_digest_lost</code></a>
          status variable.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_long_size"></a>
          <a class="indexterm" name="idm139737070528192"></a>

          <a class="indexterm" name="idm139737070527152"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size"><code class="literal">performance_schema_events_stages_history_long_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_stages_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_stages_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_long_size">performance_schema_events_stages_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a> table.
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_stages_history_size"></a>
          <a class="indexterm" name="idm139737070494336"></a>

          <a class="indexterm" name="idm139737070493216"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size"><code class="literal">performance_schema_events_stages_history_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_stages_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_stages_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size">performance_schema_events_stages_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows per thread in the
          <a class="link" href="performance-schema.html#events-stages-history-table" title="22.9.5.2 The events_stages_history Table"><code class="literal">events_stages_history</code></a> table. This
          variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_long_size"></a>
          <a class="indexterm" name="idm139737070460400"></a>

          <a class="indexterm" name="idm139737070459360"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size"><code class="literal">performance_schema_events_statements_history_long_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_statements_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_statements_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_long_size">performance_schema_events_statements_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
          table. This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_statements_history_size"></a>
          <a class="indexterm" name="idm139737070426448"></a>

          <a class="indexterm" name="idm139737070425408"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size"><code class="literal">performance_schema_events_statements_history_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_statements_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_statements_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size">performance_schema_events_statements_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows per thread in the
          <a class="link" href="performance-schema.html#events-statements-history-table" title="22.9.6.2 The events_statements_history Table"><code class="literal">events_statements_history</code></a> table.
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_long_size"></a>
          <a class="indexterm" name="idm139737070392496"></a>

          <a class="indexterm" name="idm139737070391456"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size"><code class="literal">performance_schema_events_waits_history_long_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_waits_history_long_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_waits_history_long_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size">performance_schema_events_waits_history_long_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a> table.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_events_waits_history_size"></a>
          <a class="indexterm" name="idm139737070360384"></a>

          <a class="indexterm" name="idm139737070359344"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size"><code class="literal">performance_schema_events_waits_history_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_events_waits_history_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_events_waits_history_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size">performance_schema_events_waits_history_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The number of rows per thread in the
          <a class="link" href="performance-schema.html#events-waits-history-table" title="22.9.4.2 The events_waits_history Table"><code class="literal">events_waits_history</code></a> table.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_hosts_size"></a>
          <a class="indexterm" name="idm139737070328560"></a>

          <a class="indexterm" name="idm139737070327456"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size"><code class="literal">performance_schema_hosts_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_hosts_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_hosts_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_hosts_size">performance_schema_hosts_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a>
          table. If this variable is 0, the Performance Schema does not
          maintain connection statistics in the
          <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table. This variable was
          added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_classes"></a>
          <a class="indexterm" name="idm139737070284656"></a>

          <a class="indexterm" name="idm139737070283616"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes"><code class="literal">performance_schema_max_cond_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_cond_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_cond_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_classes">performance_schema_max_cond_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">80</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of condition instruments.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_cond_instances"></a>
          <a class="indexterm" name="idm139737070259904"></a>

          <a class="indexterm" name="idm139737070258864"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances"><code class="literal">performance_schema_max_cond_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_cond_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_cond_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_cond_instances">performance_schema_max_cond_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented condition objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_digest_length"></a>
          <a class="indexterm" name="idm139737070229248"></a>

          <a class="indexterm" name="idm139737070228208"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length"><code class="literal">performance_schema_max_digest_length</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_digest_length" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.26</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_digest_length=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_digest_length">performance_schema_max_digest_length</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1024</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of bytes available for computing statement
          digests (see
          <a class="xref" href="performance-schema.html#performance-schema-statement-digests" title="22.7 Performance Schema Statement Digests">Section 22.7, “Performance Schema Statement Digests”</a>). This
          variable is like
          <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a>, but
          applies to the Performance Schema only. For more information,
          see the description of that variable in
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>
        </p><p>
          This variable was added in MySQL 5.6.26.
          <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a>. In MySQL
          5.6.24 and 5.6.25, use
          <a class="link" href="server-administration.html#sysvar_max_digest_length"><code class="literal">max_digest_length</code></a> instead.
          Before 5.6.24, the value cannot be changed.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_classes"></a>
          <a class="indexterm" name="idm139737070192256"></a>

          <a class="indexterm" name="idm139737070191216"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes"><code class="literal">performance_schema_max_file_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_file_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_classes">performance_schema_max_file_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">50</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of file instruments.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_handles"></a>
          <a class="indexterm" name="idm139737070167600"></a>

          <a class="indexterm" name="idm139737070166560"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles"><code class="literal">performance_schema_max_file_handles</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_file_handles" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_handles=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles">performance_schema_max_file_handles</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">32768</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of opened file objects.
        </p><p>
          The value of
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles"><code class="literal">performance_schema_max_file_handles</code></a>
          should be greater than the value of
          <a class="link" href="server-administration.html#sysvar_open_files_limit"><code class="literal">open_files_limit</code></a>:
          <a class="link" href="server-administration.html#sysvar_open_files_limit"><code class="literal">open_files_limit</code></a> affects the
          maximum number of open file handles the server can support and
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_handles"><code class="literal">performance_schema_max_file_handles</code></a>
          affects how many of these file handles can be instrumented.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_file_instances"></a>
          <a class="indexterm" name="idm139737070137152"></a>

          <a class="indexterm" name="idm139737070136112"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances"><code class="literal">performance_schema_max_file_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_file_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_file_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_file_instances">performance_schema_max_file_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented file objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_classes"></a>
          <a class="indexterm" name="idm139737070106512"></a>

          <a class="indexterm" name="idm139737070105472"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes"><code class="literal">performance_schema_max_mutex_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_mutex_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_mutex_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_classes">performance_schema_max_mutex_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">200</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of mutex instruments.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_mutex_instances"></a>
          <a class="indexterm" name="idm139737070081792"></a>

          <a class="indexterm" name="idm139737070080752"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances"><code class="literal">performance_schema_max_mutex_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_mutex_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_mutex_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_mutex_instances">performance_schema_max_mutex_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented mutex objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_classes"></a>
          <a class="indexterm" name="idm139737070051152"></a>

          <a class="indexterm" name="idm139737070050112"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes"><code class="literal">performance_schema_max_rwlock_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_rwlock_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_rwlock_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_classes">performance_schema_max_rwlock_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (5.6.0)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">20</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.1, &lt;= 5.6.14)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">30</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.15)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">40</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of rwlock instruments.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_rwlock_instances"></a>
          <a class="indexterm" name="idm139737070014912"></a>

          <a class="indexterm" name="idm139737070013872"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances"><code class="literal">performance_schema_max_rwlock_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_rwlock_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_rwlock_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_rwlock_instances">performance_schema_max_rwlock_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented rwlock objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_classes"></a>
          <a class="indexterm" name="idm139737069984272"></a>

          <a class="indexterm" name="idm139737069983232"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes"><code class="literal">performance_schema_max_socket_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_socket_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_socket_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_classes">performance_schema_max_socket_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of socket instruments. This variable was
          added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_socket_instances"></a>
          <a class="indexterm" name="idm139737069957664"></a>

          <a class="indexterm" name="idm139737069956624"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances"><code class="literal">performance_schema_max_socket_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_socket_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_socket_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_socket_instances">performance_schema_max_socket_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented socket objects. This
          variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_stage_classes"></a>
          <a class="indexterm" name="idm139737069925120"></a>

          <a class="indexterm" name="idm139737069924080"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes"><code class="literal">performance_schema_max_stage_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_stage_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_stage_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_stage_classes">performance_schema_max_stage_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">150</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of stage instruments. This variable was
          added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_statement_classes"></a>
          <a class="indexterm" name="idm139737069898464"></a>

          <a class="indexterm" name="idm139737069897344"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes"><code class="literal">performance_schema_max_statement_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_statement_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_statement_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_statement_classes">performance_schema_max_statement_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of statement instruments. The default value
          is calculated at server build time based on the number of
          commands in the client/server protocol and the number of SQL
          statement types supported by the server.
        </p><p>
          This variable should not be changed, unless to set it to 0 to
          disable all statement instrumentation and save all memory
          associated with it. Setting the variable to nonzero values
          other than the default has no benefit; in particular, values
          larger than the default cause more memory to be allocated then
          is needed.
        </p><p>
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_handles"></a>
          <a class="indexterm" name="idm139737069870352"></a>

          <a class="indexterm" name="idm139737069869312"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles"><code class="literal">performance_schema_max_table_handles</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_table_handles" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_table_handles=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_handles">performance_schema_max_table_handles</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">100000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of opened table objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_table_instances"></a>
          <a class="indexterm" name="idm139737069839712"></a>

          <a class="indexterm" name="idm139737069838672"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances"><code class="literal">performance_schema_max_table_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_table_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_table_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_table_instances">performance_schema_max_table_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">50000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented table objects.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_classes"></a>
          <a class="indexterm" name="idm139737069809072"></a>

          <a class="indexterm" name="idm139737069808032"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes"><code class="literal">performance_schema_max_thread_classes</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_thread_classes" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_thread_classes=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_classes">performance_schema_max_thread_classes</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">50</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of thread instruments.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_max_thread_instances"></a>
          <a class="indexterm" name="idm139737069784352"></a>

          <a class="indexterm" name="idm139737069783312"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_max_thread_instances" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_max_thread_instances=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances">performance_schema_max_thread_instances</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">1000</code></td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr></tbody></table>
</div>
<p>
          The maximum number of instrumented thread objects. The value
          controls the size of the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a>
          table. If this maximum is exceeded such that a thread cannot
          be instrumented, the Performance Schema increments the
          <a class="link" href="performance-schema.html#statvar_Performance_schema_thread_instances_lost"><code class="literal">Performance_schema_thread_instances_lost</code></a>
          status variable.
        </p><p>
          The <a class="link" href="server-administration.html#sysvar_max_connections"><code class="literal">max_connections</code></a> system
          variable affects how many threads are run in the server.
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
          affects how many of these running threads can be instrumented.
          The default value of
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
          is autosized based on the value of
          <a class="link" href="server-administration.html#sysvar_max_connections"><code class="literal">max_connections</code></a>.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_session_connect_attrs_size"></a>
          <a class="indexterm" name="idm139737069745248"></a>

          <a class="indexterm" name="idm139737069744128"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size"><code class="literal">performance_schema_session_connect_attrs_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_session_connect_attrs_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.6</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_session_connect_attrs_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_session_connect_attrs_size">performance_schema_session_connect_attrs_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">-1</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The amount of preallocated memory per thread used to hold
          connection attribute strings. If the connection attribute
          strings are larger than the reserved storage, the
          <a class="link" href="performance-schema.html#statvar_Performance_schema_session_connect_attrs_lost"><code class="literal">Performance_schema_session_connect_attrs_lost</code></a>
          status variable is incremented. This variable was added in
          MySQL 5.6.7.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_actors_size"></a>
          <a class="indexterm" name="idm139737069712576"></a>

          <a class="indexterm" name="idm139737069711536"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size"><code class="literal">performance_schema_setup_actors_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_setup_actors_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.1</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_setup_actors_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_actors_size">performance_schema_setup_actors_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">100</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#setup-actors-table" title="22.9.2.1 The setup_actors Table"><code class="literal">setup_actors</code></a> table.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_setup_objects_size"></a>
          <a class="indexterm" name="idm139737069684800"></a>

          <a class="indexterm" name="idm139737069683760"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size"><code class="literal">performance_schema_setup_objects_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_setup_objects_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.1</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_setup_objects_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_setup_objects_size">performance_schema_setup_objects_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="2"><span class="bold"><strong>Permitted Values</strong></span></td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">100</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the
          <a class="link" href="performance-schema.html#setup-objects-table" title="22.9.2.4 The setup_objects Table"><code class="literal">setup_objects</code></a> table.
        </p></li><li class="listitem"><p><a name="sysvar_performance_schema_users_size"></a>
          <a class="indexterm" name="idm139737069657072"></a>

          <a class="indexterm" name="idm139737069655968"></a>

          <a class="link" href="performance-schema.html#sysvar_performance_schema_users_size"><code class="literal">performance_schema_users_size</code></a>
</p>
<div class="informaltable">
<table summary="Options for performance_schema_users_size" border="1"><colgroup><col class="title"><col class="vt"><col class="vd"><col class="v"></colgroup><tbody><tr><td scope="row"><span class="bold"><strong>Introduced</strong></span></td><td colspan="3">5.6.3</td></tr><tr><td scope="row"><span class="bold"><strong>Command-Line Format</strong></span></td><td colspan="3"><code class="literal">--performance_schema_users_size=#</code></td></tr><tr><td scope="row" rowspan="3"><span class="bold"><strong>System Variable</strong></span></td><td><span class="bold"><strong>Name</strong></span></td><td colspan="2"><code class="literal"><a class="link" href="performance-schema.html#sysvar_performance_schema_users_size">performance_schema_users_size</a></code></td></tr><tr><td scope="row"><span class="bold"><strong>Variable Scope</strong></span></td><td colspan="2">Global</td></tr><tr><td scope="row"><span class="bold"><strong>Dynamic Variable</strong></span></td><td colspan="2">No</td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&lt;= 5.6.5)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">10</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">0</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr><tr><td scope="row" rowspan="4"><span class="bold"><strong>Permitted Values</strong></span> (&gt;= 5.6.6)</td><td><span class="bold"><strong>Type</strong></span></td><td colspan="2"><code class="literal">integer</code></td></tr><tr><td scope="row"><span class="bold"><strong>Default</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Min Value</strong></span></td><td colspan="2"><code class="literal">-1 (autosized)</code></td></tr><tr><td scope="row"><span class="bold"><strong>Max Value</strong></span></td><td colspan="2"><code class="literal">1048576</code></td></tr></tbody></table>
</div>
<p>
          The number of rows in the <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a>
          table. If this variable is 0, the Performance Schema does not
          maintain connection statistics in the
          <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table. This variable was
          added in MySQL 5.6.3.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-status-variables"></a>22.13 Performance Schema Status Variables</h2>

</div>

</div>

</div>
<p>
      The Performance Schema implements several status variables that
      provide information about instrumentation that could not be loaded
      or created due to memory constraints:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'perf%';</code></strong>
+-------------------------------------------+-------+
| Variable_name                             | Value |
+-------------------------------------------+-------+
| Performance_schema_accounts_lost          | 0     |
| Performance_schema_cond_classes_lost      | 0     |
| Performance_schema_cond_instances_lost    | 0     |
| Performance_schema_file_classes_lost      | 0     |
| Performance_schema_file_handles_lost      | 0     |
| Performance_schema_file_instances_lost    | 0     |
| Performance_schema_hosts_lost             | 0     |
| Performance_schema_locker_lost            | 0     |
| Performance_schema_mutex_classes_lost     | 0     |
| Performance_schema_mutex_instances_lost   | 0     |
| Performance_schema_rwlock_classes_lost    | 0     |
| Performance_schema_rwlock_instances_lost  | 0     |
| Performance_schema_socket_classes_lost    | 0     |
| Performance_schema_socket_instances_lost  | 0     |
| Performance_schema_stage_classes_lost     | 0     |
| Performance_schema_statement_classes_lost | 0     |
| Performance_schema_table_handles_lost     | 0     |
| Performance_schema_table_instances_lost   | 0     |
| Performance_schema_thread_classes_lost    | 0     |
| Performance_schema_thread_instances_lost  | 0     |
| Performance_schema_users_lost             | 0     |
+-------------------------------------------+-------+
</pre><p>
      Performance Schema status variables have the following meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="statvar_Performance_schema_accounts_lost"></a>
          <code class="literal">Performance_schema_accounts_lost</code>
        </p><p>
          The number of times a row could not be added to the
          <a class="link" href="performance-schema.html#accounts-table" title="22.9.7.1 The accounts Table"><code class="literal">accounts</code></a> table because it was
          full. This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_classes_lost"></a>
          <code class="literal">Performance_schema_cond_classes_lost</code>
        </p><p>
          How many condition instruments could not be loaded.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_cond_instances_lost"></a>
          <code class="literal">Performance_schema_cond_instances_lost</code>
        </p><p>
          How many condition instrument instances could not be created.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_digest_lost"></a>
          <code class="literal">Performance_schema_digest_lost</code>
        </p><p>
          The number of digest instances that could not be instrumented
          in the
          <a class="link" href="performance-schema.html#statement-summary-tables" title="22.9.9.3 Statement Summary Tables"><code class="literal">events_statements_summary_by_digest</code></a>
          table. This can be nonzero if the value of
          <a class="link" href="performance-schema.html#sysvar_performance_schema_digests_size"><code class="literal">performance_schema_digests_size</code></a>
          is too small. This variable was added in MySQL 5.6.5.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_classes_lost"></a>
          <code class="literal">Performance_schema_file_classes_lost</code>
        </p><p>
          How many file instruments could not be loaded.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_handles_lost"></a>
          <code class="literal">Performance_schema_file_handles_lost</code>
        </p><p>
          How many file instrument instances could not be opened.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_file_instances_lost"></a>
          <code class="literal">Performance_schema_file_instances_lost</code>
        </p><p>
          How many file instrument instances could not be created.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_hosts_lost"></a>
          <code class="literal">Performance_schema_hosts_lost</code>
        </p><p>
          The number of times a row could not be added to the
          <a class="link" href="performance-schema.html#hosts-table" title="22.9.7.2 The hosts Table"><code class="literal">hosts</code></a> table because it was full.
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_locker_lost"></a>
          <code class="literal">Performance_schema_locker_lost</code>
        </p><p>
          How many events are <span class="quote">“<span class="quote">lost</span>”</span> or not recorded, due
          to the following conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Events are recursive (for example, waiting for A caused a
              wait on B, which caused a wait on C).
            </p></li><li class="listitem"><p>
              The depth of the nested events stack is greater than the
              limit imposed by the implementation.
</p></li></ul>
</div>
<p>
          Currently, events recorded by the Performance Schema are not
          recursive, so this variable should always be 0.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_classes_lost"></a>
          <code class="literal">Performance_schema_mutex_classes_lost</code>
        </p><p>
          How many mutex instruments could not be loaded.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_mutex_instances_lost"></a>
          <code class="literal">Performance_schema_mutex_instances_lost</code>
        </p><p>
          How many mutex instrument instances could not be created.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_classes_lost"></a>
          <code class="literal">Performance_schema_rwlock_classes_lost</code>
        </p><p>
          How many rwlock instruments could not be loaded.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_rwlock_instances_lost"></a>
          <code class="literal">Performance_schema_rwlock_instances_lost</code>
        </p><p>
          How many rwlock instrument instances could not be created.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_session_connect_attrs_lost"></a>
          <code class="literal">Performance_schema_session_connect_attrs_lost</code>
        </p><p>
          The number of times a connection attribute string was larger
          than the reserved storage. This variable was added in MySQL
          5.6.7.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_classes_lost"></a>
          <code class="literal">Performance_schema_socket_classes_lost</code>
        </p><p>
          How many socket instruments could not be loaded. This variable
          was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_socket_instances_lost"></a>
          <code class="literal">Performance_schema_socket_instances_lost</code>
        </p><p>
          How many socket instrument instances could not be created.
          This variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_stage_classes_lost"></a>
          <code class="literal">Performance_schema_stage_classes_lost</code>
        </p><p>
          How many stage instruments could not be loaded. This variable
          was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_statement_classes_lost"></a>
          <code class="literal">Performance_schema_statement_classes_lost</code>
        </p><p>
          How many statement instruments could not be loaded. This
          variable was added in MySQL 5.6.3.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_handles_lost"></a>
          <code class="literal">Performance_schema_table_handles_lost</code>
        </p><p>
          How many table instrument instances could not be opened.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_table_instances_lost"></a>
          <code class="literal">Performance_schema_table_instances_lost</code>
        </p><p>
          How many table instrument instances could not be created.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_classes_lost"></a>
          <code class="literal">Performance_schema_thread_classes_lost</code>
        </p><p>
          How many thread instruments could not be loaded.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_thread_instances_lost"></a>
          <code class="literal">Performance_schema_thread_instances_lost</code>
        </p><p>
          The number of thread instances that could not be instrumented
          in the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table. This can be
          nonzero if the value of
          <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
          is too small.
        </p></li><li class="listitem"><p><a name="statvar_Performance_schema_users_lost"></a>
          <code class="literal">Performance_schema_users_lost</code>
        </p><p>
          The number of times a row could not be added to the
          <a class="link" href="performance-schema.html#users-table" title="22.9.7.3 The users Table"><code class="literal">users</code></a> table because it was full.
          This variable was added in MySQL 5.6.3.
</p></li></ul>
</div>
<p>
      For information on using these variables to check Performance
      Schema status, see
      <a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="22.5 Performance Schema Status Monitoring">Section 22.5, “Performance Schema Status Monitoring”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-and-plugins"></a>22.14 Performance Schema and Plugins</h2>

</div>

</div>

</div>
<p>
      Removing a plugin with <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
      PLUGIN</code></a> does not affect information already collected for
      code in that plugin. Time spent executing the code while the
      plugin was loaded was still spent even if the plugin is unloaded
      later. The associated event information, including aggregate
      information, remains readable in
      <code class="literal">performance_schema</code> database tables. For
      additional information about the effect of plugin installation and
      removal, see
      <a class="xref" href="performance-schema.html#performance-schema-status-monitoring" title="22.5 Performance Schema Status Monitoring">Section 22.5, “Performance Schema Status Monitoring”</a>.
    </p><p>
      A plugin implementor who instruments plugin code should document
      its instrumentation characteristics to enable those who load the
      plugin to account for its requirements. For example, a third-party
      storage engine should include in its documentation how much memory
      the engine needs for mutex and other instruments.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="performance-schema-examples"></a>22.15 Using the Performance Schema to Diagnose Problems</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="performance-schema.html#performance-schema-query-profiling">22.15.1 Query Profiling Using Performance Schema</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737069531680"></a><a class="indexterm" name="idm139737069530224"></a><p>
      The Performance Schema is a tool to help a DBA do performance
      tuning by taking real measurements instead of <span class="quote">“<span class="quote">wild
      guesses.</span>”</span> This section demonstrates some ways to use the
      Performance Schema for this purpose. The discussion here relies on
      the use of event filtering, which is described in
      <a class="xref" href="performance-schema.html#performance-schema-filtering" title="22.2.3.2 Performance Schema Event Filtering">Section 22.2.3.2, “Performance Schema Event Filtering”</a>.
    </p><p>
      The following example provides one methodology that you can use to
      analyze a repeatable problem, such as investigating a performance
      bottleneck. To begin, you should have a repeatable use case where
      performance is deemed <span class="quote">“<span class="quote">too slow</span>”</span> and needs
      optimization, and you should enable all instrumentation (no
      pre-filtering at all).
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Run the use case.
        </p></li><li class="listitem"><p>
          Using the Performance Schema tables, analyze the root cause of
          the performance problem. This analysis will rely heavily on
          post-filtering.
        </p></li><li class="listitem"><p>
          For problem areas that are ruled out, disable the
          corresponding instruments. For example, if analysis shows that
          the issue is not related to file I/O in a particular storage
          engine, disable the file I/O instruments for that engine. Then
          truncate the history and summary tables to remove previously
          collected events.
        </p></li><li class="listitem"><p>
          Repeat the process at step 1.
        </p><p>
          At each iteration, the Performance Schema output, particularly
          the <a class="link" href="performance-schema.html#events-waits-history-long-table" title="22.9.4.3 The events_waits_history_long Table"><code class="literal">events_waits_history_long</code></a>
          table, will contain less and less <span class="quote">“<span class="quote">noise</span>”</span> caused
          by nonsignificant instruments, and given that this table has a
          fixed size, will contain more and more data relevant to the
          analysis of the problem at hand.
        </p><p>
          At each iteration, investigation should lead closer and closer
          to the root cause of the problem, as the
          <span class="quote">“<span class="quote">signal/noise</span>”</span> ratio will improve, making
          analysis easier.
        </p></li><li class="listitem"><p>
          Once a root cause of performance bottleneck is identified,
          take the appropriate corrective action, such as:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Tune the server parameters (cache sizes, memory, and so
              forth).
            </p></li><li class="listitem"><p>
              Tune a query by writing it differently,
            </p></li><li class="listitem"><p>
              Tune the database schema (tables, indexes, and so forth).
            </p></li><li class="listitem"><p>
              Tune the code (this applies to storage engine or server
              developers only).
</p></li></ul>
</div>
</li><li class="listitem"><p>
          Start again at step 1, to see the effects of the changes on
          performance.
</p></li></ol>
</div>
<p>
      The <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code> and
      <code class="literal">rwlock_instances.WRITE_LOCKED_BY_THREAD_ID</code>
      columns are extremely important for investigating performance
      bottlenecks or deadlocks. This is made possible by Performance
      Schema instrumentation as follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Suppose that thread 1 is stuck waiting for a mutex.
        </p></li><li class="listitem"><p>
          You can determine what the thread is waiting for:
        </p><pre class="programlisting">
SELECT * FROM events_waits_current WHERE THREAD_ID = <em class="replaceable"><code>thread_1</code></em>;
</pre><p>
          Say the query result identifies that the thread is waiting for
          mutex A, found in
          <code class="literal">events_waits_current.OBJECT_INSTANCE_BEGIN</code>.
        </p></li><li class="listitem"><p>
          You can determine which thread is holding mutex A:
        </p><pre class="programlisting">
SELECT * FROM mutex_instances WHERE OBJECT_INSTANCE_BEGIN = <em class="replaceable"><code>mutex_A</code></em>;
</pre><p>
          Say the query result identifies that it is thread 2 holding
          mutex A, as found in
          <code class="literal">mutex_instances.LOCKED_BY_THREAD_ID</code>.
        </p></li><li class="listitem"><p>
          You can see what thread 2 is doing:
        </p><pre class="programlisting">
SELECT * FROM events_waits_current WHERE THREAD_ID = <em class="replaceable"><code>thread_2</code></em>;
</pre></li></ol>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="performance-schema-query-profiling"></a>22.15.1 Query Profiling Using Performance Schema</h3>

</div>

</div>

</div>
<p>
        The following example demonstrates how to use Performance Schema
        statement events and stage events to retrieve data comparable to
        profiling information provided by <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW
        PROFILES</code></a> and <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW
        PROFILE</code></a> statements.
      </p><p>
        In this example, statement and stage event data is collected in
        the <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
        and <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
        tables. On a busy server with many active foreground threads,
        data could age out of the history tables before you are able to
        retrieve the information you want to analyze. If you encounter
        this problem, options include:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Running the query on a test instance where there is less
            foreground thread activity.
          </p></li><li class="listitem"><p>
            Disabling instrumentation for other existing foreground
            threads by setting the <code class="literal">INSTRUMENTED</code> field
            of the <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table to
            <code class="literal">NO</code> for other thread records. For example,
            the following statement disables instrumentation for all
            foreground threads except the <code class="literal">test_user</code>
            thread:
          </p><pre class="programlisting">mysql&gt; UPDATE performance_schema.threads SET INSTRUMENTED = 'NO' 
    -&gt; WHERE TYPE='FOREGROUND' AND PROCESSLIST_USER NOT LIKE 'test_user';
</pre><p>
            However, be aware that new threads are always instrumented
            by default.
          </p></li><li class="listitem"><p>
            Increasing the number of rows in the
            <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
            and <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
            tables. The
            <a class="link" href="performance-schema.html#sysvar_performance_schema_events_statements_history_size"><code class="literal">performance_schema_events_statements_history_size</code></a>
            and
            <a class="link" href="performance-schema.html#sysvar_performance_schema_events_stages_history_size"><code class="literal">performance_schema_events_stages_history_size</code></a>
            configuration options are autosized by default as of MySQL
            5.6.6 but can also be set explicitly at startup. You can
            view current settings by running <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW
            VARIABLES</code></a>. For information about autosized
            Performance Schema parameters, see
            <a class="xref" href="performance-schema.html#performance-schema-startup-configuration" title="22.2.2 Performance Schema Startup Configuration">Section 22.2.2, “Performance Schema Startup Configuration”</a>.
</p></li></ul>
</div>
<p>
        Performance Schema displays event timer information in
        picoseconds (trillionths of a second) to normalize timing data
        to a standard unit. In the following example,
        <code class="literal">TIMER_WAIT</code> values are divided by
        1000000000000 to show data in units of seconds. Values are also
        truncated to 6 decimal places to display data in the same format
        as <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> and
        <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> statements.
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Ensure that statement and stage instrumentation is enabled
            by updating the
            <a class="link" href="performance-schema.html#setup-instruments-table" title="22.9.2.3 The setup_instruments Table"><code class="literal">setup_instruments</code></a> table. Some
            instruments may already be enabled by default.
          </p><pre class="programlisting">mysql&gt; UPDATE performance_schema.setup_instruments SET ENABLED = 'YES', TIMED = 'YES' 
    -&gt; WHERE NAME LIKE '%statement/%';

mysql&gt; UPDATE performance_schema.setup_instruments SET ENABLED = 'YES', TIMED = 'YES' 
    -&gt; WHERE NAME LIKE '%stage/%';</pre></li><li class="listitem"><p>
            Ensure that <code class="literal">events_statements_*</code> and
            <code class="literal">events_stages_*</code> consumers are enabled.
            Some consumers may already be enabled by default.
          </p><pre class="programlisting">mysql&gt; UPDATE performance_schema.setup_consumers SET ENABLED = 'YES' 
    -&gt; WHERE NAME LIKE '%events_statements_%';

mysql&gt; UPDATE performance_schema.setup_consumers SET ENABLED = 'YES' 
    -&gt; WHERE NAME LIKE '%events_stages_%';</pre></li><li class="listitem"><p>
            Run the statement that you want to profile. For example:
          </p><pre class="programlisting">mysql&gt; SELECT * FROM employees.employees WHERE emp_no = 10001;
+--------+------------+------------+-----------+--------+------------+
| emp_no | birth_date | first_name | last_name | gender | hire_date |
+--------+------------+------------+-----------+--------+------------+
|  10001 | 1953-09-02 | Georgi     | Facello   | M      | 1986-06-26 |
+--------+------------+------------+-----------+--------+------------+</pre></li><li class="listitem"><p>
            Identify the <code class="literal">EVENT_ID</code> of the statement by
            querying the
            <a class="link" href="performance-schema.html#events-statements-history-long-table" title="22.9.6.3 The events_statements_history_long Table"><code class="literal">events_statements_history_long</code></a>
            table. This step is similar to running
            <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> to identify the
            <code class="literal">Query_ID</code>. The following query produces
            output similar to <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW
            PROFILES</code></a>:
          </p><pre class="programlisting">mysql&gt; SELECT EVENT_ID, TRUNCATE(TIMER_WAIT/1000000000000,6) as Duration, SQL_TEXT 
    -&gt; FROM performance_schema.events_statements_history_long WHERE SQL_TEXT like '%10001%';
+----------+----------+--------------------------------------------------------+
| event_id | duration | sql_text                                               |
+----------+----------+--------------------------------------------------------+
|       31 | 0.028310 | SELECT * FROM employees.employees WHERE emp_no = 10001 |
+----------+----------+--------------------------------------------------------+</pre></li><li class="listitem"><p>
            Query the
            <a class="link" href="performance-schema.html#events-stages-history-long-table" title="22.9.5.3 The events_stages_history_long Table"><code class="literal">events_stages_history_long</code></a>
            table to retrieve the statement's stage events. Stages are
            linked to statements using event nesting. Each stage event
            record has a <code class="literal">NESTING_EVENT_ID</code> column that
            contains the <code class="literal">EVENT_ID</code> of the parent
            statement.
          </p><pre class="programlisting">mysql&gt; SELECT event_name AS Stage, TRUNCATE(TIMER_WAIT/1000000000000,6) AS Duration 
    -&gt; FROM performance_schema.events_stages_history_long WHERE NESTING_EVENT_ID=31;
+--------------------------------+----------+
| Stage                          | Duration |
+--------------------------------+----------+
| stage/sql/starting             | 0.000080 |
| stage/sql/checking permissions | 0.000005 |
| stage/sql/Opening tables       | 0.027759 |
| stage/sql/init                 | 0.000052 |
| stage/sql/System lock          | 0.000009 |
| stage/sql/optimizing           | 0.000006 |
| stage/sql/statistics           | 0.000082 |
| stage/sql/preparing            | 0.000008 |
| stage/sql/executing            | 0.000000 |
| stage/sql/Sending data         | 0.000017 |
| stage/sql/end                  | 0.000001 |
| stage/sql/query end            | 0.000004 |
| stage/sql/closing tables       | 0.000006 |
| stage/sql/freeing items        | 0.000272 |
| stage/sql/cleaning up          | 0.000001 |
+--------------------------------+----------+
15 rows in set (0.00 sec)</pre></li></ol>
</div>

</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="information-schema.html">Prev</a></td>
<td width="20%" align="center"><a accesskey="u" href="">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="connectors-apis.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 21 INFORMATION_SCHEMA Tables</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top">Chapter 23 Connectors and APIs</td>
</tr>
</table>
</div>
</body>
</html>
