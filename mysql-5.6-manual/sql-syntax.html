<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Chapter 13 SQL Statement Syntax</title>
<link rel="stylesheet" href="mvl.css" type="text/css" />
<meta name="generator" content="DocBook XSL Stylesheets + chunker.py v1.9.2" />
<link rel="start" href="index.html" title="{book-title}" />
<link rel="up" href="" title="" />
<link rel="prev" href="functions.html" title="Chapter 12 Functions and Operators" />
<link rel="next" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine" />
<script language="javascript" type="text/javascript">
  function addOnload(theFunc)
  {
    var previous = window.onload;
    if (typeof window.onload != 'function')
    {
      window.onload = theFunc;
    }
    else
    {
      window.onload = function()
      {
        previous();
        theFunc();
      }
    }
  }

  addOnload(function()
  {
    var base = new Date(1438557954*1000);
    var now = new Date();
    var diff = ((now-base)/1000)/(24*3600);

    if (diff > 90) {
      var nodes = document.getElementsByClassName('titlepage');
      nodes[0].innerHTML = '<p style="border: 5px #ff0000 solid; padding: 5px; margin 5px">' +
        'This copy of the manual is more than 90 days old. We encourage you to download a ' +
        'new version from <a href="http://dev.mysql.com">dev.mysql.com/doc</a>.</p>' + nodes[0].innerHTML;
    }
  });
</script>
<noscript></noscript>
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<th colspan="3" align="center">Chapter 13 SQL Statement Syntax</th>
</tr>
<tr>
<td width="20%" align="left"><a accesskey="p" href="functions.html">Prev</a> </td>
<th width="60%" align="center"></th>
<td width="20%" align="right"> <a accesskey="n" href="innodb-storage-engine.html">Next</a></td>
</tr>
</table>
<hr>
</div>
<div class="chapter">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="sql-syntax"></a>Chapter 13 SQL Statement Syntax</h1>

</div>

</div>

</div>
<div class="toc">
<p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="sql-syntax.html#sql-syntax-data-definition">13.1 Data Definition Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#alter-database">13.1.1 ALTER DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-event">13.1.2 ALTER EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-logfile-group">13.1.3 ALTER LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-function">13.1.4 ALTER FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-procedure">13.1.5 ALTER PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-server">13.1.6 ALTER SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table">13.1.7 ALTER TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-tablespace">13.1.8 ALTER TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-view">13.1.9 ALTER VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-database">13.1.10 CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-event">13.1.11 CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-function">13.1.12 CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-index">13.1.13 CREATE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-logfile-group">13.1.14 CREATE LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-procedure">13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-server">13.1.16 CREATE SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table">13.1.17 CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-tablespace">13.1.18 CREATE TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-trigger">13.1.19 CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-view">13.1.20 CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-database">13.1.21 DROP DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-event">13.1.22 DROP EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function">13.1.23 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-index">13.1.24 DROP INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-logfile-group">13.1.25 DROP LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-procedure">13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-server">13.1.27 DROP SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-table">13.1.28 DROP TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-tablespace">13.1.29 DROP TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-trigger">13.1.30 DROP TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-view">13.1.31 DROP VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-table">13.1.32 RENAME TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#truncate-table">13.1.33 TRUNCATE TABLE Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-data-manipulation">13.2 Data Manipulation Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#call">13.2.1 CALL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#delete">13.2.2 DELETE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#do">13.2.3 DO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler">13.2.4 HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert">13.2.5 INSERT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-data">13.2.6 LOAD DATA INFILE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-xml">13.2.7 LOAD XML Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replace">13.2.8 REPLACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#select">13.2.9 SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subqueries">13.2.10 Subquery Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#update">13.2.11 UPDATE Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-transactions">13.3 MySQL Transactional and Locking Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#commit">13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cannot-roll-back">13.3.2 Statements That Cannot Be Rolled Back</a></span></dt><dt><span class="section"><a href="sql-syntax.html#implicit-commit">13.3.3 Statements That Cause an Implicit Commit</a></span></dt><dt><span class="section"><a href="sql-syntax.html#savepoint">13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables">13.3.5 LOCK TABLES and UNLOCK TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-transaction">13.3.6 SET TRANSACTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa">13.3.7 XA Transactions</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-replication">13.4 Replication Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#replication-master-sql">13.4.1 SQL Statements for Controlling Master Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-slave-sql">13.4.2 SQL Statements for Controlling Slave Servers</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-prepared-statements">13.5 SQL Syntax for Prepared Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#prepare">13.5.1 PREPARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#execute">13.5.2 EXECUTE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#deallocate-prepare">13.5.3 DEALLOCATE PREPARE Syntax</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-compound-statements">13.6 MySQL Compound-Statement Syntax</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#begin-end">13.6.1 BEGIN ... END Compound-Statement Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#statement-labels">13.6.2 Statement Label Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare">13.6.3 DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stored-program-variables">13.6.4 Variables in Stored Programs</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flow-control-statements">13.6.5 Flow Control Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cursors">13.6.6 Cursors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#condition-handling">13.6.7 Condition Handling</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-server-administration">13.7 Database Administration Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#account-management-sql">13.7.1 Account Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#table-maintenance-sql">13.7.2 Table Maintenance Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#plugin-sql">13.7.3 Plugin and User-Defined Function Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-statement">13.7.4 SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show">13.7.5 SHOW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#other-administrative-sql">13.7.6 Other Administrative Statements</a></span></dt></dl></dd><dt><span class="section"><a href="sql-syntax.html#sql-syntax-utility">13.8 MySQL Utility Statements</a></span></dt><dd><dl><dt><span class="section"><a href="sql-syntax.html#describe">13.8.1 DESCRIBE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#explain">13.8.2 EXPLAIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#help">13.8.3 HELP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#use">13.8.4 USE Syntax</a></span></dt></dl></dd></dl>
</div>
<p>
    This chapter describes the syntax for the
    <a class="link" href="glossary.html#glos_sql" title="SQL">SQL</a> statements supported by MySQL.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-data-definition"></a>13.1 Data Definition Statements</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-database">13.1.1 ALTER DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-event">13.1.2 ALTER EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-logfile-group">13.1.3 ALTER LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-function">13.1.4 ALTER FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-procedure">13.1.5 ALTER PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-server">13.1.6 ALTER SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table">13.1.7 ALTER TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-tablespace">13.1.8 ALTER TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-view">13.1.9 ALTER VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-database">13.1.10 CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-event">13.1.11 CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-function">13.1.12 CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-index">13.1.13 CREATE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-logfile-group">13.1.14 CREATE LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-procedure">13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-server">13.1.16 CREATE SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table">13.1.17 CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-tablespace">13.1.18 CREATE TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-trigger">13.1.19 CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-view">13.1.20 CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-database">13.1.21 DROP DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-event">13.1.22 DROP EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function">13.1.23 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-index">13.1.24 DROP INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-logfile-group">13.1.25 DROP LOGFILE GROUP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-procedure">13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-server">13.1.27 DROP SERVER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-table">13.1.28 DROP TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-tablespace">13.1.29 DROP TABLESPACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-trigger">13.1.30 DROP TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-view">13.1.31 DROP VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-table">13.1.32 RENAME TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#truncate-table">13.1.33 TRUNCATE TABLE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737153982048"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-database"></a>13.1.1 ALTER DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153979856"></a><a class="indexterm" name="idm139737153978784"></a><a class="indexterm" name="idm139737153977712"></a><a class="indexterm" name="idm139737153976224"></a><a class="indexterm" name="idm139737153974736"></a><a class="indexterm" name="idm139737153973248"></a><pre class="programlisting">
ALTER {DATABASE | SCHEMA} [<em class="replaceable"><code>db_name</code></em>]
    <em class="replaceable"><code>alter_specification</code></em> ...
ALTER {DATABASE | SCHEMA} <em class="replaceable"><code>db_name</code></em>
    UPGRADE DATA DIRECTORY NAME

<em class="replaceable"><code>alter_specification</code></em>:
    [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#alter-database" title="13.1.1 ALTER DATABASE Syntax"><code class="literal">ALTER DATABASE</code></a> enables you to
      change the overall characteristics of a database. These
      characteristics are stored in the <code class="filename">db.opt</code> file
      in the database directory. To use <a class="link" href="sql-syntax.html#alter-database" title="13.1.1 ALTER DATABASE Syntax"><code class="literal">ALTER
      DATABASE</code></a>, you need the
      <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> privilege on the database.
      <a class="link" href="sql-syntax.html#alter-database" title="13.1.1 ALTER DATABASE Syntax"><code class="literal">ALTER
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#alter-database" title="13.1.1 ALTER DATABASE Syntax"><code class="literal">ALTER
      DATABASE</code></a>.
    </p><p>
      The database name can be omitted from the first syntax, in which
      case the statement applies to the default database.
</p>
<h4><a name="idm139737153957776"></a>National Language Characteristics</h4>
<p>
      The <code class="literal">CHARACTER SET</code> clause changes the default
      database character set. The <code class="literal">COLLATE</code> clause
      changes the default database collation. <a class="xref" href="globalization.html#charset" title="10.1 Character Set Support">Section 10.1, “Character Set Support”</a>,
      discusses character set and collation names.
    </p><p>
      You can see what character sets and collations are available
      using, respectively, the <a class="link" href="sql-syntax.html#show-character-set" title="13.7.5.4 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER
      SET</code></a> and <a class="link" href="sql-syntax.html#show-collation" title="13.7.5.5 SHOW COLLATION Syntax"><code class="literal">SHOW COLLATION</code></a>
      statements. See <a class="xref" href="sql-syntax.html#show-character-set" title="13.7.5.4 SHOW CHARACTER SET Syntax">Section 13.7.5.4, “SHOW CHARACTER SET Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#show-collation" title="13.7.5.5 SHOW COLLATION Syntax">Section 13.7.5.5, “SHOW COLLATION Syntax”</a>, for more information.
    </p><p>
      If you change the default character set or collation for a
      database, stored routines that use the database defaults must be
      dropped and recreated so that they use the new defaults. (In a
      stored routine, variables with character data types use the
      database defaults if the character set or collation are not
      specified explicitly. See <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.15, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.)
</p>
<h4><a name="idm139737153948624"></a>Upgrading from Versions Older than MySQL 5.1</h4>
<p>
      The syntax that includes the <code class="literal">UPGRADE DATA DIRECTORY
      NAME</code> clause updates the name of the directory associated
      with the database to use the encoding implemented in MySQL 5.1 for
      mapping database names to database directory names (see
      <a class="xref" href="language-structure.html#identifier-mapping" title="9.2.3 Mapping of Identifiers to File Names">Section 9.2.3, “Mapping of Identifiers to File Names”</a>). This clause is for use
      under these conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          It is intended when upgrading MySQL to 5.1 or later from older
          versions.
        </p></li><li class="listitem"><p>
          It is intended to update a database directory name to the
          current encoding format if the name contains special
          characters that need encoding.
        </p></li><li class="listitem"><p>
          The statement is used by <a class="link" href="programs.html#mysqlcheck" title="4.5.3 mysqlcheck — A Table Maintenance Program"><span class="command"><strong>mysqlcheck</strong></span></a> (as
          invoked by <a class="link" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables"><span class="command"><strong>mysql_upgrade</strong></span></a>).
</p></li></ul>
</div>
<p>
      For example, if a database in MySQL 5.0 has the name
      <code class="literal">a-b-c</code>, the name contains instances of the
      <code class="literal">-</code> (dash) character. In MySQL 5.0, the database
      directory is also named <code class="literal">a-b-c</code>, which is not
      necessarily safe for all file systems. In MySQL 5.1 and later, the
      same database name is encoded as <code class="literal">a@002db@002dc</code>
      to produce a file system-neutral directory name.
    </p><p>
      When a MySQL installation is upgraded to MySQL 5.1 or later from
      an older version,the server displays a name such as
      <code class="literal">a-b-c</code> (which is in the old format) as
      <code class="literal">#mysql50#a-b-c</code>, and you must refer to the name
      using the <code class="literal">#mysql50#</code> prefix. Use
      <code class="literal">UPGRADE DATA DIRECTORY NAME</code> in this case to
      explicitly tell the server to re-encode the database directory
      name to the current encoding format:
    </p><pre class="programlisting">
ALTER DATABASE `#mysql50#a-b-c` UPGRADE DATA DIRECTORY NAME;
</pre><p>
      After executing this statement, you can refer to the database as
      <code class="literal">a-b-c</code> without the special
      <code class="literal">#mysql50#</code> prefix.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-event"></a>13.1.2 ALTER EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153928688"></a><a class="indexterm" name="idm139737153927200"></a><a class="indexterm" name="idm139737153925712"></a><pre class="programlisting">
ALTER
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    EVENT <em class="replaceable"><code>event_name</code></em>
    [ON SCHEDULE <em class="replaceable"><code>schedule</code></em>]
    [ON COMPLETION [NOT] PRESERVE]
    [RENAME TO <em class="replaceable"><code>new_event_name</code></em>]
    [ENABLE | DISABLE | DISABLE ON SLAVE]
    [COMMENT '<em class="replaceable"><code>comment</code></em>']
    [DO <em class="replaceable"><code>event_body</code></em>]
</pre><p>
      The <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement changes
      one or more of the characteristics of an existing event without
      the need to drop and recreate it. The syntax for each of the
      <code class="literal">DEFINER</code>, <code class="literal">ON SCHEDULE</code>,
      <code class="literal">ON COMPLETION</code>, <code class="literal">COMMENT</code>,
      <code class="literal">ENABLE</code> / <code class="literal">DISABLE</code>, and
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clauses is exactly the same as
      when used with <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>. (See
      <a class="xref" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax">Section 13.1.11, “CREATE EVENT Syntax”</a>.)
    </p><p>
      Any user can alter an event defined on a database for which that
      user has the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege. When
      a user executes a successful <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement, that user becomes the definer for the
      affected event.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> works only with an
      existing event:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER EVENT no_such_event </code></strong>
     &gt;     <strong class="userinput"><code>ON SCHEDULE </code></strong>
     &gt;       <strong class="userinput"><code>EVERY '2:3' DAY_HOUR;</code></strong>
<span class="errortext">ERROR 1517 (HY000): Unknown event 'no_such_event'</span>
</pre><p>
      In each of the following examples, assume that the event named
      <code class="literal">myevent</code> is defined as shown here:
    </p><pre class="programlisting">
CREATE EVENT myevent
    ON SCHEDULE
      EVERY 6 HOUR
    COMMENT 'A sample comment.'
    DO
      UPDATE myschema.mytable SET mycol = mycol + 1;
</pre><p>
      The following statement changes the schedule for
      <code class="literal">myevent</code> from once every six hours starting
      immediately to once every twelve hours, starting four hours from
      the time the statement is run:
    </p><pre class="programlisting">
ALTER EVENT myevent
    ON SCHEDULE
      EVERY 12 HOUR
    STARTS CURRENT_TIMESTAMP + INTERVAL 4 HOUR;
</pre><p>
      It is possible to change multiple characteristics of an event in a
      single statement. This example changes the SQL statement executed
      by <code class="literal">myevent</code> to one that deletes all records from
      <code class="literal">mytable</code>; it also changes the schedule for the
      event such that it executes once, one day after this
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement is run.
    </p><pre class="programlisting">
ALTER EVENT myevent
    ON SCHEDULE
      AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
    DO
      TRUNCATE TABLE myschema.mytable;
</pre><p>
      Specify the options in an <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement only for those characteristics that you
      want to change; omitted options keep their existing values. This
      includes any default values for <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> such as <code class="literal">ENABLE</code>.
    </p><p>
      To disable <code class="literal">myevent</code>, use this
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement:
    </p><pre class="programlisting">
ALTER EVENT myevent
    DISABLE;
</pre><p>
      The <code class="literal">ON SCHEDULE</code> clause may use expressions
      involving built-in MySQL functions and user variables to obtain
      any of the <em class="replaceable"><code>timestamp</code></em> or
      <em class="replaceable"><code>interval</code></em> values which it contains. You
      cannot use stored routines or user-defined functions in such
      expressions, and you cannot use any table references; however, you
      can use <code class="literal">SELECT FROM DUAL</code>. This is true for both
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> and
      <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statements. References
      to stored routines, user-defined functions, and tables in such
      cases are specifically not permitted, and fail with an error (see
      Bug #22830).
    </p><p>
      Although an <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement
      that contains another <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>
      statement in its <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause appears
      to succeed, when the server attempts to execute the resulting
      scheduled event, the execution fails with an error.
    </p><p>
      To rename an event, use the <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER
      EVENT</code></a> statement's <code class="literal">RENAME TO</code> clause.
      This statement renames the event <code class="literal">myevent</code> to
      <code class="literal">yourevent</code>:
    </p><pre class="programlisting">
ALTER EVENT myevent
    RENAME TO yourevent;
</pre><p>
      You can also move an event to a different database using
      <code class="literal">ALTER EVENT ... RENAME TO ...</code> and
      <code class="literal"><em class="replaceable"><code>db_name.event_name</code></em></code>
      notation, as shown here:
    </p><pre class="programlisting">
ALTER EVENT olddb.myevent
    RENAME TO newdb.myevent;
</pre><p>
      To execute the previous statement, the user executing it must have
      the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege on both the
      <code class="literal">olddb</code> and <code class="literal">newdb</code> databases.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        There is no <code class="literal">RENAME EVENT</code> statement.
</p>
</div>
<p>
      The value <code class="literal">DISABLE ON SLAVE</code> is used on a
      replication slave instead of <code class="literal">ENABLE</code> or
      <code class="literal">DISABLE</code> to indicate an event that was created
      on the master and replicated to the slave, but that is not
      executed on the slave. Normally, <code class="literal">DISABLE ON
      SLAVE</code> is set automatically as required; however, there
      are some circumstances under which you may want or need to change
      it manually. See <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.11 Replication of Invoked Features">Section 17.4.1.11, “Replication of Invoked Features”</a>,
      for more information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-logfile-group"></a>13.1.3 ALTER LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153858016"></a><pre class="programlisting">
ALTER LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ADD UNDOFILE '<em class="replaceable"><code>file_name</code></em>'
    [INITIAL_SIZE [=] <em class="replaceable"><code>size</code></em>]
    [WAIT]
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement adds an <code class="literal">UNDO</code> file named
      '<em class="replaceable"><code>file_name</code></em>' to an existing log file
      group <em class="replaceable"><code>logfile_group</code></em>. An
      <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.3 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> statement has
      one and only one <code class="literal">ADD UNDOFILE</code> clause. No
      <code class="literal">DROP UNDOFILE</code> clause is currently supported.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All MySQL Cluster Disk Data objects share the same namespace.
        This means that <span class="emphasis"><em>each Disk Data object</em></span> must
        be uniquely named (and not merely each Disk Data object of a
        given type). For example, you cannot have a tablespace and an
        undo log file with the same name, or an undo log file and a data
        file with the same name.
</p>
</div>
<p>
      The optional <code class="literal">INITIAL_SIZE</code> parameter sets the
      <code class="literal">UNDO</code> file's initial size in bytes; if not
      specified, the initial size defaults to 134217728 (128 MB). Prior
      to MySQL Cluster NDB 7.3.2, this value was required to be
      specified using digits; in MySQL Cluster NDB 7.3.2 and later, you
      may optionally follow <em class="replaceable"><code>size</code></em> with a
      one-letter abbreviation for an order of magnitude, similar to
      those used in <code class="filename">my.cnf</code>. Generally, this is one
      of the letters <code class="literal">M</code> (megabytes) or
      <code class="literal">G</code> (gigabytes). (Bug #13116514, Bug #16104705,
      Bug #62858)
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      The minimum allowed value for <code class="literal">INITIAL_SIZE</code> is
      1048576 (1 MB). (Bug #29574)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <code class="literal">WAIT</code> is parsed but otherwise ignored. This
        keyword currently has no effect, and is intended for future
        expansion.
</p>
</div>
<p>
      The <code class="literal">ENGINE</code> parameter (required) determines the
      storage engine which is used by this log file group, with
      <em class="replaceable"><code>engine_name</code></em> being the name of the
      storage engine. Currently, the only accepted values for
      <em class="replaceable"><code>engine_name</code></em> are
      <span class="quote">“<span class="quote"><a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a></span>”</span> and
      <span class="quote">“<span class="quote"><a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a></span>”</span>. The two values
      are equivalent.
    </p><p>
      Here is an example, which assumes that the log file group
      <code class="literal">lg_3</code> has already been created using
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> (see
      <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax">Section 13.1.14, “CREATE LOGFILE GROUP Syntax”</a>):
    </p><pre class="programlisting">
ALTER LOGFILE GROUP lg_3
    ADD UNDOFILE 'undo_10.dat'
    INITIAL_SIZE=32M
    ENGINE=NDBCLUSTER;
</pre><p>
      When <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.3 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> is used
      with <code class="literal">ENGINE = NDBCLUSTER</code> (alternatively,
      <code class="literal">ENGINE = NDB</code>), an <code class="literal">UNDO</code> log
      file is created on each MySQL Cluster data node. You can verify
      that the <code class="literal">UNDO</code> files were created and obtain
      information about them by querying the
      <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. For
      example:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT FILE_NAME, LOGFILE_GROUP_NUMBER, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE LOGFILE_GROUP_NAME = 'lg_3';</code></strong>
+-------------+----------------------+----------------+
| FILE_NAME   | LOGFILE_GROUP_NUMBER | EXTRA          |
+-------------+----------------------+----------------+
| newdata.dat |                    0 | CLUSTER_NODE=3 |
| newdata.dat |                    0 | CLUSTER_NODE=4 |
| undo_10.dat |                   11 | CLUSTER_NODE=3 |
| undo_10.dat |                   11 | CLUSTER_NODE=4 |
+-------------+----------------------+----------------+
4 rows in set (0.01 sec)
</pre><p>
      (See <a class="xref" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table">Section 21.30.1, “The INFORMATION_SCHEMA FILES Table”</a>.)
    </p><p>
      Memory used for <code class="literal">UNDO_BUFFER_SIZE</code> comes from the
      global pool whose size is determined by the value of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-sharedglobalmemory"><code class="literal">SharedGlobalMemory</code></a> data
      node configuration parameter. This includes any default value
      implied for this option by the setting of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-initiallogfilegroup"><code class="literal">InitialLogFileGroup</code></a> data
      node configuration parameter.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-logfile-group" title="13.1.3 ALTER LOGFILE GROUP Syntax"><code class="literal">ALTER LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for MySQL Cluster. For more information,
      see <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-function"></a>13.1.4 ALTER FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153808432"></a><pre class="programlisting">
ALTER FUNCTION <em class="replaceable"><code>func_name</code></em> [<em class="replaceable"><code>characteristic</code></em> ...]

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
</pre><p>
      This statement can be used to change the characteristics of a
      stored function. More than one change may be specified in an
      <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a> statement. However,
      you cannot change the parameters or body of a stored function
      using this statement; to make such changes, you must drop and
      re-create the function using <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP
      FUNCTION</code></a> and <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE
      FUNCTION</code></a>.
    </p><p>
      You must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the function. (That privilege is granted
      automatically to the function creator.) If binary logging is
      enabled, the <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a>
      statement might also require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, as described in
      <a class="xref" href="stored-programs-views.html#stored-programs-logging" title="20.7 Binary Logging of Stored Programs">Section 20.7, “Binary Logging of Stored Programs”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-procedure"></a>13.1.5 ALTER PROCEDURE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153790240"></a><pre class="programlisting">
ALTER PROCEDURE <em class="replaceable"><code>proc_name</code></em> [<em class="replaceable"><code>characteristic</code></em> ...]

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }
</pre><p>
      This statement can be used to change the characteristics of a
      stored procedure. More than one change may be specified in an
      <a class="link" href="sql-syntax.html#alter-procedure" title="13.1.5 ALTER PROCEDURE Syntax"><code class="literal">ALTER PROCEDURE</code></a> statement. However,
      you cannot change the parameters or body of a stored procedure
      using this statement; to make such changes, you must drop and
      re-create the procedure using <a class="link" href="sql-syntax.html#drop-procedure" title="13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax"><code class="literal">DROP
      PROCEDURE</code></a> and <a class="link" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE
      PROCEDURE</code></a>.
    </p><p>
      You must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the procedure. By default, that privilege is granted
      automatically to the procedure creator. This behavior can be
      changed by disabling the
      <a class="link" href="server-administration.html#sysvar_automatic_sp_privileges"><code class="literal">automatic_sp_privileges</code></a> system
      variable. See <a class="xref" href="stored-programs-views.html#stored-routines-privileges" title="20.2.2 Stored Routines and MySQL Privileges">Section 20.2.2, “Stored Routines and MySQL Privileges”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-server"></a>13.1.6 ALTER SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737153773152"></a><pre class="programlisting">
ALTER SERVER  <em class="replaceable"><code>server_name</code></em>
    OPTIONS (<em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ...)
</pre><p>
      Alters the server information for
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code>,
      adjusting any of the options permitted in the
      <a class="link" href="sql-syntax.html#create-server" title="13.1.16 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a> statement. The
      corresponding fields in the <code class="literal">mysql.servers</code> table
      are updated accordingly. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      For example, to update the <code class="literal">USER</code> option:
    </p><pre class="programlisting">ALTER SERVER s OPTIONS (USER 'sally');</pre><p>
      <code class="literal">ALTER SERVER</code> does not cause an automatic
      commit.
    </p><p>
      In MySQL 5.6, <code class="literal">ALTER SERVER</code> is not
      written to the binary log, regardless of the logging format that
      is in use.
    </p><p>
      In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
      must be set to <code class="literal">AUTOMATIC</code> before issuing this
      statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-table"></a>13.1.7 ALTER TABLE Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-table-partition-operations">13.1.7.1 ALTER TABLE Partition Operations</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table-online-operations">13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster</a></span></dt><dt><span class="section"><a href="sql-syntax.html#alter-table-examples">13.1.7.3 ALTER TABLE Examples</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737153753920"></a><a class="indexterm" name="idm139737153752848"></a><a class="indexterm" name="idm139737153751360"></a><pre class="programlisting">
ALTER [ONLINE|OFFLINE] [IGNORE] TABLE <em class="replaceable"><code>tbl_name</code></em>
    [<em class="replaceable"><code>alter_specification</code></em> [, <em class="replaceable"><code>alter_specification</code></em>] ...]
    [<em class="replaceable"><code>partition_options</code></em>]

<em class="replaceable"><code>alter_specification</code></em>:
    <em class="replaceable"><code>table_options</code></em>
  | ADD [COLUMN] <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST | AFTER <em class="replaceable"><code>col_name</code></em> ]
  | ADD [COLUMN] (<em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>,...)
  | ADD {INDEX|KEY} [<em class="replaceable"><code>index_name</code></em>]
        [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] PRIMARY KEY
        [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]]
        UNIQUE [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>]
        [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD FULLTEXT [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>]
        (<em class="replaceable"><code>index_col_name</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD SPATIAL [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>]
        (<em class="replaceable"><code>index_col_name</code></em>,...) [<em class="replaceable"><code>index_option</code></em>] ...
  | ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]]
        FOREIGN KEY [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...)
        <em class="replaceable"><code>reference_definition</code></em>
  | ALGORITHM [=] {DEFAULT|INPLACE|COPY}
  | ALTER [COLUMN] <em class="replaceable"><code>col_name</code></em> {SET DEFAULT <em class="replaceable"><code>literal</code></em> | DROP DEFAULT}
  | CHANGE [COLUMN] <em class="replaceable"><code>old_col_name</code></em> <em class="replaceable"><code>new_col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST|AFTER <em class="replaceable"><code>col_name</code></em>]
  | LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
  | MODIFY [COLUMN] <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
        [FIRST | AFTER <em class="replaceable"><code>col_name</code></em>]
  | DROP [COLUMN] <em class="replaceable"><code>col_name</code></em>
  | DROP PRIMARY KEY
  | DROP {INDEX|KEY} <em class="replaceable"><code>index_name</code></em>
  | DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>
  | DISABLE KEYS
  | ENABLE KEYS
  | RENAME [TO|AS] <em class="replaceable"><code>new_tbl_name</code></em>
  | ORDER BY <em class="replaceable"><code>col_name</code></em> [, <em class="replaceable"><code>col_name</code></em>] ...
  | CONVERT TO CHARACTER SET <em class="replaceable"><code>charset_name</code></em> [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em> [COLLATE [=] <em class="replaceable"><code>collation_name</code></em>]
  | DISCARD TABLESPACE
  | IMPORT TABLESPACE
  | FORCE
  | ADD PARTITION (<em class="replaceable"><code>partition_definition</code></em>)
  | DROP PARTITION <em class="replaceable"><code>partition_names</code></em>
  | TRUNCATE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | COALESCE PARTITION <em class="replaceable"><code>number</code></em>
  | REORGANIZE PARTITION <em class="replaceable"><code>partition_names</code></em> INTO (<em class="replaceable"><code>partition_definitions</code></em>)
  | EXCHANGE PARTITION <em class="replaceable"><code>partition_name</code></em> WITH TABLE <em class="replaceable"><code>tbl_name</code></em>
  | ANALYZE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | CHECK PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | OPTIMIZE PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REBUILD PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REPAIR PARTITION {<em class="replaceable"><code>partition_names</code></em> | ALL}
  | REMOVE PARTITIONING

<em class="replaceable"><code>index_col_name</code></em>:
    <em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] [ASC | DESC]

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'

<em class="replaceable"><code>table_options</code></em>:
    <em class="replaceable"><code>table_option</code></em> [[,] <em class="replaceable"><code>table_option</code></em>] ...  (see <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> options)

<em class="replaceable"><code>partition_options</code></em>:
    (see <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> options)
</pre><p>
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> changes the structure
      of a table. For example, you can add or delete columns, create or
      destroy indexes, change the type of existing columns, or rename
      columns or the table itself. You can also change characteristics
      such as the storage engine used for the table or the table
      comment.
    </p><p>
      Following the table name, specify the alterations to be made. If
      none are given, <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> does
      nothing.
    </p><p>
      The syntax for many of the permissible alterations is similar to
      clauses of the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
      statement. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>, for more
      information.
    </p><p>
      <em class="replaceable"><code>table_options</code></em> signifies table options
      of the kind that can be used in the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
      TABLE</code></a> statement, such as <code class="literal">ENGINE</code>,
      <code class="literal">AUTO_INCREMENT</code>,
      <code class="literal">AVG_ROW_LENGTH</code>, <code class="literal">MAX_ROWS</code>, or
      <code class="literal">ROW_FORMAT</code>. For a list of all table options and
      a description of each, see <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>.
      However, <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> ignores the
      <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
      DIRECTORY</code> table options.
    </p><p>
      <em class="replaceable"><code>partition_options</code></em> signifies options
      that can be used with partitioned tables for repartitioning, for
      adding, dropping, merging, and splitting partitions, and for
      performing partitioning maintenance. It is possible for an
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement to contain a
      <code class="literal">PARTITION BY</code> or <code class="literal">REMOVE
      PARTITIONING</code> clause in an addition to other alter
      specifications, but the <code class="literal">PARTITION BY</code> or
      <code class="literal">REMOVE PARTITIONING</code> clause must be specified
      last after any other specifications. The <code class="literal">ADD
      PARTITION</code>, <code class="literal">DROP PARTITION</code>,
      <code class="literal">COALESCE PARTITION</code>, <code class="literal">REORGANIZE
      PARTITION</code>, <code class="literal">EXCHANGE PARTITION</code>,
      <code class="literal">ANALYZE PARTITION</code>, <code class="literal">CHECK
      PARTITION</code>, and <code class="literal">REPAIR PARTITION</code>
      options cannot be combined with other alter specifications in a
      single <code class="literal">ALTER TABLE</code>, since the options just
      listed act on individual partitions. For more information about
      partition options, see <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.7.1 ALTER TABLE Partition Operations">Section 13.1.7.1, “ALTER TABLE Partition Operations”</a>. For
      information about and examples of <code class="literal">ALTER TABLE ...
      EXCHANGE PARTITION</code> statements, see
      <a class="xref" href="partitioning.html#partitioning-management-exchange" title="19.3.3 Exchanging Partitions and Subpartitions with Tables">Section 19.3.3, “Exchanging Partitions and Subpartitions with Tables”</a>.
    </p><p>
      Some operations may result in warnings if attempted on a table for
      which the storage engine does not support the operation. These
      warnings can be displayed with <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
      WARNINGS</code></a>. See <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      For information on troubleshooting <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a>, see <a class="xref" href="error-handling.html#alter-table-problems" title="B.5.7.1 Problems with ALTER TABLE">Section B.5.7.1, “Problems with ALTER TABLE”</a>.
</p>
<h4><a name="idm139737153672592"></a>Storage, Performance, and Concurrency Considerations</h4>
<p>
      In most cases, <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> makes a
      temporary copy of the original table. MySQL waits for other
      operations that are modifying the table, then proceeds. It
      incorporates the alteration into the copy, deletes the original
      table, and renames the new one. While <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> is executing, the original table is readable by
      other sessions (with the exception noted shortly). Updates and
      writes to the table that begin after the
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation begins are
      stalled until the new table is ready, then are automatically
      redirected to the new table without any failed updates. The
      temporary copy of the original table is created in the database
      directory of the new table. This can differ from the database
      directory of the original table for <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> operations that rename the table to a different
      database.
    </p><p>
      The exception referred to earlier is that
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> blocks reads (not just
      writes) at the point where it is ready to install a new version of
      the table <code class="filename">.frm</code> file, discard the old file,
      and clear outdated table structures from the table and table
      definition caches. At this point, it must acquire an exclusive
      lock. To do so, it waits for current readers to finish, and blocks
      new reads (and writes).
    </p><p>
      For <code class="literal">MyISAM</code> tables, you can speed up index
      re-creation (the slowest part of the alteration process) by
      setting the
      <a class="link" href="server-administration.html#sysvar_myisam_sort_buffer_size"><code class="literal">myisam_sort_buffer_size</code></a> system
      variable to a high value.
    </p><p>
      For some operations, an in-place <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> is possible that does not require a temporary
      table:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For <code class="literal">ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
          RENAME TO <em class="replaceable"><code>new_tbl_name</code></em></code>
          without any other options, MySQL simply renames any files that
          correspond to the table <em class="replaceable"><code>tbl_name</code></em>
          without making a copy. (You can also use the
          <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> statement to
          rename tables. See <a class="xref" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax">Section 13.1.32, “RENAME TABLE Syntax”</a>.) Any
          privileges granted specifically for the renamed table are not
          migrated to the new name. They must be changed manually.
        </p></li><li class="listitem"><p>
          Alterations that modify only table metadata and not table data
          are immediate because the server only needs to alter the table
          <code class="filename">.frm</code> file, not touch table contents. The
          following changes are fast alterations that can be made this
          way:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Renaming a column, except for the
              <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage engine before
              MySQL 5.6.6.
            </p></li><li class="listitem"><p>
              Changing the default value of a column (except for
              <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables; see
              <a class="link" href="sql-syntax.html#alter-table-online-limitations" title="Limitations of MySQL Cluster online operations">Limitations
              of MySQL Cluster online operations</a>).
            </p></li><li class="listitem"><p>
              Changing the definition of an
              <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
              <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> column by adding new
              enumeration or set members to the <span class="emphasis"><em>end</em></span>
              of the list of valid member values, as long as the storage
              size of the data type does not change. For example, adding
              a member to a <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> column
              that has 8 members changes the required storage per value
              from 1 byte to 2 bytes; this will require a table copy.
              Adding members in the middle of the list causes
              renumbering of existing members, which requires a table
              copy.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">ALTER TABLE</code> with <code class="literal">ADD
          PARTITION</code>, <code class="literal">DROP PARTITION</code>,
          <code class="literal">COALESCE PARTITION</code>, <code class="literal">REBUILD
          PARTITION</code>, or <code class="literal">REORGANIZE
          PARTITION</code> does not create any temporary tables
          (except when used with <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>
          tables); however, these operations can and do create temporary
          partition files.
        </p><p>
          <code class="literal">ADD</code> or <code class="literal">DROP</code> operations
          for <code class="literal">RANGE</code> or <code class="literal">LIST</code>
          partitions are immediate operations or nearly so.
          <code class="literal">ADD</code> or <code class="literal">COALESCE</code>
          operations for <code class="literal">HASH</code> or
          <code class="literal">KEY</code> partitions copy data between all
          partitions, unless <code class="literal">LINEAR HASH</code> or
          <code class="literal">LINEAR KEY</code> was used; this is effectively
          the same as creating a new table, although the
          <code class="literal">ADD</code> or <code class="literal">COALESCE</code>
          operation is performed partition by partition.
          <code class="literal">REORGANIZE</code> operations copy only changed
          partitions and do not touch unchanged ones.
        </p></li><li class="listitem"><p>
          Renaming an index, except for
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>.
        </p></li><li class="listitem"><p>
          Adding or dropping an index, for
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>.
</p></li></ul>
</div>
<p>
      You can force an <code class="literal">ALTER TABLE</code> operation that
      would otherwise not require a table copy to use the temporary
      table method (as supported in MySQL 5.0) by setting the
      <a class="link" href="server-administration.html#sysvar_old_alter_table"><code class="literal">old_alter_table</code></a> system variable
      to <code class="literal">ON</code>, or specifying
      <code class="literal">ALGORITHM=COPY</code> as one of the
      <em class="replaceable"><code>alter_specification</code></em> clauses. If there
      is a conflict between the <code class="literal">old_alter_table</code>
      setting and an <code class="literal">ALGORITHM</code> clause with a value
      other than <code class="literal">DEFAULT</code>, the
      <code class="literal">ALGORITHM</code> clause takes precedence.
      (<code class="literal">ALGORITHM = DEFAULT</code> is the same a specifying
      no <code class="literal">ALGORITHM</code> clause at all.)
    </p><p>
      Specifying <code class="literal">ALGORITHM=INPLACE</code> makes the
      operation use the in-place technique for clauses and storage
      engines that support it, and fail with an error otherwise, thus
      avoiding a lengthy table copy if you try altering a table that
      uses a different storage engine than you expect. See
      <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">Section 14.10, “InnoDB and Online DDL”</a> for information about online
      DDL for <code class="literal">InnoDB</code> tables.
    </p><p>
      As of MySQL 5.6.16, <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
      upgrades MySQL 5.5 temporal columns to 5.6 format for <code class="literal">ADD
      COLUMN</code>, <code class="literal">CHANGE COLUMN</code>,
      <code class="literal">MODIFY COLUMN</code>, <code class="literal">ADD INDEX</code>,
      and <code class="literal">FORCE</code> operations. This conversion cannot be
      done using the <code class="literal">INPLACE</code> algorithm because the
      table must be rebuilt, so specifying
      <code class="literal">ALGORITHM=INPLACE</code> in these cases results in an
      error. Specify <code class="literal">ALGORITHM=COPY</code> if necessary.
    </p><p>
      Starting with MySQL 5.6.22, an <code class="literal">ALTER TABLE</code>
      operation on a multicolumn index used to partition a table by
      <code class="literal">KEY</code> cannot be performed online when the
      operation would change the order of the columns. In such cases,
      you must use a copying <code class="literal">ALTER TABLE</code> instead.
      (Bug #17896265)
    </p><p>
      MySQL Cluster also supports online <code class="literal">ALTER TABLE</code>
      operations using the <code class="literal">ALGORITHM=INPLACE</code> syntax
      in MySQL Cluster NDB 7.3 and later. MySQL Cluster also supports an
      older syntax specific to NDB that uses the
      <code class="literal">ONLINE</code> and <code class="literal">OFFLINE</code> keywords.
      These keywords are deprecated beginning with MySQL Cluster NDB
      7.3; they continue to be supported in MySQL Cluster NDB 7.4, but
      are subject to removal in a future version of MySQL Cluster. See
      <a class="xref" href="sql-syntax.html#alter-table-online-operations" title="13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster">Section 13.1.7.2, “ALTER TABLE Online Operations in MySQL Cluster”</a>, for the exact
      syntax and other particulars.
    </p><p>
      You can control the level of concurrent reading and writing of the
      table while it is being altered, using the <code class="literal">LOCK</code>
      clause. Specifying a non-default value for this clause lets you
      require a certain amount of concurrent access or exclusivity
      during the alter operation, and halts the operation if the
      requested degree of locking is not available. The parameters for
      the <code class="literal">LOCK</code> clause are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
</p><pre class="programlisting">
LOCK = DEFAULT
</pre><p>

          Maximum level of concurrency for the given
          <code class="literal">ALGORITHM</code> clause (if any) and
          <code class="literal">ALTER TABLE</code> operation: Permit concurrent
          reads and writes if supported. If not, permit concurrent reads
          if supported. If not, enforce exclusive access.
        </p></li><li class="listitem"><p>
</p><pre class="programlisting">
LOCK = NONE
</pre><p>

          If supported, permit concurrent reads and writes. Otherwise,
          return an error message.
        </p></li><li class="listitem"><p>
</p><pre class="programlisting">
LOCK = SHARED
</pre><p>

          If supported, permit concurrent reads but block writes. Note
          that writes will be blocked even if concurrent writes are
          supported by the storage engine for the given
          <code class="literal">ALGORITHM</code> clause (if any) and
          <code class="literal">ALTER TABLE</code> operation. If concurrent reads
          are not supported, return an error message.
        </p></li><li class="listitem"><p>
</p><pre class="programlisting">
LOCK = EXCLUSIVE
</pre><p>

          Enforce exclusive access. This will be done even if concurrent
          reads/writes are supported by the storage engine for the given
          <code class="literal">ALGORITHM</code> clause (if any) and
          <code class="literal">ALTER TABLE</code> operation.
</p></li></ul>
</div>
<p>
      As of MySQL 5.6.3, you can also use
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
      <em class="replaceable"><code>tbl_name</code></em> FORCE</code></a> to perform a
      <span class="quote">“<span class="quote">null</span>”</span> alter operation that rebuilds the table.
      Previously the <code class="literal">FORCE</code> option was recognized but
      ignored. As of MySQL 5.6.17,
      <a class="link" href="glossary.html#glos_online_ddl" title="online DDL">online DDL</a> support is
      provided for the <code class="literal">FORCE</code> option. For more
      information, see <a class="xref" href="innodb-storage-engine.html#innodb-create-index-overview" title="14.10.1 Overview of Online DDL">Section 14.10.1, “Overview of Online DDL”</a>.
    </p><p>
      For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, operations that add
      and drop indexes on variable-width columns occur online, without
      any table copying and without blocking concurrent DML actions for
      most of their duration. See
      <a class="xref" href="sql-syntax.html#alter-table-online-operations" title="13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster">Section 13.1.7.2, “ALTER TABLE Online Operations in MySQL Cluster”</a>.
</p>
<h4><a name="idm139737153570432"></a>Usage Notes</h4>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To use <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, you need
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>, and
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
          table. Renaming a table requires
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> and
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> on the old table,
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>, and
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> on the new table.
        </p></li><li class="listitem"><p>
          <code class="literal">IGNORE</code> is a MySQL extension to standard
          SQL. It controls how <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE</code></a> works if there are duplicates on unique keys
          in the new table or if warnings occur when strict mode is
          enabled. If <code class="literal">IGNORE</code> is not specified, the
          copy is aborted and rolled back if duplicate-key errors occur.
          If <code class="literal">IGNORE</code> is specified, only one row is
          used of rows with duplicates on a unique key. The other
          conflicting rows are deleted. Incorrect values are truncated
          to the closest matching acceptable value.
        </p><p>
          As of MySQL 5.6.17, the <code class="literal">IGNORE</code> clause is
          deprecated and its use generates a warning.
          <code class="literal">IGNORE</code> is removed in MySQL 5.7.
        </p></li><li class="listitem"><p>
          Pending <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>
          statements are lost if a table is write locked and
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> is used to modify
          the table structure.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>table_option</code></em> signifies a table
          option of the kind that can be used in the
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement, such as
          <code class="literal">ENGINE</code>, <code class="literal">AUTO_INCREMENT</code>,
          <code class="literal">AVG_ROW_LENGTH</code>,
          <code class="literal">MAX_ROWS</code>, or <code class="literal">ROW_FORMAT</code>.
          For a list of all table options and a description of each, see
          <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>. However,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> ignores the
          <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
          DIRECTORY</code> table options.
        </p><p>
          For example, to convert a table to be an
          <code class="literal">InnoDB</code> table, use this statement:
        </p><pre class="programlisting">
ALTER TABLE t1 ENGINE = InnoDB;
</pre><p>
          See <a class="xref" href="innodb-storage-engine.html#converting-tables-to-innodb" title="14.5.4 Converting Tables from MyISAM to InnoDB">Section 14.5.4, “Converting Tables from MyISAM to InnoDB”</a> for
          considerations when switching tables to the
          <code class="literal">InnoDB</code> storage engine.
        </p><p>
          When you specify an <code class="literal">ENGINE</code> clause,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> rebuilds the table.
          This is true even if the table already has the specified
          storage engine.
        </p><p>
          Running <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE <em class="replaceable"><code>tbl_name</code></em>
          ENGINE=INNODB</code></a> on an existing
          <code class="literal">InnoDB</code> table performs a <span class="quote">“<span class="quote">null</span>”</span>
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operation, which
          can be used to defragment an <code class="literal">InnoDB</code> table,
          as described in <a class="xref" href="innodb-storage-engine.html#innodb-file-defragmenting" title="14.9.4 Defragmenting a Table">Section 14.9.4, “Defragmenting a Table”</a>.
          Running <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE <em class="replaceable"><code>tbl_name</code></em> FORCE</code></a> on
          an <code class="literal">InnoDB</code> table performs the same function.
        </p><p>
          As of MySQL 5.6.17, both
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
          <em class="replaceable"><code>tbl_name</code></em> ENGINE=INNODB</code></a>
          and <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
          <em class="replaceable"><code>tbl_name</code></em> FORCE</code></a> use
          <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">online DDL</a>
          (<code class="literal">ALGORITHM=COPY</code>). For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-create-index-overview" title="14.10.1 Overview of Online DDL">Section 14.10.1, “Overview of Online DDL”</a>.
        </p><p>
          The outcome of attempting to change a table's storage engine
          is affected by whether the desired storage engine is available
          and the setting of the
          <a class="link" href="server-administration.html#sqlmode_no_engine_substitution"><code class="literal">NO_ENGINE_SUBSTITUTION</code></a> SQL
          mode, as described in <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>.
        </p><p>
          To prevent inadvertent loss of data,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> cannot be used to
          change the storage engine of a table to
          <code class="literal">MERGE</code> or <code class="literal">BLACKHOLE</code>.
        </p><p>
          To change the value of the <code class="literal">AUTO_INCREMENT</code>
          counter to be used for new rows, do this:
        </p><pre class="programlisting">
ALTER TABLE t2 AUTO_INCREMENT = <em class="replaceable"><code>value</code></em>;
</pre><p>
          You cannot reset the counter to a value less than or equal to
          the value that is currently in use. For both
          <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>, if
          the value is less than or equal to the maximum value currently
          in the <code class="literal">AUTO_INCREMENT</code> column, the value is
          reset to the current maximum <code class="literal">AUTO_INCREMENT</code>
          column value plus one.
        </p></li><li class="listitem"><p>
          You can issue multiple <code class="literal">ADD</code>,
          <code class="literal">ALTER</code>, <code class="literal">DROP</code>, and
          <code class="literal">CHANGE</code> clauses in a single
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement,
          separated by commas. This is a MySQL extension to standard
          SQL, which permits only one of each clause per
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement. For
          example, to drop multiple columns in a single statement, do
          this:
        </p><pre class="programlisting">
ALTER TABLE t2 DROP COLUMN c, DROP COLUMN d;
</pre></li><li class="listitem"><p>
          <code class="literal">CHANGE <em class="replaceable"><code>col_name</code></em></code>,
          <code class="literal">DROP <em class="replaceable"><code>col_name</code></em></code>,
          and <code class="literal">DROP INDEX</code> are MySQL extensions to
          standard SQL.
        </p></li><li class="listitem"><p>
          The word <code class="literal">COLUMN</code> is optional and can be
          omitted.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>column_definition</code></em> clauses use the
          same syntax for <code class="literal">ADD</code> and
          <code class="literal">CHANGE</code> as for <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a>. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>.
        </p></li><li class="listitem"><p>
          You can rename a column using a <code class="literal">CHANGE
          <em class="replaceable"><code>old_col_name</code></em>
          <em class="replaceable"><code>new_col_name</code></em>
          <em class="replaceable"><code>column_definition</code></em></code> clause.
          To do so, specify the old and new column names and the
          definition that the column currently has. For example, to
          rename an <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INTEGER</code></a> column from
          <code class="literal">a</code> to <code class="literal">b</code>, you can do this:
        </p><pre class="programlisting">
ALTER TABLE t1 CHANGE a b INTEGER;
</pre><p>
          To change a column's type but not the name,
          <code class="literal">CHANGE</code> syntax still requires an old and new
          column name, even if they are the same. For example:
        </p><pre class="programlisting">
ALTER TABLE t1 CHANGE b b BIGINT NOT NULL;
</pre><p>
          You can also use <code class="literal">MODIFY</code> to change a
          column's type without renaming it:
        </p><pre class="programlisting">
ALTER TABLE t1 MODIFY b BIGINT NOT NULL;
</pre><a class="indexterm" name="idm139737153478656"></a><a class="indexterm" name="idm139737153477584"></a><p>
          <code class="literal">MODIFY</code> is an extension to
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> for Oracle
          compatibility.
        </p><p>
          When you use <code class="literal">CHANGE</code> or
          <code class="literal">MODIFY</code>,
          <em class="replaceable"><code>column_definition</code></em> must include the
          data type and all attributes that should apply to the new
          column, other than index attributes such as <code class="literal">PRIMARY
          KEY</code> or <code class="literal">UNIQUE</code>. Attributes present
          in the original definition but not specified for the new
          definition are not carried forward. Suppose that a column
          <code class="literal">col1</code> is defined as <code class="literal">INT UNSIGNED
          DEFAULT 1 COMMENT 'my column'</code> and you modify the
          column as follows:
        </p><pre class="programlisting">
ALTER TABLE t1 MODIFY col1 BIGINT;
</pre><p>
          The resulting column will be defined as
          <code class="literal">BIGINT</code>, but will not include the attributes
          <code class="literal">UNSIGNED DEFAULT 1 COMMENT 'my column'</code>. To
          retain them, the statement should be:
        </p><pre class="programlisting">
ALTER TABLE t1 MODIFY col1 BIGINT UNSIGNED DEFAULT 1 COMMENT 'my column';
</pre></li><li class="listitem"><p>
          When you change a data type using <code class="literal">CHANGE</code> or
          <code class="literal">MODIFY</code>, MySQL tries to convert existing
          column values to the new type as well as possible.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            This conversion may result in alteration of data. For
            example, if you shorten a string column, values may be
            truncated. To prevent the operation from succeeding if
            conversions to the new data type would result in loss of
            data, enable strict SQL mode before using
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> (see
            <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>).
</p>
</div>
</li><li class="listitem"><p>
          To add a column at a specific position within a table row, use
          <code class="literal">FIRST</code> or <code class="literal">AFTER
          <em class="replaceable"><code>col_name</code></em></code>. The default is
          to add the column last. You can also use
          <code class="literal">FIRST</code> and <code class="literal">AFTER</code> in
          <code class="literal">CHANGE</code> or <code class="literal">MODIFY</code>
          operations to reorder columns within a table.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153453104"></a>

          <a class="indexterm" name="idm139737153452032"></a>

          <a class="indexterm" name="idm139737153450544"></a>

          <a class="indexterm" name="idm139737153449056"></a>

          <a class="indexterm" name="idm139737153447568"></a>

          <code class="literal">ALTER ... SET DEFAULT</code> or <code class="literal">ALTER ...
          DROP DEFAULT</code> specify a new default value for a
          column or remove the old default value, respectively. If the
          old default is removed and the column can be
          <code class="literal">NULL</code>, the new default is
          <code class="literal">NULL</code>. If the column cannot be
          <code class="literal">NULL</code>, MySQL assigns a default value as
          described in <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153440784"></a>

          <a class="indexterm" name="idm139737153439712"></a>

          <a class="indexterm" name="idm139737153438224"></a>

          <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> removes an index.
          This is a MySQL extension to standard SQL. See
          <a class="xref" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax">Section 13.1.24, “DROP INDEX Syntax”</a>. If you are unsure of the index
          name, use <code class="literal">SHOW INDEX FROM
          <em class="replaceable"><code>tbl_name</code></em></code>.
        </p></li><li class="listitem"><p>
          If columns are dropped from a table, the columns are also
          removed from any index of which they are a part. If all
          columns that make up an index are dropped, the index is
          dropped as well. If you use <code class="literal">CHANGE</code> or
          <code class="literal">MODIFY</code> to shorten a column for which an
          index exists on the column, and the resulting column length is
          less than the index length, MySQL shortens the index
          automatically.
        </p></li><li class="listitem"><p>
          If a table contains only one column, the column cannot be
          dropped. If what you intend is to remove the table, use
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> instead.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153428128"></a>

          <a class="indexterm" name="idm139737153427056"></a>

          <a class="indexterm" name="idm139737153425568"></a>

          <code class="literal">DROP PRIMARY KEY</code> drops the
          <a class="link" href="glossary.html#glos_primary_key" title="primary key">primary key</a>. If there
          is no primary key, an error occurs. For information about the
          performance characteristics of primary keys, especially for
          <code class="literal">InnoDB</code> tables, see
          <a class="xref" href="optimization.html#optimizing-primary-keys" title="8.3.2 Using Primary Keys">Section 8.3.2, “Using Primary Keys”</a>.
        </p><a class="indexterm" name="idm139737153420736"></a><a class="indexterm" name="idm139737153419664"></a><p>
          If you add a <code class="literal">UNIQUE INDEX</code> or
          <code class="literal">PRIMARY KEY</code> to a table, MySQL stores it
          before any nonunique index to permit detection of duplicate
          keys as early as possible.
        </p></li><li class="listitem"><p>
          Some storage engines permit you to specify an index type when
          creating an index. The syntax for the
          <em class="replaceable"><code>index_type</code></em> specifier is
          <code class="literal">USING <em class="replaceable"><code>type_name</code></em></code>.
          For details about <code class="literal">USING</code>, see
          <a class="xref" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax">Section 13.1.13, “CREATE INDEX Syntax”</a>. The preferred position is
          after the column list. Support for use of the option before
          the column list will be removed in a future MySQL release.
        </p><p>
          <em class="replaceable"><code>index_option</code></em> values specify
          additional options for an index. <code class="literal">USING</code> is
          one such option. For details about permissible
          <em class="replaceable"><code>index_option</code></em> values, see
          <a class="xref" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax">Section 13.1.13, “CREATE INDEX Syntax”</a>.
        </p></li><li class="listitem"><p>
          After an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement,
          it may be necessary to run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a> to update index cardinality information. See
          <a class="xref" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax">Section 13.7.5.23, “SHOW INDEX Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153405216"></a>

          <code class="literal">ORDER BY</code> enables you to create the new
          table with the rows in a specific order. This option is useful
          primarily when you know that you are mostly to query the rows
          in a certain order most of the time. By using this option
          after major changes to the table, you might be able to get
          higher performance. In some cases, it might make sorting
          easier for MySQL if the table is in order by the column that
          you want to order it by later.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The table does not remain in the specified order after
            inserts and deletes.
</p>
</div>
<p>
          <code class="literal">ORDER BY</code> syntax permits one or more column
          names to be specified for sorting, each of which optionally
          can be followed by <code class="literal">ASC</code> or
          <code class="literal">DESC</code> to indicate ascending or descending
          sort order, respectively. The default is ascending order. Only
          column names are permitted as sort criteria; arbitrary
          expressions are not permitted. This clause should be given
          last after any other clauses.
        </p><p>
          <code class="literal">ORDER BY</code> does not make sense for
          <code class="literal">InnoDB</code> tables because
          <code class="literal">InnoDB</code> always orders table rows according
          to the <a class="link" href="glossary.html#glos_clustered_index" title="clustered index">clustered
          index</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            When used on a partitioned table, <code class="literal">ALTER TABLE ...
            ORDER BY</code> orders rows within each partition only.
</p>
</div>
</li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153393152"></a>

          <a class="indexterm" name="idm139737153392080"></a>

          <a class="indexterm" name="idm139737153390592"></a>

          If you use <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
          <code class="literal">MyISAM</code> table, all nonunique indexes are
          created in a separate batch (as for
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>). This should make
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> much faster when
          you have many indexes.
        </p><p>
          For <code class="literal">MyISAM</code> tables, key updating can be
          controlled explicitly. Use <code class="literal">ALTER TABLE ... DISABLE
          KEYS</code> to tell MySQL to stop updating nonunique
          indexes. Then use <code class="literal">ALTER TABLE ... ENABLE
          KEYS</code> to re-create missing indexes.
          <code class="literal">MyISAM</code> does this with a special algorithm
          that is much faster than inserting keys one by one, so
          disabling keys before performing bulk insert operations should
          give a considerable speedup. Using <code class="literal">ALTER TABLE ...
          DISABLE KEYS</code> requires the
          <a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a> privilege in addition to
          the privileges mentioned earlier.
        </p><p>
          While the nonunique indexes are disabled, they are ignored for
          statements such as <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and
          <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> that otherwise would
          use them.
        </p></li><li class="listitem"><p>
          Before MySQL 5.6.7, using <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE</code></a> to change the definition of a foreign key
          column could cause a loss of referential integrity. For
          example, changing a foreign key column that contained
          <code class="literal">NULL</code> values to be <code class="literal">NOT
          NULL</code> caused the <code class="literal">NULL</code> values to be
          the empty string. Similarly, an
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
          IGNORE</code></a> that removed rows in a parent table could
          break referential integrity.
        </p><p>
          As of 5.6.7, the server prohibits changes to foreign key
          columns that have the potential to cause loss of referential
          integrity. It also prohibits changes to the data type of such
          columns that may be unsafe. For example, changing
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(20)</code></a> to
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(30)</code></a> is permitted, but
          changing it to <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR(1024)</code></a> is
          not because that alters the number of length bytes required to
          store individual values. A workaround is to use
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          DROP FOREIGN KEY</code></a> before changing the column
          definition and
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ADD FOREIGN KEY</code></a> afterward.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153362176"></a>

          <a class="indexterm" name="idm139737153361104"></a>

          The <code class="literal">FOREIGN KEY</code> and
          <code class="literal">REFERENCES</code> clauses are supported by the
          <code class="literal">InnoDB</code> and <code class="literal">NDB</code> storage
          engines, which implement <code class="literal">ADD [CONSTRAINT
          [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
          [<em class="replaceable"><code>index_name</code></em>] (...) REFERENCES ...
          (...)</code>. See
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="14.5.6 InnoDB and FOREIGN KEY Constraints">Section 14.5.6, “InnoDB and FOREIGN KEY Constraints”</a>. For other
          storage engines, the clauses are parsed but ignored. The
          <code class="literal">CHECK</code> clause is parsed but ignored by all
          storage engines. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>. The
          reason for accepting but ignoring syntax clauses is for
          compatibility, to make it easier to port code from other SQL
          servers, and to run applications that create tables with
          references. See <a class="xref" href="introduction.html#differences-from-ansi" title="1.7.2 MySQL Differences from Standard SQL">Section 1.7.2, “MySQL Differences from Standard SQL”</a>.
        </p><p>
          For <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, unlike
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>, <code class="literal">ADD
          FOREIGN KEY</code> ignores
          <em class="replaceable"><code>index_name</code></em> if given and uses an
          automatically generated foreign key name. As a workaround,
          include the <code class="literal">CONSTRAINT</code> clause to specify
          the foreign key name:
        </p><pre class="programlisting">
ADD CONSTRAINT <em class="replaceable"><code>name</code></em> FOREIGN KEY (....) ...
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            The inline <code class="literal">REFERENCES</code> specifications
            where the references are defined as part of the column
            specification are silently ignored. MySQL only accepts
            <code class="literal">REFERENCES</code> clauses defined as part of a
            separate <code class="literal">FOREIGN KEY</code> specification.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
            Partitioned <code class="literal">InnoDB</code> tables do not support
            foreign keys. This restriction does not apply to
            <code class="literal">NDB</code> tables, including those explicitly
            partitioned by <code class="literal">[LINEAR] KEY</code>. See
            <a class="xref" href="partitioning.html#partitioning-limitations-storage-engines" title="19.6.2 Partitioning Limitations Relating to Storage Engines">Section 19.6.2, “Partitioning Limitations Relating to Storage Engines”</a>,
            for more information.
</p>
</div>
</li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153338176"></a>

          <a class="indexterm" name="idm139737153337104"></a>

          <a class="indexterm" name="idm139737153335616"></a>

          The <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engines support the
          use of <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to drop
          foreign keys:
        </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>;
</pre><p>
          For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="14.5.6 InnoDB and FOREIGN KEY Constraints">Section 14.5.6, “InnoDB and FOREIGN KEY Constraints”</a>.
        </p></li><li class="listitem"><p>
          Prior to MySQL 5.6.6, adding and dropping a foreign key in the
          same <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement may
          be problematic in some cases and is therefore unsupported.
          Separate statements should be used for each operation. As of
          MySQL 5.6.6, adding and dropping a foreign key in the same
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement is
          supported for
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ALGORITHM=INPLACE</code></a> but remains unsupported for
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
          ALGORITHM=COPY</code></a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153320752"></a>

          <a class="indexterm" name="idm139737153319680"></a>

          For an <code class="literal">InnoDB</code> table that is created with
          its own tablespace in an <code class="filename">.ibd</code> file, that
          file can be discarded and imported. To discard the
          <code class="filename">.ibd</code> file, use this statement:
        </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DISCARD TABLESPACE;
</pre><p>
          This deletes the current <code class="filename">.ibd</code> file, so be
          sure that you have a backup first. Attempting to modify the
          table contents while the tablespace file is discarded results
          in an error. You can perform the DDL operations listed in
          <a class="xref" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">Section 14.10, “InnoDB and Online DDL”</a> while the tablespace file
          is discarded.
        </p><p>
          To import the backup <code class="filename">.ibd</code> file back into
          the table, copy it into the database directory, and then issue
          this statement:
        </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> IMPORT TABLESPACE;
</pre><p>
          The tablespace file need not necessarily have been created on
          the server into which it is imported later. In MySQL
          5.6, importing a tablespace file from another
          server works if the both servers have GA (General
          Availablility) status and their versions are within the same
          series. Otherwise, the file must have been created on the
          server into which it is imported.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
            ... IMPORT TABLESPACE</code></a> feature does not enforce
            foreign key constraints on imported data.
</p>
</div>
<p>
          See <a class="xref" href="innodb-storage-engine.html#innodb-multiple-tablespaces" title="14.4.4 InnoDB File-Per-Table Tablespaces">Section 14.4.4, “InnoDB File-Per-Table Tablespaces”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737153305552"></a>

          To change the table default character set and all character
          columns (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) to a new character set,
          use a statement like this:
        </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
CONVERT TO CHARACTER SET <em class="replaceable"><code>charset_name</code></em> [COLLATE <em class="replaceable"><code>collation_name</code></em>];
</pre><p>
          The statement also changes the collation of all character
          columns. If you specify no <code class="literal">COLLATE</code> clause
          to indicate which collation to use, the statement uses default
          collation for the character set. If this collation is
          inappropriate for the intended table use (for example, if it
          would change from a case-sensitive collation to a
          case-insensitive collation), specify a collation explicitly.
        </p><p>
          For a column that has a data type of
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> or one of the
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> types, <code class="literal">CONVERT TO
          CHARACTER SET</code> will change the data type as necessary
          to ensure that the new column is long enough to store as many
          characters as the original column. For example, a
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column has two length
          bytes, which store the byte-length of values in the column, up
          to a maximum of 65,535. For a <code class="literal">latin1</code>
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column, each character
          requires a single byte, so the column can store up to 65,535
          characters. If the column is converted to
          <code class="literal">utf8</code>, each character might require up to
          three bytes, for a maximum possible length of 3 × 65,535
          = 196,605 bytes. That length will not fit in a
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column's length bytes, so
          MySQL will convert the data type to
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">MEDIUMTEXT</code></a>, which is the
          smallest string type for which the length bytes can record a
          value of 196,605. Similarly, a
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column might be
          converted to <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">MEDIUMTEXT</code></a>.
        </p><p>
          To avoid data type changes of the type just described, do not
          use <code class="literal">CONVERT TO CHARACTER SET</code>. Instead, use
          <code class="literal">MODIFY</code> to change individual columns. For
          example:
        </p><pre class="programlisting">
ALTER TABLE t MODIFY latin1_text_col TEXT CHARACTER SET utf8;
ALTER TABLE t MODIFY latin1_varchar_col VARCHAR(<em class="replaceable"><code>M</code></em>) CHARACTER SET utf8;
</pre><p>
          If you specify <code class="literal">CONVERT TO CHARACTER SET
          binary</code>, the <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns are converted to
          their corresponding binary string types
          (<a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>). This means that the
          columns no longer will have a character set and a subsequent
          <code class="literal">CONVERT TO</code> operation will not apply to
          them.
        </p><p>
          If <em class="replaceable"><code>charset_name</code></em> is
          <code class="literal">DEFAULT</code>, the database character set is
          used.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            The <code class="literal">CONVERT TO</code> operation converts column
            values between the character sets. This is
            <span class="emphasis"><em>not</em></span> what you want if you have a column
            in one character set (like <code class="literal">latin1</code>) but
            the stored values actually use some other, incompatible
            character set (like <code class="literal">utf8</code>). In this case,
            you have to do the following for each such column:
          </p><pre class="programlisting">
ALTER TABLE t1 CHANGE c1 c1 BLOB;
ALTER TABLE t1 CHANGE c1 c1 TEXT CHARACTER SET utf8;
</pre><p>
            The reason this works is that there is no conversion when
            you convert to or from <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
            columns.
</p>
</div>
<p>
          To change only the <span class="emphasis"><em>default</em></span> character set
          for a table, use this statement:
        </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DEFAULT CHARACTER SET <em class="replaceable"><code>charset_name</code></em>;
</pre><p>
          The word <code class="literal">DEFAULT</code> is optional. The default
          character set is the character set that is used if you do not
          specify the character set for columns that you add to a table
          later (for example, with <code class="literal">ALTER TABLE ... ADD
          column</code>).
</p></li></ul>
</div>
<a class="indexterm" name="idm139737153258096"></a><p>
      With the <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a> C API
      function, you can find out how many rows were copied by
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, and (when
      <code class="literal">IGNORE</code> is used) how many rows were deleted due
      to duplication of unique key values. See
      <a class="xref" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()">Section 23.8.7.35, “mysql_info()”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-partition-operations"></a>13.1.7.1 ALTER TABLE Partition Operations</h4>
</div>
</div>
</div>
<p>
        Partitioning-related clauses for <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> can be used with partitioned tables for
        repartitioning, for adding, dropping, merging, and splitting
        partitions, and for performing partitioning maintenance.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Simply using a <em class="replaceable"><code>partition_options</code></em>
            clause with <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
            partitioned table repartitions the table according to the
            partitioning scheme defined by the
            <em class="replaceable"><code>partition_options</code></em>. This clause
            always begins with <code class="literal">PARTITION BY</code>, and
            follows the same syntax and other rules as apply to the
            <em class="replaceable"><code>partition_options</code></em> clause for
            <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> (see
            <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>, for more detailed
            information), and can also be used to partition an existing
            table that is not already partitioned. For example, consider
            a (nonpartitioned) table defined as shown here:
          </p><pre class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
);
</pre><p>
            This table can be partitioned by <code class="literal">HASH</code>,
            using the <code class="literal">id</code> column as the partitioning
            key, into 8 partitions by means of this statement:
          </p><pre class="programlisting">
ALTER TABLE t1
    PARTITION BY HASH(id)
    PARTITIONS 8;
</pre><p>
            MySQL 5.6.11 and later supports an
            <code class="literal">ALGORITHM</code> option with
            <code class="literal">[SUB]PARTITION BY [LINEAR] KEY</code>.
            <code class="literal">ALGORITHM=1</code> causes the server to use the
            same key-hashing functions as MySQL 5.1 when computing the
            placement of rows in partitions;
            <code class="literal">ALGORITHM=2</code> means that the server employs
            the key-hashing functions implemented and used by default
            for new <code class="literal">KEY</code> partitioned tables in MySQL
            5.5 and later. (Partitioned tables created with the
            key-hashing functions employed in MySQL 5.5 and later cannot
            be used by a MySQL 5.1 server.) Not specifying the option
            has the same effect as using <code class="literal">ALGORITHM=2</code>.
            This option is intended for use chiefly when upgrading or
            downgrading <code class="literal">[LINEAR] KEY</code> partitioned
            tables between MySQL 5.1 and later MySQL versions, or for
            creating tables partitioned by <code class="literal">KEY</code> or
            <code class="literal">LINEAR KEY</code> on a MySQL 5.5 or later server
            which can be used on a MySQL 5.1 server.
          </p><p>
            To upgrade a <code class="literal">KEY</code> partitioned table that
            was created in MySQL 5.1, first execute
            <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> and note
            the exact columns and number of partitions shown. Now
            execute an <code class="literal">ALTER TABLE</code> statement using
            exactly the same column list and number of partitions as in
            the <code class="literal">CREATE TABLE</code> statement, while adding
            <code class="literal">ALGORITHM=2</code> immediately following the
            <code class="literal">PARTITION BY</code> keywords. (You should also
            include the <code class="literal">LINEAR</code> keyword if it was used
            for the original table definition.) An example from a
            session in the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client is shown
            here:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE p\G</code></strong>
*************************** 1. row ***************************
       Table: p
Create Table: CREATE TABLE `p` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `cd` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
/*!50100 <span class="emphasis"><em>PARTITION BY LINEAR KEY (id)
PARTITIONS 32</em></span> */
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE p</code></strong> <span class="emphasis"><em>PARTITION BY LINEAR KEY ALGORITHM=2 (id) PARTITIONS 32</em></span><strong class="userinput"><code>;</code></strong>
Query OK, 0 rows affected (5.34 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE p\G</code></strong>
*************************** 1. row ***************************
       Table: p
Create Table: CREATE TABLE `p` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `cd` datetime NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
/*!50100 PARTITION BY LINEAR KEY (id)
PARTITIONS 32 */
1 row in set (0.00 sec)
</pre><p>
            Downgrading a table created using the default key-hashing
            used in MySQL 5.5 and later to enable its use by a MySQL 5.1
            server is similar, except in this case you should use
            <code class="literal">ALGORITHM=1</code> to force the table's
            partitions to be rebuilt using the MySQL 5.1 key-hashing
            functions. It is recommended that you not do this except
            when necessary for compatibility with a MySQL 5.1 server, as
            the improved <code class="literal">KEY</code> hashing functions used
            by default in MySQL 5.5 and later provide fixes for a number
            of issues found in the older implementation.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              A table upgraded by means of <code class="literal">ALTER TABLE ...
              PARTITION BY ALGORITHM=2 [LINEAR] KEY ...</code> can no
              longer be used by a MySQL 5.1 server. (Such a table would
              need to be downgraded with <code class="literal">ALTER TABLE ...
              PARTITION BY ALGORITHM=1 [LINEAR] KEY ...</code> before
              it could be used again by a MySQL 5.1 server.)
</p>
</div>
<p>
            The table that results from using an <code class="literal">ALTER TABLE
            ... PARTITION BY</code> statement must follow the same
            rules as one created using <code class="literal">CREATE TABLE ...
            PARTITION BY</code>. This includes the rules governing
            the relationship between any unique keys (including any
            primary key) that the table might have, and the column or
            columns used in the partitioning expression, as discussed in
            <a class="xref" href="partitioning.html#partitioning-limitations-partitioning-keys-unique-keys" title="19.6.1 Partitioning Keys, Primary Keys, and Unique Keys">Section 19.6.1, “Partitioning Keys, Primary Keys, and Unique Keys”</a>.
            The <code class="literal">CREATE TABLE ... PARTITION BY</code> rules
            for specifying the number of partitions also apply to
            <code class="literal">ALTER TABLE ... PARTITION BY</code>.
          </p><p>
            The <em class="replaceable"><code>partition_definition</code></em> clause
            for <code class="literal">ALTER TABLE ADD PARTITION</code> supports
            the same options as the clause of the same name for the
            <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement. (See
            <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>, for the syntax and
            description.) Suppose that you have the partitioned table
            created as shown here:
          </p><pre class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999)
);
</pre><p>
            You can add a new partition <code class="literal">p3</code> to this
            table for storing values less than <code class="literal">2002</code>
            as follows:
          </p><pre class="programlisting">
ALTER TABLE t1 ADD PARTITION (PARTITION p3 VALUES LESS THAN (2002));
</pre><p>
            <code class="literal">DROP PARTITION</code> can be used to drop one or
            more <code class="literal">RANGE</code> or <code class="literal">LIST</code>
            partitions. This statement cannot be used with
            <code class="literal">HASH</code> or <code class="literal">KEY</code>
            partitions; instead, use <code class="literal">COALESCE
            PARTITION</code> (see below). Any data that was stored in
            the dropped partitions named in the
            <em class="replaceable"><code>partition_names</code></em> list is
            discarded. For example, given the table
            <code class="literal">t1</code> defined previously, you can drop the
            partitions named <code class="literal">p0</code> and
            <code class="literal">p1</code> as shown here:
          </p><pre class="programlisting">
ALTER TABLE t1 DROP PARTITION p0, p1;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              <code class="literal">DROP PARTITION</code> does not work with
              tables that use the <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>
              storage engine. See
              <a class="xref" href="partitioning.html#partitioning-management-range-list" title="19.3.1 Management of RANGE and LIST Partitions">Section 19.3.1, “Management of RANGE and LIST Partitions”</a>, and
              <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations" title="18.1.6 Known Limitations of MySQL Cluster">Section 18.1.6, “Known Limitations of MySQL Cluster”</a>.
</p>
</div>
<p>
            <code class="literal">ADD PARTITION</code> and <code class="literal">DROP
            PARTITION</code> do not currently support <code class="literal">IF
            [NOT] EXISTS</code>.
          </p><p>
            Renames of partitioned table are supported. You can rename
            individual partitions indirectly using <code class="literal">ALTER TABLE
            ... REORGANIZE PARTITION</code>; however, this operation
            makes a copy of the partition's data..
          </p><p>
            In MySQL 5.6, it is possible to delete rows
            from selected partitions using the <code class="literal">TRUNCATE
            PARTITION</code> option. This option takes a
            comma-separated list of one or more partition names. For
            example, consider the table <code class="literal">t1</code> as defined
            here:
          </p><pre class="programlisting">
CREATE TABLE t1 (
    id INT,
    year_col INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999),
    PARTITION p3 VALUES LESS THAN (2003),
    PARTITION p4 VALUES LESS THAN (2007)
);
</pre><p>
            To delete all rows from partition <code class="literal">p0</code>, you
            can use the following statement:
          </p><pre class="programlisting">
ALTER TABLE t1 TRUNCATE PARTITION p0;
</pre><p>
            The statement just shown has the same effect as the
            following <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement:
          </p><pre class="programlisting">
DELETE FROM t1 WHERE year_col &lt; 1991;
</pre><p>
            When truncating multiple partitions, the partitions do not
            have to be contiguous: This can greatly simplify delete
            operations on partitioned tables that would otherwise
            require very complex <code class="literal">WHERE</code> conditions if
            done with <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements.
            For example, this statement deletes all rows from partitions
            <code class="literal">p1</code> and <code class="literal">p3</code>:
          </p><pre class="programlisting">
ALTER TABLE t1 TRUNCATE PARTITION p1, p3;
</pre><p>
            An equivalent <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
            statement is shown here:
          </p><pre class="programlisting">
DELETE FROM t1 WHERE 
    (year_col &gt;= 1991 AND year_col &lt; 1995)
    OR
    (year_col &gt;= 2003 AND year_col &lt; 2007);
</pre><p>
            You can also use the <code class="literal">ALL</code> keyword in place
            of the list of partition names; in this case, the statement
            acts on all partitions in the table.
          </p><p>
            <code class="literal">TRUNCATE PARTITION</code> merely deletes rows;
            it does not alter the definition of the table itself, or of
            any of its partitions.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              <code class="literal">TRUNCATE PARTITION</code> does not work with
              subpartitions.
</p>
</div>
<p>
            You can verify that the rows were dropped by checking the
            <code class="literal">INFORMATION_SCHEMA.PARTITIONS</code> table,
            using a query such as this one:
          </p><pre class="programlisting">
SELECT PARTITION_NAME, TABLE_ROWS 
    FROM INFORMATION_SCHEMA.PARTITIONS 
    WHERE TABLE_NAME = 't1';
</pre><p>
            <code class="literal">TRUNCATE PARTITION</code> is supported only for
            partitioned tables that use the
            <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
            <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>, or
            <a class="link" href="storage-engines.html#memory-storage-engine" title="15.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a> storage engine. It also
            works on <a class="link" href="storage-engines.html#blackhole-storage-engine" title="15.6 The BLACKHOLE Storage Engine"><code class="literal">BLACKHOLE</code></a> tables (but
            has no effect). It is not supported for
            <a class="link" href="storage-engines.html#archive-storage-engine" title="15.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a> tables.
          </p><p>
            <code class="literal">COALESCE PARTITION</code> can be used with a
            table that is partitioned by <code class="literal">HASH</code> or
            <code class="literal">KEY</code> to reduce the number of partitions by
            <em class="replaceable"><code>number</code></em>. Suppose that you have
            created table <code class="literal">t2</code> using the following
            definition:
          </p><pre class="programlisting">
CREATE TABLE t2 (
    name VARCHAR (30),
    started DATE
)
PARTITION BY HASH( YEAR(started) )
PARTITIONS 6;
</pre><p>
            You can reduce the number of partitions used by
            <code class="literal">t2</code> from 6 to 4 using the following
            statement:
          </p><pre class="programlisting">
ALTER TABLE t2 COALESCE PARTITION 2;
</pre><p>
            The data contained in the last
            <em class="replaceable"><code>number</code></em> partitions will be merged
            into the remaining partitions. In this case, partitions 4
            and 5 will be merged into the first 4 partitions (the
            partitions numbered 0, 1, 2, and 3).
          </p><p>
            To change some but not all the partitions used by a
            partitioned table, you can use <code class="literal">REORGANIZE
            PARTITION</code>. This statement can be used in several
            ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                To merge a set of partitions into a single partition.
                This can be done by naming several partitions in the
                <em class="replaceable"><code>partition_names</code></em> list and
                supplying a single definition for
                <em class="replaceable"><code>partition_definition</code></em>.
              </p></li><li class="listitem"><p>
                To split an existing partition into several partitions.
                You can accomplish this by naming a single partition for
                <em class="replaceable"><code>partition_names</code></em> and providing
                multiple
                <em class="replaceable"><code>partition_definitions</code></em>.
              </p></li><li class="listitem"><p>
                To change the ranges for a subset of partitions defined
                using <code class="literal">VALUES LESS THAN</code> or the value
                lists for a subset of partitions defined using
                <code class="literal">VALUES IN</code>.
              </p></li><li class="listitem"><p>
                This statement may also be used without the
                <code class="literal"><em class="replaceable"><code>partition_names</code></em> INTO
                (<em class="replaceable"><code>partition_definitions</code></em>)</code>
                option on tables that are automatically partitioned
                using <code class="literal">HASH</code> partitioning to force
                redistribution of data. (Currently, only
                <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables are
                automatically partitioned in this way.) This is useful
                in MySQL Cluster where, after you have added new MySQL
                Cluster data nodes online to an existing MySQL Cluster,
                you wish to redistribute existing MySQL Cluster table
                data to the new data nodes. In such cases, you should
                invoke the statement with the <code class="literal">ONLINE</code>
                option; in other words, as shown here:
              </p><pre class="programlisting">
ALTER ONLINE TABLE <em class="replaceable"><code>table</code></em> REORGANIZE PARTITION;
</pre><p>
                You cannot perform other DDL concurrently with online
                table reorganization—that is, no other DDL
                statements can be issued while an <code class="literal">ALTER ONLINE
                TABLE ... REORGANIZE PARTITION</code> statement is
                executing. For more information about adding MySQL
                Cluster data nodes online, see
                <a class="xref" href="mysql-cluster.html#mysql-cluster-online-add-node" title="18.5.13 Adding MySQL Cluster Data Nodes Online">Section 18.5.13, “Adding MySQL Cluster Data Nodes Online”</a>.
              </p><p>
                <code class="literal">ALTER ONLINE TABLE ... REORGANIZE
                PARTITION</code> does not work with tables which were
                created using the <code class="literal">MAX_ROWS</code> option,
                because it uses the constant <code class="literal">MAX_ROWS</code>
                value specified in the original
                <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement to
                determine the number of partitions required, so no new
                partitions are created. You can use <code class="literal">ALTER
                ONLINE TABLE ...
                MAX_ROWS=<em class="replaceable"><code>rows</code></em></code> to
                increase the maximum number of rows for the table; after
                this, <code class="literal">ALTER ONLINE TABLE ... REORGANIZE
                PARTITION</code> can use this new, larger value to
                increase the number of partitions. The value of
                <em class="replaceable"><code>rows</code></em> must be greater than the
                value specified for <code class="literal">MAX_ROWS</code> in the
                original <code class="literal">CREATE TABLE</code> statement for
                this to work.
              </p><p>
                Attempting to use <code class="literal">REORGANIZE
                PARTITION</code> without the
                <code class="literal"><em class="replaceable"><code>partition_names</code></em> INTO
                (<em class="replaceable"><code>partition_definitions</code></em>)</code>
                option on explicitly partitioned tables results in the
                error <span class="errortext">REORGANIZE PARTITION without parameters
                can only be used on auto-partitioned tables using HASH
                partitioning</span>.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
              For partitions that have not been explicitly named, MySQL
              automatically provides the default names
              <code class="literal">p0</code>, <code class="literal">p1</code>,
              <code class="literal">p2</code>, and so on. The same is true with
              regard to subpartitions.
</p>
</div>
<p>
            For more detailed information about and examples of
            <code class="literal">ALTER TABLE ... REORGANIZE PARTITION</code>
            statements, see
            <a class="xref" href="partitioning.html#partitioning-management-range-list" title="19.3.1 Management of RANGE and LIST Partitions">Section 19.3.1, “Management of RANGE and LIST Partitions”</a>.
          </p></li><li class="listitem"><p>
            In MySQL 5.6, it is possible to exchange a
            table partition or subpartition with a table using the
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
            EXCHANGE PARTITION</code></a> statement—that is, to
            move any existing rows in the partition or subpartition to
            the nonpartitioned table, and any existing rows in the
            nonpartitioned table to the table partition or subpartition.
          </p><p>
            For usage information and examples, see
            <a class="xref" href="partitioning.html#partitioning-management-exchange" title="19.3.3 Exchanging Partitions and Subpartitions with Tables">Section 19.3.3, “Exchanging Partitions and Subpartitions with Tables”</a>.
          </p></li><li class="listitem"><p>
            Several additional options provide partition maintenance and
            repair functionality analogous to that implemented for
            nonpartitioned tables by statements such as
            <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> and
            <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> (which are also
            supported for partitioned tables; see
            <a class="xref" href="sql-syntax.html#table-maintenance-sql" title="13.7.2 Table Maintenance Statements">Section 13.7.2, “Table Maintenance Statements”</a> for more
            information). These include <code class="literal">ANALYZE
            PARTITION</code>, <code class="literal">CHECK PARTITION</code>,
            <code class="literal">OPTIMIZE PARTITION</code>, <code class="literal">REBUILD
            PARTITION</code>, and <code class="literal">REPAIR
            PARTITION</code>. Each of these options takes a
            <em class="replaceable"><code>partition_names</code></em> clause consisting
            of one or more names of partitions, separated by commas. The
            partitions must already exist in the table to be altered.
            You can also use the <code class="literal">ALL</code> keyword in place
            of <em class="replaceable"><code>partition_names</code></em>, in which case
            the statement acts on all partitions in the table. For more
            information and examples, see
            <a class="xref" href="partitioning.html#partitioning-maintenance" title="19.3.4 Maintenance of Partitions">Section 19.3.4, “Maintenance of Partitions”</a>.
          </p><p>
            Some MySQL storage engines, such as
            <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>, do not support
            per-partition optimization. For a partitioned table using
            such a storage engine, <code class="literal">ALTER TABLE ... OPTIMIZE
            PARTITION</code> rebuilds the entire table. This is a
            known issue. Beginning with MySQL 5.6.9, running this
            statement on such a table causes the entire table to rebuilt
            and analyzed, and an appropriate warning to be issued. (Bug
            #11751825, Bug #42822)
          </p><p>
            To work around this problem, use the statements
            <code class="literal">ALTER TABLE ... REBUILD PARTITION</code> and
            <code class="literal">ALTER TABLE ... ANALYZE PARTITION</code>
            instead.
          </p><p>
            The <code class="literal">ANALYZE PARTITION</code>, <code class="literal">CHECK
            PARTITION</code>, <code class="literal">OPTIMIZE PARTITION</code>,
            and <code class="literal">REPAIR PARTITION</code> options are not
            permitted for tables which are not partitioned.
          </p></li><li class="listitem"><p>
            <code class="literal">REMOVE PARTITIONING</code> enables you to remove
            a table's partitioning without otherwise affecting the table
            or its data. This option can be combined with other
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> options such as
            those used to add, drop, or rename columns or indexes.
          </p></li><li class="listitem"><p>
            Using the <code class="literal">ENGINE</code> option with
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> changes the
            storage engine used by the table without affecting the
            partitioning.
</p></li></ul>
</div>
<p>
        Prior to MySQL 5.6.6, when <code class="literal">ALTER TABLE ... EXCHANGE
        PARTITION</code> or <code class="literal">ALTER TABLE ... TRUNCATE
        PARTITION</code> was run against a partitioned table that
        used <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> (or another storage
        engine that makes use of table-level locking), the entire
        partitioned table was locked; in MySQL 5.6.6 and later, in such
        cases, only those partitions that are actually read from are
        locked. This did not (and does not) affect partitioned tables
        using a storage engine—such as
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>—that employs row-level
        locking. See <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
      </p><p>
        It is possible for an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statement to contain a <code class="literal">PARTITION BY</code> or
        <code class="literal">REMOVE PARTITIONING</code> clause in an addition to
        other alter specifications, but the <code class="literal">PARTITION
        BY</code> or <code class="literal">REMOVE PARTITIONING</code> clause
        must be specified last after any other specifications.
      </p><p>
        The <code class="literal">ADD PARTITION</code>, <code class="literal">DROP
        PARTITION</code>, <code class="literal">COALESCE PARTITION</code>,
        <code class="literal">REORGANIZE PARTITION</code>, <code class="literal">ANALYZE
        PARTITION</code>, <code class="literal">CHECK PARTITION</code>, and
        <code class="literal">REPAIR PARTITION</code> options cannot be combined
        with other alter specifications in a single <code class="literal">ALTER
        TABLE</code>, since the options just listed act on individual
        partitions. For more information, see
        <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.7.1 ALTER TABLE Partition Operations">Section 13.1.7.1, “ALTER TABLE Partition Operations”</a>.
      </p><p>
        Only a single instance of any one of the following options can
        be used in a given <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        statement: <code class="literal">PARTITION BY</code>, <code class="literal">ADD
        PARTITION</code>, <code class="literal">DROP PARTITION</code>,
        <code class="literal">TRUNCATE PARTITION</code>, <code class="literal">EXCHANGE
        PARTITION</code>, <code class="literal">REORGANIZE PARTITION</code>, or
        <code class="literal">COALESCE PARTITION</code>, <code class="literal">ANALYZE
        PARTITION</code>, <code class="literal">CHECK PARTITION</code>,
        <code class="literal">OPTIMIZE PARTITION</code>, <code class="literal">REBUILD
        PARTITION</code>, <code class="literal">REMOVE PARTITIONING</code>.
      </p><p>
        For example, the following two statements are invalid:
      </p><pre class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1, ANALYZE PARTITION p2;

ALTER TABLE t1 ANALYZE PARTITION p1, CHECK PARTITION p2;
</pre><p>
        In the first case, you can analyze partitions
        <code class="literal">p1</code> and <code class="literal">p2</code> of table
        <code class="literal">t1</code> concurrently using a single statement with
        a single <code class="literal">ANALYZE PARTITION</code> option that lists
        both of the partitions to be analyzed, like this:
      </p><pre class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1, p2;
</pre><p>
        In the second case, it is not possible to perform
        <code class="literal">ANALYZE</code> and <code class="literal">CHECK</code>
        operations on different partitions of the same table
        concurrently. Instead, you must issue two separate statements,
        like this:
      </p><pre class="programlisting">
ALTER TABLE t1 ANALYZE PARTITION p1;
ALTER TABLE t1 CHECK PARTITION p2;
</pre><p>
        <code class="literal">ANALYZE</code>, <code class="literal">CHECK</code>,
        <code class="literal">OPTIMIZE</code>, <code class="literal">REBUILD</code>,
        <code class="literal">REPAIR</code>, and <code class="literal">TRUNCATE</code>
        operations are not supported for subpartitions.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-online-operations"></a>13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster</h4>

</div>

</div>

</div>
<p>
        This section discusses online table schema changes as
        implemented in MySQL Cluster 5.1, using a syntax specific to
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> that is now deprecated and
        subject to removal in a future version of MySQL Cluster. This
        syntax is not supported by any other storage engine, including
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>. MySQL Cluster NDB 7.3 and
        later support the standard <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> syntax employed by the MySQL Server
        (<code class="literal">ALGORITHM=DEFAULT|INPLACE|COPY</code>), and
        described elsewhere in this section.
      </p><p>
        Operations that add and drop indexes on variable-width columns
        of <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables occur online. Online
        operations are noncopying; that is, they do not require that
        indexes be re-created. They do not lock the table being altered
        from access by other API nodes in a MySQL Cluster (but see
        <em class="citetitle">Limitations</em> later in this section). Such
        operations do not require single user mode for
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table alterations made in a
        cluster with multiple API nodes; transactions can continue
        uninterrupted during online DDL operations.
      </p><p>
        The <code class="literal">ONLINE</code> keyword can be used to perform
        online <code class="literal">ADD COLUMN</code>, <code class="literal">ADD
        INDEX</code> (including <code class="literal">CREATE INDEX</code>
        statements), and <code class="literal">DROP INDEX</code> operations on
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables. Online renaming of
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables is also supported.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <code class="literal">ONLINE</code> and <code class="literal">OFFLINE</code>
          keywords are supported only in MySQL Cluster. In standard
          MySQL Server 5.6 releases, attempting to use the
          <code class="literal">ONLINE</code> or <code class="literal">OFFLINE</code>
          keyword in an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
          <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>, or
          <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> statement results in
          an error.
        </p><p>
          The <code class="literal">ONLINE</code> and <code class="literal">OFFLINE</code>
          keywords are deprecated beginning with MySQL Cluster NDB 7.3.
          They continue to be supported in MySQL Cluster NDB 7.4, but
          are subject to removal in a future version of MySQL Cluster.
</p>
</div>
<p>
        Currently you cannot add disk-based columns to
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables online. This means that,
        if you wish to add an in-memory column to an
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table that uses a table-level
        <code class="literal">STORAGE DISK</code> option, you must declare the new
        column as using memory-based storage explicitly. For
        example—assuming that you have already created tablespace
        <code class="literal">ts1</code>—suppose that you create table
        <code class="literal">t1</code> as follows:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
     &gt;     <strong class="userinput"><code>c1 INT NOT NULL PRIMARY KEY,</code></strong>
     &gt;     <strong class="userinput"><code>c2 VARCHAR(30)</code></strong>
     &gt;     <strong class="userinput"><code>)</code></strong>
     &gt;     <strong class="userinput"><code>TABLESPACE ts1 STORAGE DISK</code></strong>
     &gt;     <strong class="userinput"><code>ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.73 sec)
Records: 0  Duplicates: 0  Warnings: 0
</pre><p>
        You can add a new in-memory column to this table online as shown
        here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t1 ADD COLUMN c3 INT COLUMN_FORMAT DYNAMIC STORAGE MEMORY;</code></strong>
Query OK, 0 rows affected (1.25 sec)
Records: 0  Duplicates: 0  Warnings: 0
</pre><p>
        This statement fails if the <code class="literal">STORAGE MEMORY</code>
        option is omitted:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t1 ADD COLUMN c3 INT COLUMN_FORMAT DYNAMIC;</code></strong>
<span class="errortext">ERROR 1235 (42000): This version of MySQL doesn't yet support
'ALTER ONLINE TABLE t1 ADD COLUMN c3 INT COLUMN_FORMAT DYNAMIC'</span>
</pre><p>
        If you omit the <code class="literal">COLUMN_FORMAT DYNAMIC</code> option,
        the dynamic column format is employed automatically, but a
        warning is issued, as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t1 ADD COLUMN c3 INT STORAGE MEMORY;</code></strong>
Query OK, 0 rows affected, 1 warning (1.17 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+---------------------------------------------------------------+
| Level   | Code | Message                                                       |
+---------+------+---------------------------------------------------------------+
| Warning | 1478 | Converted FIXED field to DYNAMIC to enable on-line ADD COLUMN |
+---------+------+---------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `c1` int(11) NOT NULL,
  `c2` varchar(30) DEFAULT NULL,
  `c3` int(11) /*!50120 STORAGE MEMORY */ /*!50120 COLUMN_FORMAT DYNAMIC */ DEFAULT NULL,
  `t4` int(11) /*!50120 STORAGE MEMORY */ DEFAULT NULL,
  PRIMARY KEY (`c1`)
) /*!50100 TABLESPACE ts_1 STORAGE DISK */ ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.03 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <code class="literal">STORAGE</code> and
          <code class="literal">COLUMN_FORMAT</code> keywords are supported only
          in MySQL Cluster; in any other version of MySQL, attempting to
          use either of these keywords in a <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a> or <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
          statement results in an error.
</p>
</div>
<p>
        It is also possible to use the statement <code class="literal">ALTER ONLINE
        TABLE ... REORGANIZE PARTITION</code> with no
        <code class="literal"><em class="replaceable"><code>partition_names</code></em> INTO
        (<em class="replaceable"><code>partition_definitions</code></em>)</code>
        option on <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables. This can be
        used to redistribute MySQL Cluster data among new data nodes
        that have been added to the cluster online. For more information
        about this statement, see
        <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.7.1 ALTER TABLE Partition Operations">Section 13.1.7.1, “ALTER TABLE Partition Operations”</a> For more
        information about adding data nodes online to a MySQL Cluster,
        see <a class="xref" href="mysql-cluster.html#mysql-cluster-online-add-node" title="18.5.13 Adding MySQL Cluster Data Nodes Online">Section 18.5.13, “Adding MySQL Cluster Data Nodes Online”</a>.
</p>
<h5><a name="alter-table-online-limitations"></a>Limitations of MySQL Cluster online operations</h5>
<p>
        Online <code class="literal">DROP COLUMN</code> operations are not
        supported.
      </p><p>
        Online <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
        <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>, or
        <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> statements that add
        columns or add or drop indexes are subject to the following
        limitations:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A given online <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
            can use only one of <code class="literal">ADD COLUMN</code>,
            <code class="literal">ADD INDEX</code>, or <code class="literal">DROP
            INDEX</code>. One or more columns can be added online in
            a single statement; only one index may be created or dropped
            online in a single statement.
          </p></li><li class="listitem"><p>
            The table being altered is not locked with respect to API
            nodes other than the one on which an online
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> <code class="literal">ADD
            COLUMN</code>, <code class="literal">ADD INDEX</code>, or
            <code class="literal">DROP INDEX</code> operation (or
            <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> or
            <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> statement) is run.
            However, the table is locked against any other operations
            originating on the <span class="emphasis"><em>same</em></span> API node while
            the online operation is being executed.
          </p></li><li class="listitem"><p>
            The table to be altered must have an explicit primary key;
            the hidden primary key created by the
            <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engine is not
            sufficient for this purpose.
          </p></li><li class="listitem"><p>
            The storage engine used by the table cannot be changed
            online.
          </p></li><li class="listitem"><p>
            When used with MySQL Cluster Disk Data tables, it is not
            possible to change the storage type (<code class="literal">DISK</code>
            or <code class="literal">MEMORY</code>) of a column online. This
            means, that when you add or drop an index in such a way that
            the operation would be performed online, and you want the
            storage type of the column or columns to be changed, you
            must use the <code class="literal">OFFLINE</code> keyword in the
            statement that adds or drops the index.
</p></li></ul>
</div>
<p>
        Columns to be added online cannot use the
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> type, and must meet the
        following criteria:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The columns must be dynamic; that is, it must be possible to
            create them using <code class="literal">COLUMN_FORMAT DYNAMIC</code>.
            If you omit the <code class="literal">COLUMN_FORMAT DYNAMIC</code>
            option, the dynamic column format is employed automatically.
          </p></li><li class="listitem"><p>
            The columns must permit <code class="literal">NULL</code> values and
            not have any explicit default value other than
            <code class="literal">NULL</code>. Columns added online are
            automatically created as <code class="literal">DEFAULT NULL</code>, as
            can be seen here:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
     &gt;     <strong class="userinput"><code>c1 INT NOT NULL AUTO_INCREMENT PRIMARY KEY</code></strong>
     &gt;     <strong class="userinput"><code>) ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (1.44 sec)

mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t1</code></strong>
     &gt;     <strong class="userinput"><code>ADD COLUMN c2 INT,</code></strong>
     &gt;     <strong class="userinput"><code>ADD COLUMN c3 INT;</code></strong>
Query OK, 0 rows affected, 2 warnings (0.93 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `c1` int(11) NOT NULL AUTO_INCREMENT,
  `c2` int(11) DEFAULT NULL,
  `c3` int(11) DEFAULT NULL,
  PRIMARY KEY (`c1`)
) ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.00 sec)
</pre></li><li class="listitem"><p>
            The columns must be added following any existing columns. If
            you attempt to add a column online before any existing
            columns or using the <code class="literal">FIRST</code> keyword, the
            statement fails with an error.
          </p></li><li class="listitem"><p>
            Existing table columns cannot be reordered online.
</p></li></ul>
</div>
<p>
        For online <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations
        on <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, fixed-format columns
        are converted to dynamic when they are added online, or when
        indexes are created or dropped online, as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
     &gt;     <strong class="userinput"><code>c1 INT NOT NULL AUTO_INCREMENT PRIMARY KEY</code></strong>
     &gt;     <strong class="userinput"><code>) ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (1.44 sec)

mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t1 ADD COLUMN c2 INT, ADD COLUMN c3 INT;</code></strong>
Query OK, 0 rows affected, 2 warnings (0.93 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+---------------------------------------------------------------+
| Level   | Code | Message                                                       |
+---------+------+---------------------------------------------------------------+
| Warning | 1475 | Converted FIXED field to DYNAMIC to enable on-line ADD COLUMN |
| Warning | 1475 | Converted FIXED field to DYNAMIC to enable on-line ADD COLUMN |
+---------+------+---------------------------------------------------------------+
2 rows in set (0.00 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Existing columns, including the table's primary key, need not
          be dynamic; only the column or columns to be added online must
          be dynamic.
</p>
</div>
<pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t2 (</code></strong>
     &gt;     <strong class="userinput"><code>c1 INT NOT NULL AUTO_INCREMENT PRIMARY KEY COLUMN_FORMAT FIXED</code></strong>
     &gt;     <strong class="userinput"><code>) ENGINE=NDB;</code></strong>
Query OK, 0 rows affected (2.10 sec)

mysql&gt; <strong class="userinput"><code>ALTER ONLINE TABLE t2 ADD COLUMN c2 INT;</code></strong>
Query OK, 0 rows affected, 1 warning (0.78 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+---------------------------------------------------------------+
| Level   | Code | Message                                                       |
+---------+------+---------------------------------------------------------------+
| Warning | 1475 | Converted FIXED field to DYNAMIC to enable on-line ADD COLUMN |
+---------+------+---------------------------------------------------------------+
1 row in set (0.00 sec)
</pre><p>
        Columns are not converted from <code class="literal">FIXED</code> to
        <code class="literal">DYNAMIC</code> column format by renaming operations.
        For more information about <code class="literal">COLUMN_FORMAT</code>, see
        <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>.
      </p><p>
        The <code class="literal">KEY</code>, <code class="literal">CONSTRAINT</code>, and
        <code class="literal">IGNORE</code> keywords are supported in
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statements using the
        <code class="literal">ONLINE</code> keyword.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-table-examples"></a>13.1.7.3 ALTER TABLE Examples</h4>

</div>

</div>

</div>
<p>
        Begin with a table <code class="literal">t1</code> that is created as
        shown here:
      </p><pre class="programlisting">
CREATE TABLE t1 (a INTEGER,b CHAR(10));
</pre><p>
        To rename the table from <code class="literal">t1</code> to
        <code class="literal">t2</code>:
      </p><pre class="programlisting">
ALTER TABLE t1 RENAME t2;
</pre><p>
        To change column <code class="literal">a</code> from
        <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INTEGER</code></a> to <code class="literal">TINYINT NOT
        NULL</code> (leaving the name the same), and to change column
        <code class="literal">b</code> from <code class="literal">CHAR(10)</code> to
        <code class="literal">CHAR(20)</code> as well as renaming it from
        <code class="literal">b</code> to <code class="literal">c</code>:
      </p><pre class="programlisting">
ALTER TABLE t2 MODIFY a TINYINT NOT NULL, CHANGE b c CHAR(20);
</pre><p>
        To add a new <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> column
        named <code class="literal">d</code>:
      </p><pre class="programlisting">
ALTER TABLE t2 ADD d TIMESTAMP;
</pre><p>
        To add an index on column <code class="literal">d</code> and a
        <code class="literal">UNIQUE</code> index on column <code class="literal">a</code>:
      </p><pre class="programlisting">
ALTER TABLE t2 ADD INDEX (d), ADD UNIQUE (a);
</pre><p>
        To remove column <code class="literal">c</code>:
      </p><pre class="programlisting">
ALTER TABLE t2 DROP COLUMN c;
</pre><p>
        To add a new <code class="literal">AUTO_INCREMENT</code> integer column
        named <code class="literal">c</code>:
      </p><pre class="programlisting">
ALTER TABLE t2 ADD c INT UNSIGNED NOT NULL AUTO_INCREMENT,
  ADD PRIMARY KEY (c);
</pre><p>
        We indexed <code class="literal">c</code> (as a <code class="literal">PRIMARY
        KEY</code>) because <code class="literal">AUTO_INCREMENT</code> columns
        must be indexed, and we declare <code class="literal">c</code> as
        <code class="literal">NOT NULL</code> because primary key columns cannot
        be <code class="literal">NULL</code>.
      </p><p>
        For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, it is also possible
        to change the storage type used for a table or column. For
        example, consider an <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table
        created as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT) TABLESPACE ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.27 sec)
</pre><p>
        To convert this table to disk-based storage, you can use the
        following <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 TABLESPACE ts_1 STORAGE DISK;</code></strong>
Query OK, 0 rows affected (2.99 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t1\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t1` (
  `c1` int(11) DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */
ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.01 sec)
</pre><p>
        It is not necessary that the tablespace was referenced when the
        table was originally created; however, the tablespace must be
        referenced by the <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t2 (c1 INT) ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE t2 STORAGE DISK;</code></strong>
<span class="errortext">ERROR 1005 (HY000): Can't create table 'c.#sql-1750_3' (errno: 140)</span>
mysql&gt; <strong class="userinput"><code>ALTER TABLE t2 TABLESPACE ts_1 STORAGE DISK;</code></strong>
Query OK, 0 rows affected (3.42 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t2\G</code></strong>
*************************** 1. row ***************************
       Table: t1
Create Table: CREATE TABLE `t2` (
  `c1` int(11) DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */
ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.01 sec)
</pre><p>
        To change the storage type of an individual column, you can use
        <code class="literal">ALTER TABLE ... MODIFY [COLUMN]</code>. For example,
        suppose you create a MySQL Cluster Disk Data table with two
        columns, using this <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t3 (c1 INT, c2 INT)</code></strong>
    -&gt;     <strong class="userinput"><code>TABLESPACE ts_1 STORAGE DISK ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.34 sec)
</pre><p>
        To change column <code class="literal">c2</code> from disk-based to
        in-memory storage, include a STORAGE MEMORY clause in the column
        definition used by the ALTER TABLE statement, as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE t3 MODIFY c2 INT STORAGE MEMORY;</code></strong>
Query OK, 0 rows affected (3.14 sec)
Records: 0  Duplicates: 0  Warnings: 0
</pre><p>
        You can make an in-memory column into a disk-based column by
        using <code class="literal">STORAGE DISK</code> in a similar fashion.
      </p><p>
        Column <code class="literal">c1</code> uses disk-based storage, since this
        is the default for the table (determined by the table-level
        <code class="literal">STORAGE DISK</code> clause in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement). However,
        column <code class="literal">c2</code> uses in-memory storage, as can be
        seen here in the output of SHOW <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
        TABLE</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t3\G</code></strong>
*************************** 1. row ***************************
       Table: t3
Create Table: CREATE TABLE `t3` (
  `c1` int(11) DEFAULT NULL,
  `c2` int(11) /*!50120 STORAGE MEMORY */ DEFAULT NULL
) /*!50100 TABLESPACE ts_1 STORAGE DISK */ ENGINE=ndbcluster DEFAULT CHARSET=latin1
1 row in set (0.02 sec)
</pre><p>
        When you add an <code class="literal">AUTO_INCREMENT</code> column, column
        values are filled in with sequence numbers automatically. For
        <code class="literal">MyISAM</code> tables, you can set the first sequence
        number by executing <code class="literal">SET
        INSERT_ID=<em class="replaceable"><code>value</code></em></code> before
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> or by using the
        <code class="literal">AUTO_INCREMENT=<em class="replaceable"><code>value</code></em></code>
        table option. See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
      </p><p>
        With <code class="literal">MyISAM</code> tables, if you do not change the
        <code class="literal">AUTO_INCREMENT</code> column, the sequence number is
        not affected. If you drop an <code class="literal">AUTO_INCREMENT</code>
        column and then add another <code class="literal">AUTO_INCREMENT</code>
        column, the numbers are resequenced beginning with 1.
      </p><p>
        When replication is used, adding an
        <code class="literal">AUTO_INCREMENT</code> column to a table might not
        produce the same ordering of the rows on the slave and the
        master. This occurs because the order in which the rows are
        numbered depends on the specific storage engine used for the
        table and the order in which the rows were inserted. If it is
        important to have the same order on the master and slave, the
        rows must be ordered before assigning an
        <code class="literal">AUTO_INCREMENT</code> number. Assuming that you want
        to add an <code class="literal">AUTO_INCREMENT</code> column to the table
        <code class="literal">t1</code>, the following statements produce a new
        table <code class="literal">t2</code> identical to <code class="literal">t1</code>
        but with an <code class="literal">AUTO_INCREMENT</code> column:
      </p><pre class="programlisting">
CREATE TABLE t2 (id INT AUTO_INCREMENT PRIMARY KEY)
SELECT * FROM t1 ORDER BY col1, col2;
</pre><p>
        This assumes that the table <code class="literal">t1</code> has columns
        <code class="literal">col1</code> and <code class="literal">col2</code>.
      </p><p>
        This set of statements will also produce a new table
        <code class="literal">t2</code> identical to <code class="literal">t1</code>, with
        the addition of an <code class="literal">AUTO_INCREMENT</code> column:
      </p><pre class="programlisting">
CREATE TABLE t2 LIKE t1;
ALTER TABLE t2 ADD id INT AUTO_INCREMENT PRIMARY KEY;
INSERT INTO t2 SELECT * FROM t1 ORDER BY col1, col2;
</pre>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          To guarantee the same ordering on both master and slave,
          <span class="emphasis"><em>all</em></span> columns of <code class="literal">t1</code> must
          be referenced in the <code class="literal">ORDER BY</code> clause.
</p>
</div>
<p>
        Regardless of the method used to create and populate the copy
        having the <code class="literal">AUTO_INCREMENT</code> column, the final
        step is to drop the original table and then rename the copy:
      </p><pre class="programlisting">
DROP TABLE t1;
ALTER TABLE t2 RENAME t1;
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-tablespace"></a>13.1.8 ALTER TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152836192"></a><pre class="programlisting">
ALTER TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>
    {ADD|DROP} DATAFILE '<em class="replaceable"><code>file_name</code></em>'
    [INITIAL_SIZE [=] <em class="replaceable"><code>size</code></em>]
    [WAIT]
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement can be used either to add a new data file, or to
      drop a data file from a tablespace.
    </p><p>
      The <code class="literal">ADD DATAFILE</code> variant enables you to specify
      an initial size using an <code class="literal">INITIAL_SIZE</code> clause,
      where <em class="replaceable"><code>size</code></em> is measured in bytes; the
      default value is 134217728 (128 MB). Prior to MySQL Cluster NDB
      7.3.2, this value was required to be specified using digits (Bug
      #13116514, Bug #16104705, Bug #62858); in MySQL Cluster NDB 7.3.2
      and later, you may optionally follow
      <em class="replaceable"><code>size</code></em> with a one-letter abbreviation for
      an order of magnitude, similar to those used in
      <code class="filename">my.cnf</code>. Generally, this is one of the letters
      <code class="literal">M</code> (megabytes) or <code class="literal">G</code>
      (gigabytes).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All MySQL Cluster Disk Data objects share the same namespace.
        This means that <span class="emphasis"><em>each Disk Data object</em></span> must
        be uniquely named (and not merely each Disk Data object of a
        given type). For example, you cannot have a tablespace and an
        data file with the same name, or an undo log file and a
        tablespace with the same name.
</p>
</div>
<p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      <code class="literal">INITIAL_SIZE</code> is rounded, explicitly, as for
      <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>.
    </p><p>
      Once a data file has been created, its size cannot be changed;
      however, you can add more data files to the tablespace using
      additional <code class="literal">ALTER TABLESPACE ... ADD DATAFILE</code>
      statements.
    </p><p>
      Using <code class="literal">DROP DATAFILE</code> with
      <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a> drops the data
      file '<em class="replaceable"><code>file_name</code></em>' from the tablespace.
      You cannot drop a data file from a tablespace which is in use by
      any table; in other words, the data file must be empty (no extents
      used). See <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data-objects" title="18.5.12.1 MySQL Cluster Disk Data Objects">Section 18.5.12.1, “MySQL Cluster Disk Data Objects”</a>. In
      addition, any data file to be dropped must previously have been
      added to the tablespace with <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE
      TABLESPACE</code></a> or <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax"><code class="literal">ALTER
      TABLESPACE</code></a>.
    </p><p>
      Both <code class="literal">ALTER TABLESPACE ... ADD DATAFILE</code> and
      <code class="literal">ALTER TABLESPACE ... DROP DATAFILE</code> require an
      <code class="literal">ENGINE</code> clause which specifies the storage
      engine used by the tablespace. Currently, the only accepted values
      for <em class="replaceable"><code>engine_name</code></em> are
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> and
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>.
    </p><p>
      <code class="literal">WAIT</code> is parsed but otherwise ignored, and so
      has no effect in MySQL 5.6. It is intended for future
      expansion.
    </p><p>
      When <code class="literal">ALTER TABLESPACE ... ADD DATAFILE</code> is used
      with <code class="literal">ENGINE = NDB</code>, a data file is created on
      each Cluster data node. You can verify that the data files were
      created and obtain information about them by querying the
      <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. For
      example, the following query shows all data files belonging to the
      tablespace named <code class="literal">newts</code>:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOGFILE_GROUP_NAME, FILE_NAME, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLESPACE_NAME = 'newts' AND FILE_TYPE = 'DATAFILE';</code></strong>
+--------------------+--------------+----------------+
| LOGFILE_GROUP_NAME | FILE_NAME    | EXTRA          |
+--------------------+--------------+----------------+
| lg_3               | newdata.dat  | CLUSTER_NODE=3 |
| lg_3               | newdata.dat  | CLUSTER_NODE=4 |
| lg_3               | newdata2.dat | CLUSTER_NODE=3 |
| lg_3               | newdata2.dat | CLUSTER_NODE=4 |
+--------------------+--------------+----------------+
2 rows in set (0.03 sec)
</pre><p>
      See <a class="xref" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table">Section 21.30.1, “The INFORMATION_SCHEMA FILES Table”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a> is useful only
      with Disk Data storage for MySQL Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="alter-view"></a>13.1.9 ALTER VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152791312"></a><pre class="programlisting">
ALTER
    [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    [SQL SECURITY { DEFINER | INVOKER }]
    VIEW <em class="replaceable"><code>view_name</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
    AS <em class="replaceable"><code>select_statement</code></em>
    [WITH [CASCADED | LOCAL] CHECK OPTION]
</pre><p>
      This statement changes the definition of a view, which must exist.
      The syntax is similar to that for <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE
      VIEW</code></a> and the effect is the same as for
      <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE OR REPLACE
      VIEW</code></a>. See <a class="xref" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax">Section 13.1.20, “CREATE VIEW Syntax”</a>. This statement
      requires the <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a> and
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privileges for the view, and
      some privilege for each column referred to in the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
      <a class="link" href="sql-syntax.html#alter-view" title="13.1.9 ALTER VIEW Syntax"><code class="literal">ALTER VIEW</code></a> is permitted only to the
      definer or users with the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
      privilege.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-database"></a>13.1.10 CREATE DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152773344"></a><a class="indexterm" name="idm139737152771856"></a><a class="indexterm" name="idm139737152770784"></a><a class="indexterm" name="idm139737152769712"></a><a class="indexterm" name="idm139737152768224"></a><a class="indexterm" name="idm139737152766736"></a><a class="indexterm" name="idm139737152765248"></a><pre class="programlisting">
CREATE {DATABASE | SCHEMA} [IF NOT EXISTS] <em class="replaceable"><code>db_name</code></em>
    [<em class="replaceable"><code>create_specification</code></em>] ...

<em class="replaceable"><code>create_specification</code></em>:
    [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> creates a database
      with the given name. To use this statement, you need the
      <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> privilege for the database.
      <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE
      DATABASE</code></a>.
    </p><p>
      An error occurs if the database exists and you did not specify
      <code class="literal">IF NOT EXISTS</code>.
    </p><p>
      In MySQL 5.6, <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE
      DATABASE</code></a> is not permitted within a session that has an
      active <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement.
    </p><p>
      <em class="replaceable"><code>create_specification</code></em> options specify
      database characteristics. Database characteristics are stored in
      the <code class="filename">db.opt</code> file in the database directory.
      The <code class="literal">CHARACTER SET</code> clause specifies the default
      database character set. The <code class="literal">COLLATE</code> clause
      specifies the default database collation.
      <a class="xref" href="globalization.html#charset" title="10.1 Character Set Support">Section 10.1, “Character Set Support”</a>, discusses character set and collation
      names.
    </p><p>
      A database in MySQL is implemented as a directory containing files
      that correspond to tables in the database. Because there are no
      tables in a database when it is initially created, the
      <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a> statement creates
      only a directory under the MySQL data directory and the
      <code class="filename">db.opt</code> file. Rules for permissible database
      names are given in <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>. If a database
      name contains special characters, the name for the database
      directory contains encoded versions of those characters as
      described in <a class="xref" href="language-structure.html#identifier-mapping" title="9.2.3 Mapping of Identifiers to File Names">Section 9.2.3, “Mapping of Identifiers to File Names”</a>.
    </p><p>
      If you manually create a directory under the data directory (for
      example, with <span class="command"><strong>mkdir</strong></span>), the server considers it a
      database directory and it shows up in the output of
      <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a>.
    </p><a class="indexterm" name="idm139737152737520"></a><p>
      You can also use the <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a> program to
      create databases. See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-event"></a>13.1.11 CREATE EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152732848"></a><a class="indexterm" name="idm139737152731360"></a><a class="indexterm" name="idm139737152729872"></a><pre class="programlisting">
CREATE
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    EVENT
    [IF NOT EXISTS]
    <em class="replaceable"><code>event_name</code></em>
    ON SCHEDULE <em class="replaceable"><code>schedule</code></em>
    [ON COMPLETION [NOT] PRESERVE]
    [ENABLE | DISABLE | DISABLE ON SLAVE]
    [COMMENT '<em class="replaceable"><code>comment</code></em>']
    DO <em class="replaceable"><code>event_body</code></em>;

<em class="replaceable"><code>schedule</code></em>:
    AT <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...
  | EVERY <em class="replaceable"><code>interval</code></em>
    [STARTS <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...]
    [ENDS <em class="replaceable"><code>timestamp</code></em> [+ INTERVAL <em class="replaceable"><code>interval</code></em>] ...]

<em class="replaceable"><code>interval</code></em>:
    <em class="replaceable"><code>quantity</code></em> {YEAR | QUARTER | MONTH | DAY | HOUR | MINUTE |
              WEEK | SECOND | YEAR_MONTH | DAY_HOUR | DAY_MINUTE |
              DAY_SECOND | HOUR_MINUTE | HOUR_SECOND | MINUTE_SECOND}
</pre><p>
      This statement creates and schedules a new event. The event will
      not run unless the Event Scheduler is enabled. For information
      about checking Event Scheduler status and enabling it if
      necessary, see <a class="xref" href="stored-programs-views.html#events-configuration" title="20.4.2 Event Scheduler Configuration">Section 20.4.2, “Event Scheduler Configuration”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> requires the
      <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege for the schema in
      which the event is to be created. It might also require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, depending on the
      <code class="literal">DEFINER</code> value, as described later in this
      section.
    </p><p>
      The minimum requirements for a valid <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> statement are as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The keywords <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> plus
          an event name, which uniquely identifies the event in a
          database schema.
        </p></li><li class="listitem"><p>
          An <code class="literal">ON SCHEDULE</code> clause, which determines
          when and how often the event executes.
        </p></li><li class="listitem"><p>
          A <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause, which contains the
          SQL statement to be executed by an event.
</p></li></ul>
</div>
<p>
      This is an example of a minimal <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE
      EVENT</code></a> statement:
    </p><pre class="programlisting">
CREATE EVENT myevent
    ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 HOUR
    DO
      UPDATE myschema.mytable SET mycol = mycol + 1;
</pre><p>
      The previous statement creates an event named
      <code class="literal">myevent</code>. This event executes once—one
      hour following its creation—by running an SQL statement that
      increments the value of the <code class="literal">myschema.mytable</code>
      table's <code class="literal">mycol</code> column by 1.
    </p><p>
      The <em class="replaceable"><code>event_name</code></em> must be a valid MySQL
      identifier with a maximum length of 64 characters. Event names are
      not case sensitive, so you cannot have two events named
      <code class="literal">myevent</code> and <code class="literal">MyEvent</code> in the
      same schema. In general, the rules governing event names are the
      same as those for names of stored routines. See
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
    </p><p>
      An event is associated with a schema. If no schema is indicated as
      part of <em class="replaceable"><code>event_name</code></em>, the default
      (current) schema is assumed. To create an event in a specific
      schema, qualify the event name with a schema using
      <code class="literal"><em class="replaceable"><code>schema_name</code></em>.<em class="replaceable"><code>event_name</code></em></code>
      syntax.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at event execution
      time. If a <em class="replaceable"><code>user</code></em> value is given, it
      should be a MySQL account specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
      (the same format used in the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
      statement), <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The default
      <code class="literal">DEFINER</code> value is the user who executes the
      <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statement. This is the
      same as specifying <code class="literal">DEFINER = CURRENT_USER</code>
      explicitly.
    </p><p>
      If you specify the <code class="literal">DEFINER</code> clause, these rules
      determine the valid <code class="literal">DEFINER</code> user values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you do not have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, the only permitted <em class="replaceable"><code>user</code></em>
          value is your own account, either specified literally or by
          using <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>. You cannot
          set the definer to some other account.
        </p></li><li class="listitem"><p>
          If you have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, you can specify any syntactically valid account
          name. If the account does not exist, a warning is generated.
        </p></li><li class="listitem"><p>
          Although it is possible to create an event with a nonexistent
          <code class="literal">DEFINER</code> account, an error occurs at event
          execution time if the account does not exist.
</p></li></ul>
</div>
<p>
      For more information about event security, see
      <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.
    </p><p>
      Within an event, the <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>
      function returns the account used to check privileges at event
      execution time, which is the <code class="literal">DEFINER</code> user. For
      information about user auditing within events, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.3.14 SQL-Based MySQL Account Activity Auditing">Section 6.3.14, “SQL-Based MySQL Account Activity Auditing”</a>.
    </p><p>
      <code class="literal">IF NOT EXISTS</code> has the same meaning for
      <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> as for
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>: If an event named
      <em class="replaceable"><code>event_name</code></em> already exists in the same
      schema, no action is taken, and no error results. (However, a
      warning is generated in such cases.)
    </p><p>
      The <code class="literal">ON SCHEDULE</code> clause determines when, how
      often, and for how long the <em class="replaceable"><code>event_body</code></em>
      defined for the event repeats. This clause takes one of two forms:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">AT <em class="replaceable"><code>timestamp</code></em></code> is
          used for a one-time event. It specifies that the event
          executes one time only at the date and time given by
          <em class="replaceable"><code>timestamp</code></em>, which must include both
          the date and time, or must be an expression that resolves to a
          datetime value. You may use a value of either the
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> or
          <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> type for this
          purpose. If the date is in the past, a warning occurs, as
          shown here:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT NOW();</code></strong>
+---------------------+
| NOW()               |
+---------------------+
| 2006-02-10 23:59:01 |
+---------------------+
1 row in set (0.04 sec)

mysql&gt; <strong class="userinput"><code>CREATE EVENT e_totals</code></strong>
    -&gt;     <strong class="userinput"><code>ON SCHEDULE AT '2006-02-10 23:59:00'</code></strong>
    -&gt;     <strong class="userinput"><code>DO INSERT INTO test.totals VALUES (NOW());</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Note
   Code: 1588
Message: Event execution time is in the past and ON COMPLETION NOT
         PRESERVE is set. The event was dropped immediately after
         creation.
</pre><p>
          <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statements which
          are themselves invalid—for whatever reason—fail
          with an error.
        </p><p>
          You may use <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP</code></a>
          to specify the current date and time. In such a case, the
          event acts as soon as it is created.
        </p><p>
          To create an event which occurs at some point in the future
          relative to the current date and time—such as that
          expressed by the phrase <span class="quote">“<span class="quote">three weeks from
          now</span>”</span>—you can use the optional clause <code class="literal">+
          INTERVAL <em class="replaceable"><code>interval</code></em></code>. The
          <em class="replaceable"><code>interval</code></em> portion consists of two
          parts, a quantity and a unit of time, and follows the same
          syntax rules that govern intervals used in the
          <a class="link" href="functions.html#function_date-add"><code class="literal">DATE_ADD()</code></a> function (see
          <a class="xref" href="functions.html#date-and-time-functions" title="12.7 Date and Time Functions">Section 12.7, “Date and Time Functions”</a>. The units keywords
          are also the same, except that you cannot use any units
          involving microseconds when defining an event. With some
          interval types, complex time units may be used. For example,
          <span class="quote">“<span class="quote">two minutes and ten seconds</span>”</span> can be expressed as
          <code class="literal">+ INTERVAL '2:10' MINUTE_SECOND</code>.
        </p><p>
          You can also combine intervals. For example, <code class="literal">AT
          CURRENT_TIMESTAMP + INTERVAL 3 WEEK + INTERVAL 2 DAY</code>
          is equivalent to <span class="quote">“<span class="quote">three weeks and two days from
          now</span>”</span>. Each portion of such a clause must begin with
          <code class="literal">+ INTERVAL</code>.
        </p></li><li class="listitem"><p>
          To repeat actions at a regular interval, use an
          <code class="literal">EVERY</code> clause. The <code class="literal">EVERY</code>
          keyword is followed by an <em class="replaceable"><code>interval</code></em>
          as described in the previous discussion of the
          <code class="literal">AT</code> keyword. (<code class="literal">+ INTERVAL</code>
          is <span class="emphasis"><em>not</em></span> used with
          <code class="literal">EVERY</code>.) For example, <code class="literal">EVERY 6
          WEEK</code> means <span class="quote">“<span class="quote">every six weeks</span>”</span>.
        </p><p>
          Although <code class="literal">+ INTERVAL</code> clauses are not
          permitted in an <code class="literal">EVERY</code> clause, you can use
          the same complex time units permitted in a <code class="literal">+
          INTERVAL</code>.
        </p><p>
          An <code class="literal">EVERY</code> clause may contain an optional
          <code class="literal">STARTS</code> clause. <code class="literal">STARTS</code> is
          followed by a <em class="replaceable"><code>timestamp</code></em> value that
          indicates when the action should begin repeating, and may also
          use <code class="literal">+ INTERVAL
          <em class="replaceable"><code>interval</code></em></code> to specify an
          amount of time <span class="quote">“<span class="quote">from now</span>”</span>. For example,
          <code class="literal">EVERY 3 MONTH STARTS CURRENT_TIMESTAMP + INTERVAL 1
          WEEK</code> means <span class="quote">“<span class="quote">every three months, beginning one
          week from now</span>”</span>. Similarly, you can express <span class="quote">“<span class="quote">every
          two weeks, beginning six hours and fifteen minutes from
          now</span>”</span> as <code class="literal">EVERY 2 WEEK STARTS CURRENT_TIMESTAMP
          + INTERVAL '6:15' HOUR_MINUTE</code>. Not specifying
          <code class="literal">STARTS</code> is the same as using <code class="literal">STARTS
          CURRENT_TIMESTAMP</code>—that is, the action
          specified for the event begins repeating immediately upon
          creation of the event.
        </p><p>
          An <code class="literal">EVERY</code> clause may contain an optional
          <code class="literal">ENDS</code> clause. The <code class="literal">ENDS</code>
          keyword is followed by a <em class="replaceable"><code>timestamp</code></em>
          value that tells MySQL when the event should stop repeating.
          You may also use <code class="literal">+ INTERVAL
          <em class="replaceable"><code>interval</code></em></code> with
          <code class="literal">ENDS</code>; for instance, <code class="literal">EVERY 12 HOUR
          STARTS CURRENT_TIMESTAMP + INTERVAL 30 MINUTE ENDS
          CURRENT_TIMESTAMP + INTERVAL 4 WEEK</code> is equivalent to
          <span class="quote">“<span class="quote">every twelve hours, beginning thirty minutes from now,
          and ending four weeks from now</span>”</span>. Not using
          <code class="literal">ENDS</code> means that the event continues
          executing indefinitely.
        </p><p>
          <code class="literal">ENDS</code> supports the same syntax for complex
          time units as <code class="literal">STARTS</code> does.
        </p><p>
          You may use <code class="literal">STARTS</code>,
          <code class="literal">ENDS</code>, both, or neither in an
          <code class="literal">EVERY</code> clause.
        </p><p>
          If a repeating event does not terminate within its scheduling
          interval, the result may be multiple instances of the event
          executing simultaneously. If this is undesirable, you should
          institute a mechanism to prevent simultaneous instances. For
          example, you could use the
          <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> function, or row or
          table locking.
</p></li></ul>
</div>
<p>
      The <code class="literal">ON SCHEDULE</code> clause may use expressions
      involving built-in MySQL functions and user variables to obtain
      any of the <em class="replaceable"><code>timestamp</code></em> or
      <em class="replaceable"><code>interval</code></em> values which it contains. You
      may not use stored functions or user-defined functions in such
      expressions, nor may you use any table references; however, you
      may use <code class="literal">SELECT FROM DUAL</code>. This is true for both
      <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> and
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statements. References
      to stored functions, user-defined functions, and tables in such
      cases are specifically not permitted, and fail with an error (see
      Bug #22830).
    </p><p>
      Times in the <code class="literal">ON SCHEDULE</code> clause are interpreted
      using the current session
      <a class="link" href="server-administration.html#sysvar_time_zone"><code class="literal">time_zone</code></a> value. This becomes the
      event time zone; that is, the time zone that is used for event
      scheduling and is in effect within the event as it executes. These
      times are converted to UTC and stored along with the event time
      zone in the <code class="literal">mysql.event</code> table. This enables
      event execution to proceed as defined regardless of any subsequent
      changes to the server time zone or daylight saving time effects.
      For additional information about representation of event times,
      see <a class="xref" href="stored-programs-views.html#events-metadata" title="20.4.4 Event Metadata">Section 20.4.4, “Event Metadata”</a>. See also
      <a class="xref" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax">Section 13.7.5.19, “SHOW EVENTS Syntax”</a>, and <a class="xref" href="information-schema.html#events-table" title="21.7 The INFORMATION_SCHEMA EVENTS Table">Section 21.7, “The INFORMATION_SCHEMA EVENTS Table”</a>.
    </p><p>
      Normally, once an event has expired, it is immediately dropped.
      You can override this behavior by specifying <code class="literal">ON
      COMPLETION PRESERVE</code>. Using <code class="literal">ON COMPLETION NOT
      PRESERVE</code> merely makes the default nonpersistent behavior
      explicit.
    </p><p>
      You can create an event but prevent it from being active using the
      <code class="literal">DISABLE</code> keyword. Alternatively, you can use
      <code class="literal">ENABLE</code> to make explicit the default status,
      which is active. This is most useful in conjunction with
      <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> (see
      <a class="xref" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax">Section 13.1.2, “ALTER EVENT Syntax”</a>).
    </p><p>
      A third value may also appear in place of
      <code class="literal">ENABLE</code> or <code class="literal">DISABLE</code>;
      <code class="literal">DISABLE ON SLAVE</code> is set for the status of an
      event on a replication slave to indicate that the event was
      created on the master and replicated to the slave, but is not
      executed on the slave. See
      <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.11 Replication of Invoked Features">Section 17.4.1.11, “Replication of Invoked Features”</a>.
    </p><p>
      You may supply a comment for an event using a
      <code class="literal">COMMENT</code> clause.
      <em class="replaceable"><code>comment</code></em> may be any string of up to 64
      characters that you wish to use for describing the event. The
      comment text, being a string literal, must be surrounded by
      quotation marks.
    </p><p>
      The <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause specifies an action
      carried by the event, and consists of an SQL statement. Nearly any
      valid MySQL statement that can be used in a stored routine can
      also be used as the action statement for a scheduled event. (See
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.) For example, the
      following event <code class="literal">e_hourly</code> deletes all rows from
      the <code class="literal">sessions</code> table once per hour, where this
      table is part of the <code class="literal">site_activity</code> schema:
    </p><pre class="programlisting">
CREATE EVENT e_hourly
    ON SCHEDULE
      EVERY 1 HOUR
    COMMENT 'Clears out sessions table each hour.'
    DO
      DELETE FROM site_activity.sessions;
</pre><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when an event is created or altered,
      and always executes the event with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the event
      begins executing</em></span>.
    </p><p>
      A <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a> statement that
      contains an <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a> statement
      in its <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause appears to
      succeed; however, when the server attempts to execute the
      resulting scheduled event, the execution fails with an error.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Statements such as <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> or
        <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> that merely return a result
        set have no effect when used in an event; the output from these
        is not sent to the MySQL Monitor, nor is it stored anywhere.
        However, you can use statements such as
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT ...
        INTO</code></a> and
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
        SELECT</code></a> that store a result. (See the next example in
        this section for an instance of the latter.)
</p>
</div>
<p>
      The schema to which an event belongs is the default schema for
      table references in the <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause.
      Any references to tables in other schemas must be qualified with
      the proper schema name.
    </p><p>
      As with stored routines, you can use compound-statement syntax in
      the <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> clause by using the
      <code class="literal">BEGIN</code> and <code class="literal">END</code> keywords, as
      shown here:
    </p><pre class="programlisting">
delimiter |

CREATE EVENT e_daily
    ON SCHEDULE
      EVERY 1 DAY
    COMMENT 'Saves total number of sessions then clears the table each day'
    DO
      BEGIN
        INSERT INTO site_activity.totals (time, total)
          SELECT CURRENT_TIMESTAMP, COUNT(*)
            FROM site_activity.sessions;
        DELETE FROM site_activity.sessions;
      END |

delimiter ;
</pre><p>
      This example uses the <code class="literal">delimiter</code> command to
      change the statement delimiter. See
      <a class="xref" href="stored-programs-views.html#stored-programs-defining" title="20.1 Defining Stored Programs">Section 20.1, “Defining Stored Programs”</a>.
    </p><p>
      More complex compound statements, such as those used in stored
      routines, are possible in an event. This example uses local
      variables, an error handler, and a flow control construct:
    </p><pre class="programlisting">
delimiter |

CREATE EVENT e
    ON SCHEDULE
      EVERY 5 SECOND
    DO
      BEGIN
        DECLARE v INTEGER;
        DECLARE CONTINUE HANDLER FOR SQLEXCEPTION BEGIN END;

        SET v = 0;

        WHILE v &lt; 5 DO
          INSERT INTO t1 VALUES (0);
          UPDATE t2 SET s1 = s1 + 1;
          SET v = v + 1;
        END WHILE;
    END |

delimiter ;
</pre><p>
      There is no way to pass parameters directly to or from events;
      however, it is possible to invoke a stored routine with parameters
      within an event:
    </p><pre class="programlisting">
CREATE EVENT e_call_myproc
    ON SCHEDULE
      AT CURRENT_TIMESTAMP + INTERVAL 1 DAY
    DO CALL myproc(5, 27);
</pre><p>
      If an event's definer has the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
      privilege, the event can read and write global variables. As
      granting this privilege entails a potential for abuse, extreme
      care must be taken in doing so.
    </p><p>
      Generally, any statements that are valid in stored routines may be
      used for action statements executed by events. For more
      information about statements permitted within stored routines, see
      <a class="xref" href="stored-programs-views.html#stored-routines-syntax" title="20.2.1 Stored Routine Syntax">Section 20.2.1, “Stored Routine Syntax”</a>. You can create an event
      as part of a stored routine, but an event cannot be created by
      another event.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-function"></a>13.1.12 CREATE FUNCTION Syntax</h3>

</div>

</div>

</div>
<p>
      The <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement is
      used to create stored functions and user-defined functions (UDFs):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For information about creating stored functions, see
          <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.15, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.
        </p></li><li class="listitem"><p>
          For information about creating user-defined functions, see
          <a class="xref" href="sql-syntax.html#create-function-udf" title="13.7.3.1 CREATE FUNCTION Syntax for User-Defined Functions">Section 13.7.3.1, “CREATE FUNCTION Syntax for User-Defined Functions”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-index"></a>13.1.13 CREATE INDEX Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152542432"></a><a class="indexterm" name="idm139737152541360"></a><a class="indexterm" name="idm139737152540288"></a><a class="indexterm" name="idm139737152538800"></a><pre class="programlisting">
CREATE [ONLINE|OFFLINE] [UNIQUE|FULLTEXT|SPATIAL] INDEX <em class="replaceable"><code>index_name</code></em>
    [<em class="replaceable"><code>index_type</code></em>]
    ON <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>index_col_name</code></em>,...)
    [<em class="replaceable"><code>index_option</code></em>]
    [<em class="replaceable"><code>algorithm_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

<em class="replaceable"><code>index_col_name</code></em>:
    <em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] [ASC | DESC]

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'

<em class="replaceable"><code>algorithm_option</code></em>:
    ALGORITHM [=] {DEFAULT|INPLACE|COPY}

<em class="replaceable"><code>lock_option</code></em>:
    LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
</pre><p>
      <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> is mapped to an
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement to create
      indexes. See <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>.
      <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> cannot be used to
      create a <code class="literal">PRIMARY KEY</code>; use
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> instead. For more
      information about indexes, see <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 How MySQL Uses Indexes">Section 8.3.1, “How MySQL Uses Indexes”</a>.
    </p><p>
      Normally, you create all indexes on a table at the time the table
      itself is created with <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
      TABLE</code></a>. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>. This
      guideline is especially important for <code class="literal">InnoDB</code>
      tables, where the primary key determines the physical layout of
      rows in the data file. <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>
      enables you to add indexes to existing tables.
    </p><p>
      A column list of the form <code class="literal">(col1,col2,...)</code>
      creates a multiple-column index. Index key values are formed by
      concatenating the values of the given columns.
    </p><p>
      Indexes can be created that use only the leading part of column
      values, using
      <code class="literal"><em class="replaceable"><code>col_name</code></em>(<em class="replaceable"><code>length</code></em>)</code>
      syntax to specify an index prefix length:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Prefixes can be specified for
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, and
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> columns.
        </p></li><li class="listitem"><p>
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns also can be
          indexed, but a prefix length <span class="emphasis"><em>must</em></span> be
          given.
        </p></li><li class="listitem"><p>
          Prefix lengths are given in characters for nonbinary string
          types and in bytes for binary string types. That is, index
          entries consist of the first <em class="replaceable"><code>length</code></em>
          characters of each column value for
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns, and the first
          <em class="replaceable"><code>length</code></em> bytes of each column value
          for <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns.
        </p></li><li class="listitem"><p>
          For spatial columns, prefix values cannot be given, as
          described later in this section.
</p></li></ul>
</div>
<p>
      The statement shown here creates an index using the first 10
      characters of the <code class="literal">name</code> column:
    </p><pre class="programlisting">
CREATE INDEX part_of_name ON customer (name(10));
</pre><p>
      If names in the column usually differ in the first 10 characters,
      this index should not be much slower than an index created from
      the entire <code class="literal">name</code> column. Also, using column
      prefixes for indexes can make the index file much smaller, which
      could save a lot of disk space and might also speed up
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> operations.
    </p><p>
      Prefix support and lengths of prefixes (where supported) are
      storage engine dependent. For example, a prefix can be up to 767
      bytes long for <code class="literal">InnoDB</code> tables or 3072 bytes if
      the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_large_prefix"><code class="literal">innodb_large_prefix</code></a> option is
      enabled. For MyISAM tables, the prefix limit is 1000 bytes. The
      <code class="literal">NDB</code> storage engine does not support prefixes
      (see <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations-unsupported" title="18.1.6.6 Unsupported or Missing Features in MySQL Cluster">Section 18.1.6.6, “Unsupported or Missing Features in MySQL Cluster”</a>).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Prefix limits are measured in bytes, whereas the prefix length
        in <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> statements is
        interpreted as number of characters for nonbinary data types
        (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>). Take this into account
        when specifying a prefix length for a column that uses a
        multibyte character set.
</p>
</div>
<p>
      Indexes on variable-width columns of
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a> tables are created online;
      that is, without any table copying. The table is not locked
      against access from other MySQL Cluster API nodes, although it is
      locked against other operations on the <span class="emphasis"><em>same</em></span>
      API node for the duration of the operation. This is done
      automatically by the server whenever it determines that it is
      possible to do so; you do not have to use any special SQL syntax
      or server options to cause it to happen.
    </p><p>
      In standard MySQL 5.6 releases, it is not possible to
      override the server when it determines that an index is to be
      created without table copying. In MySQL Cluster, you can create
      indexes offline (which causes the table to be locked to all API
      nodes in the cluster) using the <code class="literal">OFFLINE</code>
      keyword. The rules and limitations governing <code class="literal">CREATE
      OFFLINE INDEX</code> and <code class="literal">CREATE ONLINE INDEX</code>
      are the same as for <code class="literal">ALTER OFFLINE TABLE ... ADD
      INDEX</code> and <code class="literal">ALTER ONLINE TABLE ... ADD
      INDEX</code>. You cannot cause the noncopying creation of an
      index that would normally be created offline by using the
      <code class="literal">ONLINE</code> keyword: If it is not possible to
      perform the <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a> operation
      without table copying, the server ignores the
      <code class="literal">ONLINE</code> keyword. For more information, see
      <a class="xref" href="sql-syntax.html#alter-table-online-operations" title="13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster">Section 13.1.7.2, “ALTER TABLE Online Operations in MySQL Cluster”</a>.
    </p><p>
      The <code class="literal">ONLINE</code> and <code class="literal">OFFLINE</code>
      keywords are available only in MySQL Cluster; attempting to use
      these keywords in standard MySQL Server 5.6 releases
      results in a syntax error. The <code class="literal">ONLINE</code> and
      <code class="literal">OFFLINE</code> keywords are deprecated in MySQL
      Cluster NDB 7.3; they continue to be supported in MySQL Cluster
      NDB 7.4, but they are subject to removal in a future MySQL Cluster
      release.
    </p><p>
      A <code class="literal">UNIQUE</code> index creates a constraint such that
      all values in the index must be distinct. An error occurs if you
      try to add a new row with a key value that matches an existing
      row. For all engines, a <code class="literal">UNIQUE</code> index permits
      multiple <code class="literal">NULL</code> values for columns that can
      contain <code class="literal">NULL</code>. If you specify a prefix value for
      a column in a <code class="literal">UNIQUE</code> index, the column values
      must be unique within the prefix.
    </p><p>
      <code class="literal">FULLTEXT</code> indexes are supported only for
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables and can include only
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. Indexing always
      happens over the entire column; column prefix indexing is not
      supported and any prefix length is ignored if specified. See
      <a class="xref" href="functions.html#fulltext-search" title="12.9 Full-Text Search Functions">Section 12.9, “Full-Text Search Functions”</a>, for details of operation.
    </p><p>
      The <code class="literal">MyISAM</code>, <code class="literal">InnoDB</code>,
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>, and <code class="literal">ARCHIVE</code>
      storage engines support spatial columns such as
      (<code class="literal">POINT</code> and <code class="literal">GEOMETRY</code>.
      (<a class="xref" href="data-types.html#spatial-extensions" title="11.5 Extensions for Spatial Data">Section 11.5, “Extensions for Spatial Data”</a>, describes the spatial data
      types.) However, support for spatial column indexing varies among
      engines. Spatial and nonspatial indexes are available according to
      the following rules.
    </p><p>
      Spatial indexes (created using <code class="literal">SPATIAL INDEX</code>)
      have these characteristics:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Available only for <code class="literal">MyISAM</code> tables.
          Specifying <code class="literal">SPATIAL INDEX</code> for other storage
          engines results in an error.
        </p></li><li class="listitem"><p>
          Indexed columns must be <code class="literal">NOT NULL</code>.
        </p></li><li class="listitem"><p>
          In MySQL 5.6, column prefix lengths are
          prohibited. The full width of each column is indexed.
</p></li></ul>
</div>
<p>
      Characteristics of nonspatial indexes (created with
      <code class="literal">INDEX</code>, <code class="literal">UNIQUE</code>, or
      <code class="literal">PRIMARY KEY</code>):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Permitted for any storage engine that supports spatial columns
          except <code class="literal">ARCHIVE</code>.
        </p></li><li class="listitem"><p>
          Columns can be <code class="literal">NULL</code> unless the index is a
          primary key.
        </p></li><li class="listitem"><p>
          For each spatial column in a non-<code class="literal">SPATIAL</code>
          index except <code class="literal">POINT</code> columns, a column prefix
          length must be specified. (This is the same requirement as for
          indexed <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns.) The
          prefix length is given in bytes.
        </p></li><li class="listitem"><p>
          The index type for a non-<code class="literal">SPATIAL</code> index
          depends on the storage engine. Currently, B-tree is used.
</p></li></ul>
</div>
<p>
      In MySQL 5.6:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          You can add an index on a column that can have
          <code class="literal">NULL</code> values only if you are using the
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, or
          <a class="link" href="storage-engines.html#memory-storage-engine" title="15.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a> storage engine.
        </p></li><li class="listitem"><p>
          You can add an index on a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
          or <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> column only if you are
          using the <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> or
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> storage engine.
        </p></li><li class="listitem"><p>
          When the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a>
          setting is enabled, run the <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a> statement for an <code class="literal">InnoDB</code>
          table after creating an index on that table.
</p></li></ul>
</div>
<p>
      An <em class="replaceable"><code>index_col_name</code></em> specification can end
      with <code class="literal">ASC</code> or <code class="literal">DESC</code>. These
      keywords are permitted for future extensions for specifying
      ascending or descending index value storage. Currently, they are
      parsed but ignored; index values are always stored in ascending
      order.
    </p><p>
      Following the index column list, index options can be given. An
      <em class="replaceable"><code>index_option</code></em> value can be any of the
      following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">KEY_BLOCK_SIZE [=]
          <em class="replaceable"><code>value</code></em></code>
        </p><p>
          Optionally specifies the size in bytes to use for index key
          blocks. The value is treated as a hint; a different size could
          be used if necessary.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">KEY_BLOCK_SIZE</code> is only supported at the
            table level for <code class="literal">InnoDB</code>. See
            <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a>.
</p>
</div>
</li><li class="listitem"><p>
          <em class="replaceable"><code>index_type</code></em>
        </p><p>
          Some storage engines permit you to specify an index type when
          creating an index. The permissible index type values supported
          by different storage engines are shown in the following table.
          Where multiple index types are listed, the first one is the
          default when no index type specifier is given.
</p>
<div class="informaltable">
<table summary="This table lists permissible index types for each
storage engine." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Storage Engine</th><th scope="col">Permissible Index Types</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a></td><td><code class="literal">BTREE</code></td></tr><tr><td scope="row"><a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a></td><td><code class="literal">BTREE</code></td></tr><tr><td scope="row"><a class="link" href="storage-engines.html#memory-storage-engine" title="15.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a>/<code class="literal">HEAP</code></td><td><code class="literal">HASH</code>, <code class="literal">BTREE</code></td></tr><tr><td scope="row"><a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a></td><td><code class="literal">HASH</code>, <code class="literal">BTREE</code> (see note in text)</td></tr></tbody></table>
</div>
<p>
          Example:
        </p><pre class="programlisting">
CREATE TABLE lookup (id INT) ENGINE = MEMORY;
CREATE INDEX id_index ON lookup (id) USING BTREE;
</pre><p>
          <code class="literal">BTREE</code> indexes are implemented by the
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engine as T-tree
          indexes.
</p><a class="indexterm" name="idm139737152377344"></a><a class="indexterm" name="idm139737152375856"></a>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For indexes on <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table
            columns, the <code class="literal">USING</code> option can be
            specified only for a unique index or primary key.
            <code class="literal">USING HASH</code> prevents the creation of an
            ordered index; otherwise, creating a unique index or primary
            key on an <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table
            automatically results in the creation of both an ordered
            index and a hash index, each of which indexes the same set
            of columns.
          </p><p>
            For unique indexes that include one or more
            <code class="literal">NULL</code> columns of an <code class="literal">NDB</code>
            table, the hash index can be used only to look up literal
            values, which means that <code class="literal">IS [NOT] NULL</code>
            conditions require a full scan of the table. One workaround
            is to make sure that a unique index using one or more
            <code class="literal">NULL</code> columns on such a table is always
            created in such a way that it includes the ordered index;
            that is, avoid employing <code class="literal">USING HASH</code> when
            creating the index.
</p>
</div>
<p>
          The <em class="replaceable"><code>index_type</code></em> clause cannot be
          used together with <code class="literal">SPATIAL INDEX</code>.
        </p><p>
          If you specify an index type that is not valid for a given
          storage engine, but there is another index type available that
          the engine can use without affecting query results, the engine
          uses the available type. The parser recognizes
          <code class="literal">RTREE</code> as a type name, but currently this
          cannot be specified for any storage engine.
        </p><p>
          Use of this option before the <code class="literal">ON
          <em class="replaceable"><code>tbl_name</code></em></code> clause is
          deprecated; support for use of the option in this position
          will be removed in a future MySQL release. If an
          <em class="replaceable"><code>index_type</code></em> option is given in both
          the earlier and later positions, the final option applies.
        </p><p>
          <code class="literal">TYPE <em class="replaceable"><code>type_name</code></em></code>
          is recognized as a synonym for <code class="literal">USING
          <em class="replaceable"><code>type_name</code></em></code>. However,
          <code class="literal">USING</code> is the preferred form.
        </p></li><li class="listitem"><p>
          <code class="literal">WITH PARSER
          <em class="replaceable"><code>parser_name</code></em></code>
        </p><p>
          This option can be used only with <code class="literal">FULLTEXT</code>
          indexes. It associates a parser plugin with the index if
          full-text indexing and searching operations need special
          handling. See <a class="xref" href="extending-mysql.html#plugin-api" title="24.2 The MySQL Plugin API">Section 24.2, “The MySQL Plugin API”</a>, for details on
          creating plugins.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMENT '<em class="replaceable"><code>string</code></em>'</code>
        </p><p>
          Index definitions can include an optional comment of up to
          1024 characters.
</p></li></ul>
</div>
<p>
      As of MySQL 5.6.6, the <code class="literal">ALGORITHM</code> and
      <code class="literal">LOCK</code> clauses may be given. These influence the
      table copying method and level of concurrency for reading and
      writing the table while its indexes are being modified. They have
      the same meaning as for the <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> statement. For more information, see
      <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-logfile-group"></a>13.1.14 CREATE LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152344880"></a><pre class="programlisting">
CREATE LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ADD UNDOFILE '<em class="replaceable"><code>undo_file</code></em>'
    [INITIAL_SIZE [=] <em class="replaceable"><code>initial_size</code></em>]
    [UNDO_BUFFER_SIZE [=] <em class="replaceable"><code>undo_buffer_size</code></em>]
    [REDO_BUFFER_SIZE [=] <em class="replaceable"><code>redo_buffer_size</code></em>]
    [NODEGROUP [=] <em class="replaceable"><code>nodegroup_id</code></em>]
    [WAIT]
    [COMMENT [=] <em class="replaceable"><code>comment_text</code></em>]
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement creates a new log file group named
      <em class="replaceable"><code>logfile_group</code></em> having a single
      <code class="literal">UNDO</code> file named
      '<em class="replaceable"><code>undo_file</code></em>'. A
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> statement has
      one and only one <code class="literal">ADD UNDOFILE</code> clause. For rules
      covering the naming of log file groups, see
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All MySQL Cluster Disk Data objects share the same namespace.
        This means that <span class="emphasis"><em>each Disk Data object</em></span> must
        be uniquely named (and not merely each Disk Data object of a
        given type). For example, you cannot have a tablespace and a log
        file group with the same name, or a tablespace and a data file
        with the same name.
</p>
</div>
<p>
      In MySQL Cluster NDB 7.3 and later, you can have only one log file
      group per Cluster at any given time. (See Bug #16386)
    </p><p>
      The optional <code class="literal">INITIAL_SIZE</code> parameter sets the
      <code class="literal">UNDO</code> file's initial size; if not specified, it
      defaults to <code class="literal">128M</code> (128 megabytes). The optional
      <code class="literal">UNDO_BUFFER_SIZE</code> parameter sets the size used
      by the <code class="literal">UNDO</code> buffer for the log file group; The
      default value for <code class="literal">UNDO_BUFFER_SIZE</code> is
      <code class="literal">8M</code> (eight megabytes); this value cannot exceed
      the amount of system memory available. Both of these parameters
      are specified in bytes. In MySQL Cluster NDB 7.3.2 and later, you
      may optionally follow either or both of these with a one-letter
      abbreviation for an order of magnitude, similar to those used in
      <code class="filename">my.cnf</code>. Generally, this is one of the
      letters <code class="literal">M</code> (for megabytes) or
      <code class="literal">G</code> (for gigabytes). Prior to MySQL Cluster NDB
      7.3.2, the values for these options could only be specified using
      digits. (Bug #13116514, Bug #16104705, Bug #62858)
    </p><p>
      Memory used for <code class="literal">UNDO_BUFFER_SIZE</code> comes from the
      global pool whose size is determined by the value of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-sharedglobalmemory"><code class="literal">SharedGlobalMemory</code></a> data
      node configuration parameter. This includes any default value
      implied for this option by the setting of the
      <a class="link" href="mysql-cluster.html#ndbparam-ndbd-initiallogfilegroup"><code class="literal">InitialLogFileGroup</code></a> data
      node configuration parameter.
    </p><p>
      The maximum permitted for <code class="literal">UNDO_BUFFER_SIZE</code> is
      629145600 (600 MB).
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      The minimum allowed value for <code class="literal">INITIAL_SIZE</code> is
      1048576 (1 MB).
    </p><p>
      The <code class="literal">ENGINE</code> option determines the storage engine
      to be used by this log file group, with
      <em class="replaceable"><code>engine_name</code></em> being the name of the
      storage engine. In MySQL 5.6, this must be
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> (or
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>). If
      <code class="literal">ENGINE</code> is not set, MySQL tries to use the
      engine specified by the
      <a class="link" href="server-administration.html#sysvar_default_storage_engine"><code class="literal">default_storage_engine</code></a> server
      system variable (formerly
      <a class="link" href="server-administration.html#sysvar_storage_engine"><code class="literal">storage_engine</code></a>). In any case, if
      the engine is not specified as <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> or
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>, the <code class="literal">CREATE
      LOGFILE GROUP</code> statement appears to succeed but actually
      fails to create the log file group, as shown here:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE LOGFILE GROUP lg1</code></strong> 
    -&gt;     <strong class="userinput"><code>ADD UNDOFILE 'undo.dat' INITIAL_SIZE = 10M;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------------------------------------------------------------------+
| Level | Code | Message                                                                                        |
+-------+------+------------------------------------------------------------------------------------------------+
| Error | 1478 | <span class="errortext">Table storage engine 'InnoDB' does not support the create option 'TABLESPACE or LOGFILE GROUP'</span> |
+-------+------+------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>DROP LOGFILE GROUP lg1 ENGINE = NDB;</code></strong>              
<span class="errortext">ERROR 1529 (HY000): Failed to drop LOGFILE GROUP</span>

mysql&gt; <strong class="userinput"><code>CREATE LOGFILE GROUP lg1</code></strong> 
    -&gt;     <strong class="userinput"><code>ADD UNDOFILE 'undo.dat' INITIAL_SIZE = 10M</code></strong>
    -&gt;     <strong class="userinput"><code>ENGINE = NDB;</code></strong>
Query OK, 0 rows affected (2.97 sec)
</pre><p>
      The fact that the <code class="literal">CREATE LOGFILE GROUP</code>
      statement does not actually return an error when a
      non-<code class="literal">NDB</code> storage engine is named, but rather
      appears to succeed, is a known issue which we hope to address in a
      future release of MySQL Cluster.
    </p><p>
      <em class="replaceable"><code>REDO_BUFFER_SIZE</code></em>,
      <code class="literal">NODEGROUP</code>, <code class="literal">WAIT</code>, and
      <code class="literal">COMMENT</code> are parsed but ignored, and so have no
      effect in MySQL 5.6. These options are intended for
      future expansion.
    </p><p>
      When used with <code class="literal">ENGINE [=] NDB</code>, a log file group
      and associated <code class="literal">UNDO</code> log file are created on
      each Cluster data node. You can verify that the
      <code class="literal">UNDO</code> files were created and obtain information
      about them by querying the
      <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> table. For
      example:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOGFILE_GROUP_NAME, LOGFILE_GROUP_NUMBER, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE FILE_NAME = 'undo_10.dat';</code></strong>
+--------------------+----------------------+----------------+
| LOGFILE_GROUP_NAME | LOGFILE_GROUP_NUMBER | EXTRA          |
+--------------------+----------------------+----------------+
| lg_3               |                   11 | CLUSTER_NODE=3 |
| lg_3               |                   11 | CLUSTER_NODE=4 |
+--------------------+----------------------+----------------+
2 rows in set (0.06 sec)
</pre><p>
      <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for MySQL Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-procedure"></a>13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152278960"></a><a class="indexterm" name="idm139737152277920"></a><pre class="programlisting">
CREATE
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    PROCEDURE <em class="replaceable"><code>sp_name</code></em> ([<em class="replaceable"><code>proc_parameter</code></em>[,...]])
    [<em class="replaceable"><code>characteristic</code></em> ...] <em class="replaceable"><code>routine_body</code></em>

CREATE
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    FUNCTION <em class="replaceable"><code>sp_name</code></em> ([<em class="replaceable"><code>func_parameter</code></em>[,...]])
    RETURNS <em class="replaceable"><code>type</code></em>
    [<em class="replaceable"><code>characteristic</code></em> ...] <em class="replaceable"><code>routine_body</code></em>

<em class="replaceable"><code>proc_parameter</code></em>:
    [ IN | OUT | INOUT ] <em class="replaceable"><code>param_name</code></em> <em class="replaceable"><code>type</code></em>

<em class="replaceable"><code>func_parameter</code></em>:
    <em class="replaceable"><code>param_name</code></em> <em class="replaceable"><code>type</code></em>

<em class="replaceable"><code>type</code></em>:
    <em class="replaceable"><code>Any valid MySQL data type</code></em>

<em class="replaceable"><code>characteristic</code></em>:
    COMMENT '<em class="replaceable"><code>string</code></em>'
  | LANGUAGE SQL
  | [NOT] DETERMINISTIC
  | { CONTAINS SQL | NO SQL | READS SQL DATA | MODIFIES SQL DATA }
  | SQL SECURITY { DEFINER | INVOKER }

<em class="replaceable"><code>routine_body</code></em>:
    <em class="replaceable"><code>Valid SQL routine statement</code></em>
</pre><p>
      These statements create stored routines. By default, a routine is
      associated with the default database. To associate the routine
      explicitly with a given database, specify the name as
      <em class="replaceable"><code>db_name.sp_name</code></em> when you create it.
    </p><p>
      The <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement is
      also used in MySQL to support UDFs (user-defined functions). See
      <a class="xref" href="extending-mysql.html#adding-functions" title="24.3 Adding New Functions to MySQL">Section 24.3, “Adding New Functions to MySQL”</a>. A UDF can be regarded as an
      external stored function. Stored functions share their namespace
      with UDFs. See <a class="xref" href="language-structure.html#function-resolution" title="9.2.4 Function Name Parsing and Resolution">Section 9.2.4, “Function Name Parsing and Resolution”</a>, for the
      rules describing how the server interprets references to different
      kinds of functions.
    </p><p>
      To invoke a stored procedure, use the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement (see
      <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>). To invoke a stored function, refer to it
      in an expression. The function returns a value during expression
      evaluation.
    </p><p>
      <a class="link" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a> and
      <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> require the
      <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a> privilege. They
      might also require the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
      privilege, depending on the <code class="literal">DEFINER</code> value, as
      described later in this section. If binary logging is enabled,
      <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> might require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, as described in
      <a class="xref" href="stored-programs-views.html#stored-programs-logging" title="20.7 Binary Logging of Stored Programs">Section 20.7, “Binary Logging of Stored Programs”</a>.
    </p><p>
      By default, MySQL automatically grants the
      <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a> and
      <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privileges to the routine
      creator. This behavior can be changed by disabling the
      <a class="link" href="server-administration.html#sysvar_automatic_sp_privileges"><code class="literal">automatic_sp_privileges</code></a> system
      variable. See <a class="xref" href="stored-programs-views.html#stored-routines-privileges" title="20.2.2 Stored Routines and MySQL Privileges">Section 20.2.2, “Stored Routines and MySQL Privileges”</a>.
    </p><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses specify the security context to be used when checking
      access privileges at routine execution time, as described later in
      this section.
    </p><p>
      If the routine name is the same as the name of a built-in SQL
      function, a syntax error occurs unless you use a space between the
      name and the following parenthesis when defining the routine or
      invoking it later. For this reason, avoid using the names of
      existing SQL functions for your own stored routines.
    </p><p>
      The <a class="link" href="server-administration.html#sqlmode_ignore_space"><code class="literal">IGNORE_SPACE</code></a> SQL mode
      applies to built-in functions, not to stored routines. It is
      always permissible to have spaces after a stored routine name,
      regardless of whether
      <a class="link" href="server-administration.html#sqlmode_ignore_space"><code class="literal">IGNORE_SPACE</code></a> is enabled.
    </p><p>
      The parameter list enclosed within parentheses must always be
      present. If there are no parameters, an empty parameter list of
      <code class="literal">()</code> should be used. Parameter names are not case
      sensitive.
    </p><p>
      Each parameter is an <code class="literal">IN</code> parameter by default.
      To specify otherwise for a parameter, use the keyword
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> before the
      parameter name.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Specifying a parameter as <code class="literal">IN</code>,
        <code class="literal">OUT</code>, or <code class="literal">INOUT</code> is valid
        only for a <code class="literal">PROCEDURE</code>. For a
        <code class="literal">FUNCTION</code>, parameters are always regarded as
        <code class="literal">IN</code> parameters.
</p>
</div>
<p>
      An <code class="literal">IN</code> parameter passes a value into a
      procedure. The procedure might modify the value, but the
      modification is not visible to the caller when the procedure
      returns. An <code class="literal">OUT</code> parameter passes a value from
      the procedure back to the caller. Its initial value is
      <code class="literal">NULL</code> within the procedure, and its value is
      visible to the caller when the procedure returns. An
      <code class="literal">INOUT</code> parameter is initialized by the caller,
      can be modified by the procedure, and any change made by the
      procedure is visible to the caller when the procedure returns.
    </p><p>
      For each <code class="literal">OUT</code> or <code class="literal">INOUT</code>
      parameter, pass a user-defined variable in the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement that invokes the
      procedure so that you can obtain its value when the procedure
      returns. If you are calling the procedure from within another
      stored procedure or function, you can also pass a routine
      parameter or local routine variable as an <code class="literal">IN</code> or
      <code class="literal">INOUT</code> parameter.
    </p><p>
      Routine parameters cannot be referenced in statements prepared
      within the routine; see
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      The following example shows a simple stored procedure that uses an
      <code class="literal">OUT</code> parameter:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE simpleproc (OUT param1 INT)</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>SELECT COUNT(*) INTO param1 FROM t;</code></strong>
    -&gt; <strong class="userinput"><code>END//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>delimiter ;</code></strong>

mysql&gt; <strong class="userinput"><code>CALL simpleproc(@a);</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @a;</code></strong>
+------+
| @a   |
+------+
| 3    |
+------+
1 row in set (0.00 sec)
</pre><p>
      The example uses the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client
      <code class="literal">delimiter</code> command to change the statement
      delimiter from <code class="literal">;</code> to <code class="literal">//</code> while
      the procedure is being defined. This enables the
      <code class="literal">;</code> delimiter used in the procedure body to be
      passed through to the server rather than being interpreted by
      <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> itself. See
      <a class="xref" href="stored-programs-views.html#stored-programs-defining" title="20.1 Defining Stored Programs">Section 20.1, “Defining Stored Programs”</a>.
    </p><p>
      The <code class="literal">RETURNS</code> clause may be specified only for a
      <code class="literal">FUNCTION</code>, for which it is mandatory. It
      indicates the return type of the function, and the function body
      must contain a <code class="literal">RETURN
      <em class="replaceable"><code>value</code></em></code> statement. If the
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement returns a value of
      a different type, the value is coerced to the proper type. For
      example, if a function specifies an
      <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
      <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> value in the
      <code class="literal">RETURNS</code> clause, but the
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement returns an
      integer, the value returned from the function is the string for
      the corresponding <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> member of
      set of <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> members.
    </p><p>
      The following example function takes a parameter, performs an
      operation using an SQL function, and returns the result. In this
      case, it is unnecessary to use <code class="literal">delimiter</code>
      because the function definition contains no internal
      <code class="literal">;</code> statement delimiters:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE FUNCTION hello (s CHAR(20))</code></strong>
mysql&gt; <strong class="userinput"><code>RETURNS CHAR(50) DETERMINISTIC</code></strong>
    -&gt; <strong class="userinput"><code>RETURN CONCAT('Hello, ',s,'!');</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT hello('world');</code></strong>
+----------------+
| hello('world') |
+----------------+
| Hello, world!  |
+----------------+
1 row in set (0.00 sec)
</pre><p>
      Parameter types and function return types can be declared to use
      any valid data type. The <code class="literal">COLLATE</code> attribute can
      be used if preceded by the <code class="literal">CHARACTER SET</code>
      attribute.
    </p><p>
      The <em class="replaceable"><code>routine_body</code></em> consists of a valid
      SQL routine statement. This can be a simple statement such as
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> or
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, or a compound statement
      written using <code class="literal">BEGIN</code> and <code class="literal">END</code>.
      Compound statements can contain declarations, loops, and other
      control structure statements. The syntax for these statements is
      described in <a class="xref" href="sql-syntax.html#sql-syntax-compound-statements" title="13.6 MySQL Compound-Statement Syntax">Section 13.6, “MySQL Compound-Statement Syntax”</a>.
    </p><p>
      MySQL permits routines to contain DDL statements, such as
      <code class="literal">CREATE</code> and <code class="literal">DROP</code>. MySQL also
      permits stored procedures (but not stored functions) to contain
      SQL transaction statements such as
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>. Stored functions may not
      contain statements that perform explicit or implicit commit or
      rollback. Support for these statements is not required by the SQL
      standard, which states that each DBMS vendor may decide whether to
      permit them.
    </p><p>
      Statements that return a result set can be used within a stored
      procedure but not within a stored function. This prohibition
      includes <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements that do
      not have an <code class="literal">INTO
      <em class="replaceable"><code>var_list</code></em></code> clause and other
      statements such as <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a>,
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>, and
      <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>. For statements that
      can be determined at function definition time to return a result
      set, a <code class="literal">Not allowed to return a result set from a
      function</code> error occurs
      (<a class="link" href="error-handling.html#error_er_sp_no_retset"><code class="literal">ER_SP_NO_RETSET</code></a>). For statements
      that can be determined only at runtime to return a result set, a
      <code class="literal">PROCEDURE %s can't return a result set in the given
      context</code> error occurs
      (<a class="link" href="error-handling.html#error_er_sp_badselect"><code class="literal">ER_SP_BADSELECT</code></a>).
    </p><p>
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statements within stored
      routines are not permitted. When a routine is invoked, an implicit
      <code class="literal">USE <em class="replaceable"><code>db_name</code></em></code> is
      performed (and undone when the routine terminates). The causes the
      routine to have the given default database while it executes.
      References to objects in databases other than the routine default
      database should be qualified with the appropriate database name.
    </p><p>
      For additional information about statements that are not permitted
      in stored routines, see
      <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      For information about invoking stored procedures from within
      programs written in a language that has a MySQL interface, see
      <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>.
    </p><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when a routine is created or altered,
      and always executes the routine with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the
      routine begins executing</em></span>.
    </p><p>
      The switch from the SQL mode of the invoker to that of the routine
      occurs after evaluation of arguments and assignment of the
      resulting values to routine parameters. If you define a routine in
      strict SQL mode but invoke it in nonstrict mode, assignment of
      arguments to routine parameters does not take place in strict
      mode. If you require that expressions passed to a routine be
      assigned in strict SQL mode, you should invoke the routine with
      strict mode in effect.
    </p><p>
      The <code class="literal">COMMENT</code> characteristic is a MySQL
      extension, and may be used to describe the stored routine. This
      information is displayed by the <a class="link" href="sql-syntax.html#show-create-procedure" title="13.7.5.11 SHOW CREATE PROCEDURE Syntax"><code class="literal">SHOW CREATE
      PROCEDURE</code></a> and <a class="link" href="sql-syntax.html#show-create-function" title="13.7.5.10 SHOW CREATE FUNCTION Syntax"><code class="literal">SHOW CREATE
      FUNCTION</code></a> statements.
    </p><p>
      The <code class="literal">LANGUAGE</code> characteristic indicates the
      language in which the routine is written. The server ignores this
      characteristic; only SQL routines are supported.
    </p><p>
      A routine is considered <span class="quote">“<span class="quote">deterministic</span>”</span> if it always
      produces the same result for the same input parameters, and
      <span class="quote">“<span class="quote">not deterministic</span>”</span> otherwise. If neither
      <code class="literal">DETERMINISTIC</code> nor <code class="literal">NOT
      DETERMINISTIC</code> is given in the routine definition, the
      default is <code class="literal">NOT DETERMINISTIC</code>. To declare that a
      function is deterministic, you must specify
      <code class="literal">DETERMINISTIC</code> explicitly.
    </p><p>
      Assessment of the nature of a routine is based on the
      <span class="quote">“<span class="quote">honesty</span>”</span> of the creator: MySQL does not check that a
      routine declared <code class="literal">DETERMINISTIC</code> is free of
      statements that produce nondeterministic results. However,
      misdeclaring a routine might affect results or affect performance.
      Declaring a nondeterministic routine as
      <code class="literal">DETERMINISTIC</code> might lead to unexpected results
      by causing the optimizer to make incorrect execution plan choices.
      Declaring a deterministic routine as
      <code class="literal">NONDETERMINISTIC</code> might diminish performance by
      causing available optimizations not to be used.
    </p><p>
      If binary logging is enabled, the <code class="literal">DETERMINISTIC</code>
      characteristic affects which routine definitions MySQL accepts.
      See <a class="xref" href="stored-programs-views.html#stored-programs-logging" title="20.7 Binary Logging of Stored Programs">Section 20.7, “Binary Logging of Stored Programs”</a>.
    </p><p>
      A routine that contains the <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>
      function (or its synonyms) or
      <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> is nondeterministic, but it
      might still be replication-safe. For
      <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a>, the binary log includes the
      timestamp and replicates correctly.
      <a class="link" href="functions.html#function_rand"><code class="literal">RAND()</code></a> also replicates correctly as
      long as it is called only a single time during the execution of a
      routine. (You can consider the routine execution timestamp and
      random number seed as implicit inputs that are identical on the
      master and slave.)
    </p><p>
      Several characteristics provide information about the nature of
      data use by the routine. In MySQL, these characteristics are
      advisory only. The server does not use them to constrain what
      kinds of statements a routine will be permitted to execute.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">CONTAINS SQL</code> indicates that the routine
          does not contain statements that read or write data. This is
          the default if none of these characteristics is given
          explicitly. Examples of such statements are <code class="literal">SET @x =
          1</code> or <code class="literal">DO RELEASE_LOCK('abc')</code>,
          which execute but neither read nor write data.
        </p></li><li class="listitem"><p>
          <code class="literal">NO SQL</code> indicates that the routine contains
          no SQL statements.
        </p></li><li class="listitem"><p>
          <code class="literal">READS SQL DATA</code> indicates that the routine
          contains statements that read data (for example,
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>), but not statements
          that write data.
        </p></li><li class="listitem"><p>
          <code class="literal">MODIFIES SQL DATA</code> indicates that the
          routine contains statements that may write data (for example,
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> or
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>).
</p></li></ul>
</div>
<p>
      The <code class="literal">SQL SECURITY</code> characteristic can be
      <code class="literal">DEFINER</code> or <code class="literal">INVOKER</code> to
      specify the security context; that is, whether the routine
      executes using the privileges of the account named in the routine
      <code class="literal">DEFINER</code> clause or the user who invokes it. This
      account must have permission to access the database with which the
      routine is associated. The default value is
      <code class="literal">DEFINER</code>. The user who invokes the routine must
      have the <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it,
      as must the <code class="literal">DEFINER</code> account if the routine
      executes in definer security context.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at routine execution
      time for routines that have the <code class="literal">SQL SECURITY
      DEFINER</code> characteristic.
    </p><p>
      If a <em class="replaceable"><code>user</code></em> value is given for the
      <code class="literal">DEFINER</code> clause, it should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
      (the same format used in the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
      statement), <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The default
      <code class="literal">DEFINER</code> value is the user who executes the
      <a class="link" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a> or
      <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement. This is
      the same as specifying <code class="literal">DEFINER = CURRENT_USER</code>
      explicitly.
    </p><p>
      If you specify the <code class="literal">DEFINER</code> clause, these rules
      determine the valid <code class="literal">DEFINER</code> user values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you do not have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, the only permitted <em class="replaceable"><code>user</code></em>
          value is your own account, either specified literally or by
          using <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>. You cannot
          set the definer to some other account.
        </p></li><li class="listitem"><p>
          If you have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, you can specify any syntactically valid account
          name. If the account does not exist, a warning is generated.
        </p></li><li class="listitem"><p>
          Although it is possible to create a routine with a nonexistent
          <code class="literal">DEFINER</code> account, an error occurs at routine
          execution time if the <code class="literal">SQL SECURITY</code> value is
          <code class="literal">DEFINER</code> but the definer account does not
          exist.
</p></li></ul>
</div>
<p>
      For more information about stored routine security, see
      <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.
    </p><p>
      Within a stored routine that is defined with the <code class="literal">SQL
      SECURITY DEFINER</code> characteristic,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> returns the routine's
      <code class="literal">DEFINER</code> value. For information about user
      auditing within stored routines, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.3.14 SQL-Based MySQL Account Activity Auditing">Section 6.3.14, “SQL-Based MySQL Account Activity Auditing”</a>.
    </p><p>
      Consider the following procedure, which displays a count of the
      number of MySQL accounts listed in the
      <code class="literal">mysql.user</code> table:
    </p><pre class="programlisting">
CREATE DEFINER = 'admin'@'localhost' PROCEDURE account_count()
BEGIN
  SELECT 'Number of accounts:', COUNT(*) FROM mysql.user;
END;
</pre><p>
      The procedure is assigned a <code class="literal">DEFINER</code> account of
      <code class="literal">'admin'@'localhost'</code> no matter which user
      defines it. It executes with the privileges of that account no
      matter which user invokes it (because the default security
      characteristic is <code class="literal">DEFINER</code>). The procedure
      succeeds or fails depending on whether invoker has the
      <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it and
      <code class="literal">'admin'@'localhost'</code> has the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
      <code class="literal">mysql.user</code> table.
    </p><p>
      Now suppose that the procedure is defined with the <code class="literal">SQL
      SECURITY INVOKER</code> characteristic:
    </p><pre class="programlisting">
CREATE DEFINER = 'admin'@'localhost' PROCEDURE account_count()
SQL SECURITY INVOKER
BEGIN
  SELECT 'Number of accounts:', COUNT(*) FROM mysql.user;
END;
</pre><p>
      The procedure still has a <code class="literal">DEFINER</code> of
      <code class="literal">'admin'@'localhost'</code>, but in this case, it
      executes with the privileges of the invoking user. Thus, the
      procedure succeeds or fails depending on whether the invoker has
      the <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a> privilege for it and
      the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
      <code class="literal">mysql.user</code> table.
    </p><p>
      The server handles the data type of a routine parameter, local
      routine variable created with
      <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, or function return value
      as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Assignments are checked for data type mismatches and overflow.
          Conversion and overflow problems result in warnings, or errors
          in strict SQL mode.
        </p></li><li class="listitem"><p>
          Only scalar values can be assigned. For example, a statement
          such as <code class="literal">SET x = (SELECT 1, 2)</code> is invalid.
        </p></li><li class="listitem"><p>
          For character data types, if there is a <code class="literal">CHARACTER
          SET</code> attribute in the declaration, the specified
          character set and its default collation is used. If the
          <code class="literal">COLLATE</code> attribute is also present, that
          collation is used rather than the default collation.
        </p><p>
          If <code class="literal">CHARACTER SET</code> and
          <code class="literal">COLLATE</code> attributes are not present, the
          database character set and collation in effect at routine
          creation time are used. To avoid having the server use the
          database character set and collation, provide explicit
          <code class="literal">CHARACTER SET</code> and
          <code class="literal">COLLATE</code> attributes for character data
          parameters.
        </p><p>
          If you change the database default character set or collation,
          stored routines that use the database defaults must be dropped
          and recreated so that they use the new defaults.
        </p><p>
          The database character set and collation are given by the
          value of the
          <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> and
          <a class="link" href="server-administration.html#sysvar_collation_database"><code class="literal">collation_database</code></a> system
          variables. For more information, see
          <a class="xref" href="globalization.html#charset-database" title="10.1.3.2 Database Character Set and Collation">Section 10.1.3.2, “Database Character Set and Collation”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-server"></a>13.1.16 CREATE SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737152052304"></a><pre class="programlisting">
CREATE SERVER <em class="replaceable"><code>server_name</code></em>
    FOREIGN DATA WRAPPER <em class="replaceable"><code>wrapper_name</code></em>
    OPTIONS (<em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ...)

<em class="replaceable"><code>option</code></em>:
  { HOST <em class="replaceable"><code>character-literal</code></em>
  | DATABASE <em class="replaceable"><code>character-literal</code></em>
  | USER <em class="replaceable"><code>character-literal</code></em>
  | PASSWORD <em class="replaceable"><code>character-literal</code></em>
  | SOCKET <em class="replaceable"><code>character-literal</code></em>
  | OWNER <em class="replaceable"><code>character-literal</code></em>
  | PORT <em class="replaceable"><code>numeric-literal</code></em> }
</pre><p>
      This statement creates the definition of a server for use with the
      <code class="literal">FEDERATED</code> storage engine. The <code class="literal">CREATE
      SERVER</code> statement creates a new row in the
      <code class="literal">servers</code> table in the <code class="literal">mysql</code>
      database. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      The <code class="literal"><em class="replaceable"><code>server_name</code></em></code>
      should be a unique reference to the server. Server definitions are
      global within the scope of the server, it is not possible to
      qualify the server definition to a specific database.
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code> has a
      maximum length of 64 characters (names longer than 64 characters
      are silently truncated), and is case insensitive. You may specify
      the name as a quoted string.
    </p><p>
      The <code class="literal"><em class="replaceable"><code>wrapper_name</code></em></code>
      should be <code class="literal">mysql</code>, and may be quoted with single
      quotation marks. Other values for
      <code class="literal"><em class="replaceable"><code>wrapper_name</code></em></code> are not
      currently supported.
    </p><p>
      For each <code class="literal"><em class="replaceable"><code>option</code></em></code> you
      must specify either a character literal or numeric literal.
      Character literals are UTF-8, support a maximum length of 64
      characters and default to a blank (empty) string. String literals
      are silently truncated to 64 characters. Numeric literals must be
      a number between 0 and 9999, default value is 0.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <code class="literal">OWNER</code> option is currently not applied,
        and has no effect on the ownership or operation of the server
        connection that is created.
</p>
</div>
<p>
      The <code class="literal">CREATE SERVER</code> statement creates an entry in
      the <code class="literal">mysql.servers</code> table that can later be used
      with the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
      when creating a <code class="literal">FEDERATED</code> table. The options
      that you specify will be used to populate the columns in the
      <code class="literal">mysql.servers</code> table. The table columns are
      <code class="literal">Server_name</code>, <code class="literal">Host</code>,
      <code class="literal">Db</code>, <code class="literal">Username</code>,
      <code class="literal">Password</code>, <code class="literal">Port</code> and
      <code class="literal">Socket</code>.
    </p><p>
      For example:
    </p><pre class="programlisting">
CREATE SERVER s
FOREIGN DATA WRAPPER mysql
OPTIONS (USER 'Remote', HOST '192.168.1.106', DATABASE 'test');
</pre><p>
      Be sure to specify all options necessary to establish a connection
      to the server. The user name, host name, and database name are
      mandatory. Other options might be required as well, such as
      password.
    </p><p>
      The data stored in the table can be used when creating a
      connection to a <code class="literal">FEDERATED</code> table:
    </p><pre class="programlisting">CREATE TABLE t (s1 INT) ENGINE=FEDERATED CONNECTION='s';</pre><p>
      For more information, see
      <a class="xref" href="storage-engines.html#federated-storage-engine" title="15.8 The FEDERATED Storage Engine">Section 15.8, “The FEDERATED Storage Engine”</a>.
    </p><p>
      <code class="literal">CREATE SERVER</code> causes an automatic commit.
    </p><p>
      In MySQL 5.6, <code class="literal">CREATE SERVER</code> is not
      written to the binary log, regardless of the logging format that
      is in use.
    </p><p>
      In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
      must be set to <code class="literal">AUTOMATIC</code> before issuing this
      statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-table"></a>13.1.17 CREATE TABLE Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#create-table-like">13.1.17.1 CREATE TABLE ... LIKE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-select">13.1.17.2 CREATE TABLE ... SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-table-foreign-keys">13.1.17.3 Using FOREIGN KEY Constraints</a></span></dt><dt><span class="section"><a href="sql-syntax.html#silent-column-changes">13.1.17.4 Silent Column Specification Changes</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737152007600"></a><pre class="programlisting">
CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    (<em class="replaceable"><code>create_definition</code></em>,...)
    [<em class="replaceable"><code>table_options</code></em>]
    [<em class="replaceable"><code>partition_options</code></em>]

CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    [(<em class="replaceable"><code>create_definition</code></em>,...)]
    [<em class="replaceable"><code>table_options</code></em>]
    [<em class="replaceable"><code>partition_options</code></em>]
    <em class="replaceable"><code>select_statement</code></em>

CREATE [TEMPORARY] TABLE [IF NOT EXISTS] <em class="replaceable"><code>tbl_name</code></em>
    { LIKE <em class="replaceable"><code>old_tbl_name</code></em> | (LIKE <em class="replaceable"><code>old_tbl_name</code></em>) }

<em class="replaceable"><code>create_definition</code></em>:
    <em class="replaceable"><code>col_name</code></em> <em class="replaceable"><code>column_definition</code></em>
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] PRIMARY KEY [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | {INDEX|KEY} [<em class="replaceable"><code>index_name</code></em>] [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] UNIQUE [INDEX|KEY]
      [<em class="replaceable"><code>index_name</code></em>] [<em class="replaceable"><code>index_type</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | {FULLTEXT|SPATIAL} [INDEX|KEY] [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...)
      [<em class="replaceable"><code>index_option</code></em>] ...
  | [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
      [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>index_col_name</code></em>,...) <em class="replaceable"><code>reference_definition</code></em>
  | CHECK (<em class="replaceable"><code>expr</code></em>)

<em class="replaceable"><code>column_definition</code></em>:
    <em class="replaceable"><code>data_type</code></em> [NOT NULL | NULL] [DEFAULT <em class="replaceable"><code>default_value</code></em>]
      [AUTO_INCREMENT] [UNIQUE [KEY] | [PRIMARY] KEY]
      [COMMENT '<em class="replaceable"><code>string</code></em>']
      [COLUMN_FORMAT {FIXED|DYNAMIC|DEFAULT}]
      [STORAGE {DISK|MEMORY|DEFAULT}]
      [<em class="replaceable"><code>reference_definition</code></em>]

<em class="replaceable"><code>data_type</code></em>:
    BIT[(<em class="replaceable"><code>length</code></em>)]
  | TINYINT[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | SMALLINT[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | MEDIUMINT[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | INT[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | INTEGER[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | BIGINT[(<em class="replaceable"><code>length</code></em>)] [UNSIGNED] [ZEROFILL]
  | REAL[(<em class="replaceable"><code>length</code></em>,<em class="replaceable"><code>decimals</code></em>)] [UNSIGNED] [ZEROFILL]
  | DOUBLE[(<em class="replaceable"><code>length</code></em>,<em class="replaceable"><code>decimals</code></em>)] [UNSIGNED] [ZEROFILL]
  | FLOAT[(<em class="replaceable"><code>length</code></em>,<em class="replaceable"><code>decimals</code></em>)] [UNSIGNED] [ZEROFILL]
  | DECIMAL[(<em class="replaceable"><code>length</code></em>[,<em class="replaceable"><code>decimals</code></em>])] [UNSIGNED] [ZEROFILL]
  | NUMERIC[(<em class="replaceable"><code>length</code></em>[,<em class="replaceable"><code>decimals</code></em>])] [UNSIGNED] [ZEROFILL]
  | DATE
  | TIME[(<em class="replaceable"><code>fsp</code></em>)]
  | TIMESTAMP[(<em class="replaceable"><code>fsp</code></em>)]
  | DATETIME[(<em class="replaceable"><code>fsp</code></em>)]
  | YEAR
  | CHAR[(<em class="replaceable"><code>length</code></em>)] [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | VARCHAR(<em class="replaceable"><code>length</code></em>) [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | BINARY[(<em class="replaceable"><code>length</code></em>)]
  | VARBINARY(<em class="replaceable"><code>length</code></em>)
  | TINYBLOB
  | BLOB
  | MEDIUMBLOB
  | LONGBLOB
  | TINYTEXT [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | TEXT [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | MEDIUMTEXT [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | LONGTEXT [BINARY]
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | ENUM(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,<em class="replaceable"><code>value3</code></em>,...)
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | SET(<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,<em class="replaceable"><code>value3</code></em>,...)
      [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>] [COLLATE <em class="replaceable"><code>collation_name</code></em>]
  | <em class="replaceable"><code>spatial_type</code></em>

<em class="replaceable"><code>index_col_name</code></em>:
    <em class="replaceable"><code>col_name</code></em> [(<em class="replaceable"><code>length</code></em>)] [ASC | DESC]

<em class="replaceable"><code>index_type</code></em>:
    USING {BTREE | HASH}

<em class="replaceable"><code>index_option</code></em>:
    KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | <em class="replaceable"><code>index_type</code></em>
  | WITH PARSER <em class="replaceable"><code>parser_name</code></em>
  | COMMENT '<em class="replaceable"><code>string</code></em>'

<em class="replaceable"><code>reference_definition</code></em>:
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>index_col_name</code></em>,...)
      [MATCH FULL | MATCH PARTIAL | MATCH SIMPLE]
      [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
      [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]

<em class="replaceable"><code>reference_option</code></em>:
    RESTRICT | CASCADE | SET NULL | NO ACTION

<em class="replaceable"><code>table_options</code></em>:
    <em class="replaceable"><code>table_option</code></em> [[,] <em class="replaceable"><code>table_option</code></em>] ...

<em class="replaceable"><code>table_option</code></em>:
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
  | AUTO_INCREMENT [=] <em class="replaceable"><code>value</code></em>
  | AVG_ROW_LENGTH [=] <em class="replaceable"><code>value</code></em>
  | [DEFAULT] CHARACTER SET [=] <em class="replaceable"><code>charset_name</code></em>
  | CHECKSUM [=] {0 | 1}
  | [DEFAULT] COLLATE [=] <em class="replaceable"><code>collation_name</code></em>
  | COMMENT [=] '<em class="replaceable"><code>string</code></em>'
  | CONNECTION [=] '<em class="replaceable"><code>connect_string</code></em>'
  | DATA DIRECTORY [=] '<em class="replaceable"><code>absolute path to directory</code></em>'
  | DELAY_KEY_WRITE [=] {0 | 1}
  | INDEX DIRECTORY [=] '<em class="replaceable"><code>absolute path to directory</code></em>'
  | INSERT_METHOD [=] { NO | FIRST | LAST }
  | KEY_BLOCK_SIZE [=] <em class="replaceable"><code>value</code></em>
  | MAX_ROWS [=] <em class="replaceable"><code>value</code></em>
  | MIN_ROWS [=] <em class="replaceable"><code>value</code></em>
  | PACK_KEYS [=] {0 | 1 | DEFAULT}
  | PASSWORD [=] '<em class="replaceable"><code>string</code></em>'
  | ROW_FORMAT [=] {DEFAULT|DYNAMIC|FIXED|COMPRESSED|REDUNDANT|COMPACT}
  | STATS_AUTO_RECALC [=] {DEFAULT|0|1}
  | STATS_PERSISTENT [=] {DEFAULT|0|1}
  | STATS_SAMPLE_PAGES [=] <em class="replaceable"><code>value</code></em>
  | TABLESPACE <em class="replaceable"><code>tablespace_name</code></em> [STORAGE {DISK|MEMORY|DEFAULT}]
  | UNION [=] (<em class="replaceable"><code>tbl_name</code></em>[,<em class="replaceable"><code>tbl_name</code></em>]...)

<em class="replaceable"><code>partition_options</code></em>:
    PARTITION BY
        { [LINEAR] HASH(<em class="replaceable"><code>expr</code></em>)
        | [LINEAR] KEY [ALGORITHM={1|2}] (<em class="replaceable"><code>column_list</code></em>)
        | RANGE{(<em class="replaceable"><code>expr</code></em>) | COLUMNS(<em class="replaceable"><code>column_list</code></em>)}
        | LIST{(<em class="replaceable"><code>expr</code></em>) | COLUMNS(<em class="replaceable"><code>column_list</code></em>)} }
    [PARTITIONS <em class="replaceable"><code>num</code></em>]
    [SUBPARTITION BY
        { [LINEAR] HASH(<em class="replaceable"><code>expr</code></em>)
        | [LINEAR] KEY [ALGORITHM={1|2}] (<em class="replaceable"><code>column_list</code></em>) }
      [SUBPARTITIONS <em class="replaceable"><code>num</code></em>]
    ]
    [(<em class="replaceable"><code>partition_definition</code></em> [, <em class="replaceable"><code>partition_definition</code></em>] ...)]

<em class="replaceable"><code>partition_definition</code></em>:
    PARTITION <em class="replaceable"><code>partition_name</code></em>
        [VALUES 
            {LESS THAN {(<em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>value_list</code></em>) | <code class="literal">MAXVALUE</code>} 
            | 
            IN (<em class="replaceable"><code>value_list</code></em>)}]
        [[STORAGE] ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
        [COMMENT [=] <em class="replaceable"><code>'comment_text'</code></em> ]
        [DATA DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>data_dir</code></em></code>']
        [INDEX DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>index_dir</code></em></code>']
        [MAX_ROWS [=] <em class="replaceable"><code>max_number_of_rows</code></em>]
        [MIN_ROWS [=] <em class="replaceable"><code>min_number_of_rows</code></em>]
        [TABLESPACE [=] <em class="replaceable"><code>tablespace_name</code></em>]
        [NODEGROUP [=] <em class="replaceable"><code>node_group_id</code></em>]
        [(<em class="replaceable"><code>subpartition_definition</code></em> [, <em class="replaceable"><code>subpartition_definition</code></em>] ...)]

<em class="replaceable"><code>subpartition_definition</code></em>:
    SUBPARTITION <em class="replaceable"><code>logical_name</code></em>
        [[STORAGE] ENGINE [=] <em class="replaceable"><code>engine_name</code></em>]
        [COMMENT [=] <em class="replaceable"><code>'comment_text'</code></em> ]
        [DATA DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>data_dir</code></em></code>']
        [INDEX DIRECTORY [=] '<code class="filename"><em class="replaceable"><code>index_dir</code></em></code>']
        [MAX_ROWS [=] <em class="replaceable"><code>max_number_of_rows</code></em>]
        [MIN_ROWS [=] <em class="replaceable"><code>min_number_of_rows</code></em>]
        [TABLESPACE [=] <em class="replaceable"><code>tablespace_name</code></em>]
        [NODEGROUP [=] <em class="replaceable"><code>node_group_id</code></em>]

<em class="replaceable"><code>select_statement:</code></em>
    [IGNORE | REPLACE] [AS] SELECT ...   (<em class="replaceable"><code>Some valid select statement</code></em>)
</pre><p>
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> creates a table with
      the given name. You must have the
      <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> privilege for the table.
    </p><p>
      Rules for permissible table names are given in
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>. By default, the table is created in
      the default database, using the
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage engine. An error
      occurs if the table exists, if there is no default database, or if
      the database does not exist.
    </p><p>
      The table name can be specified as
      <em class="replaceable"><code>db_name.tbl_name</code></em> to create the table in
      a specific database. This works regardless of whether there is a
      default database, assuming that the database exists. If you use
      quoted identifiers, quote the database and table names separately.
      For example, write <code class="literal">`mydb`.`mytbl`</code>, not
      <code class="literal">`mydb.mytbl`</code>.
</p>
<h4><a name="idm139737151916672"></a>Cloning or Copying a Table</h4>
<p>
      Use <code class="literal">CREATE TABLE ... LIKE</code> to create an empty
      table based on the definition of another table, including any
      column attributes and indexes defined in the original table:
    </p><pre class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> LIKE <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
      For more information, see <a class="xref" href="sql-syntax.html#create-table-like" title="13.1.17.1 CREATE TABLE ... LIKE Syntax">Section 13.1.17.1, “CREATE TABLE ... LIKE Syntax”</a>.
    </p><p>
      To create one table from another, add a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement at the end of the
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
    </p><pre class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
      For more information, see <a class="xref" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax">Section 13.1.17.2, “CREATE TABLE ... SELECT Syntax”</a>.
</p>
<h4><a name="create-temporary-table"></a>Temporary Tables</h4>
<p>
      You can use the <code class="literal">TEMPORARY</code> keyword when creating
      a table. A <code class="literal">TEMPORARY</code> table is visible only to
      the current session, and is dropped automatically when the session
      is closed. This means that two different sessions can use the same
      temporary table name without conflicting with each other or with
      an existing non-<code class="literal">TEMPORARY</code> table of the same
      name. (The existing table is hidden until the temporary table is
      dropped.) To create temporary tables, you must have the
      <a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a> privilege.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> does not
        automatically commit the current active transaction if you use
        the <code class="literal">TEMPORARY</code> keyword.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
        <code class="literal">TEMPORARY</code> tables have a very loose
        relationship with databases (schemas). Dropping a database does
        not automatically drop any <code class="literal">TEMPORARY</code> tables
        created within that database. Also, you can create a
        <code class="literal">TEMPORARY</code> table in a nonexistent database if
        you qualify the table name with the database name in the
        <code class="literal">CREATE TABLE</code> statement. In this case, all
        subsequent references to the table must be qualified with the
        database name.
</p>
</div>
<h4><a name="idm139737151893904"></a>Existing Table with Same Name</h4>
<p>
      The keywords <code class="literal">IF NOT EXISTS</code> prevent an error
      from occurring if the table exists. However, there is no
      verification that the existing table has a structure identical to
      that indicated by the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
      statement.
</p>
<h4><a name="idm139737151890656"></a>Physical Representation</h4>
<p>
      MySQL represents each table by an <code class="filename">.frm</code> table
      format (definition) file in the database directory. The storage
      engine for the table might create other files as well.
    </p><p>
      For <code class="literal">InnoDB</code> tables, the file storage is
      controlled by the
      <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
      configuration option. When this option is turned off, all
      <code class="literal">InnoDB</code> tables and indexes are stored in the
      <a class="link" href="glossary.html#glos_system_tablespace" title="system tablespace">system tablespace</a>,
      represented by one or more <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd
      files</a>. For each <code class="literal">InnoDB</code> table created
      when this option is turned on, the table data and all associated
      indexes are stored in a <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd
      file</a> located inside the database directory.
    </p><p>
      For <code class="literal">MyISAM</code> tables, the storage engine creates
      data and index files. Thus, for each <code class="literal">MyISAM</code>
      table <em class="replaceable"><code>tbl_name</code></em>, there are three disk
      files.
</p>
<div class="informaltable">
<table summary="This table describes the purpose of
        MyISAM table
tbl_name disk files." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">File</th><th scope="col">Purpose</th></tr></thead><tbody><tr><td scope="row"><code class="filename"><em class="replaceable"><code>tbl_name</code></em>.frm</code></td><td>Table format (definition) file</td></tr><tr><td scope="row"><code class="filename"><em class="replaceable"><code>tbl_name</code></em>.MYD</code></td><td>Data file</td></tr><tr><td scope="row"><code class="filename"><em class="replaceable"><code>tbl_name</code></em>.MYI</code></td><td>Index file</td></tr></tbody></table>
</div>
<p>
      <a class="xref" href="storage-engines.html" title="Chapter 15 Alternative Storage Engines">Chapter 15, <i>Alternative Storage Engines</i></a>, describes what files each
      storage engine creates to represent tables. If a table name
      contains special characters, the names for the table files contain
      encoded versions of those characters as described in
      <a class="xref" href="language-structure.html#identifier-mapping" title="9.2.3 Mapping of Identifiers to File Names">Section 9.2.3, “Mapping of Identifiers to File Names”</a>.
</p>
<h4><a name="idm139737151865824"></a>Data Types and Attributes for Columns</h4>
<p>
      <em class="replaceable"><code>data_type</code></em> represents the data type in a
      column definition. <em class="replaceable"><code>spatial_type</code></em>
      represents a spatial data type. The data type syntax shown is
      representative only. For a full description of the syntax
      available for specifying column data types, as well as information
      about the properties of each type, see
      <a class="xref" href="data-types.html" title="Chapter 11 Data Types">Chapter 11, <i>Data Types</i></a>, and
      <a class="xref" href="data-types.html#spatial-extensions" title="11.5 Extensions for Spatial Data">Section 11.5, “Extensions for Spatial Data”</a>.
    </p><p>
      Some attributes do not apply to all data types.
      <code class="literal">AUTO_INCREMENT</code> applies only to integer and
      floating-point types. <code class="literal">DEFAULT</code> does not apply to
      the <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> types.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If neither <code class="literal">NULL</code> nor <code class="literal">NOT
          NULL</code> is specified, the column is treated as though
          <code class="literal">NULL</code> had been specified.
        </p></li><li class="listitem"><p>
          An integer or floating-point column can have the additional
          attribute <code class="literal">AUTO_INCREMENT</code>. When you insert a
          value of <code class="literal">NULL</code> (recommended) or
          <code class="literal">0</code> into an indexed
          <code class="literal">AUTO_INCREMENT</code> column, the column is set to
          the next sequence value. Typically this is
          <code class="literal"><em class="replaceable"><code>value</code></em>+1</code>, where
          <em class="replaceable"><code>value</code></em> is the largest value for the
          column currently in the table.
          <code class="literal">AUTO_INCREMENT</code> sequences begin with
          <code class="literal">1</code>.
        </p><p>
          To retrieve an <code class="literal">AUTO_INCREMENT</code> value after
          inserting a row, use the
          <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> SQL function
          or the <a class="link" href="connectors-apis.html#mysql-insert-id" title="23.8.7.37 mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> C API
          function. See <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>, and
          <a class="xref" href="connectors-apis.html#mysql-insert-id" title="23.8.7.37 mysql_insert_id()">Section 23.8.7.37, “mysql_insert_id()”</a>.
        </p><p>
          If the <a class="link" href="server-administration.html#sqlmode_no_auto_value_on_zero"><code class="literal">NO_AUTO_VALUE_ON_ZERO</code></a>
          SQL mode is enabled, you can store <code class="literal">0</code> in
          <code class="literal">AUTO_INCREMENT</code> columns as
          <code class="literal">0</code> without generating a new sequence value.
          See <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            There can be only one <code class="literal">AUTO_INCREMENT</code>
            column per table, it must be indexed, and it cannot have a
            <code class="literal">DEFAULT</code> value. An
            <code class="literal">AUTO_INCREMENT</code> column works properly only
            if it contains only positive values. Inserting a negative
            number is regarded as inserting a very large positive
            number. This is done to avoid precision problems when
            numbers <span class="quote">“<span class="quote">wrap</span>”</span> over from positive to negative
            and also to ensure that you do not accidentally get an
            <code class="literal">AUTO_INCREMENT</code> column that contains
            <code class="literal">0</code>.
</p>
</div>
<p>
          For <code class="literal">MyISAM</code> tables, you can specify an
          <code class="literal">AUTO_INCREMENT</code> secondary column in a
          multiple-column key. See
          <a class="xref" href="tutorial.html#example-auto-increment" title="3.6.9 Using AUTO_INCREMENT">Section 3.6.9, “Using AUTO_INCREMENT”</a>.
        </p><a class="indexterm" name="idm139737151830304"></a><a class="indexterm" name="idm139737151829232"></a><p>
          To make MySQL compatible with some ODBC applications, you can
          find the <code class="literal">AUTO_INCREMENT</code> value for the last
          inserted row with the following query:
        </p><pre class="programlisting">
SELECT * FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>auto_col</code></em> IS NULL
</pre><p>
          For information about <code class="literal">InnoDB</code> and
          <code class="literal">AUTO_INCREMENT</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="14.5.5 AUTO_INCREMENT Handling in InnoDB">Section 14.5.5, “AUTO_INCREMENT Handling in InnoDB”</a>. For
          information about <code class="literal">AUTO_INCREMENT</code> and MySQL
          Replication, see
          <a class="xref" href="replication.html#replication-features-auto-increment" title="17.4.1.1 Replication and AUTO_INCREMENT">Section 17.4.1.1, “Replication and AUTO_INCREMENT”</a>.
        </p></li><li class="listitem"><p>
          Character data types (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>) can include
          <code class="literal">CHARACTER SET</code> and
          <code class="literal">COLLATE</code> attributes to specify the character
          set and collation for the column. For details, see
          <a class="xref" href="globalization.html#charset" title="10.1 Character Set Support">Section 10.1, “Character Set Support”</a>. <code class="literal">CHARSET</code> is a
          synonym for <code class="literal">CHARACTER SET</code>. Example:
        </p><pre class="programlisting">
CREATE TABLE t (c CHAR(20) CHARACTER SET utf8 COLLATE utf8_bin);
</pre><p>
          MySQL 5.6 interprets length specifications in
          character column definitions in characters. (Versions before
          MySQL 4.1 interpreted them in bytes.) Lengths for
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a> and
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> are in bytes.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151808240"></a>

          <a class="indexterm" name="idm139737151807168"></a>

          The <code class="literal">DEFAULT</code> clause specifies a default
          value for a column. With one exception, the default value must
          be a constant; it cannot be a function or an expression. This
          means, for example, that you cannot set the default for a date
          column to be the value of a function such as
          <a class="link" href="functions.html#function_now"><code class="literal">NOW()</code></a> or
          <a class="link" href="functions.html#function_current-date"><code class="literal">CURRENT_DATE</code></a>. The exception is
          that you can specify
          <a class="link" href="functions.html#function_current-timestamp"><code class="literal">CURRENT_TIMESTAMP</code></a> as the
          default for a <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> or (as
          of MySQL 5.6.5) <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a>
          column. See <a class="xref" href="data-types.html#timestamp-initialization" title="11.3.5 Automatic Initialization and Updating for TIMESTAMP and DATETIME">Section 11.3.5, “Automatic Initialization and Updating for TIMESTAMP and DATETIME”</a>.
        </p><p>
          If a column definition includes no explicit
          <code class="literal">DEFAULT</code> value, MySQL determines the default
          value as described in <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>.
        </p><p>
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns cannot be assigned
          a default value.
        </p><p>
          If the <a class="link" href="server-administration.html#sqlmode_no_zero_date"><code class="literal">NO_ZERO_DATE</code></a> or
          <a class="link" href="server-administration.html#sqlmode_no_zero_in_date"><code class="literal">NO_ZERO_IN_DATE</code></a> SQL mode is
          enabled and a date-valued default is not correct according to
          that mode, <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          produces a warning if strict SQL mode is not enabled and an
          error if strict mode is enabled. For example, with
          <a class="link" href="server-administration.html#sqlmode_no_zero_in_date"><code class="literal">NO_ZERO_IN_DATE</code></a> enabled,
          <code class="literal">c1 DATE DEFAULT '2010-00-00'</code> produces a
          warning. (Before MySQL 5.6.6, the statement produces an error
          even if strict mode is not enabled.)
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151786080"></a>

          A comment for a column can be specified with the
          <code class="literal">COMMENT</code> option, up to 1024 characters long.
          The comment is displayed by the <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW
          CREATE TABLE</code></a> and
          <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW FULL
          COLUMNS</code></a> statements.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151780880"></a>

          In MySQL Cluster, it is also possible to specify a data
          storage format for individual columns of
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables using
          <code class="literal">COLUMN_FORMAT</code>. Permissible column formats
          are <code class="literal">FIXED</code>, <code class="literal">DYNAMIC</code>, and
          <code class="literal">DEFAULT</code>. <code class="literal">FIXED</code> is used
          to specify fixed-width storage, <code class="literal">DYNAMIC</code>
          permits the column to be variable-width, and
          <code class="literal">DEFAULT</code> causes the column to use
          fixed-width or variable-width storage as determined by the
          column's data type (possibly overridden by a
          <code class="literal">ROW_FORMAT</code> specifier).
        </p><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, the default value
          for <code class="literal">COLUMN_FORMAT</code> is
          <code class="literal">DEFAULT</code>.
        </p><p>
          <code class="literal">COLUMN_FORMAT</code> currently has no effect on
          columns of tables using storage engines other than
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>. In MySQL 5.6
          and later, <code class="literal">COLUMN_FORMAT</code> is silently
          ignored.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151765488"></a>

          For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, it is also
          possible to specify whether the column is stored on disk or in
          memory by using a <code class="literal">STORAGE</code> clause.
          <code class="literal">STORAGE DISK</code> causes the column to be stored
          on disk, and <code class="literal">STORAGE MEMORY</code> causes
          in-memory storage to be used. The <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a> statement used must still include a
          <code class="literal">TABLESPACE</code> clause:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    -&gt;     <strong class="userinput"><code>c1 INT STORAGE DISK,</code></strong>
    -&gt;     <strong class="userinput"><code>c2 INT STORAGE MEMORY</code></strong>
    -&gt; <strong class="userinput"><code>) ENGINE NDB;</code></strong>
<span class="errortext">ERROR 1005 (HY000): Can't create table 'c.t1' (errno: 140)</span>

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (</code></strong>
    -&gt;     <strong class="userinput"><code>c1 INT STORAGE DISK,</code></strong>
    -&gt;     <strong class="userinput"><code>c2 INT STORAGE MEMORY</code></strong>
    -&gt; <strong class="userinput"><code>) TABLESPACE ts_1 ENGINE NDB;</code></strong>
Query OK, 0 rows affected (1.06 sec)
</pre><p>
          For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, <code class="literal">STORAGE
          DEFAULT</code> is equivalent to <code class="literal">STORAGE
          MEMORY</code>.
        </p><p>
          The <code class="literal">STORAGE</code> clause has no effect on tables
          using storage engines other than
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>. The
          <code class="literal">STORAGE</code> keyword is supported only in the
          build of <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> that is supplied with MySQL
          Cluster; it is not recognized in any other version of MySQL,
          where any attempt to use the <code class="literal">STORAGE</code>
          keyword causes a syntax error.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY</code> is normally a synonym for
          <code class="literal">INDEX</code>. The key attribute <code class="literal">PRIMARY
          KEY</code> can also be specified as just
          <code class="literal">KEY</code> when given in a column definition. This
          was implemented for compatibility with other database systems.
        </p></li><li class="listitem"><p>
          A <code class="literal">UNIQUE</code> index creates a constraint such
          that all values in the index must be distinct. An error occurs
          if you try to add a new row with a key value that matches an
          existing row. For all engines, a <code class="literal">UNIQUE</code>
          index permits multiple <code class="literal">NULL</code> values for
          columns that can contain <code class="literal">NULL</code>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151735120"></a>

          A <code class="literal">PRIMARY KEY</code> is a unique index where all
          key columns must be defined as <code class="literal">NOT NULL</code>. If
          they are not explicitly declared as <code class="literal">NOT
          NULL</code>, MySQL declares them so implicitly (and
          silently). A table can have only one <code class="literal">PRIMARY
          KEY</code>. The name of a <code class="literal">PRIMARY KEY</code> is
          always <code class="literal">PRIMARY</code>, which thus cannot be used
          as the name for any other kind of index.
        </p><p>
          If you do not have a <code class="literal">PRIMARY KEY</code> and an
          application asks for the <code class="literal">PRIMARY KEY</code> in
          your tables, MySQL returns the first <code class="literal">UNIQUE</code>
          index that has no <code class="literal">NULL</code> columns as the
          <code class="literal">PRIMARY KEY</code>.
        </p><p>
          In <code class="literal">InnoDB</code> tables, keep the <code class="literal">PRIMARY
          KEY</code> short to minimize storage overhead for secondary
          indexes. Each secondary index entry contains a copy of the
          primary key columns for the corresponding row. (See
          <a class="xref" href="innodb-storage-engine.html#innodb-table-and-index" title="14.2.6 InnoDB Table and Index Structures">Section 14.2.6, “InnoDB Table and Index Structures”</a>.)
        </p></li><li class="listitem"><p>
          In the created table, a <code class="literal">PRIMARY KEY</code> is
          placed first, followed by all <code class="literal">UNIQUE</code>
          indexes, and then the nonunique indexes. This helps the MySQL
          optimizer to prioritize which index to use and also more
          quickly to detect duplicated <code class="literal">UNIQUE</code> keys.
        </p></li><li class="listitem"><p>
          A <code class="literal">PRIMARY KEY</code> can be a multiple-column
          index. However, you cannot create a multiple-column index
          using the <code class="literal">PRIMARY KEY</code> key attribute in a
          column specification. Doing so only marks that single column
          as primary. You must use a separate <code class="literal">PRIMARY
          KEY(<em class="replaceable"><code>index_col_name</code></em>, ...)</code>
          clause.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151715056"></a>

          If a <code class="literal">PRIMARY KEY</code> or
          <code class="literal">UNIQUE</code> index consists of only one column
          that has an integer type, you can also refer to the column as
          <code class="literal">_rowid</code> in
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
        </p></li><li class="listitem"><p>
          In MySQL, the name of a <code class="literal">PRIMARY KEY</code> is
          <code class="literal">PRIMARY</code>. For other indexes, if you do not
          assign a name, the index is assigned the same name as the
          first indexed column, with an optional suffix
          (<code class="literal">_2</code>, <code class="literal">_3</code>,
          <code class="literal">...</code>) to make it unique. You can see index
          names for a table using <code class="literal">SHOW INDEX FROM
          <em class="replaceable"><code>tbl_name</code></em></code>. See
          <a class="xref" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax">Section 13.7.5.23, “SHOW INDEX Syntax”</a>.
        </p></li><li class="listitem"><p>
          Some storage engines permit you to specify an index type when
          creating an index. The syntax for the
          <em class="replaceable"><code>index_type</code></em> specifier is
          <code class="literal">USING <em class="replaceable"><code>type_name</code></em></code>.
        </p><p>
          Example:
        </p><pre class="programlisting">
CREATE TABLE lookup
  (id INT, INDEX USING BTREE (id))
  ENGINE = MEMORY;
</pre><p>
          The preferred position for <code class="literal">USING</code> is after
          the index column list. It can be given before the column list,
          but support for use of the option in that position is
          deprecated and will be removed in a future MySQL release.
        </p><p>
          <em class="replaceable"><code>index_option</code></em> values specify
          additional options for an index. <code class="literal">USING</code> is
          one such option. For details about permissible
          <em class="replaceable"><code>index_option</code></em> values, see
          <a class="xref" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax">Section 13.1.13, “CREATE INDEX Syntax”</a>.
        </p><p>
          For more information about indexes, see
          <a class="xref" href="optimization.html#mysql-indexes" title="8.3.1 How MySQL Uses Indexes">Section 8.3.1, “How MySQL Uses Indexes”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737151694560"></a>

          <a class="indexterm" name="idm139737151693072"></a>

          In MySQL 5.6, only the <code class="literal">InnoDB</code>,
          <code class="literal">MyISAM</code>, and <code class="literal">MEMORY</code>
          storage engines support indexes on columns that can have
          <code class="literal">NULL</code> values. In other cases, you must
          declare indexed columns as <code class="literal">NOT NULL</code> or an
          error results.
        </p></li><li class="listitem"><p>
          For <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, and
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> columns, indexes can
          be created that use only the leading part of column values,
          using
          <code class="literal"><em class="replaceable"><code>col_name</code></em>(<em class="replaceable"><code>length</code></em>)</code>
          syntax to specify an index prefix length.
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns also can be
          indexed, but a prefix length <span class="emphasis"><em>must</em></span> be
          given. Prefix lengths are given in characters for nonbinary
          string types and in bytes for binary string types. That is,
          index entries consist of the first
          <em class="replaceable"><code>length</code></em> characters of each column
          value for <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns, and the first
          <em class="replaceable"><code>length</code></em> bytes of each column value
          for <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns. Indexing only a
          prefix of column values like this can make the index file much
          smaller. See <a class="xref" href="optimization.html#column-indexes" title="8.3.4 Column Indexes">Section 8.3.4, “Column Indexes”</a>.
        </p><a class="indexterm" name="idm139737151668112"></a><a class="indexterm" name="idm139737151666624"></a><a class="indexterm" name="idm139737151665136"></a><a class="indexterm" name="idm139737151663648"></a><p>
          Only the <code class="literal">InnoDB</code> and
          <code class="literal">MyISAM</code> storage engines support indexing on
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. For example:
        </p><pre class="programlisting">
CREATE TABLE test (blob_col BLOB, INDEX(blob_col(10)));
</pre><p>
          Prefixes can be up to 767 bytes long for
          <code class="literal">InnoDB</code> tables or 3072 bytes if the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_large_prefix"><code class="literal">innodb_large_prefix</code></a> option is
          enabled.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Prefix limits are measured in bytes, whereas the prefix
            length in <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
            statements is interpreted as number of characters for
            nonbinary data types (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>). Take this into account
            when specifying a prefix length for a column that uses a
            multibyte character set.
</p>
</div>
</li><li class="listitem"><p>
          An <em class="replaceable"><code>index_col_name</code></em> specification can
          end with <code class="literal">ASC</code> or <code class="literal">DESC</code>.
          These keywords are permitted for future extensions for
          specifying ascending or descending index value storage.
          Currently, they are parsed but ignored; index values are
          always stored in ascending order.
        </p></li><li class="listitem"><p>
          When you use <code class="literal">ORDER BY</code> or <code class="literal">GROUP
          BY</code> on a column in a
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>, the server sorts values
          using only the initial number of bytes indicated by the
          <a class="link" href="server-administration.html#sysvar_max_sort_length"><code class="literal">max_sort_length</code></a> system
          variable.
        </p></li><li class="listitem"><p>
          You can create special <code class="literal">FULLTEXT</code> indexes,
          which are used for full-text searches. Only the
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> storage engines support
          <code class="literal">FULLTEXT</code> indexes. They can be created only
          from <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>, and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns. Indexing always
          happens over the entire column; column prefix indexing is not
          supported and any prefix length is ignored if specified. See
          <a class="xref" href="functions.html#fulltext-search" title="12.9 Full-Text Search Functions">Section 12.9, “Full-Text Search Functions”</a>, for details of operation. A
          <code class="literal">WITH PARSER</code> clause can be specified as an
          <em class="replaceable"><code>index_option</code></em> value to associate a
          parser plugin with the index if full-text indexing and
          searching operations need special handling. This clause is
          valid only for <code class="literal">FULLTEXT</code> indexes. See
          <a class="xref" href="extending-mysql.html#plugin-api" title="24.2 The MySQL Plugin API">Section 24.2, “The MySQL Plugin API”</a>, for details on creating plugins.
        </p></li><li class="listitem"><p>
          You can create <code class="literal">SPATIAL</code> indexes on spatial
          data types. Spatial types are supported only for
          <code class="literal">MyISAM</code> tables and indexed columns must be
          declared as <code class="literal">NOT NULL</code>. See
          <a class="xref" href="data-types.html#spatial-extensions" title="11.5 Extensions for Spatial Data">Section 11.5, “Extensions for Spatial Data”</a>.
        </p></li><li class="listitem"><p>
          In MySQL 5.6, index definitions can include an
          optional comment of up to 1024 characters.
        </p></li><li class="listitem"><p>
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables support checking of
          foreign key constraints. The columns of the referenced table
          must always be explicitly named. Both <code class="literal">ON
          DELETE</code> and <code class="literal">ON UPDATE</code> actions on
          foreign keys are supported. For more detailed information and
          examples, see <a class="xref" href="sql-syntax.html#create-table-foreign-keys" title="13.1.17.3 Using FOREIGN KEY Constraints">Section 13.1.17.3, “Using FOREIGN KEY Constraints”</a>. For
          information specific to foreign keys in
          <code class="literal">InnoDB</code>, see
          <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="14.5.6 InnoDB and FOREIGN KEY Constraints">Section 14.5.6, “InnoDB and FOREIGN KEY Constraints”</a>.
        </p><p>
          For other storage engines, MySQL Server parses and ignores the
          <code class="literal">FOREIGN KEY</code> and
          <code class="literal">REFERENCES</code> syntax in
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements. The
          <code class="literal">CHECK</code> clause is parsed but ignored by all
          storage engines. See <a class="xref" href="introduction.html#ansi-diff-foreign-keys" title="1.7.2.3 Foreign Key Differences">Section 1.7.2.3, “Foreign Key Differences”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            For users familiar with the ANSI/ISO SQL Standard, please
            note that no storage engine, including
            <code class="literal">InnoDB</code>, recognizes or enforces the
            <code class="literal">MATCH</code> clause used in referential
            integrity constraint definitions. Use of an explicit
            <code class="literal">MATCH</code> clause will not have the specified
            effect, and also causes <code class="literal">ON DELETE</code> and
            <code class="literal">ON UPDATE</code> clauses to be ignored. For
            these reasons, specifying <code class="literal">MATCH</code> should be
            avoided.
          </p><p>
            The <code class="literal">MATCH</code> clause in the SQL standard
            controls how <code class="literal">NULL</code> values in a composite
            (multiple-column) foreign key are handled when comparing to
            a primary key. <code class="literal">InnoDB</code> essentially
            implements the semantics defined by <code class="literal">MATCH
            SIMPLE</code>, which permit a foreign key to be all or
            partially <code class="literal">NULL</code>. In that case, the (child
            table) row containing such a foreign key is permitted to be
            inserted, and does not match any row in the referenced
            (parent) table. It is possible to implement other semantics
            using triggers.
          </p><p>
            Additionally, MySQL requires that the referenced columns be
            indexed for performance. However, it does not enforce any
            requirement that the referenced columns be declared
            <code class="literal">UNIQUE</code> or <code class="literal">NOT NULL</code>.
            The handling of foreign key references to nonunique keys or
            keys that contain <code class="literal">NULL</code> values is not well
            defined for operations such as <code class="literal">UPDATE</code> or
            <code class="literal">DELETE CASCADE</code>. You are advised to use
            foreign keys that reference only keys that are both
            <code class="literal">UNIQUE</code> (or <code class="literal">PRIMARY</code>)
            and <code class="literal">NOT NULL</code>.
          </p><p>
            MySQL parses but ignores <span class="quote">“<span class="quote">inline
            <code class="literal">REFERENCES</code> specifications</span>”</span> (as
            defined in the SQL standard) where the references are
            defined as part of the column specification. MySQL accepts
            <code class="literal">REFERENCES</code> clauses only when specified as
            part of a separate <code class="literal">FOREIGN KEY</code>
            specification.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
            Partitioned tables employing the
            <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage engine do not
            support foreign keys. <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>
            tables that are partitioned by <code class="literal">KEY</code> or
            <code class="literal">LINEAR KEY</code> are not affected by this
            restriction. See <a class="xref" href="partitioning.html#partitioning-limitations" title="19.6 Restrictions and Limitations on Partitioning">Section 19.6, “Restrictions and Limitations on Partitioning”</a>,
            for more information.
</p>
</div>
</li><li class="listitem"><p>
          There is a hard limit of 4096 columns per table, but the
          effective maximum may be less for a given table and depends on
          the factors discussed in <a class="xref" href="restrictions.html#column-count-limit" title="D.10.4 Limits on Table Column Count and Row Size">Section D.10.4, “Limits on Table Column Count and Row Size”</a>.
</p></li></ul>
</div>
<p>
      The <code class="literal">TABLESPACE</code> and <code class="literal">STORAGE</code>
      table options are employed only with
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables. The tablespace named
      <em class="replaceable"><code>tablespace_name</code></em> must already have been
      created using <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a>.
      <code class="literal">STORAGE</code> determines the type of storage used
      (disk or memory), and can be one of <code class="literal">DISK</code>,
      <code class="literal">MEMORY</code>, or <code class="literal">DEFAULT</code>.
    </p><p>
      <code class="literal">TABLESPACE ... STORAGE DISK</code> assigns a table to
      a MySQL Cluster Disk Data tablespace. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>, for more information.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        A <code class="literal">STORAGE</code> clause cannot be used in a
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement without a
        <code class="literal">TABLESPACE</code> clause.
</p>
</div>
<h4><a name="idm139737151571856"></a>Storage Engines</h4>
<p>
      The <code class="literal">ENGINE</code> table option specifies the storage
      engine for the table, using one of the names shown in the
      following table. The engine name can be unquoted or quoted. The
      quoted name <code class="literal">'DEFAULT'</code> is recognized but
      ignored.
</p>
<div class="informaltable">
<table summary="This table lists storage engine names that are taken by
        the ENGINE table option. A description is
        provided for each name." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Storage Engine</th><th scope="col">Description</th></tr></thead><tbody><tr><td scope="row"><code class="literal">InnoDB</code></td><td>Transaction-safe tables with row locking and foreign keys. The default
              storage engine for new tables. See
              <a class="xref" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine">Chapter 14, <i>The InnoDB Storage Engine</i></a>, and in particular
              <a class="xref" href="innodb-storage-engine.html#innodb-default-se" title="14.1.1 InnoDB as the Default MySQL Storage Engine">Section 14.1.1, “InnoDB as the Default MySQL Storage Engine”</a> if you have MySQL
              experience but are new to <code class="literal">InnoDB</code>.</td></tr><tr><td scope="row"><code class="literal">MyISAM</code></td><td>The binary portable storage engine that is primarily used for read-only
              or read-mostly workloads. See
              <a class="xref" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine">Section 15.2, “The MyISAM Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">MEMORY</code></td><td>The data for this storage engine is stored only in memory. See
              <a class="xref" href="storage-engines.html#memory-storage-engine" title="15.3 The MEMORY Storage Engine">Section 15.3, “The MEMORY Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">CSV</code></td><td>Tables that store rows in comma-separated values format. See
              <a class="xref" href="storage-engines.html#csv-storage-engine" title="15.4 The CSV Storage Engine">Section 15.4, “The CSV Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">ARCHIVE</code></td><td>The archiving storage engine. See
              <a class="xref" href="storage-engines.html#archive-storage-engine" title="15.5 The ARCHIVE Storage Engine">Section 15.5, “The ARCHIVE Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">EXAMPLE</code></td><td>An example engine. See <a class="xref" href="storage-engines.html#example-storage-engine" title="15.9 The EXAMPLE Storage Engine">Section 15.9, “The EXAMPLE Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">FEDERATED</code></td><td>Storage engine that accesses remote tables. See
              <a class="xref" href="storage-engines.html#federated-storage-engine" title="15.8 The FEDERATED Storage Engine">Section 15.8, “The FEDERATED Storage Engine”</a>.</td></tr><tr><td scope="row"><code class="literal">HEAP</code></td><td>This is a synonym for <code class="literal">MEMORY</code>.</td></tr><tr><td scope="row"><code class="literal">MERGE</code></td><td>A collection of <code class="literal">MyISAM</code> tables used as one table. Also
              known as <code class="literal">MRG_MyISAM</code>. See
              <a class="xref" href="storage-engines.html#merge-storage-engine" title="15.7 The MERGE Storage Engine">Section 15.7, “The MERGE Storage Engine”</a>.</td></tr><tr><td scope="row"><a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a></td><td>Clustered, fault-tolerant, memory-based tables, supporting transactions
              and foreign keys. Also known as
              <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>. See
<a class="xref" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4">Chapter 18, <i>MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4</i></a>.</td></tr></tbody></table>
</div>
<p>
      If a storage engine is specified that is not available, MySQL uses
      the default engine instead. Normally, this is
      <code class="literal">MyISAM</code>. For example, if a table definition
      includes the <code class="literal">ENGINE=INNODB</code> option but the MySQL
      server does not support <code class="literal">INNODB</code> tables, the
      table is created as a <code class="literal">MyISAM</code> table. This makes
      it possible to have a replication setup where you have
      transactional tables on the master but tables created on the slave
      are nontransactional (to get more speed). In MySQL
      5.6, a warning occurs if the storage engine
      specification is not honored.
    </p><p>
      Engine substitution can be controlled by the setting of the
      <a class="link" href="server-administration.html#sqlmode_no_engine_substitution"><code class="literal">NO_ENGINE_SUBSTITUTION</code></a> SQL mode,
      as described in <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The older <code class="literal">TYPE</code> option that was synonymous
        with <code class="literal">ENGINE</code> was removed in MySQL 5.5.
        <span class="emphasis"><em>When upgrading to MySQL 5.5 or later, you must convert
        existing applications that rely on <code class="literal">TYPE</code> to
        use <code class="literal">ENGINE</code> instead</em></span>.
</p>
</div>
<h4><a name="idm139737151525056"></a>Optimizing Performance</h4>
<p>
      The other table options are used to optimize the behavior of the
      table. In most cases, you do not have to specify any of them.
      These options apply to all storage engines unless otherwise
      indicated. Options that do not apply to a given storage engine may
      be accepted and remembered as part of the table definition. Such
      options then apply if you later use <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> to convert the table to use a different storage
      engine.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">AUTO_INCREMENT</code>
        </p><p>
          The initial <code class="literal">AUTO_INCREMENT</code> value for the
          table. In MySQL 5.6, this works for
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
          <code class="literal">InnoDB</code>, and <code class="literal">ARCHIVE</code>
          tables. To set the first auto-increment value for engines that
          do not support the <code class="literal">AUTO_INCREMENT</code> table
          option, insert a <span class="quote">“<span class="quote">dummy</span>”</span> row with a value one
          less than the desired value after creating the table, and then
          delete the dummy row.
        </p><p>
          For engines that support the <code class="literal">AUTO_INCREMENT</code>
          table option in <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statements, you can also use <code class="literal">ALTER TABLE
          <em class="replaceable"><code>tbl_name</code></em> AUTO_INCREMENT =
          <em class="replaceable"><code>N</code></em></code> to reset the
          <code class="literal">AUTO_INCREMENT</code> value. The value cannot be
          set lower than the maximum value currently in the column.
        </p></li><li class="listitem"><p>
          <code class="literal">AVG_ROW_LENGTH</code>
        </p><p>
          An approximation of the average row length for your table. You
          need to set this only for large tables with variable-size
          rows.
        </p><p>
          When you create a <code class="literal">MyISAM</code> table, MySQL uses
          the product of the <code class="literal">MAX_ROWS</code> and
          <code class="literal">AVG_ROW_LENGTH</code> options to decide how big
          the resulting table is. If you don't specify either option,
          the maximum size for <code class="literal">MyISAM</code> data and index
          files is 256TB by default. (If your operating system does not
          support files that large, table sizes are constrained by the
          file size limit.) If you want to keep down the pointer sizes
          to make the index smaller and faster and you don't really need
          big files, you can decrease the default pointer size by
          setting the
          <a class="link" href="server-administration.html#sysvar_myisam_data_pointer_size"><code class="literal">myisam_data_pointer_size</code></a>
          system variable. (See
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.) If you want all
          your tables to be able to grow above the default limit and are
          willing to have your tables slightly slower and larger than
          necessary, you can increase the default pointer size by
          setting this variable. Setting the value to 7 permits table
          sizes up to 65,536TB.
        </p></li><li class="listitem"><p>
          <code class="literal">[DEFAULT] CHARACTER SET</code>
        </p><p>
          Specify a default character set for the table.
          <code class="literal">CHARSET</code> is a synonym for <code class="literal">CHARACTER
          SET</code>. If the character set name is
          <code class="literal">DEFAULT</code>, the database character set is
          used.
        </p></li><li class="listitem"><p>
          <code class="literal">CHECKSUM</code>
        </p><p>
          Set this to 1 if you want MySQL to maintain a live checksum
          for all rows (that is, a checksum that MySQL updates
          automatically as the table changes). This makes the table a
          little slower to update, but also makes it easier to find
          corrupted tables. The <a class="link" href="sql-syntax.html#checksum-table" title="13.7.2.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM
          TABLE</code></a> statement reports the checksum.
          (<code class="literal">MyISAM</code> only.)
        </p></li><li class="listitem"><p>
          <code class="literal">[DEFAULT] COLLATE</code>
        </p><p>
          Specify a default collation for the table.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMENT</code>
        </p><p>
          A comment for the table, up to 2048 characters long.
        </p></li><li class="listitem"><p>
          <code class="literal">CONNECTION</code>
        </p><p>
          The connection string for a <code class="literal">FEDERATED</code>
          table.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Older versions of MySQL used a <code class="literal">COMMENT</code>
            option for the connection string.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">DATA DIRECTORY</code>, <code class="literal">INDEX
          DIRECTORY</code>
        </p><p>
          For <code class="literal">InnoDB</code>, the <code class="literal">DATA
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          option allows you to create <code class="literal">InnoDB</code>
          file-per-table tablespaces outside the MySQL data directory.
          Within the directory that you specify, MySQL creates a
          subdirectory corresponding to the database name, and within
          that a <code class="filename">.ibd</code> file for the table. The
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
          configuration option must be enabled to use the <code class="literal">DATA
          DIRECTORY</code> option with <code class="literal">InnoDB</code>. The
          full directory path must be specified. See
          <a class="xref" href="innodb-storage-engine.html#tablespace-placing" title="14.4.5 Creating a File-Per-Table Tablespace Outside the Data Directory">Section 14.4.5, “Creating a File-Per-Table Tablespace Outside the Data Directory”</a> for more information.
        </p><p>
          When creating <code class="literal">MyISAM</code> tables, you can use
          the <code class="literal">DATA
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          clause, the <code class="literal">INDEX
          DIRECTORY='<em class="replaceable"><code>directory</code></em>'</code>
          clause, or both. They specify where to put a
          <code class="literal">MyISAM</code> table's data file and index file,
          respectively. Unlike <code class="literal">InnoDB</code> tables, MySQL
          does not create subdirectories that correspond to the database
          name when creating a <code class="literal">MyISAM</code> table with a
          <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
          DIRECTORY</code> option. Files are created in the directory
          that is specified.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            Table-level <code class="literal">DATA DIRECTORY</code> and
            <code class="literal">INDEX DIRECTORY</code> options are ignored for
            partitioned tables. (Bug #32091)
</p>
</div>
<p>
          These options work only when you are not using the
          <a class="link" href="server-administration.html#option_mysqld_symbolic-links"><code class="option">--skip-symbolic-links</code></a>
          option. Your operating system must also have a working,
          thread-safe <code class="literal">realpath()</code> call. See
          <a class="xref" href="optimization.html#symbolic-links-to-tables" title="8.12.4.2 Using Symbolic Links for MyISAM Tables on Unix">Section 8.12.4.2, “Using Symbolic Links for MyISAM Tables on Unix”</a>, for more complete
          information.
        </p><p>
          If a <code class="literal">MyISAM</code> table is created with no
          <code class="literal">DATA DIRECTORY</code> option, the
          <code class="filename">.MYD</code> file is created in the database
          directory. By default, if <code class="literal">MyISAM</code> finds an
          existing <code class="filename">.MYD</code> file in this case, it
          overwrites it. The same applies to <code class="filename">.MYI</code>
          files for tables created with no <code class="literal">INDEX
          DIRECTORY</code> option. To suppress this behavior, start
          the server with the
          <a class="link" href="server-administration.html#sysvar_keep_files_on_create"><code class="option">--keep_files_on_create</code></a> option,
          in which case <code class="literal">MyISAM</code> will not overwrite
          existing files and returns an error instead.
        </p><p>
          If a <code class="literal">MyISAM</code> table is created with a
          <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
          DIRECTORY</code> option and an existing
          <code class="filename">.MYD</code> or <code class="filename">.MYI</code> file is
          found, MyISAM always returns an error. It will not overwrite a
          file in the specified directory.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            You cannot use path names that contain the MySQL data
            directory with <code class="literal">DATA DIRECTORY</code> or
            <code class="literal">INDEX DIRECTORY</code>. This includes
            partitioned tables and individual table partitions. (See Bug
            #32167.)
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">DELAY_KEY_WRITE</code>
        </p><p>
          Set this to 1 if you want to delay key updates for the table
          until the table is closed. See the description of the
          <a class="link" href="server-administration.html#sysvar_delay_key_write"><code class="literal">delay_key_write</code></a> system
          variable in <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
          (<code class="literal">MyISAM</code> only.)
        </p></li><li class="listitem"><p>
          <code class="literal">INSERT_METHOD</code>
        </p><p>
          If you want to insert data into a <code class="literal">MERGE</code>
          table, you must specify with <code class="literal">INSERT_METHOD</code>
          the table into which the row should be inserted.
          <code class="literal">INSERT_METHOD</code> is an option useful for
          <code class="literal">MERGE</code> tables only. Use a value of
          <code class="literal">FIRST</code> or <code class="literal">LAST</code> to have
          inserts go to the first or last table, or a value of
          <code class="literal">NO</code> to prevent inserts. See
          <a class="xref" href="storage-engines.html#merge-storage-engine" title="15.7 The MERGE Storage Engine">Section 15.7, “The MERGE Storage Engine”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY_BLOCK_SIZE</code>
        </p><p>
          For <a class="link" href="glossary.html#glos_compression" title="compression">compressed</a>
          <code class="literal">InnoDB</code> tables, optionally specifies the
          size in kilobytes to use for
          <a class="link" href="glossary.html#glos_page" title="page">pages</a>. Possible
          <code class="literal">KEY_BLOCK_SIZE</code> values include 0, 1, 2, 4,
          8, and 16. The <code class="literal">KEY_BLOCK_SIZE</code> value is
          treated as a hint; a different size could be used by
          <code class="literal">InnoDB</code> if necessary. A value of 0
          represents the default compressed page size, which is half of
          the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value.
          The <code class="literal">KEY_BLOCK_SIZE</code> can only be less than or
          equal to the <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a>
          value. If you specify a value greater than the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value, the
          value is ignored, a warning is issued, and
          <code class="literal">KEY_BLOCK_SIZE</code> is set to half of the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_page_size"><code class="literal">innodb_page_size</code></a> value. If
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode=ON</code></a>,
          specifying an invalid <code class="literal">KEY_BLOCK_SIZE</code> value
          returns an error. See <a class="xref" href="innodb-storage-engine.html#innodb-compression" title="14.6 InnoDB Table Compression">Section 14.6, “InnoDB Table Compression”</a> for
          usage details.
        </p><p>
          Individual index definitions can specify a
          <code class="literal">KEY_BLOCK_SIZE</code> value of their own to
          override the table value.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Oracle recommends enabling
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> when
            using the <code class="literal">KEY_BLOCK_SIZE</code> clause for
            <code class="literal">InnoDB</code> tables.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">MAX_ROWS</code>
        </p><p>
          The maximum number of rows you plan to store in the table.
          This is not a hard limit, but rather a hint to the storage
          engine that the table must be able to store at least this many
          rows.
        </p><p>
          <a class="indexterm" name="idm139737151413808"></a>

          <a class="indexterm" name="idm139737151412320"></a>

          <a class="indexterm" name="idm139737151410832"></a>

          <a class="indexterm" name="idm139737151409344"></a>

          <a class="indexterm" name="idm139737151407856"></a>

          <a class="indexterm" name="idm139737151406368"></a>

          <a class="indexterm" name="idm139737151404896"></a>

          <a class="indexterm" name="idm139737151403440"></a>

          The <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engine treats
          this value as a maximum. If you plan to create very large
          MySQL Cluster tables (containing millions of rows), you should
          use this option to insure that
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> allocates sufficient number
          of index slots in the hash table used for storing hashes of
          the table's primary keys by setting <code class="literal">MAX_ROWS = 2
          * <em class="replaceable"><code>rows</code></em></code>, where
          <em class="replaceable"><code>rows</code></em> is the number of rows that you
          expect to insert into the table.
        </p><p>
          The maximum <code class="literal">MAX_ROWS</code> value is 4294967295;
          larger values are truncated to this limit.
        </p></li><li class="listitem"><p>
          <code class="literal">MIN_ROWS</code>
        </p><p>
          The minimum number of rows you plan to store in the table. The
          <a class="link" href="storage-engines.html#memory-storage-engine" title="15.3 The MEMORY Storage Engine"><code class="literal">MEMORY</code></a> storage engine uses this
          option as a hint about memory use.
        </p></li><li class="listitem"><p>
          <code class="literal">PACK_KEYS</code>
        </p><p>
          <code class="literal">PACK_KEYS</code> takes effect only with
          <code class="literal">MyISAM</code> tables. Set this option to 1 if you
          want to have smaller indexes. This usually makes updates
          slower and reads faster. Setting the option to 0 disables all
          packing of keys. Setting it to <code class="literal">DEFAULT</code>
          tells the storage engine to pack only long
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>, or
          <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> columns.
        </p><p>
          If you do not use <code class="literal">PACK_KEYS</code>, the default is
          to pack strings, but not numbers. If you use
          <code class="literal">PACK_KEYS=1</code>, numbers are packed as well.
        </p><p>
          When packing binary number keys, MySQL uses prefix
          compression:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Every key needs one extra byte to indicate how many bytes
              of the previous key are the same for the next key.
            </p></li><li class="listitem"><p>
              The pointer to the row is stored in high-byte-first order
              directly after the key, to improve compression.
</p></li></ul>
</div>
<p>
          This means that if you have many equal keys on two consecutive
          rows, all following <span class="quote">“<span class="quote">same</span>”</span> keys usually only take
          two bytes (including the pointer to the row). Compare this to
          the ordinary case where the following keys takes
          <code class="literal">storage_size_for_key + pointer_size</code> (where
          the pointer size is usually 4). Conversely, you get a
          significant benefit from prefix compression only if you have
          many numbers that are the same. If all keys are totally
          different, you use one byte more per key, if the key is not a
          key that can have <code class="literal">NULL</code> values. (In this
          case, the packed key length is stored in the same byte that is
          used to mark if a key is <code class="literal">NULL</code>.)
        </p></li><li class="listitem"><p>
          <code class="literal">PASSWORD</code>
        </p><p>
          This option is unused. If you have a need to scramble your
          <code class="filename">.frm</code> files and make them unusable to any
          other MySQL server, please contact our sales department.
        </p></li><li class="listitem"><p>
          <code class="literal">ROW_FORMAT</code>
        </p><p>
          Defines the physical format in which the rows are stored. The
          choices differ depending on the storage engine used for the
          table.
        </p><p>
          For <code class="literal">InnoDB</code> tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Rows are stored in compact format
              (<code class="literal">ROW_FORMAT=COMPACT</code>) by default.
            </p></li><li class="listitem"><p>
              The noncompact format used in older versions of MySQL can
              still be requested by specifying
              <code class="literal">ROW_FORMAT=REDUNDANT</code>.
            </p></li><li class="listitem"><p>
              To enable compression for <code class="literal">InnoDB</code>
              tables, specify <code class="literal">ROW_FORMAT=COMPRESSED</code>
              and follow the procedures in
              <a class="xref" href="innodb-storage-engine.html#innodb-compression" title="14.6 InnoDB Table Compression">Section 14.6, “InnoDB Table Compression”</a>.
            </p></li><li class="listitem"><p>
              For more efficient <code class="literal">InnoDB</code> storage of
              data types, especially <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
              types, specify <code class="literal">ROW_FORMAT=DYNAMIC</code> and
              follow the procedures in
              <a class="xref" href="innodb-storage-engine.html#innodb-row-format-dynamic" title="14.8.3 DYNAMIC and COMPRESSED Row Formats">Section 14.8.3, “DYNAMIC and COMPRESSED Row Formats”</a>. Both the
              <code class="literal">COMPRESSED</code> and
              <code class="literal">DYNAMIC</code> row formats require creating
              the table with the configuration settings
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table=1</code></a>
              and
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_format"><code class="literal">innodb_file_format=barracuda</code></a>.
            </p></li><li class="listitem"><p>
              When you specify a non-default
              <code class="literal">ROW_FORMAT</code> clause, consider also
              enabling the
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a>
              configuration option.
            </p></li><li class="listitem"><p>
              <code class="literal">ROW_FORMAT=FIXED</code> is not supported. If
              <code class="literal">ROW_FORMAT=FIXED</code> is specified while
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
              disabled, <code class="literal">InnoDB</code> issues a warning and
              assumes <code class="literal">ROW_FORMAT=COMPACT</code>. If
              <code class="literal">ROW_FORMAT=FIXED</code> is specified while
              <a class="link" href="innodb-storage-engine.html#sysvar_innodb_strict_mode"><code class="literal">innodb_strict_mode</code></a> is
              enabled, <code class="literal">InnoDB</code> returns an error.
            </p></li><li class="listitem"><p>
              For additional information about <code class="literal">InnoDB</code>
              row formats, see <a class="xref" href="innodb-storage-engine.html#innodb-row-format" title="14.8 InnoDB Row Storage and Row Formats">Section 14.8, “InnoDB Row Storage and Row Formats”</a>.
</p></li></ul>
</div>
<p>
          For <code class="literal">MyISAM</code> tables, the option value can be
          <code class="literal">FIXED</code> or <code class="literal">DYNAMIC</code> for
          static or variable-length row format.
          <a class="link" href="programs.html#myisampack" title="4.6.5 myisampack — Generate Compressed, Read-Only MyISAM Tables"><span class="command"><strong>myisampack</strong></span></a> sets the type to
          <code class="literal">COMPRESSED</code>. See
          <a class="xref" href="storage-engines.html#myisam-table-formats" title="15.2.3 MyISAM Table Storage Formats">Section 15.2.3, “MyISAM Table Storage Formats”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            When executing a <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
            statement, if you specify a row format that is not supported
            by the storage engine that is used for the table, the table
            is created using that storage engine's default row
            format. The information reported in this column in response
            to <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> is the
            actual row format used. This may differ from the value in
            the <code class="literal">Create_options</code> column because the
            original <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
            definition is retained during creation.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">STATS_AUTO_RECALC</code>
        </p><p>
          Specifies whether to automatically recalculate
          <a class="link" href="glossary.html#glos_persistent_statistics" title="persistent statistics">persistent
          statistics</a> for an <code class="literal">InnoDB</code> table. The
          value <code class="literal">DEFAULT</code> causes the persistent
          statistics setting for the table to be determined by the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_auto_recalc"><code class="literal">innodb_stats_auto_recalc</code></a>
          configuration option. The value <code class="literal">1</code> causes
          statistics to be recalculated when 10% of the data in the
          table has changed. The value <code class="literal">0</code> prevents
          automatic recalculation for this table; with this setting,
          issue an <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>
          statement to recalculate the statistics after making
          substantial changes to the table. For more information about
          the persistent statistics feature, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="14.3.11.1 Configuring Persistent Optimizer Statistics Parameters">Section 14.3.11.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">STATS_PERSISTENT</code>
        </p><p>
          Specifies whether to enable
          <a class="link" href="glossary.html#glos_persistent_statistics" title="persistent statistics">persistent
          statistics</a> for an <code class="literal">InnoDB</code> table. The
          value <code class="literal">DEFAULT</code> causes the persistent
          statistics setting for the table to be determined by the
          <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a>
          configuration option. The value <code class="literal">1</code> enables
          persistent statistics for the table, while the value
          <code class="literal">0</code> turns off this feature. After enabling
          persistent statistics through a <code class="literal">CREATE
          TABLE</code> or <code class="literal">ALTER TABLE</code> statement,
          issue an <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>
          statement to calculate the statistics, after loading
          representative data into the table. For more information about
          the persistent statistics feature, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="14.3.11.1 Configuring Persistent Optimizer Statistics Parameters">Section 14.3.11.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">STATS_SAMPLE_PAGES</code>
        </p><p>
          The number of index pages to sample when estimating
          cardinality and other statistics for an indexed column, such
          as those calculated by <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
          TABLE</code></a>. For more information, see
          <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="14.3.11.1 Configuring Persistent Optimizer Statistics Parameters">Section 14.3.11.1, “Configuring Persistent Optimizer Statistics Parameters”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a>
        </p><p>
          <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> is used when you want to
          access a collection of identical <code class="literal">MyISAM</code>
          tables as one. This works only with <code class="literal">MERGE</code>
          tables. See <a class="xref" href="storage-engines.html#merge-storage-engine" title="15.7 The MERGE Storage Engine">Section 15.7, “The MERGE Storage Engine”</a>.
        </p><p>
          You must have <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>,
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>, and
          <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privileges for the
          tables you map to a <code class="literal">MERGE</code> table.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Formerly, all tables used had to be in the same database as
            the <code class="literal">MERGE</code> table itself. This restriction
            no longer applies.
</p>
</div>
</li></ul>
</div>
<h4><a name="create-table-partitioning"></a>Creating Partitioned Tables</h4>
<p>
      <em class="replaceable"><code>partition_options</code></em> can be used to
      control partitioning of the table created with
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Not all options shown in the syntax for
        <em class="replaceable"><code>partition_options</code></em> at the beginning of
        this section are available for all partitioning types. Please
        see the listings for the following individual types for
        information specific to each type, and see
        <a class="xref" href="partitioning.html" title="Chapter 19 Partitioning">Chapter 19, <i>Partitioning</i></a>, for more complete information
        about the workings of and uses for partitioning in MySQL, as
        well as additional examples of table creation and other
        statements relating to MySQL partitioning.
</p>
</div>
<p>
      If used, a <em class="replaceable"><code>partition_options</code></em> clause
      begins with <code class="literal">PARTITION BY</code>. This clause contains
      the function that is used to determine the partition; the function
      returns an integer value ranging from 1 to
      <em class="replaceable"><code>num</code></em>, where
      <em class="replaceable"><code>num</code></em> is the number of partitions. (The
      maximum number of user-defined partitions which a table may
      contain is 1024; the number of subpartitions—discussed later
      in this section—is included in this maximum.) The choices
      that are available for this function in MySQL 5.6 are
      shown in the following list:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">HASH(<em class="replaceable"><code>expr</code></em>)</code>:
          Hashes one or more columns to create a key for placing and
          locating rows. <em class="replaceable"><code>expr</code></em> is an
          expression using one or more table columns. This can be any
          valid MySQL expression (including MySQL functions) that yields
          a single integer value. For example, these are both valid
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statements using
          <code class="literal">PARTITION BY HASH</code>:
        </p><pre class="programlisting">
CREATE TABLE t1 (col1 INT, col2 CHAR(5))
    PARTITION BY HASH(col1);

CREATE TABLE t1 (col1 INT, col2 CHAR(5), col3 DATETIME)
    PARTITION BY HASH ( YEAR(col3) );
</pre><p>
          You may not use either <code class="literal">VALUES LESS THAN</code> or
          <code class="literal">VALUES IN</code> clauses with <code class="literal">PARTITION
          BY HASH</code>.
        </p><p>
          <code class="literal">PARTITION BY HASH</code> uses the remainder of
          <em class="replaceable"><code>expr</code></em> divided by the number of
          partitions (that is, the modulus). For examples and additional
          information, see <a class="xref" href="partitioning.html#partitioning-hash" title="19.2.4 HASH Partitioning">Section 19.2.4, “HASH Partitioning”</a>.
        </p><p>
          The <code class="literal">LINEAR</code> keyword entails a somewhat
          different algorithm. In this case, the number of the partition
          in which a row is stored is calculated as the result of one or
          more logical <a class="link" href="functions.html#operator_and"><code class="literal">AND</code></a> operations. For
          discussion and examples of linear hashing, see
          <a class="xref" href="partitioning.html#partitioning-linear-hash" title="19.2.4.1 LINEAR HASH Partitioning">Section 19.2.4.1, “LINEAR HASH Partitioning”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">KEY(<em class="replaceable"><code>column_list</code></em>)</code>:
          This is similar to <code class="literal">HASH</code>, except that MySQL
          supplies the hashing function so as to guarantee an even data
          distribution. The <em class="replaceable"><code>column_list</code></em>
          argument is simply a list of 1 or more table columns (maximum:
          16). This example shows a simple table partitioned by key,
          with 4 partitions:
        </p><pre class="programlisting">
CREATE TABLE tk (col1 INT, col2 CHAR(5), col3 DATE)
    PARTITION BY KEY(col3)
    PARTITIONS 4;
</pre><p>
          For tables that are partitioned by key, you can employ linear
          partitioning by using the <code class="literal">LINEAR</code> keyword.
          This has the same effect as with tables that are partitioned
          by <code class="literal">HASH</code>. That is, the partition number is
          found using the
          <a class="link" href="functions.html#operator_bitwise-and"><code class="literal">&amp;</code></a>
          operator rather than the modulus (see
          <a class="xref" href="partitioning.html#partitioning-linear-hash" title="19.2.4.1 LINEAR HASH Partitioning">Section 19.2.4.1, “LINEAR HASH Partitioning”</a>, and
          <a class="xref" href="partitioning.html#partitioning-key" title="19.2.5 KEY Partitioning">Section 19.2.5, “KEY Partitioning”</a>, for details). This example
          uses linear partitioning by key to distribute data between 5
          partitions:
        </p><pre class="programlisting">
CREATE TABLE tk (col1 INT, col2 CHAR(5), col3 DATE)
    PARTITION BY LINEAR KEY(col3)
    PARTITIONS 5;
</pre><p>
          The <code class="literal">ALGORITHM={1|2}</code> option is supported
          with <code class="literal">[SUB]PARTITION BY [LINEAR] KEY</code>
          beginning with MySQL 5.6.11. <code class="literal">ALGORITHM=1</code>
          causes the server to use the same key-hashing functions as
          MySQL 5.1; <code class="literal">ALGORITHM=2</code> means that the
          server employs the key-hashing functions implemented and used
          by default for new <code class="literal">KEY</code> partitioned tables
          in MySQL 5.5 and later. (Partitioned tables created with the
          key-hashing functions employed in MySQL 5.5 and later cannot
          be used by a MySQL 5.1 server.) Not specifying the option has
          the same effect as using <code class="literal">ALGORITHM=2</code>. This
          option is intended for use chiefly when upgrading or
          downgrading <code class="literal">[LINEAR] KEY</code> partitioned tables
          between MySQL 5.1 and later MySQL versions, or for creating
          tables partitioned by <code class="literal">KEY</code> or
          <code class="literal">LINEAR KEY</code> on a MySQL 5.5 or later server
          which can be used on a MySQL 5.1 server. For more information,
          see <a class="xref" href="sql-syntax.html#alter-table-partition-operations" title="13.1.7.1 ALTER TABLE Partition Operations">Section 13.1.7.1, “ALTER TABLE Partition Operations”</a>.
        </p><p>
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> in MySQL 5.6.11 and later writes
          this option encased in versioned comments, like this:
        </p><pre class="programlisting">
CREATE TABLE t1 (a INT)
/*!50100 PARTITION BY KEY */ <span class="emphasis"><em>/*!50611 ALGORITHM = 1 */</em></span> /*!50100 ()
      PARTITIONS 3 */
</pre><p>
          This causes MySQL 5.6.10 and earlier servers to ignore the
          option, which would otherwise cause a syntax error in those
          versions. If you plan to load a dump made on a MySQL 5.5.31 or
          later MySQL 5.5 server where you use tables that are
          partitioned or subpartitioned by <code class="literal">KEY</code> into a
          MySQL 5.6 server previous to version 5.6.11, be sure to
          consult <a class="xref" href="installing.html#upgrading-from-previous-series" title="2.11.1.3 Upgrading from MySQL 5.5 to 5.6">Section 2.11.1.3, “Upgrading from MySQL 5.5 to 5.6”</a>,
          before proceeding. (The information found there also applies
          if you are loading a dump containing <code class="literal">KEY</code>
          partitioned or subpartitioned tables made from a MySQL 5.6.11
          or later server into a MySQL 5.5.30 or earlier server.)
        </p><p>
          Also in MySQL 5.6.11 and later, <code class="literal">ALGORITHM=1</code>
          is shown when necessary in the output of
          <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> using
          versioned comments in the same manner as
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>. <code class="literal">ALGORITHM=2</code>
          is always omitted from <code class="literal">SHOW CREATE TABLE</code>
          output, even if this option was specified when creating the
          original table.
        </p><p>
          You may not use either <code class="literal">VALUES LESS THAN</code> or
          <code class="literal">VALUES IN</code> clauses with <code class="literal">PARTITION
          BY KEY</code>.
        </p></li><li class="listitem"><p>
          <code class="literal">RANGE(<em class="replaceable"><code>expr</code></em>)</code>: In
          this case, <em class="replaceable"><code>expr</code></em> shows a range of
          values using a set of <code class="literal">VALUES LESS THAN</code>
          operators. When using range partitioning, you must define at
          least one partition using <code class="literal">VALUES LESS THAN</code>.
          You cannot use <code class="literal">VALUES IN</code> with range
          partitioning.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For tables partitioned by <code class="literal">RANGE</code>,
            <code class="literal">VALUES LESS THAN</code> must be used with either
            an integer literal value or an expression that evaluates to
            a single integer value. In MySQL 5.6, you can
            overcome this limitation in a table that is defined using
            <code class="literal">PARTITION BY RANGE COLUMNS</code>, as described
            later in this section.
</p>
</div>
<p>
          Suppose that you have a table that you wish to partition on a
          column containing year values, according to the following
          scheme.
</p>
<div class="informaltable">
<table summary="This table illustrates a table partitioning scheme
            based on a column containing year values, as described in
            the preceding text. The table lists partition numbers and
corresponding range of years." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Partition Number:</th><th scope="col">Years Range:</th></tr></thead><tbody><tr><td scope="row">0</td><td>1990 and earlier</td></tr><tr><td scope="row">1</td><td>1991 to 1994</td></tr><tr><td scope="row">2</td><td>1995 to 1998</td></tr><tr><td scope="row">3</td><td>1999 to 2002</td></tr><tr><td scope="row">4</td><td>2003 to 2005</td></tr><tr><td scope="row">5</td><td>2006 and later</td></tr></tbody></table>
</div>
<p>
          A table implementing such a partitioning scheme can be
          realized by the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          statement shown here:
        </p><pre class="programlisting">
CREATE TABLE t1 (
    year_col  INT,
    some_data INT
)
PARTITION BY RANGE (year_col) (
    PARTITION p0 VALUES LESS THAN (1991),
    PARTITION p1 VALUES LESS THAN (1995),
    PARTITION p2 VALUES LESS THAN (1999),
    PARTITION p3 VALUES LESS THAN (2002),
    PARTITION p4 VALUES LESS THAN (2006),
    PARTITION p5 VALUES LESS THAN MAXVALUE
);
</pre><p>
          <code class="literal">PARTITION ... VALUES LESS THAN ...</code>
          statements work in a consecutive fashion. <code class="literal">VALUES LESS
          THAN MAXVALUE</code> works to specify
          <span class="quote">“<span class="quote">leftover</span>”</span> values that are greater than the
          maximum value otherwise specified.
        </p><p>
          <code class="literal">VALUES LESS THAN</code> clauses work sequentially
          in a manner similar to that of the <code class="literal">case</code>
          portions of a <code class="literal">switch ... case</code> block (as
          found in many programming languages such as C, Java, and PHP).
          That is, the clauses must be arranged in such a way that the
          upper limit specified in each successive <code class="literal">VALUES LESS
          THAN</code> is greater than that of the previous one, with
          the one referencing <code class="literal">MAXVALUE</code> coming last of
          all in the list.
        </p></li><li class="listitem"><p>
          <code class="literal">RANGE
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code>:
          This variant on <code class="literal">RANGE</code> facilitates partition
          pruning for queries using range conditions on multiple columns
          (that is, having conditions such as <code class="literal">WHERE a = 1 AND b
          &lt; 10</code> or <code class="literal">WHERE a = 1 AND b = 10 AND c
          &lt; 10</code>). It enables you to specify value ranges in
          multiple columns by using a list of columns in the
          <code class="literal">COLUMNS</code> clause and a set of column values
          in each <code class="literal">PARTITION ... VALUES LESS THAN
          (<em class="replaceable"><code>value_list</code></em>)</code> partition
          definition clause. (In the simplest case, this set consists of
          a single column.) The maximum number of columns that can be
          referenced in the <em class="replaceable"><code>column_list</code></em> and
          <em class="replaceable"><code>value_list</code></em> is 16.
        </p><p>
          The <em class="replaceable"><code>column_list</code></em> used in the
          <code class="literal">COLUMNS</code> clause may contain only names of
          columns; each column in the list must be one of the following
          MySQL data types: the integer types; the string types; and
          time or date column types. Columns using
          <code class="literal">BLOB</code>, <code class="literal">TEXT</code>,
          <code class="literal">SET</code>, <code class="literal">ENUM</code>,
          <code class="literal">BIT</code>, or spatial data types are not
          permitted; columns that use floating-point number types are
          also not permitted. You also may not use functions or
          arithmetic expressions in the <code class="literal">COLUMNS</code>
          clause.
        </p><p>
          The <code class="literal">VALUES LESS THAN</code> clause used in a
          partition definition must specify a literal value for each
          column that appears in the <code class="literal">COLUMNS()</code>
          clause; that is, the list of values used for each
          <code class="literal">VALUES LESS THAN</code> clause must contain the
          same number of values as there are columns listed in the
          <code class="literal">COLUMNS</code> clause. An attempt to use more or
          fewer values in a <code class="literal">VALUES LESS THAN</code> clause
          than there are in the <code class="literal">COLUMNS</code> clause causes
          the statement to fail with the error <span class="errortext">Inconsistency
          in usage of column lists for partitioning...</span>. You
          cannot use <code class="literal">NULL</code> for any value appearing in
          <code class="literal">VALUES LESS THAN</code>. It is possible to use
          <code class="literal">MAXVALUE</code> more than once for a given column
          other than the first, as shown in this example:
        </p><pre class="programlisting">
CREATE TABLE rc (
    a INT NOT NULL, 
    b INT NOT NULL
)
PARTITION BY RANGE COLUMNS(a,b) (
    PARTITION p0 VALUES LESS THAN (10,5),
    PARTITION p1 VALUES LESS THAN (20,10),
    PARTITION p2 VALUES LESS THAN (MAXVALUE,15),
    PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
);
</pre><p>
          Each value used in a <code class="literal">VALUES LESS THAN</code> value
          list must match the type of the corresponding column exactly;
          no conversion is made. For example, you cannot use the string
          <code class="literal">'1'</code> for a value that matches a column that
          uses an integer type (you must use the numeral
          <code class="literal">1</code> instead), nor can you use the numeral
          <code class="literal">1</code> for a value that matches a column that
          uses a string type (in such a case, you must use a quoted
          string: <code class="literal">'1'</code>).
        </p><p>
          For more information, see
          <a class="xref" href="partitioning.html#partitioning-range" title="19.2.1 RANGE Partitioning">Section 19.2.1, “RANGE Partitioning”</a>, and
          <a class="xref" href="partitioning.html#partitioning-pruning" title="19.4 Partition Pruning">Section 19.4, “Partition Pruning”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">LIST(<em class="replaceable"><code>expr</code></em>)</code>: This
          is useful when assigning partitions based on a table column
          with a restricted set of possible values, such as a state or
          country code. In such a case, all rows pertaining to a certain
          state or country can be assigned to a single partition, or a
          partition can be reserved for a certain set of states or
          countries. It is similar to <code class="literal">RANGE</code>, except
          that only <code class="literal">VALUES IN</code> may be used to specify
          permissible values for each partition.
        </p><p>
          <code class="literal">VALUES IN</code> is used with a list of values to
          be matched. For instance, you could create a partitioning
          scheme such as the following:
        </p><pre class="programlisting">
CREATE TABLE client_firms (
    id   INT,
    name VARCHAR(35)
)
PARTITION BY LIST (id) (
    PARTITION r0 VALUES IN (1, 5, 9, 13, 17, 21),
    PARTITION r1 VALUES IN (2, 6, 10, 14, 18, 22),
    PARTITION r2 VALUES IN (3, 7, 11, 15, 19, 23),
    PARTITION r3 VALUES IN (4, 8, 12, 16, 20, 24)
);
</pre><p>
          When using list partitioning, you must define at least one
          partition using <code class="literal">VALUES IN</code>. You cannot use
          <code class="literal">VALUES LESS THAN</code> with <code class="literal">PARTITION BY
          LIST</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            For tables partitioned by <code class="literal">LIST</code>, the value
            list used with <code class="literal">VALUES IN</code> must consist of
            integer values only. In MySQL 5.6, you can
            overcome this limitation using partitioning by <code class="literal">LIST
            COLUMNS</code>, which is described later in this section.
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">LIST
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code>:
          This variant on <code class="literal">LIST</code> facilitates partition
          pruning for queries using comparison conditions on multiple
          columns (that is, having conditions such as <code class="literal">WHERE a =
          5 AND b = 5</code> or <code class="literal">WHERE a = 1 AND b = 10 AND c
          = 5</code>). It enables you to specify values in multiple
          columns by using a list of columns in the
          <code class="literal">COLUMNS</code> clause and a set of column values
          in each <code class="literal">PARTITION ... VALUES IN
          (<em class="replaceable"><code>value_list</code></em>)</code> partition
          definition clause.
        </p><p>
          The rules governing regarding data types for the column list
          used in <code class="literal">LIST
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code> and
          the value list used in <code class="literal">VALUES
          IN(<em class="replaceable"><code>value_list</code></em>)</code> are the
          same as those for the column list used in <code class="literal">RANGE
          COLUMNS(<em class="replaceable"><code>column_list</code></em>)</code> and
          the value list used in <code class="literal">VALUES LESS
          THAN(<em class="replaceable"><code>value_list</code></em>)</code>,
          respectively, except that in the <code class="literal">VALUES IN</code>
          clause, <code class="literal">MAXVALUE</code> is not permitted, and you
          may use <code class="literal">NULL</code>.
        </p><p>
          There is one important difference between the list of values
          used for <code class="literal">VALUES IN</code> with <code class="literal">PARTITION
          BY LIST COLUMNS</code> as opposed to when it is used with
          <code class="literal">PARTITION BY LIST</code>. When used with
          <code class="literal">PARTITION BY LIST COLUMNS</code>, each element in
          the <code class="literal">VALUES IN</code> clause must be a
          <span class="emphasis"><em>set</em></span> of column values; the number of
          values in each set must be the same as the number of columns
          used in the <code class="literal">COLUMNS</code> clause, and the data
          types of these values must match those of the columns (and
          occur in the same order). In the simplest case, the set
          consists of a single column. The maximum number of columns
          that can be used in the <em class="replaceable"><code>column_list</code></em>
          and in the elements making up the
          <em class="replaceable"><code>value_list</code></em> is 16.
        </p><p>
          The table defined by the following <code class="literal">CREATE
          TABLE</code> statement provides an example of a table using
          <code class="literal">LIST COLUMNS</code> partitioning:
        </p><pre class="programlisting">
CREATE TABLE lc (
    a INT NULL, 
    b INT NULL
)
PARTITION BY LIST COLUMNS(a,b) (
    PARTITION p0 VALUES IN( (0,0), (NULL,NULL) ),
    PARTITION p1 VALUES IN( (0,1), (0,2), (0,3), (1,1), (1,2) ),
    PARTITION p2 VALUES IN( (1,0), (2,0), (2,1), (3,0), (3,1) ),
    PARTITION p3 VALUES IN( (1,3), (2,2), (2,3), (3,2), (3,3) )
);
</pre></li><li class="listitem"><p>
          The number of partitions may optionally be specified with a
          <code class="literal">PARTITIONS <em class="replaceable"><code>num</code></em></code>
          clause, where <em class="replaceable"><code>num</code></em> is the number of
          partitions. If both this clause <span class="emphasis"><em>and</em></span> any
          <code class="literal">PARTITION</code> clauses are used,
          <em class="replaceable"><code>num</code></em> must be equal to the total
          number of any partitions that are declared using
          <code class="literal">PARTITION</code> clauses.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Whether or not you use a <code class="literal">PARTITIONS</code>
            clause in creating a table that is partitioned by
            <code class="literal">RANGE</code> or <code class="literal">LIST</code>, you
            must still include at least one <code class="literal">PARTITION
            VALUES</code> clause in the table definition (see below).
</p>
</div>
</li><li class="listitem"><p>
          A partition may optionally be divided into a number of
          subpartitions. This can be indicated by using the optional
          <code class="literal">SUBPARTITION BY</code> clause. Subpartitioning may
          be done by <code class="literal">HASH</code> or <code class="literal">KEY</code>.
          Either of these may be <code class="literal">LINEAR</code>. These work
          in the same way as previously described for the equivalent
          partitioning types. (It is not possible to subpartition by
          <code class="literal">LIST</code> or <code class="literal">RANGE</code>.)
        </p><p>
          The number of subpartitions can be indicated using the
          <code class="literal">SUBPARTITIONS</code> keyword followed by an
          integer value.
        </p></li><li class="listitem"><p>
          Rigorous checking of the value used in
          <code class="literal">PARTITIONS</code> or
          <code class="literal">SUBPARTITIONS</code> clauses is applied and this
          value must adhere to the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The value must be a positive, nonzero integer.
            </p></li><li class="listitem"><p>
              No leading zeros are permitted.
            </p></li><li class="listitem"><p>
              The value must be an integer literal, and cannot not be an
              expression. For example, <code class="literal">PARTITIONS
              0.2E+01</code> is not permitted, even though
              <code class="literal">0.2E+01</code> evaluates to
              <code class="literal">2</code>. (Bug #15890)
</p></li></ul>
</div>
</li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
        The expression (<em class="replaceable"><code>expr</code></em>) used in a
        <code class="literal">PARTITION BY</code> clause cannot refer to any
        columns not in the table being created; such references are
        specifically not permitted and cause the statement to fail with
        an error. (Bug #29444)
</p>
</div>
<p>
      Each partition may be individually defined using a
      <em class="replaceable"><code>partition_definition</code></em> clause. The
      individual parts making up this clause are as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">PARTITION
          <em class="replaceable"><code>partition_name</code></em></code>: This
          specifies a logical name for the partition.
        </p></li><li class="listitem"><p>
          A <code class="literal">VALUES</code> clause: For range partitioning,
          each partition must include a <code class="literal">VALUES LESS
          THAN</code> clause; for list partitioning, you must specify
          a <code class="literal">VALUES IN</code> clause for each partition. This
          is used to determine which rows are to be stored in this
          partition. See the discussions of partitioning types in
          <a class="xref" href="partitioning.html" title="Chapter 19 Partitioning">Chapter 19, <i>Partitioning</i></a>, for syntax examples.
        </p></li><li class="listitem"><p>
          An optional <code class="literal">COMMENT</code> clause may be used to
          specify a string that describes the partition. Example:
        </p><pre class="programlisting">
COMMENT = 'Data for the years previous to 1999'
</pre><p>
          Beginning with MySQL 5.6.6, the maximum length for a partition
          comment is 1024 characters. (Previously, this limit was not
          explicitly defined.)
        </p></li><li class="listitem"><p>
          <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
          DIRECTORY</code> may be used to indicate the directory
          where, respectively, the data and indexes for this partition
          are to be stored. Both the
          <code class="filename"><em class="replaceable"><code>data_dir</code></em></code> and
          the <code class="filename"><em class="replaceable"><code>index_dir</code></em></code>
          must be absolute system path names. Example:
        </p><pre class="programlisting">
CREATE TABLE th (id INT, name VARCHAR(30), adate DATE)
PARTITION BY LIST(YEAR(adate))
(
  PARTITION p1999 VALUES IN (1995, 1999, 2003)
    DATA DIRECTORY = '<code class="filename">/var/appdata/95/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/95/idx</code>',
  PARTITION p2000 VALUES IN (1996, 2000, 2004)
    DATA DIRECTORY = '<code class="filename">/var/appdata/96/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/96/idx</code>',
  PARTITION p2001 VALUES IN (1997, 2001, 2005)
    DATA DIRECTORY = '<code class="filename">/var/appdata/97/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/97/idx</code>',
  PARTITION p2002 VALUES IN (1998, 2002, 2006)
    DATA DIRECTORY = '<code class="filename">/var/appdata/98/data</code>'
    INDEX DIRECTORY = '<code class="filename">/var/appdata/98/idx</code>'
);
</pre><p>
          <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
          DIRECTORY</code> behave in the same way as in the
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement's
          <em class="replaceable"><code>table_option</code></em> clause as used for
          <code class="literal">MyISAM</code> tables.
        </p><p>
          One data directory and one index directory may be specified
          per partition. If left unspecified, the data and indexes are
          stored by default in the table's database directory.
        </p><p>
          On Windows, the <code class="literal">DATA DIRECTORY</code> and
          <code class="literal">INDEX DIRECTORY</code> options are not supported
          for individual partitions or subpartitions of
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> tables, and the
          <code class="literal">INDEX DIRECTORY</code> option is not supported for
          individual partitions or subpartitions of
          <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables. These options are
          ignored on Windows, except that a warning is generated. (Bug
          #30459)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            The <code class="literal">DATA DIRECTORY</code> and <code class="literal">INDEX
            DIRECTORY</code> options are ignored for creating
            partitioned tables if
            <a class="link" href="server-administration.html#sqlmode_no_dir_in_create"><code class="literal">NO_DIR_IN_CREATE</code></a> is in
            effect. (Bug #24633)
</p>
</div>
</li><li class="listitem"><p>
          <code class="literal">MAX_ROWS</code> and <code class="literal">MIN_ROWS</code>
          may be used to specify, respectively, the maximum and minimum
          number of rows to be stored in the partition. The values for
          <em class="replaceable"><code>max_number_of_rows</code></em> and
          <em class="replaceable"><code>min_number_of_rows</code></em> must be positive
          integers. As with the table-level options with the same names,
          these act only as <span class="quote">“<span class="quote">suggestions</span>”</span> to the server and
          are not hard limits.
        </p></li><li class="listitem"><p>
          The optional <code class="literal">TABLESPACE</code> clause may be used
          to designate a tablespace for the partition. Used for MySQL
          Cluster only.
        </p></li><li class="listitem"><p>
          The partitioning handler accepts a <code class="literal">[STORAGE]
          ENGINE</code> option for both <code class="literal">PARTITION</code>
          and <code class="literal">SUBPARTITION</code>. Currently, the only way
          in which this can be used is to set all partitions or all
          subpartitions to the same storage engine, and an attempt to
          set different storage engines for partitions or subpartitions
          in the same table will give rise to the error <span class="errortext">ERROR
          1469 (HY000): The mix of handlers in the partitions is not
          permitted in this version of MySQL</span>. We expect to
          lift this restriction on partitioning in a future MySQL
          release.
        </p></li><li class="listitem"><p>
          The partition definition may optionally contain one or more
          <em class="replaceable"><code>subpartition_definition</code></em> clauses.
          Each of these consists at a minimum of the
          <code class="literal">SUBPARTITION
          <em class="replaceable"><code>name</code></em></code>, where
          <em class="replaceable"><code>name</code></em> is an identifier for the
          subpartition. Except for the replacement of the
          <code class="literal">PARTITION</code> keyword with
          <code class="literal">SUBPARTITION</code>, the syntax for a subpartition
          definition is identical to that for a partition definition.
        </p><p>
          Subpartitioning must be done by <code class="literal">HASH</code> or
          <code class="literal">KEY</code>, and can be done only on
          <code class="literal">RANGE</code> or <code class="literal">LIST</code>
          partitions. See <a class="xref" href="partitioning.html#partitioning-subpartitions" title="19.2.6 Subpartitioning">Section 19.2.6, “Subpartitioning”</a>.
</p></li></ul>
</div>
<p>
      Partitions can be modified, merged, added to tables, and dropped
      from tables. For basic information about the MySQL statements to
      accomplish these tasks, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>. For
      more detailed descriptions and examples, see
      <a class="xref" href="partitioning.html#partitioning-management" title="19.3 Partition Management">Section 19.3, “Partition Management”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        The original <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement, including all specifications and table options are
        stored by MySQL when the table is created. The information is
        retained so that if you change storage engines, collations or
        other settings using an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> statement, the original table options specified
        are retained. This enables you to change between
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> table types even though the
        row formats supported by the two engines are different.
      </p><p>
        Because the text of the original statement is retained, but due
        to the way that certain values and options may be silently
        reconfigured (such as the <code class="literal">ROW_FORMAT</code>), the
        active table definition (accessible through
        <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> or with
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>) and the table
        creation string (accessible through <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW
        CREATE TABLE</code></a>) will report different values.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-like"></a>13.1.17.1 CREATE TABLE ... LIKE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737151051856"></a><a class="indexterm" name="idm139737151050816"></a><p>
        Use <code class="literal">CREATE TABLE ... LIKE</code> to create an empty
        table based on the definition of another table, including any
        column attributes and indexes defined in the original table:
      </p><pre class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> LIKE <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
        The copy is created using the same version of the table storage
        format as the original table. The
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege is required on
        the original table.
      </p><p>
        <code class="literal">LIKE</code> works only for base tables, not for
        views.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          Beginning with MySQL 5.6.1, you cannot execute <code class="literal">CREATE
          TABLE</code> or <code class="literal">CREATE TABLE ... LIKE</code>
          while a <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement
          is in effect.
        </p><p>
          Also as of MySQL 5.6.1,
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          LIKE</code></a> makes the same checks as
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and does not just
          copy the <code class="filename">.frm</code> file. This means that if
          the current SQL mode is different from the mode in effect when
          the original table was created, the table definition might be
          considered invalid for the new mode and the statement will
          fail.
</p>
</div>
<p>
        <code class="literal">CREATE TABLE ... LIKE</code> does not preserve any
        <code class="literal">DATA DIRECTORY</code> or <code class="literal">INDEX
        DIRECTORY</code> table options that were specified for the
        original table, or any foreign key definitions.
      </p><p>
        If the original table is a <code class="literal">TEMPORARY</code> table,
        <code class="literal">CREATE TABLE ... LIKE</code> does not preserve
        <code class="literal">TEMPORARY</code>. To create a
        <code class="literal">TEMPORARY</code> destination table, use
        <code class="literal">CREATE TEMPORARY TABLE ... LIKE</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-select"></a>13.1.17.2 CREATE TABLE ... SELECT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737151028032"></a><a class="indexterm" name="idm139737151026992"></a><p>
        You can create one table from another by adding a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement at the end of
        the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
      </p><pre class="programlisting">
CREATE TABLE <em class="replaceable"><code>new_tbl</code></em> [AS] SELECT * FROM <em class="replaceable"><code>orig_tbl</code></em>;
</pre><p>
        MySQL creates new columns for all elements in the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE test (a INT NOT NULL AUTO_INCREMENT,</code></strong>
    -&gt;        <strong class="userinput"><code>PRIMARY KEY (a), KEY(b))</code></strong>
    -&gt;        <strong class="userinput"><code>ENGINE=MyISAM SELECT b,c FROM test2;</code></strong>
</pre><p>
        This creates a <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> table with
        three columns, <code class="literal">a</code>, <code class="literal">b</code>, and
        <code class="literal">c</code>. The <code class="literal">ENGINE</code> option is
        part of the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
        statement, and should not be used following the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>; this would result in a
        syntax error. The same is true for other
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> options such as
        <code class="literal">CHARSET</code>.
      </p><p>
        Notice that the columns from the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement are appended to
        the right side of the table, not overlapped onto it. Take the
        following example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM foo;</code></strong>
+---+
| n |
+---+
| 1 |
+---+

mysql&gt; <strong class="userinput"><code>CREATE TABLE bar (m INT) SELECT n FROM foo;</code></strong>
Query OK, 1 row affected (0.02 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM bar;</code></strong>
+------+---+
| m    | n |
+------+---+
| NULL | 1 |
+------+---+
1 row in set (0.00 sec)
</pre><p>
        For each row in table <code class="literal">foo</code>, a row is inserted
        in <code class="literal">bar</code> with the values from
        <code class="literal">foo</code> and default values for the new columns.
      </p><p>
        In a table resulting from
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a>, columns named only in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> part come first.
        Columns named in both parts or only in the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part come after that. The
        data type of <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> columns can
        be overridden by also specifying the column in the
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> part.
      </p><p>
        If any errors occur while copying the data to the table, it is
        automatically dropped and not created.
      </p><p>
        You can precede the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> by
        <code class="literal">IGNORE</code> or
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> to indicate how to handle
        rows that duplicate unique key values. With
        <code class="literal">IGNORE</code>, rows that duplicate an existing row
        on a unique key value are discarded. With
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>, new rows replace rows
        that have the same unique key value. If neither
        <code class="literal">IGNORE</code> nor
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> is specified, duplicate
        unique key values result in an error.
      </p><p>
        Because the ordering of the rows in the underlying
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements cannot always
        be determined, <code class="literal">CREATE TABLE ... IGNORE SELECT</code>
        and <code class="literal">CREATE TABLE ... REPLACE SELECT</code>
        statements in MySQL 5.6.4 and later are flagged as unsafe for
        statement-based replication. With this change, such statements
        produce a warning in the log when using statement-based mode and
        are logged using the row-based format when using
        <code class="literal">MIXED</code> mode. See also
        <a class="xref" href="replication.html#replication-sbr-rbr" title="17.1.2.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.1.2.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a> does not automatically create any indexes for
        you. This is done intentionally to make the statement as
        flexible as possible. If you want to have indexes in the created
        table, you should specify these before the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE bar (UNIQUE (n)) SELECT n FROM foo;</code></strong>
</pre><p>
        Some conversion of data types might occur. For example, the
        <code class="literal">AUTO_INCREMENT</code> attribute is not preserved,
        and <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> columns can become
        <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a> columns. Retrained
        attributes are <code class="literal">NULL</code> (or <code class="literal">NOT
        NULL</code>) and, for those columns that have them,
        <code class="literal">CHARACTER SET</code>, <code class="literal">COLLATION</code>,
        <code class="literal">COMMENT</code>, and the <code class="literal">DEFAULT</code>
        clause.
      </p><p>
        When creating a table with
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE ... SELECT</code></a>, make sure to alias any function
        calls or expressions in the query. If you do not, the
        <code class="literal">CREATE</code> statement might fail or result in
        undesirable column names.
      </p><pre class="programlisting">
CREATE TABLE artists_and_works
  SELECT artist.name, COUNT(work.artist_id) AS number_of_works
  FROM artist LEFT JOIN work ON artist.id = work.artist_id
  GROUP BY artist.id;
</pre><p>
        You can also explicitly specify the data type for a column in
        the created table:
      </p><pre class="programlisting">
CREATE TABLE foo (a TINYINT NOT NULL) SELECT b+1 AS a FROM bar;
</pre><p>
        For <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE
        ... SELECT</code></a>, if <code class="literal">IF NOT EXISTS</code> is
        given and the destination table already exists, the result is
        version dependent. Before MySQL 5.5.6, MySQL handles the
        statement as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The table definition given in the
            <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> part is ignored.
            No error occurs, even if the definition does not match that
            of the existing table. MySQL attempts to insert the rows
            from the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part anyway.
          </p></li><li class="listitem"><p>
            If there is a mismatch between the number of columns in the
            table and the number of columns produced by the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part, the selected
            values are assigned to the rightmost columns. For example,
            if the table contains <em class="replaceable"><code>n</code></em> columns
            and the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> produces
            <em class="replaceable"><code>m</code></em> columns, where
            <em class="replaceable"><code>m</code></em> &lt;
            <em class="replaceable"><code>n</code></em>, the selected values are
            assigned to the <em class="replaceable"><code>m</code></em> rightmost
            columns in the table. Each of the initial
            <em class="replaceable"><code>n</code></em> −
            <em class="replaceable"><code>m</code></em> columns is assigned its default
            value, either that specified explicitly in the column
            definition or the implicit column data type default if the
            definition contains no default. If the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part produces too many
            columns (<em class="replaceable"><code>m</code></em> &gt;
            <em class="replaceable"><code>n</code></em>), an error occurs.
          </p></li><li class="listitem"><p>
            If strict SQL mode is enabled and any of these initial
            columns do not have an explicit default value, the statement
            fails with an error.
</p></li></ul>
</div>
<p>
        The following example illustrates <code class="literal">IF NOT
        EXISTS</code> handling:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (i1 INT DEFAULT 0, i2 INT, i3 INT, i4 INT);</code></strong>
Query OK, 0 rows affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE IF NOT EXISTS t1 (c1 CHAR(10)) SELECT 1, 2;</code></strong>
Query OK, 1 row affected, 1 warning (0.01 sec)
Records: 1  Duplicates: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM t1;</code></strong>
+------+------+------+------+
| i1   | i2   | i3   | i4   |
+------+------+------+------+
|    0 | NULL |    1 |    2 |
+------+------+------+------+
1 row in set (0.00 sec)
</pre><p>
        As of MySQL 5.5.6, handling of
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a> statements was changed
        for the case that the destination table already exists. This
        change also involves a change in MySQL 5.1 beginning with
        5.1.51.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Previously, for
            <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
            TABLE IF NOT EXISTS ... SELECT</code></a>, MySQL produced a
            warning that the table exists, but inserted the rows and
            wrote the statement to the binary log anyway. By contrast,
            <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
            TABLE ... SELECT</code></a> (without <code class="literal">IF NOT
            EXISTS</code>) failed with an error, but MySQL inserted
            no rows and did not write the statement to the binary log.
          </p></li><li class="listitem"><p>
            MySQL now handles both statements the same way when the
            destination table exists, in that neither statement inserts
            rows or is written to the binary log. The difference between
            them is that MySQL produces a warning when <code class="literal">IF NOT
            EXISTS</code> is present and an error when it is not.
</p></li></ul>
</div>
<p>
        This change means that, for the preceding example, the
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a> statement inserts
        nothing into the destination table as of MySQL 5.5.6.
      </p><p>
        This change in handling of <code class="literal">IF NOT EXISTS</code>
        results in an incompatibility for statement-based replication
        from a MySQL 5.1 master with the original behavior and a MySQL
        5.5 slave with the new behavior. Suppose that
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a> is executed on the
        master and the destination table exists. The result is that rows
        are inserted on the master but not on the slave. (Row-based
        replication does not have this problem.)
      </p><p>
        To address this issue, statement-based binary logging for
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a> is changed in MySQL 5.1
        as of 5.1.51:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If the destination table does not exist, there is no change:
            The statement is logged as is.
          </p></li><li class="listitem"><p>
            If the destination table does exist, the statement is logged
            as the equivalent pair of
            <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
            TABLE IF NOT EXISTS</code></a> and
            <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
            SELECT</code></a> statements. (If the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> in the original
            statement is preceded by <code class="literal">IGNORE</code> or
            <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>, the
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> becomes
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT
            IGNORE</code></a> or <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>,
            respectively.)
</p></li></ul>
</div>
<p>
        This change provides forward compatibility for statement-based
        replication from MySQL 5.1 to 5.5 because when the destination
        table exists, the rows will be inserted on both the master and
        slave. To take advantage of this compatibility measure, the 5.1
        server must be at least 5.1.51 and the 5.5 server must be at
        least 5.5.6.
      </p><p>
        To upgrade an existing 5.1-to-5.5 replication scenario, upgrade
        the master first to 5.1.51 or higher. Note that this differs
        from the usual replication upgrade advice of upgrading the slave
        first.
      </p><p>
        A workaround for applications that wish to achieve the original
        effect (rows inserted regardless of whether the destination
        table exists) is to use
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS</code></a> and
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements rather than
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a> statements.
      </p><p>
        Along with the change just described, the following related
        change was made: Previously, if an existing view was named as
        the destination table for
        <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
        TABLE IF NOT EXISTS ... SELECT</code></a>, rows were inserted
        into the underlying base table and the statement was written to
        the binary log. As of MySQL 5.1.51 and 5.5.6, nothing is
        inserted or logged.
      </p><p>
        To ensure that the binary log can be used to re-create the
        original tables, MySQL does not permit concurrent inserts during
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        SELECT</code></a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          You cannot use <code class="literal">FOR UPDATE</code> as part of the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> in a statement such as
          <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
          TABLE <em class="replaceable"><code>new_table</code></em> SELECT ... FROM
          <em class="replaceable"><code>old_table</code></em> ...</code></a>. If you
          attempt to do so, the statement fails. This represents a
          change in behavior from MySQL 5.5 and earlier, which permitted
          <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
          TABLE ... SELECT</code></a> statements to make changes in
          tables other than the table being created.
        </p><p>
          This change can also have implications for statement-based
          replication from an older master to a MySQL 5.6 or newer
          slave. See
          <a class="xref" href="replication.html#replication-features-create-select" title="17.4.1.5 Replication of CREATE TABLE ... SELECT Statements">Section 17.4.1.5, “Replication of CREATE TABLE ... SELECT Statements”</a>, for more
          information.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-table-foreign-keys"></a>13.1.17.3 Using FOREIGN KEY Constraints</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150896528"></a><a class="indexterm" name="idm139737150895456"></a><p>
        MySQL supports foreign keys, which let you cross-reference
        related data across tables, and
        <a class="link" href="glossary.html#glos_foreign_key_constraint" title="FOREIGN KEY constraint">foreign key
        constraints</a>, which help keep this spread-out data
        consistent. The essential syntax for a foreign key constraint
        definition in a <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement looks like
        this:
      </p><pre class="programlisting">
[CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
    [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>index_col_name</code></em>, ...)
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>index_col_name</code></em>,...)
    [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
    [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]

<em class="replaceable"><code>reference_option</code></em>:
    RESTRICT | CASCADE | SET NULL | NO ACTION
</pre><p>
        <em class="replaceable"><code>index_name</code></em> represents a foreign key
        ID. The <em class="replaceable"><code>index_name</code></em> value is ignored
        if there is already an explicitly defined index on the child
        table that can support the foreign key. Otherwise, MySQL
        implicitly creates a foreign key index that is named according
        to the following rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If defined, the <code class="literal">CONSTRAINT</code>
            <em class="replaceable"><code>symbol</code></em> value is used. Otherwise,
            the <code class="literal">FOREIGN KEY</code>
            <em class="replaceable"><code>index_name</code></em> value is used.
          </p></li><li class="listitem"><p>
            If neither a <code class="literal">CONSTRAINT</code>
            <em class="replaceable"><code>symbol</code></em> or <code class="literal">FOREIGN
            KEY</code> <em class="replaceable"><code>index_name</code></em> is
            defined, the foreign key index name is generated using the
            name of the referencing foreign key column.
</p></li></ul>
</div>
<p>
        Foreign keys definitions are subject to the following
        conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Foreign key relationships involve a
            <a class="link" href="glossary.html#glos_parent_table" title="parent table">parent table</a> that
            holds the central data values, and a
            <a class="link" href="glossary.html#glos_child_table" title="child table">child table</a> with
            identical values pointing back to its parent. The
            <code class="literal">FOREIGN KEY</code> clause is specified in the
            child table. The parent and child tables must use the same
            storage engine. They must not be
            <code class="literal">TEMPORARY</code> tables.
          </p><p>
            In MySQL 5.6, creation of a foreign key
            constraint requires at least one of the
            <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>,
            <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
            <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>,
            <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a>, or
            <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a> privileges for the
            parent table as of 5.6.22.
          </p></li><li class="listitem"><p>
            Corresponding columns in the foreign key and the referenced
            key must have similar data types. <span class="emphasis"><em>The size and
            sign of integer types must be the same</em></span>. The
            length of string types need not be the same. For nonbinary
            (character) string columns, the character set and collation
            must be the same.
          </p></li><li class="listitem"><p>
            MySQL requires indexes on foreign keys and referenced keys
            so that foreign key checks can be fast and not require a
            table scan. In the referencing table, there must be an index
            where the foreign key columns are listed as the
            <span class="emphasis"><em>first</em></span> columns in the same order. Such
            an index is created on the referencing table automatically
            if it does not exist. This index might be silently dropped
            later, if you create another index that can be used to
            enforce the foreign key constraint.
            <em class="replaceable"><code>index_name</code></em>, if given, is used as
            described previously.
          </p></li><li class="listitem"><p>
            <code class="literal">InnoDB</code> permits a foreign key to reference
            any index column or group of columns. However, in the
            referenced table, there must be an index where the
            referenced columns are listed as the
            <span class="emphasis"><em>first</em></span> columns in the same order.
          </p><p>
            <code class="literal">NDB</code> requires an explicit unique key (or
            primary key) on any column referenced as a foreign key.
          </p></li><li class="listitem"><p>
            Index prefixes on foreign key columns are not supported. One
            consequence of this is that
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns cannot be
            included in a foreign key because indexes on those columns
            must always include a prefix length.
          </p></li><li class="listitem"><p>
            If the <code class="literal">CONSTRAINT
            <em class="replaceable"><code>symbol</code></em></code> clause is given,
            the <em class="replaceable"><code>symbol</code></em> value, if used, must
            be unique in the database. A duplicate
            <em class="replaceable"><code>symbol</code></em> will result in an error
            similar to: <span class="errortext">ERROR 1022 (2300): Can't write;
            duplicate key in table '#sql- 464_1'</span>. If the
            clause is not given, or a <em class="replaceable"><code>symbol</code></em>
            is not included following the <code class="literal">CONSTRAINT</code>
            keyword, a name for the constraint is created automatically.
          </p></li><li class="listitem"><p>
            <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> does not currently
            support foreign keys for tables with user-defined
            partitioning. This includes both parent and child tables.
          </p><p>
            This restriction does not apply for
            <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables that are partitioned
            by <code class="literal">KEY</code> or <code class="literal">LINEAR KEY</code>
            (the only user partitioning types supported by the
            <code class="literal">NDB</code> storage engine); these may have
            foreign key references or be the targets of such references.
          </p></li><li class="listitem"><p>
            For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, <code class="literal">ON
            UPDATE CASCADE</code> is not supported where the
            reference is to the parent table's primary key.
</p></li></ul>
</div>
<h5><a name="idm139737150837696"></a>Referential Actions</h5>
<p>
        This section describes how foreign keys help guarantee
        <a class="link" href="glossary.html#glos_referential_integrity" title="referential integrity">referential
        integrity</a>.
      </p><p>
        For storage engines supporting foreign keys, MySQL rejects any
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> or
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> operation that attempts to
        create a foreign key value in a child table if there is no a
        matching candidate key value in the parent table.
      </p><p>
        When an <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> or
        <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> operation affects a key
        value in the parent table that has matching rows in the child
        table, the result depends on the <span class="emphasis"><em>referential
        action</em></span> specified using <code class="literal">ON UPDATE</code>
        and <code class="literal">ON DELETE</code> subclauses of the
        <code class="literal">FOREIGN KEY</code> clause. MySQL supports five
        options regarding the action to be taken, listed here:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CASCADE</code>: Delete or update the row from
            the parent table, and automatically delete or update the
            matching rows in the child table. Both <code class="literal">ON DELETE
            CASCADE</code> and <code class="literal">ON UPDATE CASCADE</code>
            are supported. Between two tables, do not define several
            <code class="literal">ON UPDATE CASCADE</code> clauses that act on the
            same column in the parent table or in the child table.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Currently, cascaded foreign key actions do not activate
              triggers.
</p>
</div>
</li><li class="listitem"><p>
            <code class="literal">SET NULL</code>: Delete or update the row from
            the parent table, and set the foreign key column or columns
            in the child table to <code class="literal">NULL</code>. Both
            <code class="literal">ON DELETE SET NULL</code> and <code class="literal">ON UPDATE
            SET NULL</code> clauses are supported.
          </p><p>
            If you specify a <code class="literal">SET NULL</code> action,
            <span class="emphasis"><em>make sure that you have not declared the columns
            in the child table as <code class="literal">NOT
            NULL</code></em></span>.
          </p></li><li class="listitem"><p>
            <code class="literal">RESTRICT</code>: Rejects the delete or update
            operation for the parent table. Specifying
            <code class="literal">RESTRICT</code> (or <code class="literal">NO
            ACTION</code>) is the same as omitting the <code class="literal">ON
            DELETE</code> or <code class="literal">ON UPDATE</code> clause.
          </p></li><li class="listitem"><p>
            <code class="literal">NO ACTION</code>: A keyword from standard SQL.
            In MySQL, equivalent to <code class="literal">RESTRICT</code>. The
            MySQL Server rejects the delete or update operation for the
            parent table if there is a related foreign key value in the
            referenced table. Some database systems have deferred
            checks, and <code class="literal">NO ACTION</code> is a deferred
            check. In MySQL, foreign key constraints are checked
            immediately, so <code class="literal">NO ACTION</code> is the same as
            <code class="literal">RESTRICT</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">SET DEFAULT</code>: This action is recognized by
            the MySQL parser, but both
            <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and
            <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> reject table definitions
            containing <code class="literal">ON DELETE SET DEFAULT</code> or
            <code class="literal">ON UPDATE SET DEFAULT</code> clauses.
</p></li></ul>
</div>
<p>
        For an <code class="literal">ON DELETE</code> or <code class="literal">ON
        UPDATE</code> that is not specified, the default action is
        always <code class="literal">RESTRICT</code>.
      </p><p>
        MySQL supports foreign key references between one column and
        another within a table. (A column cannot have a foreign key
        reference to itself.) In these cases, <span class="quote">“<span class="quote">child table
        records</span>”</span> really refers to dependent records within the
        same table.
</p>
<h5><a name="idm139737150797152"></a>Examples of Foreign Key Clauses</h5>
<p>
        Here is a simple example that relates <code class="literal">parent</code>
        and <code class="literal">child</code> tables through a single-column
        foreign key:
      </p><pre class="programlisting">
CREATE TABLE parent (
    id INT NOT NULL,
    PRIMARY KEY (id)
) ENGINE=INNODB;

CREATE TABLE child (
    id INT, 
    parent_id INT,
    INDEX par_ind (parent_id),
    FOREIGN KEY (parent_id) 
        REFERENCES parent(id)
        ON DELETE CASCADE
) ENGINE=INNODB;
</pre><p>
        A more complex example in which a
        <code class="literal">product_order</code> table has foreign keys for two
        other tables. One foreign key references a two-column index in
        the <code class="literal">product</code> table. The other references a
        single-column index in the <code class="literal">customer</code> table:
      </p><pre class="programlisting">
CREATE TABLE product (
    category INT NOT NULL, id INT NOT NULL,
    price DECIMAL,
    PRIMARY KEY(category, id)
)   ENGINE=INNODB;

CREATE TABLE customer (
    id INT NOT NULL,
    PRIMARY KEY (id)
)   ENGINE=INNODB;

CREATE TABLE product_order (
    no INT NOT NULL AUTO_INCREMENT,
    product_category INT NOT NULL,
    product_id INT NOT NULL,
    customer_id INT NOT NULL,

    PRIMARY KEY(no),
    INDEX (product_category, product_id),
    INDEX (customer_id),

    FOREIGN KEY (product_category, product_id)
      REFERENCES product(category, id)
      ON UPDATE CASCADE ON DELETE RESTRICT,

    FOREIGN KEY (customer_id)
      REFERENCES customer(id)
)   ENGINE=INNODB;
</pre>
<h5><a name="idm139737150788160"></a>Adding foreign keys</h5>
<p>
        You can add a new foreign key constraint to an existing table by
        using <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>. The syntax
        relating to foreign keys for this statement is shown here:
      </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em>
    ADD [CONSTRAINT [<em class="replaceable"><code>symbol</code></em>]] FOREIGN KEY
    [<em class="replaceable"><code>index_name</code></em>] (<em class="replaceable"><code>index_col_name</code></em>, ...)
    REFERENCES <em class="replaceable"><code>tbl_name</code></em> (<em class="replaceable"><code>index_col_name</code></em>,...)
    [ON DELETE <em class="replaceable"><code>reference_option</code></em>]
    [ON UPDATE <em class="replaceable"><code>reference_option</code></em>]
</pre><p>
        The foreign key can be self referential (referring to the same
        table). When you add a foreign key constraint to a table using
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>, <span class="emphasis"><em>remember
        to create the required indexes first.</em></span>
</p>
<h5><a name="idm139737150779312"></a>Dropping Foreign Keys</h5>
<a class="indexterm" name="idm139737150778624"></a><a class="indexterm" name="idm139737150777552"></a><a class="indexterm" name="idm139737150776064"></a><p>
        You can also use <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> to
        drop foreign keys, using the syntax shown here:
      </p><pre class="programlisting">
ALTER TABLE <em class="replaceable"><code>tbl_name</code></em> DROP FOREIGN KEY <em class="replaceable"><code>fk_symbol</code></em>;
</pre><p>
        If the <code class="literal">FOREIGN KEY</code> clause included a
        <code class="literal">CONSTRAINT</code> name when you created the foreign
        key, you can refer to that name to drop the foreign key.
        Otherwise, the <em class="replaceable"><code>fk_symbol</code></em> value is
        generated internally when the foreign key is created. To find
        out the symbol value when you want to drop a foreign key, use a
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> statement, as
        shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE ibtest11c\G</code></strong>
*************************** 1. row ***************************
       Table: ibtest11c
Create Table: CREATE TABLE `ibtest11c` (
  `A` int(11) NOT NULL auto_increment,
  `D` int(11) NOT NULL default '0',
  `B` varchar(200) NOT NULL default '',
  `C` varchar(175) default NULL,
  PRIMARY KEY  (`A`,`D`,`B`),
  KEY `B` (`B`,`C`),
  KEY `C` (`C`),
  CONSTRAINT `0_38775` FOREIGN KEY (`A`, `D`)
REFERENCES `ibtest11a` (`A`, `D`)
ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `0_38776` FOREIGN KEY (`B`, `C`)
REFERENCES `ibtest11a` (`B`, `C`)
ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=INNODB CHARSET=latin1
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE ibtest11c DROP FOREIGN KEY `0_38775`;</code></strong>
</pre><p>
        Prior to MySQL 5.6.6, adding and dropping a foreign key in the
        same <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement may be
        problematic in some cases and is therefore unsupported. Separate
        statements should be used for each operation. As of MySQL 5.6.6,
        adding and dropping a foreign key in the same
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement is
        supported for <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE ... ALGORITHM=INPLACE</code></a> but remains unsupported
        for <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        ALGORITHM=COPY</code></a>.
      </p><p>
        Before MySQL 5.6.7, using <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> to change the definition of a foreign key column
        could cause a loss of referential integrity. For example,
        changing a foreign key column that contained
        <code class="literal">NULL</code> values to be <code class="literal">NOT NULL</code>
        caused the <code class="literal">NULL</code> values to be the empty
        string. Similarly, an
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE
        IGNORE</code></a> that removed rows in a parent table could break
        referential integrity.
      </p><p>
        As of 5.6.7, the server prohibits changes to foreign key columns
        with the potential to cause loss of referential integrity. A
        workaround is to use
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        DROP FOREIGN KEY</code></a> before changing the column definition
        and <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        ADD FOREIGN KEY</code></a> afterward.
</p>
<h5><a name="idm139737150749184"></a>Foreign Keys and Other MySQL Statements</h5>
<p>
        Table and column identifiers in a <code class="literal">FOREIGN KEY ...
        REFERENCES ...</code> clause can be quoted within backticks
        (<code class="literal">`</code>). Alternatively, double quotation marks
        (<code class="literal">"</code>) can be used if the
        <a class="link" href="server-administration.html#sqlmode_ansi_quotes"><code class="literal">ANSI_QUOTES</code></a> SQL mode is
        enabled. The setting of the
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
        variable is also taken into account.
      </p><p>
        You can view a child table's foreign key definitions as
        part of the output of the <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE
        TABLE</code></a> statement:
      </p><pre class="programlisting">
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>;
</pre><p>
        You can also obtain information about foreign keys by querying
        the
        <a class="link" href="information-schema.html#key-column-usage-table" title="21.10 The INFORMATION_SCHEMA KEY_COLUMN_USAGE Table"><code class="literal">INFORMATION_SCHEMA.KEY_COLUMN_USAGE</code></a>
        table.
      </p><p>
        You can find information about foreign keys used by
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables in the
        <a class="link" href="information-schema.html#innodb-sys-foreign-table" title="21.29.11 The INFORMATION_SCHEMA INNODB_SYS_FOREIGN Table"><code class="literal">INNODB_SYS_FOREIGN</code></a> and
        <a class="link" href="information-schema.html#innodb-sys-foreign-cols-table" title="21.29.12 The INFORMATION_SCHEMA INNODB_SYS_FOREIGN_COLS Table"><code class="literal">INNODB_SYS_FOREIGN_COLS</code></a> tables,
        also in the <code class="literal">INFORMATION_SCHEMA</code> database.
      </p><p>
        <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> produces correct definitions of
        tables in the dump file, including the foreign keys for child
        tables.
      </p><p>
        To make it easier to reload dump files for tables that have
        foreign key relationships, <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>
        automatically includes a statement in the dump output to set
        <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> to 0. This
        avoids problems with tables having to be reloaded in a
        particular order when the dump is reloaded. It is also possible
        to set this variable manually:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET foreign_key_checks = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>SOURCE <em class="replaceable"><code>dump_file_name</code></em>;</code></strong>
mysql&gt; <strong class="userinput"><code>SET foreign_key_checks = 1;</code></strong>
</pre><p>
        This enables you to import the tables in any order if the dump
        file contains tables that are not correctly ordered for foreign
        keys. It also speeds up the import operation. Setting
        <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks</code></a> to 0 can
        also be useful for ignoring foreign key constraints during
        <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> and
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> operations. However,
        even if <a class="link" href="server-administration.html#sysvar_foreign_key_checks"><code class="literal">foreign_key_checks = 0</code></a>,
        MySQL does not permit the creation of a foreign key constraint
        where a column references a nonmatching column type. Also, if a
        table has foreign key constraints, <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> cannot be used to alter the table to use another
        storage engine. To change the storage engine, you must drop any
        foreign key constraints first.
      </p><p>
        You cannot issue <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> for a
        table that is referenced by a <code class="literal">FOREIGN KEY</code>
        constraint, unless you do <code class="literal">SET foreign_key_checks =
        0</code>. When you drop a table, any constraints that were
        defined in the statement used to create that table are also
        dropped.
      </p><p>
        If you re-create a table that was dropped, it must have a
        definition that conforms to the foreign key constraints
        referencing it. It must have the correct column names and types,
        and it must have indexes on the referenced keys, as stated
        earlier. If these are not satisfied, MySQL returns Error 1005
        and refers to Error 150 in the error message, which means that a
        foreign key constraint was not correctly formed. Similarly, if
        an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> fails due to Error
        150, this means that a foreign key definition would be
        incorrectly formed for the altered table.
      </p><p>
        For <code class="literal">InnoDB</code> tables, you can obtain a detailed
        explanation of the most recent <code class="literal">InnoDB</code> foreign
        key error in the MySQL Server, by checking the output of
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        STATUS</code></a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          For users familiar with the ANSI/ISO SQL Standard, please note
          that no storage engine, including <code class="literal">InnoDB</code>,
          recognizes or enforces the <code class="literal">MATCH</code> clause
          used in referential-integrity constraint definitions. Use of
          an explicit <code class="literal">MATCH</code> clause will not have the
          specified effect, and also causes <code class="literal">ON DELETE</code>
          and <code class="literal">ON UPDATE</code> clauses to be ignored. For
          these reasons, specifying <code class="literal">MATCH</code> should be
          avoided.
        </p><p>
          The <code class="literal">MATCH</code> clause in the SQL standard
          controls how <code class="literal">NULL</code> values in a composite
          (multiple-column) foreign key are handled when comparing to a
          primary key. MySQL essentially implements the semantics
          defined by <code class="literal">MATCH SIMPLE</code>, which permit a
          foreign key to be all or partially <code class="literal">NULL</code>. In
          that case, the (child table) row containing such a foreign key
          is permitted to be inserted, and does not match any row in the
          referenced (parent) table. It is possible to implement other
          semantics using triggers.
        </p><p>
          Additionally, MySQL requires that the referenced columns be
          indexed for performance reasons. However, the system does not
          enforce a requirement that the referenced columns be
          <code class="literal">UNIQUE</code> or be declared <code class="literal">NOT
          NULL</code>. The handling of foreign key references to
          nonunique keys or keys that contain <code class="literal">NULL</code>
          values is not well defined for operations such as
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> or <code class="literal">DELETE
          CASCADE</code>. You are advised to use foreign keys that
          reference only <code class="literal">UNIQUE</code> (including
          <code class="literal">PRIMARY</code>) and <code class="literal">NOT NULL</code>
          keys.
        </p><p>
          Furthermore, MySQL parses but ignores <span class="quote">“<span class="quote">inline
          <code class="literal">REFERENCES</code> specifications</span>”</span> (as
          defined in the SQL standard) where the references are defined
          as part of the column specification. MySQL accepts
          <code class="literal">REFERENCES</code> clauses only when specified as
          part of a separate <code class="literal">FOREIGN KEY</code>
          specification. For storage engines that do not support foreign
          keys (such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>), MySQL
          Server parses and ignores foreign key specifications.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="silent-column-changes"></a>13.1.17.4 Silent Column Specification Changes</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150687216"></a><p>
        In some cases, MySQL silently changes column specifications from
        those given in a <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement. These
        might be changes to a data type, to attributes associated with a
        data type, or to an index specification.
      </p><p>
        All changes are subject to the internal row-size limit of 65,535
        bytes, which may cause some attempts at data type changes to
        fail. See <a class="xref" href="restrictions.html#column-count-limit" title="D.10.4 Limits on Table Column Count and Row Size">Section D.10.4, “Limits on Table Column Count and Row Size”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Columns that are part of a <code class="literal">PRIMARY KEY</code>
            are made <code class="literal">NOT NULL</code> even if not declared
            that way.
          </p></li><li class="listitem"><p>
            Trailing spaces are automatically deleted from
            <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
            <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> member values when the
            table is created.
          </p></li><li class="listitem"><p>
            MySQL maps certain data types used by other SQL database
            vendors to MySQL types. See
            <a class="xref" href="data-types.html#other-vendor-data-types" title="11.9 Using Data Types from Other Database Engines">Section 11.9, “Using Data Types from Other Database Engines”</a>.
          </p></li><li class="listitem"><p>
            If you include a <code class="literal">USING</code> clause to specify
            an index type that is not permitted for a given storage
            engine, but there is another index type available that the
            engine can use without affecting query results, the engine
            uses the available type.
          </p></li><li class="listitem"><p>
            If strict SQL mode is not enabled, a
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> column with a length
            specification greater than 65535 is converted to
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, and a
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a> column with a
            length specification greater than 65535 is converted to
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>. Otherwise, an error
            occurs in either of these cases.
          </p></li><li class="listitem"><p>
            Specifying the <code class="literal">CHARACTER SET binary</code>
            attribute for a character data type causes the column to be
            created as the corresponding binary data type:
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a> becomes
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a> becomes
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>, and
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> becomes
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>. For the
            <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
            <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> data types, this does not
            occur; they are created as declared. Suppose that you
            specify a table using this definition:
          </p><pre class="programlisting">
CREATE TABLE t
(
  c1 VARCHAR(10) CHARACTER SET binary,
  c2 TEXT CHARACTER SET binary,
  c3 ENUM('a','b','c') CHARACTER SET binary
);
</pre><p>
            The resulting table has this definition:
          </p><pre class="programlisting">
CREATE TABLE t
(
  c1 VARBINARY(10),
  c2 BLOB,
  c3 ENUM('a','b','c') CHARACTER SET binary
);
</pre></li></ul>
</div>
<p>
        To see whether MySQL used a data type other than the one you
        specified, issue a <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> or
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> statement after
        creating or altering the table.
      </p><a class="indexterm" name="idm139737150649760"></a><p>
        Certain other data type changes can occur if you compress a
        table using <a class="link" href="programs.html#myisampack" title="4.6.5 myisampack — Generate Compressed, Read-Only MyISAM Tables"><span class="command"><strong>myisampack</strong></span></a>. See
        <a class="xref" href="storage-engines.html#compressed-format" title="15.2.3.3 Compressed Table Characteristics">Section 15.2.3.3, “Compressed Table Characteristics”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-tablespace"></a>13.1.18 CREATE TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150644944"></a><pre class="programlisting">
CREATE TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>
    ADD DATAFILE '<em class="replaceable"><code>file_name</code></em>'
    USE LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    [EXTENT_SIZE [=] <em class="replaceable"><code>extent_size</code></em>]
    [INITIAL_SIZE [=] <em class="replaceable"><code>initial_size</code></em>]
    [AUTOEXTEND_SIZE [=] <em class="replaceable"><code>autoextend_size</code></em>]
    [MAX_SIZE [=] <em class="replaceable"><code>max_size</code></em>]
    [NODEGROUP [=] <em class="replaceable"><code>nodegroup_id</code></em>]
    [WAIT]
    [COMMENT [=] <em class="replaceable"><code>comment_text</code></em>]
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement is used to create a tablespace, which can contain
      one or more data files, providing storage space for tables. One
      data file is created and added to the tablespace using this
      statement. Additional data files may be added to the tablespace by
      using the <a class="link" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax"><code class="literal">ALTER TABLESPACE</code></a>
      statement (see <a class="xref" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax">Section 13.1.8, “ALTER TABLESPACE Syntax”</a>). For rules
      covering the naming of tablespaces, see
      <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        All MySQL Cluster Disk Data objects share the same namespace.
        This means that <span class="emphasis"><em>each Disk Data object</em></span> must
        be uniquely named (and not merely each Disk Data object of a
        given type). For example, you cannot have a tablespace and a log
        file group with the same name, or a tablespace and a data file
        with the same name.
</p>
</div>
<p>
      A log file group of one or more <code class="literal">UNDO</code> log files
      must be assigned to the tablespace to be created with the
      <code class="literal">USE LOGFILE GROUP</code> clause.
      <em class="replaceable"><code>logfile_group</code></em> must be an existing log
      file group created with <a class="link" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax"><code class="literal">CREATE LOGFILE
      GROUP</code></a> (see <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax">Section 13.1.14, “CREATE LOGFILE GROUP Syntax”</a>).
      Multiple tablespaces may use the same log file group for
      <code class="literal">UNDO</code> logging.
    </p><p>
      The <code class="literal">EXTENT_SIZE</code> sets the size, in bytes, of the
      extents used by any files belonging to the tablespace. The default
      value is 1M. The minimum size is 32K, and theoretical maximum is
      2G, although the practical maximum size depends on a number of
      factors. In most cases, changing the extent size does not have any
      measurable effect on performance, and the default value is
      recommended for all but the most unusual situations.
    </p><p>
      An <em class="firstterm">extent</em> is a unit of disk space
      allocation. One extent is filled with as much data as that extent
      can contain before another extent is used. In theory, up to 65,535
      (64K) extents may used per data file; however, the recommended
      maximum is 32,768 (32K). The recommended maximum size for a single
      data file is 32G—that is, 32K extents × 1 MB per
      extent. In addition, once an extent is allocated to a given
      partition, it cannot be used to store data from a different
      partition; an extent cannot store data from more than one
      partition. This means, for example that a tablespace having a
      single datafile whose <code class="literal">INITIAL_SIZE</code> is 256 MB
      and whose <code class="literal">EXTENT_SIZE</code> is 128M has just two
      extents, and so can be used to store data from at most two
      different disk data table partitions.
    </p><p>
      You can see how many extents remain free in a given data file by
      querying the <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a>
      table, and so derive an estimate for how much space remains free
      in the file. For further discussion and examples, see
      <a class="xref" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table">Section 21.30.1, “The INFORMATION_SCHEMA FILES Table”</a>.
    </p><p>
      The <code class="literal">INITIAL_SIZE</code> parameter sets the data file's
      total size in bytes. Once the file has been created, its size
      cannot be changed; however, you can add more data files to the
      tablespace using <code class="literal">ALTER TABLESPACE ... ADD
      DATAFILE</code>. See <a class="xref" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax">Section 13.1.8, “ALTER TABLESPACE Syntax”</a>.
    </p><p>
      <code class="literal">INITIAL_SIZE</code> is optional; its default value is
      134217728 (128 MB).
    </p><p>
      On 32-bit systems, the maximum supported value for
      <code class="literal">INITIAL_SIZE</code> is 4294967296 (4 GB). (Bug #29186)
    </p><p>
      When setting <code class="literal">EXTENT_SIZE</code>, you may optionally
      follow the number with a one-letter abbreviation for an order of
      magnitude, similar to those used in <code class="filename">my.cnf</code>.
      Generally, this is one of the letters <code class="literal">M</code> (for
      megabytes) or <code class="literal">G</code> (for gigabytes). In MySQL
      Cluster NDB 7.3.2 and later, these abbreviations are also
      supported when specifying <code class="literal">INITIAL_SIZE</code> as well.
      (Bug #13116514, Bug #16104705, Bug #62858)
    </p><p>
      <code class="literal">INITIAL_SIZE</code>, <code class="literal">EXTENT_SIZE</code>,
      and <code class="literal">UNDO_BUFFER_SIZE</code> are subject to rounding as
      follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">EXTENT_SIZE</code> and
          <code class="literal">UNDO_BUFFER_SIZE</code> are each rounded up to the
          nearest whole multiple of 32K.
        </p></li><li class="listitem"><p>
          <code class="literal">INITIAL_SIZE</code> is rounded
          <span class="emphasis"><em>down</em></span> to the nearest whole multiple of
          32K.
        </p><p>
          For data files, <span class="emphasis"><em>INITIAL_SIZE</em></span> is subject
          to further rounding; the result just obtained is rounded up to
          the nearest whole multiple of <code class="literal">EXTENT_SIZE</code>
          (after any rounding).
</p></li></ul>
</div>
<p>
      The rounding just described is done explicitly, and a warning is
      issued by the MySQL Server when any such rounding is performed.
      The rounded values are also used by the NDB kernel for calculating
      <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a> column
      values and other purposes. However, to avoid an unexpected result,
      we suggest that you always use whole multiples of 32K in
      specifying these options.
    </p><p>
      <code class="literal">AUTOEXTEND_SIZE</code>, <code class="literal">MAX_SIZE</code>,
      <code class="literal">NODEGROUP</code>, <code class="literal">WAIT</code>, and
      <code class="literal">COMMENT</code> are parsed but ignored, and so
      currently have no effect. These options are intended for future
      expansion.
    </p><p>
      The <code class="literal">ENGINE</code> parameter determines the storage
      engine which uses this tablespace, with
      <em class="replaceable"><code>engine_name</code></em> being the name of the
      storage engine. Currently, <em class="replaceable"><code>engine_name</code></em>
      must be one of the values <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> or
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>.
    </p><p>
      When <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> is used with
      <code class="literal">ENGINE = NDB</code>, a tablespace and associated data
      file are created on each Cluster data node. You can verify that
      the data files were created and obtain information about them by
      querying the <a class="link" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table"><code class="literal">INFORMATION_SCHEMA.FILES</code></a>
      table. For example:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT LOGFILE_GROUP_NAME, FILE_NAME, EXTRA</code></strong>
    -&gt; <strong class="userinput"><code>FROM INFORMATION_SCHEMA.FILES</code></strong>
    -&gt; <strong class="userinput"><code>WHERE TABLESPACE_NAME = 'newts' AND FILE_TYPE = 'DATAFILE';</code></strong>
+--------------------+-------------+----------------+
| LOGFILE_GROUP_NAME | FILE_NAME   | EXTRA          |
+--------------------+-------------+----------------+
| lg_3               | newdata.dat | CLUSTER_NODE=3 |
| lg_3               | newdata.dat | CLUSTER_NODE=4 |
+--------------------+-------------+----------------+
2 rows in set (0.01 sec)
</pre><p>
      (See <a class="xref" href="information-schema.html#files-table" title="21.30.1 The INFORMATION_SCHEMA FILES Table">Section 21.30.1, “The INFORMATION_SCHEMA FILES Table”</a>.)
    </p><p>
      <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> is useful only
      with Disk Data storage for MySQL Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-trigger"></a>13.1.19 CREATE TRIGGER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150576560"></a><a class="indexterm" name="idm139737150575488"></a><pre class="programlisting">
CREATE
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    TRIGGER <em class="replaceable"><code>trigger_name</code></em>
    <em class="replaceable"><code>trigger_time</code></em> <em class="replaceable"><code>trigger_event</code></em>
    ON <em class="replaceable"><code>tbl_name</code></em> FOR EACH ROW
    <em class="replaceable"><code>trigger_body</code></em>

<em class="replaceable"><code>trigger_time</code></em>: { BEFORE | AFTER }

<em class="replaceable"><code>trigger_event</code></em>: { INSERT | UPDATE | DELETE }
</pre><p>
      This statement creates a new trigger. A trigger is a named
      database object that is associated with a table, and that
      activates when a particular event occurs for the table. The
      trigger becomes associated with the table named
      <em class="replaceable"><code>tbl_name</code></em>, which must refer to a
      permanent table. You cannot associate a trigger with a
      <code class="literal">TEMPORARY</code> table or a view.
    </p><p>
      Trigger names exist in the schema namespace, meaning that all
      triggers must have unique names within a schema. Triggers in
      different schemas can have the same name.
    </p><p>
      This section describes <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE
      TRIGGER</code></a> syntax. For additional discussion, see
      <a class="xref" href="stored-programs-views.html#trigger-syntax" title="20.3.1 Trigger Syntax and Examples">Section 20.3.1, “Trigger Syntax and Examples”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> requires the
      <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for the table
      associated with the trigger. The statement might also require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, depending on the
      <code class="literal">DEFINER</code> value, as described later in this
      section. If binary logging is enabled, <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE
      TRIGGER</code></a> might require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, as described in
      <a class="xref" href="stored-programs-views.html#stored-programs-logging" title="20.7 Binary Logging of Stored Programs">Section 20.7, “Binary Logging of Stored Programs”</a>.
    </p><p>
      The <code class="literal">DEFINER</code> clause determines the security
      context to be used when checking access privileges at trigger
      activation time, as described later in this section.
    </p><p>
      <em class="replaceable"><code>trigger_time</code></em> is the trigger action
      time. It can be <code class="literal">BEFORE</code> or
      <code class="literal">AFTER</code> to indicate that the trigger activates
      before or after each row to be modified.
    </p><p>
      <em class="replaceable"><code>trigger_event</code></em> indicates the kind of
      operation that activates the trigger. These
      <em class="replaceable"><code>trigger_event</code></em> values are permitted:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>: The trigger activates
          whenever a new row is inserted into the table; for example,
          through <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
          <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a>, and
          <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> statements.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>: The trigger activates
          whenever a row is modified; for example, through
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>: The trigger activates
          whenever a row is deleted from the table; for example, through
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> and
          <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> statements.
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> and
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statements on
          the table do <span class="emphasis"><em>not</em></span> activate this trigger,
          because they do not use <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>.
          Dropping a partition does not activate
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> triggers, either.
</p></li></ul>
</div>
<p>
      The <em class="replaceable"><code>trigger_event</code></em> does not represent a
      literal type of SQL statement that activates the trigger so much
      as it represents a type of table operation. For example, an
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> trigger activates not only
      for <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements but also
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> statements because both
      statements insert rows into a table.
    </p><p>
      A potentially confusing example of this is the <code class="literal">INSERT
      INTO ... ON DUPLICATE KEY UPDATE ...</code> syntax: a
      <code class="literal">BEFORE INSERT</code> trigger activates for every row,
      followed by either an <code class="literal">AFTER INSERT</code> trigger or
      both the <code class="literal">BEFORE UPDATE</code> and <code class="literal">AFTER
      UPDATE</code> triggers, depending on whether there was a
      duplicate key for the row.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Cascaded foreign key actions do not activate triggers.
</p>
</div>
<p>
      There cannot be multiple triggers for a given table that have the
      same trigger event and action time. For example, you cannot have
      two <code class="literal">BEFORE UPDATE</code> triggers for a table. But you
      can have a <code class="literal">BEFORE UPDATE</code> and a <code class="literal">BEFORE
      INSERT</code> trigger, or a <code class="literal">BEFORE UPDATE</code>
      and an <code class="literal">AFTER UPDATE</code> trigger.
    </p><p>
      <em class="replaceable"><code>trigger_body</code></em> is the statement to
      execute when the trigger activates. To execute multiple
      statements, use the
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement construct. This also enables you to use the
      same statements that are permissible within stored routines. See
      <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>. Some statements are not permitted in
      triggers; see <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
    </p><p>
      Within the trigger body, you can refer to columns in the subject
      table (the table associated with the trigger) by using the aliases
      <code class="literal">OLD</code> and <code class="literal">NEW</code>.
      <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code> refers
      to a column of an existing row before it is updated or deleted.
      <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code> refers
      to the column of a new row to be inserted or an existing row after
      it is updated.
    </p><p>
      MySQL stores the <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system
      variable setting in effect when a trigger is created, and always
      executes the trigger body with this setting in force,
      <span class="emphasis"><em>regardless of the current server SQL mode when the
      trigger begins executing</em></span>.
    </p><p>
      The <code class="literal">DEFINER</code> clause specifies the MySQL account
      to be used when checking access privileges at trigger activation
      time. If a <em class="replaceable"><code>user</code></em> value is given, it
      should be a MySQL account specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
      (the same format used in the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
      statement), <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The default
      <code class="literal">DEFINER</code> value is the user who executes the
      <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> statement. This is
      the same as specifying <code class="literal">DEFINER = CURRENT_USER</code>
      explicitly.
    </p><p>
      If you specify the <code class="literal">DEFINER</code> clause, these rules
      determine the valid <code class="literal">DEFINER</code> user values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you do not have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, the only permitted <em class="replaceable"><code>user</code></em>
          value is your own account, either specified literally or by
          using <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>. You cannot
          set the definer to some other account.
        </p></li><li class="listitem"><p>
          If you have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, you can specify any syntactically valid account
          name. If the account does not exist, a warning is generated.
        </p></li><li class="listitem"><p>
          Although it is possible to create a trigger with a nonexistent
          <code class="literal">DEFINER</code> account, it is not a good idea for
          such triggers to be activated until the account actually does
          exist. Otherwise, the behavior with respect to privilege
          checking is undefined.
</p></li></ul>
</div>
<p>
      MySQL takes the <code class="literal">DEFINER</code> user into account when
      checking trigger privileges as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> time, the
          user who issues the statement must have the
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege.
        </p></li><li class="listitem"><p>
          At trigger activation time, privileges are checked against the
          <code class="literal">DEFINER</code> user. This user must have these
          privileges:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for
              the subject table.
            </p></li><li class="listitem"><p>
              The <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for
              the subject table if references to table columns occur
              using
              <code class="literal">OLD.<em class="replaceable"><code>col_name</code></em></code>
              or
              <code class="literal">NEW.<em class="replaceable"><code>col_name</code></em></code>
              in the trigger body.
            </p></li><li class="listitem"><p>
              The <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for
              the subject table if table columns are targets of
              <code class="literal">SET NEW.<em class="replaceable"><code>col_name</code></em> =
              <em class="replaceable"><code>value</code></em></code> assignments in
              the trigger body.
            </p></li><li class="listitem"><p>
              Whatever other privileges normally are required for the
              statements executed by the trigger.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
      For more information about trigger security, see
      <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.
    </p><p>
      Within a trigger body, the
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> function returns the
      account used to check privileges at trigger activation time. This
      is the <code class="literal">DEFINER</code> user, not the user whose actions
      caused the trigger to be activated. For information about user
      auditing within triggers, see
      <a class="xref" href="security.html#account-activity-auditing" title="6.3.14 SQL-Based MySQL Account Activity Auditing">Section 6.3.14, “SQL-Based MySQL Account Activity Auditing”</a>.
    </p><p>
      If you use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to lock a
      table that has triggers, the tables used within the trigger are
      also locked, as described in
      <a class="xref" href="sql-syntax.html#lock-tables-and-triggers" title="13.3.5.2 LOCK TABLES and Triggers">Section 13.3.5.2, “LOCK TABLES and Triggers”</a>.
    </p><p>
      For additional discussion of trigger use, see
      <a class="xref" href="stored-programs-views.html#trigger-syntax" title="20.3.1 Trigger Syntax and Examples">Section 20.3.1, “Trigger Syntax and Examples”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="create-view"></a>13.1.20 CREATE VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150458048"></a><a class="indexterm" name="idm139737150456976"></a><a class="indexterm" name="idm139737150455488"></a><pre class="programlisting">
CREATE
    [OR REPLACE]
    [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]
    [DEFINER = { <em class="replaceable"><code>user</code></em> | CURRENT_USER }]
    [SQL SECURITY { DEFINER | INVOKER }]
    VIEW <em class="replaceable"><code>view_name</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
    AS <em class="replaceable"><code>select_statement</code></em>
    [WITH [CASCADED | LOCAL] CHECK OPTION]
</pre><p>
      The <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> statement creates a
      new view, or replaces an existing view if the <code class="literal">OR
      REPLACE</code> clause is given. If the view does not exist,
      <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE OR REPLACE
      VIEW</code></a> is the same as <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE
      VIEW</code></a>. If the view does exist,
      <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE OR REPLACE
      VIEW</code></a> is the same as <a class="link" href="sql-syntax.html#alter-view" title="13.1.9 ALTER VIEW Syntax"><code class="literal">ALTER
      VIEW</code></a>.
    </p><p>
      The <em class="replaceable"><code>select_statement</code></em> is a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement that provides the
      definition of the view. (Selecting from the view selects, in
      effect, using the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement.) The <em class="replaceable"><code>select_statement</code></em> can
      select from base tables or other views.
    </p><p>
      The view definition is <span class="quote">“<span class="quote">frozen</span>”</span> at creation time.
      Changes to the underlying tables afterward do not affect the view
      definition. For example, if a view is defined as <code class="literal">SELECT
      *</code> on a table, new columns added to the table later do
      not become part of the view.
    </p><p>
      The <code class="literal">ALGORITHM</code> clause affects how MySQL
      processes the view. The <code class="literal">DEFINER</code> and
      <code class="literal">SQL SECURITY</code> clauses specify the security
      context to be used when checking access privileges at view
      invocation time. The <code class="literal">WITH CHECK OPTION</code> clause
      can be given to constrain inserts or updates to rows in tables
      referenced by the view. These clauses are described later in this
      section.
    </p><p>
      The <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> statement requires
      the <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a> privilege for the
      view, and some privilege for each column selected by the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. For columns used
      elsewhere in the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement,
      you must have the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege.
      If the <code class="literal">OR REPLACE</code> clause is present, you must
      also have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege for
      the view. <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> might also
      require the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege,
      depending on the <code class="literal">DEFINER</code> value, as described
      later in this section.
    </p><p>
      When a view is referenced, privilege checking occurs as described
      later in this section.
    </p><p>
      A view belongs to a database. By default, a new view is created in
      the default database. To create the view explicitly in a given
      database, use <em class="replaceable"><code>db_name.view_name</code></em> syntax
      to qualify the view name with the database name:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE VIEW test.v AS SELECT * FROM t;</code></strong>
</pre><p>
      Within a database, base tables and views share the same namespace,
      so a base table and a view cannot have the same name.
    </p><p>
      Columns retrieved by the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement can be simple references to table columns, or
      expressions that use functions, constant values, operators, and so
      forth.
    </p><p>
      A view must have unique column names with no duplicates, just like
      a base table. By default, the names of the columns retrieved by
      the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement are used for
      the view column names. To define explicit names for the view
      columns, the optional <em class="replaceable"><code>column_list</code></em>
      clause can be given as a list of comma-separated identifiers. The
      number of names in <em class="replaceable"><code>column_list</code></em> must be
      the same as the number of columns retrieved by the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
    </p><p>
      Unqualified table or view names in the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement are interpreted
      with respect to the default database. A view can refer to tables
      or views in other databases by qualifying the table or view name
      with the appropriate database name.
    </p><p>
      A view can be created from many kinds of
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements. It can refer to
      base tables or other views. It can use joins,
      <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a>, and subqueries. The
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> need not even refer to any
      tables.
    </p><p>
      The following example defines a view that selects two columns from
      another table as well as an expression calculated from those
      columns:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (qty INT, price INT);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES(3, 50);</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE VIEW v AS SELECT qty, price, qty*price AS value FROM t;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM v;</code></strong>
+------+-------+-------+
| qty  | price | value |
+------+-------+-------+
|    3 |    50 |   150 |
+------+-------+-------+
</pre><p>
      A view definition is subject to the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot
          contain a subquery in the <code class="literal">FROM</code> clause.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot
          refer to system variables or user-defined variables.
        </p></li><li class="listitem"><p>
          Within a stored program, the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot refer
          to program parameters or local variables.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot
          refer to prepared statement parameters.
        </p></li><li class="listitem"><p>
          Any table or view referred to in the definition must exist.
          After the view has been created, it is possible to drop a
          table or view that the definition refers to. In this case, use
          of the view results in an error. To check a view definition
          for problems of this kind, use the <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK
          TABLE</code></a> statement.
        </p></li><li class="listitem"><p>
          The definition cannot refer to a <code class="literal">TEMPORARY</code>
          table, and you cannot create a <code class="literal">TEMPORARY</code>
          view.
        </p></li><li class="listitem"><p>
          You cannot associate a trigger with a view.
        </p></li><li class="listitem"><p>
          Aliases for column names in the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement are checked
          against the maximum column length of 64 characters (not the
          maximum alias length of 256 characters).
</p></li></ul>
</div>
<p>
      <code class="literal">ORDER BY</code> is permitted in a view definition, but
      it is ignored if you select from a view using a statement that has
      its own <code class="literal">ORDER BY</code>.
    </p><p>
      For other options or clauses in the definition, they are added to
      the options or clauses of the statement that references the view,
      but the effect is undefined. For example, if a view definition
      includes a <code class="literal">LIMIT</code> clause, and you select from
      the view using a statement that has its own
      <code class="literal">LIMIT</code> clause, it is undefined which limit
      applies. This same principle applies to options such as
      <code class="literal">ALL</code>, <code class="literal">DISTINCT</code>, or
      <code class="literal">SQL_SMALL_RESULT</code> that follow the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> keyword, and to clauses such
      as <code class="literal">INTO</code>, <code class="literal">FOR UPDATE</code>,
      <code class="literal">LOCK IN SHARE MODE</code>, and
      <code class="literal">PROCEDURE</code>.
    </p><p>
      If you create a view and then change the query processing
      environment by changing system variables, that may affect the
      results you get from the view:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE VIEW v (mycol) AS SELECT 'abc';</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET sql_mode = '';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT "mycol" FROM v;</code></strong>
+-------+
| mycol |
+-------+
| mycol |
+-------+
1 row in set (0.01 sec)

mysql&gt; <strong class="userinput"><code>SET sql_mode = 'ANSI_QUOTES';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT "mycol" FROM v;</code></strong>
+-------+
| mycol |
+-------+
| abc   |
+-------+
1 row in set (0.00 sec)
</pre><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses determine which MySQL account to use when checking access
      privileges for the view when a statement is executed that
      references the view. The valid <code class="literal">SQL SECURITY</code>
      characteristic values are <code class="literal">DEFINER</code> (the default)
      and <code class="literal">INVOKER</code>. These indicate that the required
      privileges must be held by the user who defined or invoked the
      view, respectively.
    </p><p>
      If a <em class="replaceable"><code>user</code></em> value is given for the
      <code class="literal">DEFINER</code> clause, it should be a MySQL account
      specified as
      <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
      (the same format used in the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
      statement), <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>, or
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a>. The default
      <code class="literal">DEFINER</code> value is the user who executes the
      <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a> statement. This is the
      same as specifying <code class="literal">DEFINER = CURRENT_USER</code>
      explicitly.
    </p><p>
      If you specify the <code class="literal">DEFINER</code> clause, these rules
      determine the valid <code class="literal">DEFINER</code> user values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you do not have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, the only valid <em class="replaceable"><code>user</code></em>
          value is your own account, either specified literally or by
          using <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>. You cannot
          set the definer to some other account.
        </p></li><li class="listitem"><p>
          If you have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
          privilege, you can specify any syntactically valid account
          name. If the account does not exist, a warning is generated.
        </p></li><li class="listitem"><p>
          Although it is possible to create a view with a nonexistent
          <code class="literal">DEFINER</code> account, an error occurs when the
          view is referenced if the <code class="literal">SQL SECURITY</code>
          value is <code class="literal">DEFINER</code> but the definer account
          does not exist.
</p></li></ul>
</div>
<p>
      For more information about view security, see
      <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.
    </p><p>
      Within a view definition,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> returns the view's
      <code class="literal">DEFINER</code> value by default. For views defined
      with the <code class="literal">SQL SECURITY INVOKER</code> characteristic,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> returns the account
      for the view's invoker. For information about user auditing within
      views, see <a class="xref" href="security.html#account-activity-auditing" title="6.3.14 SQL-Based MySQL Account Activity Auditing">Section 6.3.14, “SQL-Based MySQL Account Activity Auditing”</a>.
    </p><p>
      Within a stored routine that is defined with the <code class="literal">SQL
      SECURITY DEFINER</code> characteristic,
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> returns the routine's
      <code class="literal">DEFINER</code> value. This also affects a view defined
      within such a routine, if the view definition contains a
      <code class="literal">DEFINER</code> value of
      <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a>.
    </p><p>
      MySQL checks view privileges like this:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At view definition time, the view creator must have the
          privileges needed to use the top-level objects accessed by the
          view. For example, if the view definition refers to table
          columns, the creator must have some privilege for each column
          in the select list of the definition, and the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for each
          column used elsewhere in the definition. If the definition
          refers to a stored function, only the privileges needed to
          invoke the function can be checked. The privileges required at
          function invocation time can be checked only as it executes:
          For different invocations, different execution paths within
          the function might be taken.
        </p></li><li class="listitem"><p>
          The user who references a view must have appropriate
          privileges to access it (<a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
          to select from it, <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> to
          insert into it, and so forth.)
        </p></li><li class="listitem"><p>
          When a view has been referenced, privileges for objects
          accessed by the view are checked against the privileges held
          by the view <code class="literal">DEFINER</code> account or invoker,
          depending on whether the <code class="literal">SQL SECURITY</code>
          characteristic is <code class="literal">DEFINER</code> or
          <code class="literal">INVOKER</code>, respectively.
        </p></li><li class="listitem"><p>
          If reference to a view causes execution of a stored function,
          privilege checking for statements executed within the function
          depend on whether the function <code class="literal">SQL SECURITY</code>
          characteristic is <code class="literal">DEFINER</code> or
          <code class="literal">INVOKER</code>. If the security characteristic is
          <code class="literal">DEFINER</code>, the function runs with the
          privileges of the <code class="literal">DEFINER</code> account. If the
          characteristic is <code class="literal">INVOKER</code>, the function
          runs with the privileges determined by the view's <code class="literal">SQL
          SECURITY</code> characteristic.
</p></li></ul>
</div>
<p>
      Example: A view might depend on a stored function, and that
      function might invoke other stored routines. For example, the
      following view invokes a stored function <code class="literal">f()</code>:
    </p><pre class="programlisting">
CREATE VIEW v AS SELECT * FROM t WHERE t.id = f(t.name);
</pre><p>
      Suppose that <code class="literal">f()</code> contains a statement such as
      this:
    </p><pre class="programlisting">
IF name IS NULL then
  CALL p1();
ELSE
  CALL p2();
END IF;
</pre><p>
      The privileges required for executing statements within
      <code class="literal">f()</code> need to be checked when
      <code class="literal">f()</code> executes. This might mean that privileges
      are needed for <code class="literal">p1()</code> or <code class="literal">p2()</code>,
      depending on the execution path within <code class="literal">f()</code>.
      Those privileges must be checked at runtime, and the user who must
      possess the privileges is determined by the <code class="literal">SQL
      SECURITY</code> values of the view <code class="literal">v</code> and the
      function <code class="literal">f()</code>.
    </p><p>
      The <code class="literal">DEFINER</code> and <code class="literal">SQL SECURITY</code>
      clauses for views are extensions to standard SQL. In standard SQL,
      views are handled using the rules for <code class="literal">SQL SECURITY
      DEFINER</code>. The standard says that the definer of the view,
      which is the same as the owner of the view's schema, gets
      applicable privileges on the view (for example,
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>) and may grant them. MySQL
      has no concept of a schema <span class="quote">“<span class="quote">owner</span>”</span>, so MySQL adds a
      clause to identify the definer. The <code class="literal">DEFINER</code>
      clause is an extension where the intent is to have what the
      standard has; that is, a permanent record of who defined the view.
      This is why the default <code class="literal">DEFINER</code> value is the
      account of the view creator.
    </p><p>
      The optional <code class="literal">ALGORITHM</code> clause is a MySQL
      extension to standard SQL. It affects how MySQL processes the
      view. <code class="literal">ALGORITHM</code> takes three values:
      <code class="literal">MERGE</code>, <code class="literal">TEMPTABLE</code>, or
      <code class="literal">UNDEFINED</code>. The default algorithm is
      <code class="literal">UNDEFINED</code> if no <code class="literal">ALGORITHM</code>
      clause is present. For more information, see
      <a class="xref" href="stored-programs-views.html#view-algorithms" title="20.5.2 View Processing Algorithms">Section 20.5.2, “View Processing Algorithms”</a>.
    </p><p>
      Some views are updatable. That is, you can use them in statements
      such as <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>, or
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> to update the contents of
      the underlying table. For a view to be updatable, there must be a
      one-to-one relationship between the rows in the view and the rows
      in the underlying table. There are also certain other constructs
      that make a view nonupdatable.
    </p><p>
      The <code class="literal">WITH CHECK OPTION</code> clause can be given for
      an updatable view to prevent inserts or updates to rows except
      those for which the <code class="literal">WHERE</code> clause in the
      <em class="replaceable"><code>select_statement</code></em> is true.
    </p><p>
      In a <code class="literal">WITH CHECK OPTION</code> clause for an updatable
      view, the <code class="literal">LOCAL</code> and <code class="literal">CASCADED</code>
      keywords determine the scope of check testing when the view is
      defined in terms of another view. The <code class="literal">LOCAL</code>
      keyword restricts the <code class="literal">CHECK OPTION</code> only to the
      view being defined. <code class="literal">CASCADED</code> causes the checks
      for underlying views to be evaluated as well. When neither keyword
      is given, the default is <code class="literal">CASCADED</code>.
    </p><p>
      For more information about updatable views and the <code class="literal">WITH
      CHECK OPTION</code> clause, see
      <a class="xref" href="stored-programs-views.html#view-updatability" title="20.5.3 Updatable and Insertable Views">Section 20.5.3, “Updatable and Insertable Views”</a>, and
      <a class="xref" href="stored-programs-views.html#view-check-option" title="20.5.4 The View WITH CHECK OPTION Clause">Section 20.5.4, “The View WITH CHECK OPTION Clause”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-database"></a>13.1.21 DROP DATABASE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150273008"></a><a class="indexterm" name="idm139737150271936"></a><a class="indexterm" name="idm139737150270864"></a><a class="indexterm" name="idm139737150269376"></a><a class="indexterm" name="idm139737150267888"></a><a class="indexterm" name="idm139737150266400"></a><pre class="programlisting">
DROP {DATABASE | SCHEMA} [IF EXISTS] <em class="replaceable"><code>db_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> drops all tables in
      the database and deletes the database. Be
      <span class="emphasis"><em>very</em></span> careful with this statement! To use
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>, you need the
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privilege on the database.
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP
      SCHEMA</code></a> is a synonym for <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP
      DATABASE</code></a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        When a database is dropped, user privileges on the database are
        <span class="emphasis"><em>not</em></span> automatically dropped. See
        <a class="xref" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax">Section 13.7.1.4, “GRANT Syntax”</a>.
</p>
</div>
<p>
      <code class="literal">IF EXISTS</code> is used to prevent an error from
      occurring if the database does not exist.
    </p><p>
      If the default database is dropped, the default database is unset
      (the <a class="link" href="functions.html#function_database"><code class="literal">DATABASE()</code></a> function returns
      <code class="literal">NULL</code>).
    </p><p>
      If you use <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> on a
      symbolically linked database, both the link and the original
      database are deleted.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> returns the number of
      tables that were removed. This corresponds to the number of
      <code class="filename">.frm</code> files removed.
    </p><p>
      The <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> statement removes
      from the given database directory those files and directories that
      MySQL itself may create during normal operation:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          All files with the following extensions.
</p>
<div class="informaltable">
<table summary="The DROP DATABASE
            statement removes files with extension types shown in this
            table. Extensions are listed in alphabetical order from left
to right." border="1"><colgroup><col><col><col><col></colgroup><tbody><tr><td scope="row"><code class="literal">.BAK</code></td><td><code class="literal">.DAT</code></td><td><code class="literal">.HSH</code></td><td><code class="literal">.MRG</code></td></tr><tr><td scope="row"><code class="literal">.MYD</code></td><td><code class="literal">.MYI</code></td><td><code class="literal">.TRG</code></td><td><code class="literal">.TRN</code></td></tr><tr><td scope="row"><code class="literal">.db</code></td><td><code class="literal">.frm</code></td><td><code class="literal">.ibd</code></td><td><code class="literal">.ndb</code></td></tr><tr><td scope="row"><code class="literal">.par</code></td><td> </td><td> </td><td> </td></tr></tbody></table>
</div>
</li><li class="listitem"><p>
          The <code class="filename">db.opt</code> file, if it exists.
</p></li></ul>
</div>
<p>
      If other files or directories remain in the database directory
      after MySQL removes those just listed, the database directory
      cannot be removed. In this case, you must remove any remaining
      files or directories manually and issue the
      <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a> statement again.
    </p><p>
      Dropping a database does not remove any
      <code class="literal">TEMPORARY</code> tables that were created in that
      database. <code class="literal">TEMPORARY</code> tables are automatically
      removed when the session that created them ends. See
      <a class="xref" href="sql-syntax.html#create-temporary-table" title="Temporary Tables">Temporary Tables</a>.
    </p><a class="indexterm" name="idm139737150216192"></a><p>
      You can also drop databases with <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a>.
      See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-event"></a>13.1.22 DROP EVENT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150211488"></a><a class="indexterm" name="idm139737150210416"></a><a class="indexterm" name="idm139737150208928"></a><pre class="programlisting">
DROP EVENT [IF EXISTS] <em class="replaceable"><code>event_name</code></em>
</pre><p>
      This statement drops the event named
      <em class="replaceable"><code>event_name</code></em>. The event immediately
      ceases being active, and is deleted completely from the server.
    </p><p>
      If the event does not exist, the error <span class="errortext">ERROR 1517
      (HY000): Unknown event
      '<em class="replaceable"><code>event_name</code></em>'</span> results. You
      can override this and cause the statement to generate a warning
      for nonexistent events instead using <code class="literal">IF EXISTS</code>.
    </p><p>
      This statement requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a>
      privilege for the schema to which the event to be dropped belongs.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-function"></a>13.1.23 DROP FUNCTION Syntax</h3>

</div>

</div>

</div>
<p>
      The <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement is used
      to drop stored functions and user-defined functions (UDFs):
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For information about dropping stored functions, see
          <a class="xref" href="sql-syntax.html#drop-procedure" title="13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax">Section 13.1.26, “DROP PROCEDURE and DROP FUNCTION Syntax”</a>.
        </p></li><li class="listitem"><p>
          For information about dropping user-defined functions, see
          <a class="xref" href="sql-syntax.html#drop-function-udf" title="13.7.3.2 DROP FUNCTION Syntax">Section 13.7.3.2, “DROP FUNCTION Syntax”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-index"></a>13.1.24 DROP INDEX Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150188144"></a><a class="indexterm" name="idm139737150187072"></a><a class="indexterm" name="idm139737150185584"></a><pre class="programlisting">
DROP INDEX [ONLINE|OFFLINE] <em class="replaceable"><code>index_name</code></em> ON <em class="replaceable"><code>tbl_name</code></em>
    [<em class="replaceable"><code>algorithm_option</code></em> | <em class="replaceable"><code>lock_option</code></em>] ...

<em class="replaceable"><code>algorithm_option</code></em>:
    ALGORITHM [=] {DEFAULT|INPLACE|COPY}

<em class="replaceable"><code>lock_option</code></em>:
    LOCK [=] {DEFAULT|NONE|SHARED|EXCLUSIVE}
</pre><p>
      <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a> drops the index named
      <em class="replaceable"><code>index_name</code></em> from the table
      <em class="replaceable"><code>tbl_name</code></em>. This statement is mapped to
      an <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> statement to drop
      the index. See <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>.
    </p><p>
      To drop a primary key, the index name is always
      <code class="literal">PRIMARY</code>, which must be specified as a quoted
      identifier because <code class="literal">PRIMARY</code> is a reserved word:
    </p><pre class="programlisting">
DROP INDEX `PRIMARY` ON t;
</pre><p>
      Indexes on variable-width columns of
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables are dropped online; that
      is, without any table copying. The table is not locked against
      access from other MySQL Cluster API nodes, although it is locked
      against other operations on the <span class="emphasis"><em>same</em></span> API node
      for the duration of the operation. This is done automatically by
      the server whenever it determines that it is possible to do so;
      you do not have to use any special SQL syntax or server options to
      cause it to happen.
    </p><p>
      In MySQL Cluster, you can drop indexes offline (which causes the
      table to be locked for all API nodes in the cluster) using the
      <code class="literal">OFFLINE</code> keyword. The rules and limitations
      governing <code class="literal">DROP OFFLINE INDEX</code> and <code class="literal">DROP
      ONLINE INDEX</code> are the same as for <code class="literal">ALTER OFFLINE
      TABLE ... DROP INDEX</code> and <code class="literal">ALTER ONLINE TABLE ...
      DROP INDEX</code>. You cannot cause the noncopying dropping of
      an index that would normally be dropped offline by using the
      <code class="literal">ONLINE</code> keyword: If it is not possible to
      perform the <code class="literal">DROP</code> operation without table
      copying, the server ignores the <code class="literal">ONLINE</code> keyword.
      For more information, see
      <a class="xref" href="sql-syntax.html#alter-table-online-operations" title="13.1.7.2 ALTER TABLE Online Operations in MySQL Cluster">Section 13.1.7.2, “ALTER TABLE Online Operations in MySQL Cluster”</a>.
    </p><p>
      The <code class="literal">ONLINE</code> and <code class="literal">OFFLINE</code>
      keywords are available only in MySQL Cluster; attempting to use
      these keywords in standard MySQL Server 5.6 releases
      results in a syntax error. The <code class="literal">ONLINE</code> and
      <code class="literal">OFFLINE</code> keywords are deprecated in MySQL
      Cluster NDB 7.3; they continue to be supported in MySQL Cluster
      NDB 7.4, but are scheduled for removal in a future MySQL Cluster
      release.
    </p><p>
      As of MySQL 5.6.6, the <code class="literal">ALGORITHM</code> and
      <code class="literal">LOCK</code> clauses may be given. These influence the
      table copying method and level of concurrency for reading and
      writing the table while its indexes are being modified. They have
      the same meaning as for the <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
      TABLE</code></a> statement. For more information, see
      <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-logfile-group"></a>13.1.25 DROP LOGFILE GROUP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150151680"></a><pre class="programlisting">
DROP LOGFILE GROUP <em class="replaceable"><code>logfile_group</code></em>
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement drops the log file group named
      <em class="replaceable"><code>logfile_group</code></em>. The log file group must
      already exist or an error results. (For information on creating
      log file groups, see <a class="xref" href="sql-syntax.html#create-logfile-group" title="13.1.14 CREATE LOGFILE GROUP Syntax">Section 13.1.14, “CREATE LOGFILE GROUP Syntax”</a>.)
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Before dropping a log file group, you must drop all tablespaces
        that use that log file group for <code class="literal">UNDO</code>
        logging.
</p>
</div>
<p>
      The required <code class="literal">ENGINE</code> clause provides the name of
      the storage engine used by the log file group to be dropped.
      Currently, the only permitted values for
      <em class="replaceable"><code>engine_name</code></em> are
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> and
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-logfile-group" title="13.1.25 DROP LOGFILE GROUP Syntax"><code class="literal">DROP LOGFILE GROUP</code></a> is useful only
      with Disk Data storage for MySQL Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-procedure"></a>13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150137440"></a><a class="indexterm" name="idm139737150136400"></a><pre class="programlisting">
DROP {PROCEDURE | FUNCTION} [IF EXISTS] <em class="replaceable"><code>sp_name</code></em>
</pre><p>
      This statement is used to drop a stored procedure or function.
      That is, the specified routine is removed from the server. You
      must have the <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>
      privilege for the routine. (If the
      <code class="literal">automatic_sp_privileges</code> system variable is
      enabled, that privilege and <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>
      are granted automatically to the routine creator when the routine
      is created and dropped from the creator when the routine is
      dropped. See <a class="xref" href="stored-programs-views.html#stored-routines-privileges" title="20.2.2 Stored Routines and MySQL Privileges">Section 20.2.2, “Stored Routines and MySQL Privileges”</a>.)
    </p><p>
      The <code class="literal">IF EXISTS</code> clause is a MySQL extension. It
      prevents an error from occurring if the procedure or function does
      not exist. A warning is produced that can be viewed with
      <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> is also used to drop
      user-defined functions (see <a class="xref" href="sql-syntax.html#drop-function-udf" title="13.7.3.2 DROP FUNCTION Syntax">Section 13.7.3.2, “DROP FUNCTION Syntax”</a>).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-server"></a>13.1.27 DROP SERVER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150120352"></a><pre class="programlisting">
DROP SERVER [ IF EXISTS ] <em class="replaceable"><code>server_name</code></em>
</pre><p>
      Drops the server definition for the server named
      <code class="literal"><em class="replaceable"><code>server_name</code></em></code>. The
      corresponding row in the <code class="literal">mysql.servers</code> table is
      deleted. This statement requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
    </p><p>
      Dropping a server for a table does not affect any
      <code class="literal">FEDERATED</code> tables that used this connection
      information when they were created. See
      <a class="xref" href="sql-syntax.html#create-server" title="13.1.16 CREATE SERVER Syntax">Section 13.1.16, “CREATE SERVER Syntax”</a>.
    </p><p>
      <code class="literal">DROP SERVER</code> does not cause an automatic commit.
    </p><p>
      In MySQL 5.6, <code class="literal">DROP SERVER</code> is not
      written to the binary log, regardless of the logging format that
      is in use.
    </p><p>
      In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
      must be set to <code class="literal">AUTOMATIC</code> before issuing this
      statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-table"></a>13.1.28 DROP TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150103856"></a><a class="indexterm" name="idm139737150102784"></a><a class="indexterm" name="idm139737150101296"></a><pre class="programlisting">
DROP [TEMPORARY] TABLE [IF EXISTS]
    <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
    [RESTRICT | CASCADE]
</pre><p>
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> removes one or more
      tables. You must have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege for each table. All table data and the table definition
      are <span class="emphasis"><em>removed</em></span>, so <span class="emphasis"><em>be
      careful</em></span> with this statement! If any of the tables named
      in the argument list do not exist, MySQL returns an error
      indicating by name which nonexisting tables it was unable to drop,
      but it also drops all of the tables in the list that do exist.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        When a table is dropped, user privileges on the table are
        <span class="emphasis"><em>not</em></span> automatically dropped. See
        <a class="xref" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax">Section 13.7.1.4, “GRANT Syntax”</a>.
</p>
</div>
<p>
      For a partitioned table, <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>
      permanently removes the table definition, all of its partitions,
      and all of the data which was stored in those partitions. It also
      removes the partitioning definition (<code class="filename">.par</code>)
      file associated with the dropped table.
    </p><p>
      Use <code class="literal">IF EXISTS</code> to prevent an error from
      occurring for tables that do not exist. A <code class="literal">NOTE</code>
      is generated for each nonexistent table when using <code class="literal">IF
      EXISTS</code>. See <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      <code class="literal">RESTRICT</code> and <code class="literal">CASCADE</code> are
      permitted to make porting easier. In MySQL 5.6, they
      do nothing.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> automatically commits
        the current active transaction, unless you use the
        <code class="literal">TEMPORARY</code> keyword.
</p>
</div>
<p>
      The <code class="literal">TEMPORARY</code> keyword has the following
      effects:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The statement drops only <code class="literal">TEMPORARY</code> tables.
        </p></li><li class="listitem"><p>
          The statement does not end an ongoing transaction.
        </p></li><li class="listitem"><p>
          No access rights are checked. (A <code class="literal">TEMPORARY</code>
          table is visible only to the session that created it, so no
          check is necessary.)
</p></li></ul>
</div>
<p>
      Using <code class="literal">TEMPORARY</code> is a good way to ensure that
      you do not accidentally drop a non-<code class="literal">TEMPORARY</code>
      table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-tablespace"></a>13.1.29 DROP TABLESPACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150069664"></a><pre class="programlisting">
DROP TABLESPACE <em class="replaceable"><code>tablespace_name</code></em>
    ENGINE [=] <em class="replaceable"><code>engine_name</code></em>
</pre><p>
      This statement drops a tablespace that was previously created
      using <a class="link" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax"><code class="literal">CREATE TABLESPACE</code></a> (see
      <a class="xref" href="sql-syntax.html#create-tablespace" title="13.1.18 CREATE TABLESPACE Syntax">Section 13.1.18, “CREATE TABLESPACE Syntax”</a>).
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        The tablespace to be dropped must not contain any data files; in
        other words, before you can drop a tablespace, you must first
        drop each of its data files using <code class="literal">ALTER TABLESPACE ...
        DROP DATAFILE</code> (see
        <a class="xref" href="sql-syntax.html#alter-tablespace" title="13.1.8 ALTER TABLESPACE Syntax">Section 13.1.8, “ALTER TABLESPACE Syntax”</a>).
</p>
</div>
<p>
      The <code class="literal">ENGINE</code> clause (required) specifies the
      storage engine used by the tablespace. Currently, the only
      accepted values for <em class="replaceable"><code>engine_name</code></em> are
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> and
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDBCLUSTER</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#drop-tablespace" title="13.1.29 DROP TABLESPACE Syntax"><code class="literal">DROP TABLESPACE</code></a> is useful only with
      Disk Data storage for MySQL Cluster. See
      <a class="xref" href="mysql-cluster.html#mysql-cluster-disk-data" title="18.5.12 MySQL Cluster Disk Data Tables">Section 18.5.12, “MySQL Cluster Disk Data Tables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-trigger"></a>13.1.30 DROP TRIGGER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150050912"></a><a class="indexterm" name="idm139737150049840"></a><pre class="programlisting">
DROP TRIGGER [IF EXISTS] [<em class="replaceable"><code>schema_name</code></em>.]<em class="replaceable"><code>trigger_name</code></em>
</pre><p>
      This statement drops a trigger. The schema (database) name is
      optional. If the schema is omitted, the trigger is dropped from
      the default schema. <a class="link" href="sql-syntax.html#drop-trigger" title="13.1.30 DROP TRIGGER Syntax"><code class="literal">DROP TRIGGER</code></a>
      requires the <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for
      the table associated with the trigger.
    </p><p>
      Use <code class="literal">IF EXISTS</code> to prevent an error from
      occurring for a trigger that does not exist. A
      <code class="literal">NOTE</code> is generated for a nonexistent trigger
      when using <code class="literal">IF EXISTS</code>. See
      <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      Triggers for a table are also dropped if you drop the table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="drop-view"></a>13.1.31 DROP VIEW Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150035904"></a><pre class="programlisting">
DROP VIEW [IF EXISTS]
    <em class="replaceable"><code>view_name</code></em> [, <em class="replaceable"><code>view_name</code></em>] ...
    [RESTRICT | CASCADE]
</pre><p>
      <a class="link" href="sql-syntax.html#drop-view" title="13.1.31 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a> removes one or more
      views. You must have the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege for each view. If any of the views named in the argument
      list do not exist, MySQL returns an error indicating by name which
      nonexisting views it was unable to drop, but it also drops all of
      the views in the list that do exist.
    </p><p>
      The <code class="literal">IF EXISTS</code> clause prevents an error from
      occurring for views that don't exist. When this clause is given, a
      <code class="literal">NOTE</code> is generated for each nonexistent view.
      See <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
    </p><p>
      <code class="literal">RESTRICT</code> and <code class="literal">CASCADE</code>, if
      given, are parsed and ignored.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="rename-table"></a>13.1.32 RENAME TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737150021232"></a><pre class="programlisting">
RENAME TABLE <em class="replaceable"><code>tbl_name</code></em> TO <em class="replaceable"><code>new_tbl_name</code></em>
    [, <em class="replaceable"><code>tbl_name2</code></em> TO <em class="replaceable"><code>new_tbl_name2</code></em>] ...
</pre><p>
      This statement renames one or more tables.
    </p><p>
      The rename operation is done atomically, which means that no other
      session can access any of the tables while the rename is running.
      For example, if you have an existing table
      <code class="literal">old_table</code>, you can create another table
      <code class="literal">new_table</code> that has the same structure but is
      empty, and then replace the existing table with the empty one as
      follows (assuming that <code class="literal">backup_table</code> does not
      already exist):
    </p><pre class="programlisting">
CREATE TABLE new_table (...);
RENAME TABLE old_table TO backup_table, new_table TO old_table;
</pre><p>
      If the statement renames more than one table, renaming operations
      are done from left to right. If you want to swap two table names,
      you can do so like this (assuming that
      <code class="literal">tmp_table</code> does not already exist):
    </p><pre class="programlisting">
RENAME TABLE old_table TO tmp_table,
             new_table TO old_table,
             tmp_table TO new_table;
</pre><p>
      As long as two databases are on the same file system, you can use
      <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> to move a table from
      one database to another:
    </p><pre class="programlisting">
RENAME TABLE <em class="replaceable"><code>current_db.tbl_name</code></em> TO <em class="replaceable"><code>other_db.tbl_name;</code></em>
</pre><p>
      If there are any triggers associated with a table which is moved
      to a different database using <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME
      TABLE</code></a>, then the statement fails with the error
      <span class="errortext">Trigger in wrong schema</span>.
    </p><p>
      <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> also works for views,
      as long as you do not try to rename a view into a different
      database.
    </p><p>
      Any privileges granted specifically for the renamed table or view
      are not migrated to the new name. They must be changed manually.
    </p><p>
      When you execute <code class="literal">RENAME</code>, you cannot have any
      locked tables or active transactions. You must also have the
      <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> and
      <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a> privileges on the original
      table, and the <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a> and
      <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges on the new table.
    </p><p>
      If MySQL encounters any errors in a multiple-table rename, it does
      a reverse rename for all renamed tables to return everything to
      its original state.
    </p><p>
      You cannot use <code class="literal">RENAME</code> to rename a
      <code class="literal">TEMPORARY</code> table. However, you can use
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> instead:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>ALTER TABLE orig_name RENAME new_name;</code></strong>
</pre><p>
      If the rename operation would move the table to a database located
      on a different file system, outcome success is platform specific
      and depends on the underlying operating system calls used to move
      table files.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="truncate-table"></a>13.1.33 TRUNCATE TABLE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149986928"></a><pre class="programlisting">
TRUNCATE [TABLE] <em class="replaceable"><code>tbl_name</code></em>
</pre><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> empties a table
      completely. It requires the <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>
      privilege.
    </p><p>
      Logically, <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is
      similar to a <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement that
      deletes all rows, or a sequence of <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP
      TABLE</code></a> and <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
      statements. To achieve high performance, it bypasses the DML
      method of deleting data. Thus, it cannot be rolled back, it does
      not cause <code class="literal">ON DELETE</code> triggers to fire, and it
      cannot be performed for <code class="literal">InnoDB</code> tables with
      parent-child foreign key relationships.
    </p><p>
      Although <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is similar
      to <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>, it is classified as a
      DDL statement rather than a DML statement. It differs from
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> in the following ways in
      MySQL 5.6:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Truncate operations drop and re-create the table, which is
          much faster than deleting rows one by one, particularly for
          large tables.
        </p></li><li class="listitem"><p>
          Truncate operations cause an implicit commit, and so cannot be
          rolled back.
        </p></li><li class="listitem"><p>
          Truncation operations cannot be performed if the session holds
          an active table lock.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> fails for an
          <code class="literal">InnoDB</code> table or
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table if there are any
          <code class="literal">FOREIGN KEY</code> constraints from other tables
          that reference the table. Foreign key constraints between
          columns of the same table are permitted.
        </p></li><li class="listitem"><p>
          Truncation operations do not return a meaningful value for the
          number of deleted rows. The usual result is <span class="quote">“<span class="quote">0 rows
          affected,</span>”</span> which should be interpreted as <span class="quote">“<span class="quote">no
          information.</span>”</span>
        </p></li><li class="listitem"><p>
          As long as the table format file
          <code class="filename"><em class="replaceable"><code>tbl_name</code></em>.frm</code>
          is valid, the table can be re-created as an empty table with
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>, even if the
          data or index files have become corrupted.
        </p></li><li class="listitem"><p>
          Any <code class="literal">AUTO_INCREMENT</code> value is reset to its
          start value. This is true even for <code class="literal">MyISAM</code>
          and <code class="literal">InnoDB</code>, which normally do not reuse
          sequence values.
        </p></li><li class="listitem"><p>
          When used with partitioned tables,
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> preserves the
          partitioning; that is, the data and index files are dropped
          and re-created, while the partition definitions
          (<code class="filename">.par</code>) file is unaffected.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statement
          does not invoke <code class="literal">ON DELETE</code> triggers.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> for a table closes
      all handlers for the table that were opened with
      <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER OPEN</code></a>.
    </p><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> is treated for
      purposes of binary logging and replication as
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> followed by
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>—that is, as DDL
      rather than DML. This is due to the fact that, when using
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> and other transactional
      storage engines where the transaction isolation level does not
      permit statement-based logging (<code class="literal">READ COMMITTED</code>
      or <code class="literal">READ UNCOMMITTED</code>), the statement was not
      logged and replicated when using <code class="literal">STATEMENT</code> or
      <code class="literal">MIXED</code> logging mode. (Bug #36763) However, it is
      still applied on replication slaves using
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> in the manner described
      previously.
    </p><p>
      On a system with a large <code class="literal">InnoDB</code> buffer pool and
      <a class="link" href="innodb-storage-engine.html#sysvar_innodb_adaptive_hash_index"><code class="literal">innodb_adaptive_hash_index</code></a>
      enabled, <code class="literal">TRUNCATE TABLE</code> operations may cause a
      temporary drop in system performance due to an LRU scan that
      occurs when removing an <code class="literal">InnoDB</code> table's adaptive
      hash index entries. The problem was addressed for
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> in MySQL 5.5.23 (Bug
      #13704145, Bug #64284) but remains a known issue for
      <code class="literal">TRUNCATE TABLE</code> (Bug #68184).
    </p><p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> can be used with
      Performance Schema summary tables, but the effect is to reset the
      summary columns to 0 or <code class="literal">NULL</code>, not to remove
      rows. See <a class="xref" href="performance-schema.html#performance-schema-summary-tables" title="22.9.9 Performance Schema Summary Tables">Section 22.9.9, “Performance Schema Summary Tables”</a>.
</p>
</div>

</div>

<div class="section">

<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-data-manipulation"></a>13.2 Data Manipulation Statements</h2>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#call">13.2.1 CALL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#delete">13.2.2 DELETE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#do">13.2.3 DO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler">13.2.4 HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert">13.2.5 INSERT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-data">13.2.6 LOAD DATA INFILE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-xml">13.2.7 LOAD XML Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replace">13.2.8 REPLACE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#select">13.2.9 SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subqueries">13.2.10 Subquery Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#update">13.2.11 UPDATE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737149921424"></a>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="call"></a>13.2.1 CALL Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149919280"></a><pre class="programlisting">
CALL <em class="replaceable"><code>sp_name</code></em>([<em class="replaceable"><code>parameter</code></em>[,...]])
CALL <em class="replaceable"><code>sp_name</code></em>[()]
</pre><p>
      The <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement invokes a stored
      procedure that was defined previously with
      <a class="link" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a>.
    </p><p>
      Stored procedures that take no arguments can be invoked without
      parentheses. That is, <code class="literal">CALL p()</code> and
      <code class="literal">CALL p</code> are equivalent.
    </p><p>
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> can pass back values to its
      caller using parameters that are declared as
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameters.
      When the procedure returns, a client program can also obtain the
      number of rows affected for the final statement executed within
      the routine: At the SQL level, call the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function; from the C
      API, call the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> function.
    </p><p>
      To get back a value from a procedure using an
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameter, pass
      the parameter by means of a user variable, and then check the
      value of the variable after the procedure returns. (If you are
      calling the procedure from within another stored procedure or
      function, you can also pass a routine parameter or local routine
      variable as an <code class="literal">IN</code> or <code class="literal">INOUT</code>
      parameter.) For an <code class="literal">INOUT</code> parameter, initialize
      its value before passing it to the procedure. The following
      procedure has an <code class="literal">OUT</code> parameter that the
      procedure sets to the current server version, and an
      <code class="literal">INOUT</code> value that the procedure increments by
      one from its current value:
    </p><pre class="programlisting">
CREATE PROCEDURE p (OUT ver_param VARCHAR(25), INOUT incr_param INT)
BEGIN
  # Set value of OUT parameter
  SELECT VERSION() INTO ver_param;
  # Increment value of INOUT parameter
  SET incr_param = incr_param + 1;
END;
</pre><p>
      Before calling the procedure, initialize the variable to be passed
      as the <code class="literal">INOUT</code> parameter. After calling the
      procedure, the values of the two variables will have been set or
      modified:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @increment = 10;</code></strong>
mysql&gt; <strong class="userinput"><code>CALL p(@version, @increment);</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @version, @increment;</code></strong>
+--------------+------------+
| @version     | @increment |
+--------------+------------+
| 5.5.3-m3-log |         11 |
+--------------+------------+
</pre><p>
      In prepared <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements used
      with <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, placeholders can be used
      for <code class="literal">IN</code> parameters. For <code class="literal">OUT</code>
      and <code class="literal">INOUT</code> parameters, placeholder support is
      available as of MySQL 5.5.3. These types of parameters can be used
      as follows:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @increment = 10;</code></strong>
mysql&gt; <strong class="userinput"><code>PREPARE s FROM 'CALL p(?, ?)';</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE s USING @version, @increment;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @version, @increment;</code></strong>
+--------------+------------+
| @version     | @increment |
+--------------+------------+
| 5.5.3-m3-log |         11 |
+--------------+------------+
</pre><p>
      Before MySQL 5.5.3, placeholder support is not available for
      <code class="literal">OUT</code> or <code class="literal">INOUT</code> parameters. To
      work around this limitation for <code class="literal">OUT</code> and
      <code class="literal">INOUT</code> parameters, forego the use of
      placeholders; instead, refer to user variables in the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement itself and do not
      specify them in the <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>
      statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @increment = 10;</code></strong>
mysql&gt; <strong class="userinput"><code>PREPARE s FROM 'CALL p(@version, @increment)';</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE s;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @version, @increment;</code></strong>
+--------------+------------+
| @version     | @increment |
+--------------+------------+
| 5.5.0-m2-log |         11 |
+--------------+------------+
</pre><p>
      To write C programs that use the
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> SQL statement to execute
      stored procedures that produce result sets, the
      <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be enabled. This
      is because each <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> returns a
      result to indicate the call status, in addition to any result sets
      that might be returned by statements executed within the
      procedure. <code class="literal">CLIENT_MULTI_RESULTS</code> must also be
      enabled if <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> is used to execute
      any stored procedure that contains prepared statements. It cannot
      be determined when such a procedure is loaded whether those
      statements will produce result sets, so it is necessary to assume
      that they will.
    </p><p>
      <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when you
      call <a class="link" href="connectors-apis.html#mysql-real-connect" title="23.8.7.53 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, either
      explicitly by passing the <code class="literal">CLIENT_MULTI_RESULTS</code>
      flag itself, or implicitly by passing
      <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
      <code class="literal">CLIENT_MULTI_RESULTS</code>). In MySQL
      5.6, <code class="literal">CLIENT_MULTI_RESULTS</code> is
      enabled by default.
    </p><p>
      To process the result of a <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
      statement executed using
      <a class="link" href="connectors-apis.html#mysql-query" title="23.8.7.52 mysql_query()"><code class="literal">mysql_query()</code></a> or
      <a class="link" href="connectors-apis.html#mysql-real-query" title="23.8.7.55 mysql_real_query()"><code class="literal">mysql_real_query()</code></a>, use a loop
      that calls <a class="link" href="connectors-apis.html#mysql-next-result" title="23.8.7.46 mysql_next_result()"><code class="literal">mysql_next_result()</code></a> to
      determine whether there are more results. For an example, see
      <a class="xref" href="connectors-apis.html#c-api-multiple-queries" title="23.8.17 C API Support for Multiple Statement Execution">Section 23.8.17, “C API Support for Multiple Statement Execution”</a>.
    </p><p>
      For programs written in a language that provides a MySQL
      interface, there is no native method prior to MySQL 5.5.3 for
      directly retrieving the results of <code class="literal">OUT</code> or
      <code class="literal">INOUT</code> parameters from
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements. To get the
      parameter values, pass user-defined variables to the procedure in
      the <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement and then execute
      a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement to produce a
      result set containing the variable values. To handle an
      <code class="literal">INOUT</code> parameter, execute a statement prior to
      the <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> that sets the
      corresponding user variable to the value to be passed to the
      procedure.
    </p><p>
      The following example illustrates the technique (without error
      checking) for the stored procedure <code class="literal">p</code> described
      earlier that has an <code class="literal">OUT</code> parameter and an
      <code class="literal">INOUT</code> parameter:
    </p><pre class="programlisting">
mysql_query(mysql, "SET @increment = 10");
mysql_query(mysql, "CALL p(@version, @increment)");
mysql_query(mysql, "SELECT @version, @increment");
result = mysql_store_result(mysql);
row = mysql_fetch_row(result);
mysql_free_result(result);
</pre><p>
      After the preceding code executes, <code class="literal">row[0]</code> and
      <code class="literal">row[1]</code> contain the values of
      <code class="literal">@version</code> and <code class="literal">@increment</code>,
      respectively.
    </p><p>
      In MySQL 5.6, C programs can use the
      prepared-statement interface to execute
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements and access
      <code class="literal">OUT</code> and <code class="literal">INOUT</code> parameters.
      This is done by processing the result of a
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statement using a loop that
      calls <a class="link" href="connectors-apis.html#mysql-stmt-next-result" title="23.8.11.17 mysql_stmt_next_result()"><code class="literal">mysql_stmt_next_result()</code></a> to
      determine whether there are more results. For an example, see
      <a class="xref" href="connectors-apis.html#c-api-prepared-call-statements" title="23.8.20 C API Support for Prepared CALL Statements">Section 23.8.20, “C API Support for Prepared CALL Statements”</a>. Languages that
      provide a MySQL interface can use prepared
      <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements to directly
      retrieve <code class="literal">OUT</code> and <code class="literal">INOUT</code>
      procedure parameters.
    </p><p>
      As of MySQL 5.6.6, metadata changes to objects referred to by
      stored programs are detected and cause automatic reparsing of the
      affected statements when the program is next executed. For more
      information, see <a class="xref" href="optimization.html#statement-caching" title="8.10.4 Caching of Prepared Statements and Stored Programs">Section 8.10.4, “Caching of Prepared Statements and Stored Programs”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="delete"></a>13.2.2 DELETE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149826416"></a><a class="indexterm" name="idm139737149825344"></a><p>
      <code class="literal">DELETE</code> is a DML statement that removes rows
      from a table.
</p>
<h4><a name="idm139737149820656"></a>Single-Table Syntax</h4>
<pre class="programlisting">
DELETE [LOW_PRIORITY] [QUICK] [IGNORE] FROM <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [ORDER BY ...]
    [LIMIT <em class="replaceable"><code>row_count</code></em>]
</pre><p>
      The <code class="literal">DELETE</code> statement deletes rows from
      <em class="replaceable"><code>tbl_name</code></em> and returns the number of
      deleted rows. To check the number of deleted rows, call the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function described in
      <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>.
</p>
<h4><a name="idm139737149813872"></a>Main Clauses</h4>
<p>
      The conditions in the optional <code class="literal">WHERE</code> clause
      identify which rows to delete. With no <code class="literal">WHERE</code>
      clause, all rows are deleted.
    </p><p>
      <em class="replaceable"><code>where_condition</code></em> is an expression that
      evaluates to true for each row to be deleted. It is specified as
      described in <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
    </p><p>
      If the <code class="literal">ORDER BY</code> clause is specified, the rows
      are deleted in the order that is specified. The
      <code class="literal">LIMIT</code> clause places a limit on the number of
      rows that can be deleted. These clauses apply to single-table
      deletes, but not multi-table deletes.
</p>
<h4><a name="idm139737149807568"></a>Multiple-Table Syntax</h4>
<pre class="programlisting">
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
    <em class="replaceable"><code>tbl_name</code></em>[.*] [, <em class="replaceable"><code>tbl_name</code></em>[.*]] ...
    FROM <em class="replaceable"><code>table_references</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
</pre><p>
      Or:
    </p><pre class="programlisting">
DELETE [LOW_PRIORITY] [QUICK] [IGNORE]
    FROM <em class="replaceable"><code>tbl_name</code></em>[.*] [, <em class="replaceable"><code>tbl_name</code></em>[.*]] ...
    USING <em class="replaceable"><code>table_references</code></em>
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
</pre>
<h4><a name="idm139737149800448"></a>Privileges</h4>
<p>
      You need the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege on a
      table to delete rows from it. You need only the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for any columns
      that are only read, such as those named in the
      <code class="literal">WHERE</code> clause.
</p>
<h4><a name="idm139737149796032"></a>Performance</h4>
<p>
      When you do not need to know the number of deleted rows, the
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> statement is a
      faster way to empty a table than a
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement with no
      <code class="literal">WHERE</code> clause. Unlike
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> cannot be used
      within a transaction or if you have a lock on the table. See
      <a class="xref" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax">Section 13.1.33, “TRUNCATE TABLE Syntax”</a> and
      <a class="xref" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax">Section 13.3.5, “LOCK TABLES and UNLOCK TABLES Syntax”</a>.
    </p><p>
      The speed of delete operations may also be affected by factors
      discussed in <a class="xref" href="optimization.html#delete-speed" title="8.2.2.3 Speed of DELETE Statements">Section 8.2.2.3, “Speed of DELETE Statements”</a>.
    </p><p>
      To ensure that a given <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
      statement does not take too much time, the MySQL-specific
      <code class="literal">LIMIT <em class="replaceable"><code>row_count</code></em></code>
      clause for <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> specifies the
      maximum number of rows to be deleted. If the number of rows to
      delete is larger than the limit, repeat the
      <code class="literal">DELETE</code> statement until the number of affected
      rows is less than the <code class="literal">LIMIT</code> value.
</p>
<h4><a name="idm139737149780864"></a>Subqueries</h4>
<p>
      Currently, you cannot delete from a table and select from the same
      table in a subquery.
</p>
<h4><a name="idm139737149779664"></a>Partitioned Tables</h4>
<p>
      Beginning with MySQL 5.6.2, <code class="literal">DELETE</code> supports
      explicit partition selection using the
      <code class="literal">PARTITION</code> option, which takes a comma-separated
      list of the names of one or more partitions or subpartitions (or
      both) from which to select rows to be dropped. Partitions not
      included in the list are ignored. Given a partitioned table
      <code class="literal">t</code> with a partition named <code class="literal">p0</code>,
      executing the statement <code class="literal">DELETE FROM t PARTITION
      (p0)</code> has the same effect on the table as executing
      <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE t
      TRUNCATE PARTITION (p0)</code></a>; in both cases, all rows in
      partition <code class="literal">p0</code> are dropped.
    </p><p>
      <code class="literal">PARTITION</code> can be used along with a
      <code class="literal">WHERE</code> condition, in which case the condition is
      tested only on rows in the listed partitions. For example,
      <code class="literal">DELETE FROM t PARTITION (p0) WHERE c &lt; 5</code>
      deletes rows only from partition <code class="literal">p0</code> for which
      the condition <code class="literal">c &lt; 5</code> is true; rows in any
      other partitions are not checked and thus not affected by the
      <code class="literal">DELETE</code>.
    </p><p>
      The <code class="literal">PARTITION</code> option can also be used in
      multiple-table <code class="literal">DELETE</code> statements. You can use
      up to one such option per table named in the
      <code class="literal">FROM</code> option.
    </p><p>
      See <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>, for more information
      and examples.
</p>
<h4><a name="idm139737149763360"></a>Auto-Increment Columns</h4>
<p>
      If you delete the row containing the maximum value for an
      <code class="literal">AUTO_INCREMENT</code> column, the value is not reused
      for a <code class="literal">MyISAM</code> or <code class="literal">InnoDB</code>
      table. If you delete all rows in the table with <code class="literal">DELETE
      FROM <em class="replaceable"><code>tbl_name</code></em></code> (without a
      <code class="literal">WHERE</code> clause) in
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> mode, the sequence
      starts over for all storage engines except
      <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>. There are
      some exceptions to this behavior for <code class="literal">InnoDB</code>
      tables, as discussed in
      <a class="xref" href="innodb-storage-engine.html#innodb-auto-increment-handling" title="14.5.5 AUTO_INCREMENT Handling in InnoDB">Section 14.5.5, “AUTO_INCREMENT Handling in InnoDB”</a>.
    </p><p>
      For <code class="literal">MyISAM</code> tables, you can specify an
      <code class="literal">AUTO_INCREMENT</code> secondary column in a
      multiple-column key. In this case, reuse of values deleted from
      the top of the sequence occurs even for <code class="literal">MyISAM</code>
      tables. See <a class="xref" href="tutorial.html#example-auto-increment" title="3.6.9 Using AUTO_INCREMENT">Section 3.6.9, “Using AUTO_INCREMENT”</a>.
</p>
<h4><a name="idm139737149750656"></a>Modifiers</h4>
<p>
      The <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you specify <code class="literal">LOW_PRIORITY</code>, the server
          delays execution of the <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
          until no other clients are reading from the table. This
          affects only storage engines that use only table-level locking
          (such as <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
          and <code class="literal">MERGE</code>).
        </p></li><li class="listitem"><p>
          For <code class="literal">MyISAM</code> tables, if you use the
          <code class="literal">QUICK</code> keyword, the storage engine does not
          merge index leaves during delete, which may speed up some
          kinds of delete operations.
        </p></li><li class="listitem"><p>
          The <code class="literal">IGNORE</code> keyword causes MySQL to ignore
          errors during the process of deleting rows. (Errors
          encountered during the parsing stage are processed in the
          usual manner.) Errors that are ignored due to the use of
          <code class="literal">IGNORE</code> are returned as warnings.
</p></li></ul>
</div>
<h4><a name="idm139737149737952"></a>Order of Deletion</h4>
<p>
      If the <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement includes an
      <code class="literal">ORDER BY</code> clause, rows are deleted in the order
      specified by the clause. This is useful primarily in conjunction
      with <code class="literal">LIMIT</code>. For example, the following
      statement finds rows matching the <code class="literal">WHERE</code> clause,
      sorts them by <code class="literal">timestamp_column</code>, and deletes the
      first (oldest) one:
    </p><pre class="programlisting">
DELETE FROM somelog WHERE user = 'jcole'
ORDER BY timestamp_column LIMIT 1;
</pre><p>
      <code class="literal">ORDER BY</code> also helps to delete rows in an order
      required to avoid referential integrity violations.
</p>
<h4><a name="idm139737149730576"></a>InnoDB Tables</h4>
<p>
      If you are deleting many rows from a large table, you may exceed
      the lock table size for an <code class="literal">InnoDB</code> table. To
      avoid this problem, or simply to minimize the time that the table
      remains locked, the following strategy (which does not use
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> at all) might be helpful:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Select the rows <span class="emphasis"><em>not</em></span> to be deleted into an
          empty table that has the same structure as the original table:
        </p><pre class="programlisting">
INSERT INTO t_copy SELECT * FROM t WHERE ... ;
</pre></li><li class="listitem"><p>
          Use <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> to atomically
          move the original table out of the way and rename the copy to
          the original name:
        </p><pre class="programlisting">
RENAME TABLE t TO t_old, t_copy TO t;
</pre></li><li class="listitem"><p>
          Drop the original table:
        </p><pre class="programlisting">
DROP TABLE t_old;
</pre></li></ol>
</div>
<p>
      No other sessions can access the tables involved while
      <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a> executes, so the
      rename operation is not subject to concurrency problems. See
      <a class="xref" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax">Section 13.1.32, “RENAME TABLE Syntax”</a>.
</p>
<h4><a name="idm139737149717424"></a>MyISAM Tables</h4>
<p>
      In <code class="literal">MyISAM</code> tables, deleted rows are maintained
      in a linked list and subsequent
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> operations reuse old row
      positions. To reclaim unused space and reduce file sizes, use the
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> statement or the
      <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a> utility to reorganize tables.
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is easier to use,
      but <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a> is faster. See
      <a class="xref" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax">Section 13.7.2.4, “OPTIMIZE TABLE Syntax”</a>, and <a class="xref" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility">Section 4.6.3, “<span class="command"><strong>myisamchk</strong></span> — MyISAM Table-Maintenance Utility”</a>.
    </p><p>
      The <code class="literal">QUICK</code> modifier affects whether index leaves
      are merged for delete operations. <code class="literal">DELETE QUICK</code>
      is most useful for applications where index values for deleted
      rows are replaced by similar index values from rows inserted
      later. In this case, the holes left by deleted values are reused.
    </p><p>
      <code class="literal">DELETE QUICK</code> is not useful when deleted values
      lead to underfilled index blocks spanning a range of index values
      for which new inserts occur again. In this case, use of
      <code class="literal">QUICK</code> can lead to wasted space in the index
      that remains unreclaimed. Here is an example of such a scenario:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Create a table that contains an indexed
          <code class="literal">AUTO_INCREMENT</code> column.
        </p></li><li class="listitem"><p>
          Insert many rows into the table. Each insert results in an
          index value that is added to the high end of the index.
        </p></li><li class="listitem"><p>
          Delete a block of rows at the low end of the column range
          using <code class="literal">DELETE QUICK</code>.
</p></li></ol>
</div>
<p>
      In this scenario, the index blocks associated with the deleted
      index values become underfilled but are not merged with other
      index blocks due to the use of <code class="literal">QUICK</code>. They
      remain underfilled when new inserts occur, because new rows do not
      have index values in the deleted range. Furthermore, they remain
      underfilled even if you later use
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> without
      <code class="literal">QUICK</code>, unless some of the deleted index values
      happen to lie in index blocks within or adjacent to the
      underfilled blocks. To reclaim unused index space under these
      circumstances, use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>.
    </p><p>
      If you are going to delete many rows from a table, it might be
      faster to use <code class="literal">DELETE QUICK</code> followed by
      <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a>. This rebuilds the
      index rather than performing many index block merge operations.
</p>
<h4><a name="idm139737149691328"></a>Multi-Table Deletes</h4>
<p>
      You can specify multiple tables in a
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statement to delete rows
      from one or more tables depending on the condition in the
      <code class="literal">WHERE</code> clause. You cannot use <code class="literal">ORDER
      BY</code> or <code class="literal">LIMIT</code> in a multiple-table
      <code class="literal">DELETE</code>. The
      <em class="replaceable"><code>table_references</code></em> clause lists the
      tables involved in the join, as described in
      <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>.
    </p><p>
      For the first multiple-table syntax, only matching rows from the
      tables listed before the <code class="literal">FROM</code> clause are
      deleted. For the second multiple-table syntax, only matching rows
      from the tables listed in the <code class="literal">FROM</code> clause
      (before the <code class="literal">USING</code> clause) are deleted. The
      effect is that you can delete rows from many tables at the same
      time and have additional tables that are used only for searching:
    </p><pre class="programlisting">
DELETE t1, t2 FROM t1 INNER JOIN t2 INNER JOIN t3
WHERE t1.id=t2.id AND t2.id=t3.id;
</pre><p>
      Or:
    </p><pre class="programlisting">
DELETE FROM t1, t2 USING t1 INNER JOIN t2 INNER JOIN t3
WHERE t1.id=t2.id AND t2.id=t3.id;
</pre><p>
      These statements use all three tables when searching for rows to
      delete, but delete matching rows only from tables
      <code class="literal">t1</code> and <code class="literal">t2</code>.
    </p><p>
      The preceding examples use <code class="literal">INNER JOIN</code>, but
      multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements
      can use other types of join permitted in
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements, such as
      <code class="literal">LEFT JOIN</code>. For example, to delete rows that
      exist in <code class="literal">t1</code> that have no match in
      <code class="literal">t2</code>, use a <code class="literal">LEFT JOIN</code>:
    </p><pre class="programlisting">
DELETE t1 FROM t1 LEFT JOIN t2 ON t1.id=t2.id WHERE t2.id IS NULL;
</pre><p>
      The syntax permits <code class="literal">.*</code> after each
      <em class="replaceable"><code>tbl_name</code></em> for compatibility with
      <span class="command"><strong>Access</strong></span>.
    </p><p>
      If you use a multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>
      statement involving <code class="literal">InnoDB</code> tables for which
      there are foreign key constraints, the MySQL optimizer might
      process tables in an order that differs from that of their
      parent/child relationship. In this case, the statement fails and
      rolls back. Instead, you should delete from a single table and
      rely on the <code class="literal">ON DELETE</code> capabilities that
      <code class="literal">InnoDB</code> provides to cause the other tables to be
      modified accordingly.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        If you declare an alias for a table, you must use the alias when
        referring to the table:
      </p><pre class="programlisting">
DELETE t1 FROM test AS t1, test2 WHERE ...
</pre>
</div>
<p>
      Table aliases in a multiple-table
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> should be declared only in
      the <em class="replaceable"><code>table_references</code></em> part of the
      statement. Elsewhere, alias references are permitted but not alias
      declarations.
    </p><p>
      Correct:
    </p><pre class="programlisting">
DELETE a1, a2 FROM t1 AS a1 INNER JOIN t2 AS a2
WHERE a1.id=a2.id;

DELETE FROM a1, a2 USING t1 AS a1 INNER JOIN t2 AS a2
WHERE a1.id=a2.id;
</pre><p>
      Incorrect:
    </p><pre class="programlisting">
DELETE t1 AS a1, t2 AS a2 FROM t1 INNER JOIN t2
WHERE a1.id=a2.id;

DELETE FROM t1 AS a1, t2 AS a2 USING t1 INNER JOIN t2
WHERE a1.id=a2.id;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="do"></a>13.2.3 DO Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149656672"></a><pre class="programlisting">
DO <em class="replaceable"><code>expr</code></em> [, <em class="replaceable"><code>expr</code></em>] ...
</pre><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> executes the expressions but
      does not return any results. In most respects,
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> is shorthand for <code class="literal">SELECT
      <em class="replaceable"><code>expr</code></em>, ...</code>, but has the
      advantage that it is slightly faster when you do not care about
      the result.
    </p><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> is useful primarily with
      functions that have side effects, such as
      <a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a>.
    </p><p>
      Example: This <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement
      pauses, but also produces a result set:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT SLEEP(5);</code></strong>
+----------+
| SLEEP(5) |
+----------+
|        0 |
+----------+
1 row in set (5.02 sec)
</pre><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a>, on the other hand, pauses
      without producing a result set.:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DO SLEEP(5);</code></strong>
Query OK, 0 rows affected (4.99 sec)
</pre><p>
      This could be useful, for example in a stored function or trigger,
      which prohibit statements that produce result sets.
    </p><p>
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a> only executes expressions. It
      cannot be used in all cases where <code class="literal">SELECT</code> can be
      used. For example, <code class="literal">DO id FROM t1</code> is invalid
      because it references a table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="handler"></a>13.2.4 HANDLER Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149633088"></a><pre class="programlisting">
HANDLER <em class="replaceable"><code>tbl_name</code></em> OPEN [ [AS] <em class="replaceable"><code>alias</code></em>]

HANDLER <em class="replaceable"><code>tbl_name</code></em> READ <em class="replaceable"><code>index_name</code></em> { = | &lt;= | &gt;= | &lt; | &gt; } (<em class="replaceable"><code>value1</code></em>,<em class="replaceable"><code>value2</code></em>,...)
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ <em class="replaceable"><code>index_name</code></em> { FIRST | NEXT | PREV | LAST }
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ { FIRST | NEXT }
    [ WHERE <em class="replaceable"><code>where_condition</code></em> ] [LIMIT ... ]

HANDLER <em class="replaceable"><code>tbl_name</code></em> CLOSE
</pre><p>
      The <code class="literal">HANDLER</code> statement provides direct access to
      table storage engine interfaces. It is available for
      <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code> tables.
    </p><p>
      The <code class="literal">HANDLER ... OPEN</code> statement opens a table,
      making it accessible using subsequent <code class="literal">HANDLER ...
      READ</code> statements. This table object is not shared by
      other sessions and is not closed until the session calls
      <code class="literal">HANDLER ... CLOSE</code> or the session terminates. If
      you open the table using an alias, further references to the open
      table with other <code class="literal">HANDLER</code> statements must use
      the alias rather than the table name.
    </p><p>
      The first <code class="literal">HANDLER ... READ</code> syntax fetches a row
      where the index specified satisfies the given values and the
      <code class="literal">WHERE</code> condition is met. If you have a
      multiple-column index, specify the index column values as a
      comma-separated list. Either specify values for all the columns in
      the index, or specify values for a leftmost prefix of the index
      columns. Suppose that an index <code class="literal">my_idx</code> includes
      three columns named <code class="literal">col_a</code>,
      <code class="literal">col_b</code>, and <code class="literal">col_c</code>, in that
      order. The <code class="literal">HANDLER</code> statement can specify values
      for all three columns in the index, or for the columns in a
      leftmost prefix. For example:
    </p><pre class="programlisting">
HANDLER ... READ my_idx = (col_a_val,col_b_val,col_c_val) ...
HANDLER ... READ my_idx = (col_a_val,col_b_val) ...
HANDLER ... READ my_idx = (col_a_val) ...
</pre><p>
      To employ the <code class="literal">HANDLER</code> interface to refer to a
      table's <code class="literal">PRIMARY KEY</code>, use the quoted identifier
      <code class="literal">`PRIMARY`</code>:
    </p><pre class="programlisting">
HANDLER <em class="replaceable"><code>tbl_name</code></em> READ `PRIMARY` ...
</pre><p>
      The second <code class="literal">HANDLER ... READ</code> syntax fetches a
      row from the table in index order that matches the
      <code class="literal">WHERE</code> condition.
    </p><p>
      The third <code class="literal">HANDLER ... READ</code> syntax fetches a row
      from the table in natural row order that matches the
      <code class="literal">WHERE</code> condition. It is faster than
      <code class="literal">HANDLER <em class="replaceable"><code>tbl_name</code></em> READ
      <em class="replaceable"><code>index_name</code></em></code> when a full table
      scan is desired. Natural row order is the order in which rows are
      stored in a <code class="literal">MyISAM</code> table data file. This
      statement works for <code class="literal">InnoDB</code> tables as well, but
      there is no such concept because there is no separate data file.
    </p><p>
      Without a <code class="literal">LIMIT</code> clause, all forms of
      <code class="literal">HANDLER ... READ</code> fetch a single row if one is
      available. To return a specific number of rows, include a
      <code class="literal">LIMIT</code> clause. It has the same syntax as for the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
      <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
    </p><p>
      <code class="literal">HANDLER ... CLOSE</code> closes a table that was
      opened with <code class="literal">HANDLER ... OPEN</code>.
    </p><p>
      There are several reasons to use the <code class="literal">HANDLER</code>
      interface instead of normal <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
      statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">HANDLER</code> is faster than
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              A designated storage engine handler object is allocated
              for the <code class="literal">HANDLER ... OPEN</code>. The object is
              reused for subsequent <code class="literal">HANDLER</code>
              statements for that table; it need not be reinitialized
              for each one.
            </p></li><li class="listitem"><p>
              There is less parsing involved.
            </p></li><li class="listitem"><p>
              There is no optimizer or query-checking overhead.
            </p></li><li class="listitem"><p>
              The handler interface does not have to provide a
              consistent look of the data (for example,
              <a class="link" href="glossary.html#glos_dirty_read" title="dirty read">dirty reads</a> are
              permitted), so the storage engine can use optimizations
              that <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> does not
              normally permit.
</p></li></ul>
</div>
</li><li class="listitem"><p>
          <code class="literal">HANDLER</code> makes it easier to port to MySQL
          applications that use a low-level <code class="literal">ISAM</code>-like
          interface. (See <a class="xref" href="innodb-storage-engine.html#innodb-memcached" title="14.17 InnoDB Integration with memcached">Section 14.17, “InnoDB Integration with memcached”</a> for an
          alternative way to adapt applications that use the key-value
          store paradigm.)
        </p></li><li class="listitem"><p>
          <code class="literal">HANDLER</code> enables you to traverse a database
          in a manner that is difficult (or even impossible) to
          accomplish with <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>. The
          <code class="literal">HANDLER</code> interface is a more natural way to
          look at data when working with applications that provide an
          interactive user interface to the database.
</p></li></ul>
</div>
<p>
      <code class="literal">HANDLER</code> is a somewhat low-level statement. For
      example, it does not provide consistency. That is,
      <code class="literal">HANDLER ... OPEN</code> does <span class="emphasis"><em>not</em></span>
      take a snapshot of the table, and does <span class="emphasis"><em>not</em></span>
      lock the table. This means that after a <code class="literal">HANDLER ...
      OPEN</code> statement is issued, table data can be modified (by
      the current session or other sessions) and these modifications
      might be only partially visible to <code class="literal">HANDLER ...
      NEXT</code> or <code class="literal">HANDLER ... PREV</code> scans.
    </p><p>
      An open handler can be closed and marked for reopen, in which case
      the handler loses its position in the table. This occurs when both
      of the following circumstances are true:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Any session executes
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>
          or DDL statements on the handler's table.
        </p></li><li class="listitem"><p>
          The session in which the handler is open executes
          non-<code class="literal">HANDLER</code> statements that use tables.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a> for a table closes
      all handlers for the table that were opened with
      <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER OPEN</code></a>.
    </p><p>
      If a table is flushed with
      <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES
      <em class="replaceable"><code>tbl_name</code></em> WITH READ LOCK</code></a> was
      opened with <code class="literal">HANDLER</code>, the handler is implicitly
      flushed and loses its position.
    </p><p>
      <code class="literal">HANDLER</code> is not supported with partitioned
      tables.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="insert"></a>13.2.5 INSERT Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#insert-select">13.2.5.1 INSERT ... SELECT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert-delayed">13.2.5.2 INSERT DELAYED Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#insert-on-duplicate">13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737149554080"></a><a class="indexterm" name="idm139737149553008"></a><a class="indexterm" name="idm139737149551936"></a><pre class="programlisting">
INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)] 
    [(<em class="replaceable"><code>col_name</code></em>,...)]
    {VALUES | VALUE} ({<em class="replaceable"><code>expr</code></em> | DEFAULT},...),(...),...
    [ ON DUPLICATE KEY UPDATE
      <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>
        [, <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>] ... ]
</pre><p>
      Or:
    </p><pre class="programlisting">
INSERT [LOW_PRIORITY | DELAYED | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]
    SET <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT}, ...
    [ ON DUPLICATE KEY UPDATE
      <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>
        [, <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>] ... ]
</pre><p>
      Or:
    </p><pre class="programlisting">
INSERT [LOW_PRIORITY | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)] 
    [(<em class="replaceable"><code>col_name</code></em>,...)]
    SELECT ...
    [ ON DUPLICATE KEY UPDATE
      <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>
        [, <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>] ... ]
</pre><p>
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> inserts new rows into an
      existing table. The <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT
      ... VALUES</code></a> and
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT ... SET</code></a>
      forms of the statement insert rows based on explicitly specified
      values. The <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT
      ... SELECT</code></a> form inserts rows selected from another table
      or tables. <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT
      ... SELECT</code></a> is discussed further in
      <a class="xref" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax">Section 13.2.5.1, “INSERT ... SELECT Syntax”</a>.
    </p><p>
      In MySQL 5.6.2 and later, when inserting into a partitioned table,
      you can control which partitions and subpartitions accept new
      rows. The <code class="literal">PARTITION</code> option takes a
      comma-separated list of the names of one or more partitions or
      subpartitions (or both) of the table. If any of the rows to be
      inserted by a given <code class="literal">INSERT</code> statement do not
      match one of the partitions listed, the <code class="literal">INSERT</code>
      statement fails with the error <span class="errortext">Found a row not matching
      the given partition set</span>. See
      <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>, for more information and
      examples.
    </p><p>
      You can use <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> instead of
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> to overwrite old rows.
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> is the counterpart to
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT IGNORE</code></a> in
      the treatment of new rows that contain unique key values that
      duplicate old rows: The new rows are used to replace the old rows
      rather than being discarded. See <a class="xref" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax">Section 13.2.8, “REPLACE Syntax”</a>.
    </p><p>
      <em class="replaceable"><code>tbl_name</code></em> is the table into which rows
      should be inserted. The columns for which the statement provides
      values can be specified as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          You can provide a comma-separated list of column names
          following the table name. In this case, a value for each named
          column must be provided by the <code class="literal">VALUES</code> list
          or the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
        </p></li><li class="listitem"><p>
          If you do not specify a list of column names for
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT ...
          VALUES</code></a> or
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
          SELECT</code></a>, values for every column in the table must be
          provided by the <code class="literal">VALUES</code> list or the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. If you do not
          know the order of the columns in the table, use
          <code class="literal">DESCRIBE
          <em class="replaceable"><code>tbl_name</code></em></code> to find out.
        </p></li><li class="listitem"><p>
          The <code class="literal">SET</code> clause indicates the column names
          explicitly.
</p></li></ul>
</div>
<p>
      Column values can be given in several ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm139737149502272"></a>

          If you are not running in strict SQL mode, any column not
          explicitly given a value is set to its default (explicit or
          implicit) value. For example, if you specify a column list
          that does not name all the columns in the table, unnamed
          columns are set to their default values. Default value
          assignment is described in
          <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>. See also
          <a class="xref" href="introduction.html#constraint-invalid-data" title="1.7.3.3 Constraints on Invalid Data">Section 1.7.3.3, “Constraints on Invalid Data”</a>.
        </p><p>
          If you want an <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement
          to generate an error unless you explicitly specify values for
          all columns that do not have a default value, you should use
          strict mode. See <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>.
        </p></li><li class="listitem"><p>
          Use the keyword <code class="literal">DEFAULT</code> to set a column
          explicitly to its default value. This makes it easier to write
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements that assign
          values to all but a few columns, because it enables you to
          avoid writing an incomplete <code class="literal">VALUES</code> list
          that does not include a value for each column in the table.
          Otherwise, you would have to write out the list of column
          names corresponding to each value in the
          <code class="literal">VALUES</code> list.
        </p><p>
          You can also use
          <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>
          as a more general form that can be used in expressions to
          produce a given column's default value.
        </p></li><li class="listitem"><p>
          If both the column list and the <code class="literal">VALUES</code> list
          are empty, <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> creates a row
          with each column set to its default value:
        </p><pre class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> () VALUES();
</pre><p>
          In strict mode, an error occurs if any column doesn't have a
          default value. Otherwise, MySQL uses the implicit default
          value for any column that does not have an explicitly defined
          default.
        </p></li><li class="listitem"><p>
          You can specify an expression <em class="replaceable"><code>expr</code></em>
          to provide a column value. This might involve type conversion
          if the type of the expression does not match the type of the
          column, and conversion of a given value can result in
          different inserted values depending on the data type. For
          example, inserting the string <code class="literal">'1999.0e-2'</code>
          into an <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a>,
          <a class="link" href="data-types.html#floating-point-types" title="11.2.3 Floating-Point Types (Approximate Value) - FLOAT, DOUBLE"><code class="literal">FLOAT</code></a>,
          <code class="literal">DECIMAL(10,6)</code>, or
          <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR</code></a> column results in the
          values <code class="literal">1999</code>, <code class="literal">19.9921</code>,
          <code class="literal">19.992100</code>, and <code class="literal">1999</code>
          being inserted, respectively. The reason the value stored in
          the <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a> and
          <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR</code></a> columns is
          <code class="literal">1999</code> is that the string-to-integer
          conversion looks only at as much of the initial part of the
          string as may be considered a valid integer or year. For the
          floating-point and fixed-point columns, the
          string-to-floating-point conversion considers the entire
          string a valid floating-point value.
        </p><p>
          An expression <em class="replaceable"><code>expr</code></em> can refer to any
          column that was set earlier in a value list. For example, you
          can do this because the value for <code class="literal">col2</code>
          refers to <code class="literal">col1</code>, which has previously been
          assigned:
        </p><pre class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (col1,col2) VALUES(15,col1*2);
</pre><p>
          But the following is not legal, because the value for
          <code class="literal">col1</code> refers to <code class="literal">col2</code>,
          which is assigned after <code class="literal">col1</code>:
        </p><pre class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (col1,col2) VALUES(col2*2,15);
</pre><p>
          One exception involves columns that contain
          <code class="literal">AUTO_INCREMENT</code> values. Because the
          <code class="literal">AUTO_INCREMENT</code> value is generated after
          other value assignments, any reference to an
          <code class="literal">AUTO_INCREMENT</code> column in the assignment
          returns a <code class="literal">0</code>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements that use
      <code class="literal">VALUES</code> syntax can insert multiple rows. To do
      this, include multiple lists of column values, each enclosed
      within parentheses and separated by commas. Example:
    </p><pre class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (a,b,c) VALUES(1,2,3),(4,5,6),(7,8,9);
</pre><p>
      The values list for each row must be enclosed within parentheses.
      The following statement is illegal because the number of values in
      the list does not match the number of column names:
    </p><pre class="programlisting">
INSERT INTO <em class="replaceable"><code>tbl_name</code></em> (a,b,c) VALUES(1,2,3,4,5,6,7,8,9);
</pre><p>
      <code class="literal">VALUE</code> is a synonym for
      <code class="literal">VALUES</code> in this context. Neither implies
      anything about the number of values lists, and either may be used
      whether there is a single values list or multiple lists.
    </p><p>
      The affected-rows value for an
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> can be obtained using the
      <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function (see
      <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>), or the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> C API
      function (see <a class="xref" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()">Section 23.8.7.1, “mysql_affected_rows()”</a>).
    </p><p>
      If you use an <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT ...
      VALUES</code></a> statement with multiple value lists or
      <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
      SELECT</code></a>, the statement returns an information string in
      this format:
    </p><pre class="programlisting">
Records: 100 Duplicates: 0 Warnings: 0
</pre><p>
      <code class="literal">Records</code> indicates the number of rows processed
      by the statement. (This is not necessarily the number of rows
      actually inserted because <code class="literal">Duplicates</code> can be
      nonzero.) <code class="literal">Duplicates</code> indicates the number of
      rows that could not be inserted because they would duplicate some
      existing unique index value. <code class="literal">Warnings</code> indicates
      the number of attempts to insert column values that were
      problematic in some way. Warnings can occur under any of the
      following conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Inserting <code class="literal">NULL</code> into a column that has been
          declared <code class="literal">NOT NULL</code>. For multiple-row
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements or
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
          SELECT</code></a> statements, the column is set to the implicit
          default value for the column data type. This is
          <code class="literal">0</code> for numeric types, the empty string
          (<code class="literal">''</code>) for string types, and the
          <span class="quote">“<span class="quote">zero</span>”</span> value for date and time types.
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT INTO ...
          SELECT</code></a> statements are handled the same way as
          multiple-row inserts because the server does not examine the
          result set from the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> to
          see whether it returns a single row. (For a single-row
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, no warning occurs when
          <code class="literal">NULL</code> is inserted into a <code class="literal">NOT
          NULL</code> column. Instead, the statement fails with an
          error.)
        </p></li><li class="listitem"><p>
          Setting a numeric column to a value that lies outside the
          column's range. The value is clipped to the closest endpoint
          of the range.
        </p></li><li class="listitem"><p>
          Assigning a value such as <code class="literal">'10.34 a'</code> to a
          numeric column. The trailing nonnumeric text is stripped off
          and the remaining numeric part is inserted. If the string
          value has no leading numeric part, the column is set to
          <code class="literal">0</code>.
        </p></li><li class="listitem"><p>
          Inserting a string into a string column
          (<a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
          <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, or
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>) that exceeds the column's
          maximum length. The value is truncated to the column's maximum
          length.
        </p></li><li class="listitem"><p>
          Inserting a value into a date or time column that is illegal
          for the data type. The column is set to the appropriate zero
          value for the type.
</p></li></ul>
</div>
<a class="indexterm" name="idm139737149417856"></a><p>
      If you are using the C API, the information string can be obtained
      by invoking the <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a>
      function. See <a class="xref" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()">Section 23.8.7.35, “mysql_info()”</a>.
    </p><a class="indexterm" name="idm139737149414384"></a><a class="indexterm" name="idm139737149413312"></a><p>
      If <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> inserts a row into a
      table that has an <code class="literal">AUTO_INCREMENT</code> column, you
      can find the value used for that column by using the SQL
      <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> function. From
      within the C API, use the
      <a class="link" href="connectors-apis.html#mysql-insert-id" title="23.8.7.37 mysql_insert_id()"><code class="literal">mysql_insert_id()</code></a> function.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        These two functions do not always behave identically. The
        behavior of <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements
        with respect to <code class="literal">AUTO_INCREMENT</code> columns is
        discussed further in <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>,
        and <a class="xref" href="connectors-apis.html#mysql-insert-id" title="23.8.7.37 mysql_insert_id()">Section 23.8.7.37, “mysql_insert_id()”</a>.
</p>
</div>
<p>
      The <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you use the <code class="literal">DELAYED</code> keyword, the server
          puts the row or rows to be inserted into a buffer, and the
          client issuing the <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
          DELAYED</code></a> statement can then continue immediately. If
          the table is in use, the server holds the rows. When the table
          is free, the server begins inserting rows, checking
          periodically to see whether there are any new read requests
          for the table. If there are, the delayed row queue is
          suspended until the table becomes free again. See
          <a class="xref" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax">Section 13.2.5.2, “INSERT DELAYED Syntax”</a>.
        </p><a class="indexterm" name="idm139737149397344"></a><p>
          <code class="literal">DELAYED</code> is ignored with
          <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
          SELECT</code></a> or
          <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
          ... ON DUPLICATE KEY UPDATE</code></a>.
        </p><a class="indexterm" name="idm139737149392224"></a><a class="indexterm" name="idm139737149390736"></a><p>
          <code class="literal">DELAYED</code> is also disregarded for an
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> that uses functions
          accessing tables or triggers, or that is called from a
          function or a trigger.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            As of MySQL 5.6.6, <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> is deprecated, and will be removed in a
            future release. Use <code class="literal">INSERT</code> (without
            <code class="literal">DELAYED</code>) instead.
</p>
</div>
</li><li class="listitem"><p>
          If you use the <code class="literal">LOW_PRIORITY</code> keyword,
          execution of the <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> is
          delayed until no other clients are reading from the table.
          This includes other clients that began reading while existing
          clients are reading, and while the <code class="literal">INSERT
          LOW_PRIORITY</code> statement is waiting. It is possible,
          therefore, for a client that issues an <code class="literal">INSERT
          LOW_PRIORITY</code> statement to wait for a very long time
          (or even forever) in a read-heavy environment. (This is in
          contrast to <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>,
          which lets the client continue at once.)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            <code class="literal">LOW_PRIORITY</code> should normally not be used
            with <code class="literal">MyISAM</code> tables because doing so
            disables concurrent inserts. See
            <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.
</p>
</div>
<p>
          If you specify <code class="literal">HIGH_PRIORITY</code>, it overrides
          the effect of the
          <a class="link" href="server-administration.html#option_mysqld_low-priority-updates"><code class="option">--low-priority-updates</code></a> option
          if the server was started with that option. It also causes
          concurrent inserts not to be used. See
          <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.
        </p><p>
          <code class="literal">LOW_PRIORITY</code> and
          <code class="literal">HIGH_PRIORITY</code> affect only storage engines
          that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
        </p></li><li class="listitem"><p>
          If you use the <code class="literal">IGNORE</code> keyword, errors that
          occur while executing the
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement are ignored.
          For example, without <code class="literal">IGNORE</code>, a row that
          duplicates an existing <code class="literal">UNIQUE</code> index or
          <code class="literal">PRIMARY KEY</code> value in the table causes a
          duplicate-key error and the statement is aborted. With
          <code class="literal">IGNORE</code>, the row is discarded and no error
          occurs. Ignored errors may generate warnings instead, although
          duplicate-key errors do not.
        </p><p>
          <a class="indexterm" name="idm139737149361072"></a>

          <code class="literal">IGNORE</code> has a similar effect on inserts into
          partitioned tables where no partition matching a given value
          is found. Without <code class="literal">IGNORE</code>, such
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements are aborted
          with an error; however, when
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT
          IGNORE</code></a> is used, the insert operation fails silently
          for the row containing the unmatched value, but any rows that
          are matched are inserted. For an example, see
          <a class="xref" href="partitioning.html#partitioning-list" title="19.2.2 LIST Partitioning">Section 19.2.2, “LIST Partitioning”</a>.
        </p><p>
          Data conversions that would trigger errors abort the statement
          if <code class="literal">IGNORE</code> is not specified. With
          <code class="literal">IGNORE</code>, invalid values are adjusted to the
          closest values and inserted; warnings are produced but the
          statement does not abort. You can determine with the
          <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a> C API function
          how many rows were actually inserted into the table.
        </p></li><li class="listitem"><p>
          If you specify <code class="literal">ON DUPLICATE KEY UPDATE</code>, and
          a row is inserted that would cause a duplicate value in a
          <code class="literal">UNIQUE</code> index or <code class="literal">PRIMARY
          KEY</code>, an <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> of the
          old row is performed. The affected-rows value per row is 1 if
          the row is inserted as a new row, 2 if an existing row is
          updated, and 0 if an existing row is set to its current
          values. If you specify the
          <code class="literal">CLIENT_FOUND_ROWS</code> flag to
          <a class="link" href="connectors-apis.html#mysql-real-connect" title="23.8.7.53 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> when
          connecting to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, the affected-rows
          value is 1 (not 0) if an existing row is set to its current
          values. See <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.5.3, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a>.
</p></li></ul>
</div>
<p>
      Inserting into a table requires the
      <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the table. If
      the <code class="literal">ON DUPLICATE KEY UPDATE</code> clause is used and
      a duplicate key causes an <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> to
      be performed instead, the statement requires the
      <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for the columns to
      be updated. For columns that are read but not modified you need
      only the <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege (such as
      for a column referenced only on the right hand side of an
      <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>
      assignment in an <code class="literal">ON DUPLICATE KEY UPDATE</code>
      clause).
    </p><p>
      Prior to MySQL 5.6.6, an <code class="literal">INSERT</code> that affected a
      partitioned table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locked all partitions of the table. This was true even for
      <code class="literal">INSERT ... PARTITION</code> statements. (This did not
      and does not occur with storage engines such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level
      locking.) In MySQL 5.6.6 and later, MySQL uses partition lock
      pruning, so that only partitions into which rows are inserted are
      actually locked. For more information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-select"></a>13.2.5.1 INSERT ... SELECT Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737149327632"></a><pre class="programlisting">
INSERT [LOW_PRIORITY | HIGH_PRIORITY] [IGNORE]
    [INTO] <em class="replaceable"><code>tbl_name</code></em> 
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]
    [(<em class="replaceable"><code>col_name</code></em>,...)]
    SELECT ...
    [ ON DUPLICATE KEY UPDATE <em class="replaceable"><code>col_name</code></em>=<em class="replaceable"><code>expr</code></em>, ... ]
</pre><p>
        With <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a>, you can quickly insert many rows into a table
        from one or many tables. For example:
      </p><pre class="programlisting">
INSERT INTO tbl_temp2 (fld_id)
  SELECT tbl_temp1.fld_order_id
  FROM tbl_temp1 WHERE tbl_temp1.fld_order_id &gt; 100;
</pre><p>
        The following conditions hold for a
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Specify <code class="literal">IGNORE</code> to ignore rows that would
            cause duplicate-key violations.
          </p></li><li class="listitem"><p>
            <code class="literal">DELAYED</code> is ignored with
            <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
            SELECT</code></a>.
          </p></li><li class="listitem"><p>
            The target table of the
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement may appear
            in the <code class="literal">FROM</code> clause of the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part of the query.
            (This was not possible in some older versions of MySQL.)
            However, you cannot insert into a table and select from the
            same table in a subquery.
          </p><p>
            When selecting from and inserting into a table at the same
            time, MySQL creates a temporary table to hold the rows from
            the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and then inserts
            those rows into the target table. However, it remains true
            that you cannot use <code class="literal">INSERT INTO t ... SELECT ...
            FROM t</code> when <code class="literal">t</code> is a
            <code class="literal">TEMPORARY</code> table, because
            <code class="literal">TEMPORARY</code> tables cannot be referred to
            twice in the same statement (see
            <a class="xref" href="error-handling.html#temporary-table-problems" title="B.5.7.2 TEMPORARY Table Problems">Section B.5.7.2, “TEMPORARY Table Problems”</a>).
          </p></li><li class="listitem"><p>
            <code class="literal">AUTO_INCREMENT</code> columns work as usual.
          </p></li><li class="listitem"><p>
            To ensure that the binary log can be used to re-create the
            original tables, MySQL does not permit concurrent inserts
            for <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT
            ... SELECT</code></a> statements.
          </p></li><li class="listitem"><p>
            To avoid ambiguous column reference problems when the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and the
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> refer to the same
            table, provide a unique alias for each table used in the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part, and qualify
            column names in that part with the appropriate alias.
</p></li></ul>
</div>
<p>
        Starting with MySQL 5.6.2, you can explicitly select which
        partitions or subpartitions (or both) of the source or target
        table (or both) are to be used with a
        <code class="literal">PARTITION</code> option following the name of the
        table. When <code class="literal">PARTITION</code> is used with the name
        of the source table in the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        portion of the statement, rows are selected only from the
        partitions or subpartitions named in its partition list. When
        <code class="literal">PARTITION</code> is used with the name of the target
        table for the <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> portion of
        the statement, then it must be possible to insert all rows
        selected into the partitions or subpartitions named in the
        partition list following the option, else the <code class="literal">INSERT
        ... SELECT</code> statement fails. For more information and
        examples, see <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>.
      </p><p>
        In the values part of <code class="literal">ON DUPLICATE KEY
        UPDATE</code>, you can refer to columns in other tables, as
        long as you do not use <code class="literal">GROUP BY</code> in the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> part. One side effect is
        that you must qualify nonunique column names in the values part.
      </p><p>
        The order in which rows are returned by a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement with no
        <code class="literal">ORDER BY</code> clause is not determined. This means
        that, when using replication, there is no guarantee that such a
        <code class="literal">SELECT</code> returns rows in the same order on the
        master and the slave; this can lead to inconsistencies between
        them. To prevent this from occurring, you should always write
        <code class="literal">INSERT ... SELECT</code> statements that are to be
        replicated as <code class="literal">INSERT ... SELECT ... ORDER BY
        <em class="replaceable"><code>column</code></em></code>. The choice of
        <em class="replaceable"><code>column</code></em> does not matter as long as the
        same order for returning the rows is enforced on both the master
        and the slave. See also
        <a class="xref" href="replication.html#replication-features-limit" title="17.4.1.16 Replication and LIMIT">Section 17.4.1.16, “Replication and LIMIT”</a>.
      </p><p>
        Due to this issue, beginning with MySQL 5.6.4,
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> and
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT IGNORE ...
        SELECT</code></a> statements are flagged as unsafe for
        statement-based replication. With this change, such statements
        produce a warning in the log when using statement-based mode and
        are logged using the row-based format when using
        <code class="literal">MIXED</code> mode. (Bug #11758262, Bug #50439)
      </p><p>
        See also <a class="xref" href="replication.html#replication-sbr-rbr" title="17.1.2.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.1.2.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        Prior to MySQL 5.6.6, an <code class="literal">INSERT ... SELECT</code>
        statement that acted on partitioned tables using a storage
        engine such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs
        table-level locks locked all partitions of the source and target
        tables. (This did not and does not occur with tables using
        storage engines such as <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that
        employ row-level locking.) In MySQL 5.6.6 and later, only those
        partitions of the source table that are actually read are
        locked, although all partitions of the target table are locked.
        See <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>, for more
        information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-delayed"></a>13.2.5.2 INSERT DELAYED Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149264912"></a><a class="indexterm" name="idm139737149263840"></a><a class="indexterm" name="idm139737149262768"></a><pre class="programlisting">
INSERT DELAYED ...
</pre><p>
        The <code class="literal">DELAYED</code> option for the
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement is a MySQL
        extension to standard SQL that can be used for certain kinds of
        tables (such as <code class="literal">MyISAM</code>). When a client uses
        <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>, it gets an okay
        from the server at once, and the row is queued to be inserted
        when the table is not in use by any other thread.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> is slower than a
          normal <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> if the table is
          not otherwise in use. There is also the additional overhead
          for the server to handle a separate thread for each table for
          which there are delayed rows. This means that you should use
          <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> only when you
          are really sure that you need it.
        </p><p>
          As of MySQL 5.6.6, <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
          DELAYED</code></a> is deprecated, and will be removed in a
          future release. Use <code class="literal">INSERT</code> (without
          <code class="literal">DELAYED</code>) instead.
</p>
</div>
<p>
        The queued rows are held only in memory until they are inserted
        into the table. This means that if you terminate
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> forcibly (for example, with
        <code class="literal">kill -9</code>) or if <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> dies
        unexpectedly, <span class="emphasis"><em>any queued rows that have not been
        written to disk are lost</em></span>.
      </p><p>
        There are some constraints on the use of
        <code class="literal">DELAYED</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> works only
            with <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
            <code class="literal">ARCHIVE</code>, and <code class="literal">BLACKHOLE</code>
            tables. For engines that do not support
            <code class="literal">DELAYED</code>, an error occurs.
          </p></li><li class="listitem"><p>
            An error occurs for <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> if used with a table that has been locked
            with <code class="literal">LOCK TABLES</code> because the insert must
            be handled by a separate thread, not by the session that
            holds the lock.
          </p></li><li class="listitem"><p>
            For <code class="literal">MyISAM</code> tables, if there are no free
            blocks in the middle of the data file, concurrent
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements are
            supported. Under these circumstances, you very seldom need
            to use <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> with
            <code class="literal">MyISAM</code>.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> should be used
            only for <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements
            that specify value lists. The server ignores
            <code class="literal">DELAYED</code> for
            <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
            SELECT</code></a> or
            <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
            ... ON DUPLICATE KEY UPDATE</code></a> statements.
          </p></li><li class="listitem"><p>
            Because the <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>
            statement returns immediately, before the rows are inserted,
            you cannot use
            <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> to get the
            <code class="literal">AUTO_INCREMENT</code> value that the statement
            might generate.
          </p></li><li class="listitem"><p>
            <code class="literal">DELAYED</code> rows are not visible to
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements until they
            actually have been inserted.
          </p></li><li class="listitem"><p>
            Prior to MySQL 5.6, <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> was treated as a normal
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> if the statement
            inserted multiple rows, binary logging was enabled, and the
            global logging format was statement-based (that is, whenever
            <a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> was set to
            <code class="literal">STATEMENT</code>). Beginning with MySQL
            5.6, <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> is always handled as a simple
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> (that is, without the
            <code class="literal">DELAYED</code> option) whenever the value of
            <a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> is
            <code class="literal">STATEMENT</code> or <code class="literal">MIXED</code>.
            (In the latter case, the statement no longer triggers a
            switch to row-based logging, and so is logged using the
            statement-based format.)
          </p><p>
            This does not apply when using row-based binary logging mode
            (<a class="link" href="replication.html#sysvar_binlog_format"><code class="literal">binlog_format</code></a> set to
            <code class="literal">ROW</code>), in which
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> statements are
            always executed using the <code class="literal">DELAYED</code> option
            as specified, and logged as row-update events.
          </p></li><li class="listitem"><p>
            <code class="literal">DELAYED</code> is ignored on slave replication
            servers, so that <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> is treated as a normal
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> on slaves. This is
            because <code class="literal">DELAYED</code> could cause the slave to
            have different data than the master.
          </p></li><li class="listitem"><p>
            Pending <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>
            statements are lost if a table is write locked and
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> is used to modify
            the table structure.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> is not
            supported for views.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> is not
            supported for partitioned tables.
</p></li></ul>
</div>
<p>
        The following describes in detail what happens when you use the
        <code class="literal">DELAYED</code> option to
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> or
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>. In this description, the
        <span class="quote">“<span class="quote">thread</span>”</span> is the thread that received an
        <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> statement and
        <span class="quote">“<span class="quote">handler</span>”</span> is the thread that handles all
        <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> statements for a
        particular table.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            When a thread executes a <code class="literal">DELAYED</code>
            statement for a table, a handler thread is created to
            process all <code class="literal">DELAYED</code> statements for the
            table, if no such handler already exists.
          </p></li><li class="listitem"><p>
            The thread checks whether the handler has previously
            acquired a <code class="literal">DELAYED</code> lock; if not, it tells
            the handler thread to do so. The <code class="literal">DELAYED</code>
            lock can be obtained even if other threads have a
            <code class="literal">READ</code> or <code class="literal">WRITE</code> lock on
            the table. However, the handler waits for all
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> locks or
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> statements to finish, to ensure that the
            table structure is up to date.
          </p></li><li class="listitem"><p>
            The thread executes the
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement, but instead
            of writing the row to the table, it puts a copy of the final
            row into a queue that is managed by the handler thread. Any
            syntax errors are noticed by the thread and reported to the
            client program.
          </p></li><li class="listitem"><p>
            The client cannot obtain from the server the number of
            duplicate rows or the <code class="literal">AUTO_INCREMENT</code>
            value for the resulting row, because the
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> returns before the
            insert operation has been completed. (If you use the C API,
            the <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a> function
            does not return anything meaningful, for the same reason.)
          </p></li><li class="listitem"><p>
            The binary log is updated by the handler thread when the row
            is inserted into the table. In case of multiple-row inserts,
            the binary log is updated when the first row is inserted.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737149158576"></a>

            Each time that
            <a class="link" href="server-administration.html#sysvar_delayed_insert_limit"><code class="literal">delayed_insert_limit</code></a> rows
            are written, the handler checks whether any
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements are still
            pending. If so, it permits these to execute before
            continuing.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737149154016"></a>

            When the handler has no more rows in its queue, the table is
            unlocked. If no new <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> statements are received within
            <a class="link" href="server-administration.html#sysvar_delayed_insert_timeout"><code class="literal">delayed_insert_timeout</code></a>
            seconds, the handler terminates.
          </p></li><li class="listitem"><p>
            If more than
            <a class="link" href="server-administration.html#sysvar_delayed_queue_size"><code class="literal">delayed_queue_size</code></a> rows are
            pending in a specific handler queue, the thread requesting
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> waits until
            there is room in the queue. This is done to ensure that
            <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> does not use all memory for the
            delayed memory queue.
          </p></li><li class="listitem"><p>
            The handler thread shows up in the MySQL process list with
            <code class="literal">delayed_insert</code> in the
            <code class="literal">Command</code> column. It is killed if you
            execute a <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> statement or kill it with <code class="literal">KILL
            <em class="replaceable"><code>thread_id</code></em></code>. However,
            before exiting, it first stores all queued rows into the
            table. During this time it does not accept any new
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements from other
            threads. If you execute an <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> statement after this, a new handler thread
            is created.
          </p><p>
            This means that <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
            DELAYED</code></a> statements have higher priority than
            normal <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements if
            there is an <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>
            handler running. Other update statements have to wait until
            the <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> queue is
            empty, someone terminates the handler thread (with
            <code class="literal">KILL
            <em class="replaceable"><code>thread_id</code></em></code>), or someone
            executes a <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a>.
          </p></li><li class="listitem"><p>
            The following status variables provide information about
            <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> statements.
</p>
<div class="informaltable">
<table summary="This table lists status variables for
              INSERT DELAYED statements
              and describes the meaning of each." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Status Variable</th><th scope="col">Meaning</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="server-administration.html#statvar_Delayed_insert_threads"><code class="literal">Delayed_insert_threads</code></a></td><td>Number of handler threads</td></tr><tr><td scope="row"><a class="link" href="server-administration.html#statvar_Delayed_writes"><code class="literal">Delayed_writes</code></a></td><td>Number of rows written with <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT
DELAYED</code></a></td></tr><tr><td scope="row"><a class="link" href="server-administration.html#statvar_Not_flushed_delayed_rows"><code class="literal">Not_flushed_delayed_rows</code></a></td><td>Number of rows waiting to be written</td></tr></tbody></table>
</div>
<p>
            You can view these variables by issuing a
            <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> statement or by
            executing a <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin extended-status</strong></span></a>
            command.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="insert-on-duplicate"></a>13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax</h4>

</div>

</div>

</div>
<p>
        If you specify <code class="literal">ON DUPLICATE KEY UPDATE</code>, and a
        row is inserted that would cause a duplicate value in a
        <code class="literal">UNIQUE</code> index or <code class="literal">PRIMARY
        KEY</code>, MySQL performs an
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> of the old row. For
        example, if column <code class="literal">a</code> is declared as
        <code class="literal">UNIQUE</code> and contains the value
        <code class="literal">1</code>, the following two statements have similar
        effect:
      </p><pre class="programlisting">
INSERT INTO table (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=c+1;

UPDATE table SET c=c+1 WHERE a=1;
</pre><p>
        (The effects are not identical for an <code class="literal">InnoDB</code>
        table where <code class="literal">a</code> is an auto-increment column.
        With an auto-increment column, an <code class="literal">INSERT</code>
        statement increases the auto-increment value but
        <code class="literal">UPDATE</code> does not.)
      </p><p>
        The <code class="literal">ON DUPLICATE KEY UPDATE</code> clause can
        contain multiple column assignments, separated by commas.
      </p><p>
        With <code class="literal">ON DUPLICATE KEY UPDATE</code>, the
        affected-rows value per row is 1 if the row is inserted as a new
        row, 2 if an existing row is updated, and 0 if an existing row
        is set to its current values. If you specify the
        <code class="literal">CLIENT_FOUND_ROWS</code> flag to
        <a class="link" href="connectors-apis.html#mysql-real-connect" title="23.8.7.53 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a> when
        connecting to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>, the affected-rows value
        is 1 (not 0) if an existing row is set to its current values.
      </p><p>
        If column <code class="literal">b</code> is also unique, the
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> is equivalent to this
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement instead:
      </p><pre class="programlisting">
UPDATE table SET c=c+1 WHERE a=1 OR b=2 LIMIT 1;
</pre><p>
        If <code class="literal">a=1 OR b=2</code> matches several rows, only
        <span class="emphasis"><em>one</em></span> row is updated. In general, you should
        try to avoid using an <code class="literal">ON DUPLICATE KEY UPDATE</code>
        clause on tables with multiple unique indexes.
      </p><p>
        You can use the
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code></a>
        function in the <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> clause to
        refer to column values from the
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> portion of the
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        ON DUPLICATE KEY UPDATE</code></a> statement. In other words,
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES(<em class="replaceable"><code>col_name</code></em>)</code></a>
        in the <code class="literal">ON DUPLICATE KEY UPDATE</code> clause refers
        to the value of <em class="replaceable"><code>col_name</code></em> that would
        be inserted, had no duplicate-key conflict occurred. This
        function is especially useful in multiple-row inserts. The
        <a class="link" href="functions.html#function_values"><code class="literal">VALUES()</code></a> function is meaningful
        only in <code class="literal">INSERT ... UPDATE</code> statements and
        returns <code class="literal">NULL</code> otherwise. Example:
      </p><pre class="programlisting">
INSERT INTO table (a,b,c) VALUES (1,2,3),(4,5,6)
  ON DUPLICATE KEY UPDATE c=VALUES(a)+VALUES(b);
</pre><p>
        That statement is identical to the following two statements:
      </p><pre class="programlisting">
INSERT INTO table (a,b,c) VALUES (1,2,3)
  ON DUPLICATE KEY UPDATE c=3;
INSERT INTO table (a,b,c) VALUES (4,5,6)
  ON DUPLICATE KEY UPDATE c=9;
</pre><p>
        If a table contains an <code class="literal">AUTO_INCREMENT</code> column
        and <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT
        ... ON DUPLICATE KEY UPDATE</code></a> inserts or updates a row,
        the <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> function
        returns the <code class="literal">AUTO_INCREMENT</code> value.
      </p><p>
        The <code class="literal">DELAYED</code> option is ignored when you use
        <code class="literal">ON DUPLICATE KEY UPDATE</code>.
      </p><p>
        Because the results of
        <a class="link" href="sql-syntax.html#insert-select" title="13.2.5.1 INSERT ... SELECT Syntax"><code class="literal">INSERT ...
        SELECT</code></a> statements depend on the ordering of rows from
        the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and this order cannot
        always be guaranteed, it is possible when logging
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> statements for the
        master and the slave to diverge. Thus, in MySQL 5.6.4 and later,
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        SELECT ON DUPLICATE KEY UPDATE</code></a> statements are flagged
        as unsafe for statement-based replication. With this change,
        such statements produce a warning in the log when using
        statement-based mode and are logged using the row-based format
        when using <code class="literal">MIXED</code> mode. In addition, beginning
        with MySQL 5.6.6, an
        <a class="link" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax"><code class="literal">INSERT ...
        ON DUPLICATE KEY UPDATE</code></a> statement against a table
        having more than one unique or primary key is also marked as
        unsafe. (Bug #11765650, Bug #58637) See also
        <a class="xref" href="replication.html#replication-sbr-rbr" title="17.1.2.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.1.2.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
      </p><p>
        Prior to MySQL 5.6.6, an <code class="literal">INSERT ... ON DUPLICATE KEY
        UPDATE</code> on a partitioned table using a storage engine
        such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs
        table-level locks locked all partitions of the table. (This did
        not and does not occur with tables using storage engines such as
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level
        locking.) In MySQL 5.6.6 and later, such statements lock only
        those partitions in which a partitioning key column is updated.
        See <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>, for more
        information.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="load-data"></a>13.2.6 LOAD DATA INFILE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737149052272"></a><a class="indexterm" name="idm139737149051200"></a><pre class="programlisting">
LOAD DATA [LOW_PRIORITY | CONCURRENT] [LOCAL] INFILE '<em class="replaceable"><code>file_name</code></em>'
    [REPLACE | IGNORE]
    INTO TABLE <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]
    [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
    [{FIELDS | COLUMNS}
        [TERMINATED BY '<em class="replaceable"><code>string</code></em>']
        [[OPTIONALLY] ENCLOSED BY '<em class="replaceable"><code>char</code></em>']
        [ESCAPED BY '<em class="replaceable"><code>char</code></em>']
    ]
    [LINES
        [STARTING BY '<em class="replaceable"><code>string</code></em>']
        [TERMINATED BY '<em class="replaceable"><code>string</code></em>']
    ]
    [IGNORE <em class="replaceable"><code>number</code></em> {LINES | ROWS}]
    [(<em class="replaceable"><code>col_name_or_user_var</code></em>,...)]
    [SET <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>expr</code></em>,...]
</pre><p>
      The <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> statement reads rows from a text file into a
      table at a very high speed.
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> is the complement of
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a>. (See <a class="xref" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax">Section 13.2.9.1, “SELECT ... INTO Syntax”</a>.) To write
      data from a table to a file, use
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a>. To read the file back into a table, use
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>. The syntax of the <code class="literal">FIELDS</code> and
      <code class="literal">LINES</code> clauses is the same for both statements.
      Both clauses are optional, but <code class="literal">FIELDS</code> must
      precede <code class="literal">LINES</code> if both are specified.
    </p><a class="indexterm" name="idm139737149029920"></a><p>
      You can also load data files by using the
      <a class="link" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program"><span class="command"><strong>mysqlimport</strong></span></a> utility; it operates by sending a
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> statement to the server. The
      <a class="link" href="programs.html#option_mysqlimport_local"><code class="option">--local</code></a> option causes
      <a class="link" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program"><span class="command"><strong>mysqlimport</strong></span></a> to read data files from the client
      host. You can specify the
      <a class="link" href="programs.html#option_mysqlimport_compress"><code class="option">--compress</code></a> option to get
      better performance over slow networks if the client and server
      support the compressed protocol. See
      <a class="xref" href="programs.html#mysqlimport" title="4.5.5 mysqlimport — A Data Import Program">Section 4.5.5, “<span class="command"><strong>mysqlimport</strong></span> — A Data Import Program”</a>.
    </p><p>
      For more information about the efficiency of
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> versus
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> and speeding up
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>, see <a class="xref" href="optimization.html#insert-speed" title="8.2.2.1 Speed of INSERT Statements">Section 8.2.2.1, “Speed of INSERT Statements”</a>.
    </p><p>
      The file name must be given as a literal string. On Windows,
      specify backslashes in path names as forward slashes or doubled
      backslashes. The
      <a class="link" href="server-administration.html#sysvar_character_set_filesystem"><code class="literal">character_set_filesystem</code></a> system
      variable controls the interpretation of the file name.
    </p><p>
      In MySQL 5.6.2 and later, <code class="literal">LOAD DATA</code> supports
      explicit partition selection using the
      <code class="literal">PARTITION</code> option with a comma-separated list of
      more or more names of partitions, subpartitions, or both. When
      this option is used, if any rows from the file cannot be inserted
      into any of the partitions or subpartitions named in the list, the
      statement fails with the error <span class="errortext">Found a row not matching
      the given partition set</span>. For more information, see
      <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>.
    </p><p>
      For partitioned tables using storage engines that employ table
      locks, such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, <code class="literal">LOAD
      DATA</code> cannot prune any partition locks. This does not
      apply to tables using storage engines which employ row-level
      locking, such as <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>. For more
      information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
    </p><p>
      The server uses the character set indicated by the
      <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a> system
      variable to interpret the information in the file. <code class="literal">SET
      NAMES</code> and the setting of
      <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> do not
      affect interpretation of input. If the contents of the input file
      use a character set that differs from the default, it is usually
      preferable to specify the character set of the file by using the
      <code class="literal">CHARACTER SET</code> clause. A character set of
      <code class="literal">binary</code> specifies <span class="quote">“<span class="quote">no conversion.</span>”</span>
    </p><p>
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> interprets all fields in the file as having the
      same character set, regardless of the data types of the columns
      into which field values are loaded. For proper interpretation of
      file contents, you must ensure that it was written with the
      correct character set. For example, if you write a data file with
      <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump -T</strong></span></a> or by issuing a
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a> statement in <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a>, be sure
      to use a <code class="option">--default-character-set</code> option so that
      output is written in the character set to be used when the file is
      loaded with <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        It is not possible to load data files that use the
        <code class="literal">ucs2</code>, <code class="literal">utf16</code>,
        <code class="literal">utf16le</code>, or <code class="literal">utf32</code>
        character set.
</p>
</div>
<p>
      If you use <code class="literal">LOW_PRIORITY</code>, execution of the
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> statement is delayed
      until no other clients are reading from the table. This affects
      only storage engines that use only table-level locking (such as
      <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
      <code class="literal">MERGE</code>).
    </p><p>
      If you specify <code class="literal">CONCURRENT</code> with a
      <code class="literal">MyISAM</code> table that satisfies the condition for
      concurrent inserts (that is, it contains no free blocks in the
      middle), other threads can retrieve data from the table while
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> is executing. This option
      affects the performance of <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD
      DATA</code></a> a bit, even if no other thread is using the table
      at the same time.
    </p><p>
      With row-based replication, <code class="literal">CONCURRENT</code> is
      replicated regardless of MySQL version. With statement-based
      replication <code class="literal">CONCURRENT</code> is not replicated prior
      to MySQL 5.5.1 (see Bug #34628). For more information, see
      <a class="xref" href="replication.html#replication-features-load-data" title="17.4.1.17 Replication and LOAD DATA INFILE">Section 17.4.1.17, “Replication and LOAD DATA INFILE”</a>.
    </p><p>
      The <code class="literal">LOCAL</code> keyword affects expected location of
      the file and error handling, as described later.
      <code class="literal">LOCAL</code> works only if your server and your client
      both have been configured to permit it. For example, if
      <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> was started with
      <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">--local-infile=0</code></a>,
      <code class="literal">LOCAL</code> does not work. See
      <a class="xref" href="security.html#load-data-local" title="6.1.6 Security Issues with LOAD DATA LOCAL">Section 6.1.6, “Security Issues with LOAD DATA LOCAL”</a>.
    </p><p>
      The <code class="literal">LOCAL</code> keyword affects where the file is
      expected to be found:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If <code class="literal">LOCAL</code> is specified, the file is read by
          the client program on the client host and sent to the server.
          The file can be given as a full path name to specify its exact
          location. If given as a relative path name, the name is
          interpreted relative to the directory in which the client
          program was started.
        </p><p>
          When using <code class="literal">LOCAL</code> with
          <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a>, a copy of the file
          is created in the server's temporary directory. This is
          <span class="emphasis"><em>not</em></span> the directory determined by the value
          of <a class="link" href="server-administration.html#sysvar_tmpdir"><code class="literal">tmpdir</code></a> or
          <a class="link" href="replication.html#sysvar_slave_load_tmpdir"><code class="literal">slave_load_tmpdir</code></a>, but rather
          the operating system's temporary directory, and is not
          configurable in the MySQL Server. (Typically the system
          temporary directory is <code class="filename">/tmp</code> on Linux
          systems and <code class="filename">C:\WINDOWS\TEMP</code> on Windows.)
          Lack of sufficient space for the copy in this directory can
          cause the <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          LOCAL</code></a> statement to fail.
        </p></li><li class="listitem"><p>
          If <code class="literal">LOCAL</code> is not specified, the file must be
          located on the server host and is read directly by the server.
          The server uses the following rules to locate the file:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              If the file name is an absolute path name, the server uses
              it as given.
            </p></li><li class="listitem"><p>
              If the file name is a relative path name with one or more
              leading components, the server searches for the file
              relative to the server's data directory.
            </p></li><li class="listitem"><p>
              If a file name with no leading components is given, the
              server looks for the file in the database directory of the
              default database.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
      In the non-<code class="literal">LOCAL</code> case, these rules mean that a
      file named as <code class="filename">./myfile.txt</code> is read from the
      server's data directory, whereas the file named as
      <code class="filename">myfile.txt</code> is read from the database
      directory of the default database. For example, if
      <code class="literal">db1</code> is the default database, the following
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> statement reads the file
      <code class="filename">data.txt</code> from the database directory for
      <code class="literal">db1</code>, even though the statement explicitly loads
      the file into a table in the <code class="literal">db2</code> database:
    </p><pre class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE db2.my_table;
</pre><p>
      For security reasons, when reading text files located on the
      server, the files must either reside in the database directory or
      be readable by the user account used to run the server. Also, to
      use <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> on server files, you must have the
      <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege. See
      <a class="xref" href="security.html#privileges-provided" title="6.2.1 Privileges Provided by MySQL">Section 6.2.1, “Privileges Provided by MySQL”</a>. For
      non-<code class="literal">LOCAL</code> load operations, if the
      <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a> system variable
      is set to a nonempty directory name, the file to be loaded must be
      located in that directory.
    </p><p>
      Using <code class="literal">LOCAL</code> is a bit slower than letting the
      server access the files directly, because the contents of the file
      must be sent over the connection by the client to the server. On
      the other hand, you do not need the
      <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to load local files.
    </p><p>
      <code class="literal">LOCAL</code> also affects error handling:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          With <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          INFILE</code></a>, data-interpretation and duplicate-key errors
          terminate the operation.
        </p></li><li class="listitem"><p>
          With <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          LOCAL INFILE</code></a>, data-interpretation and duplicate-key
          errors become warnings and the operation continues because the
          server has no way to stop transmission of the file in the
          middle of the operation. For duplicate-key errors, this is the
          same as if <code class="literal">IGNORE</code> is specified.
          <code class="literal">IGNORE</code> is explained further later in this
          section.
</p></li></ul>
</div>
<p>
      The <code class="literal">REPLACE</code> and <code class="literal">IGNORE</code>
      keywords control handling of input rows that duplicate existing
      rows on unique key values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you specify <code class="literal">REPLACE</code>, input rows replace
          existing rows. In other words, rows that have the same value
          for a primary key or unique index as an existing row. See
          <a class="xref" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax">Section 13.2.8, “REPLACE Syntax”</a>.
        </p></li><li class="listitem"><p>
          If you specify <code class="literal">IGNORE</code>, rows that duplicate
          an existing row on a unique key value are discarded.
        </p></li><li class="listitem"><p>
          If you do not specify either option, the behavior depends on
          whether the <code class="literal">LOCAL</code> keyword is specified.
          Without <code class="literal">LOCAL</code>, an error occurs when a
          duplicate key value is found, and the rest of the text file is
          ignored. With <code class="literal">LOCAL</code>, the default behavior
          is the same as if <code class="literal">IGNORE</code> is specified; this
          is because the server has no way to stop transmission of the
          file in the middle of the operation.
</p></li></ul>
</div>
<p>
      To ignore foreign key constraints during the load operation, issue
      a <code class="literal">SET foreign_key_checks = 0</code> statement before
      executing <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a>.
    </p><p>
      If you use <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> on an empty <code class="literal">MyISAM</code> table, all
      nonunique indexes are created in a separate batch (as for
      <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>). Normally, this makes
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> much faster when you have many indexes. In some
      extreme cases, you can create the indexes even faster by turning
      them off with <code class="literal">ALTER TABLE ... DISABLE KEYS</code>
      before loading the file into the table and using <code class="literal">ALTER
      TABLE ... ENABLE KEYS</code> to re-create the indexes after
      loading the file. See <a class="xref" href="optimization.html#insert-speed" title="8.2.2.1 Speed of INSERT Statements">Section 8.2.2.1, “Speed of INSERT Statements”</a>.
    </p><p>
      For both the <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> and
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a> statements, the syntax of the
      <code class="literal">FIELDS</code> and <code class="literal">LINES</code> clauses is
      the same. Both clauses are optional, but <code class="literal">FIELDS</code>
      must precede <code class="literal">LINES</code> if both are specified.
    </p><p>
      If you specify a <code class="literal">FIELDS</code> clause, each of its
      subclauses (<code class="literal">TERMINATED BY</code>,
      <code class="literal">[OPTIONALLY] ENCLOSED BY</code>, and <code class="literal">ESCAPED
      BY</code>) is also optional, except that you must specify at
      least one of them.
    </p><p>
      If you specify no <code class="literal">FIELDS</code> or
      <code class="literal">LINES</code> clause, the defaults are the same as if
      you had written this:
    </p><pre class="programlisting">
FIELDS TERMINATED BY '\t' ENCLOSED BY '' ESCAPED BY '\\'
LINES TERMINATED BY '\n' STARTING BY ''
</pre><p>
      (Backslash is the MySQL escape character within strings in SQL
      statements, so to specify a literal backslash, you must specify
      two backslashes for the value to be interpreted as a single
      backslash. The escape sequences <code class="literal">'\t'</code> and
      <code class="literal">'\n'</code> specify tab and newline characters,
      respectively.)
    </p><p>
      In other words, the defaults cause
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> to act as follows when reading input:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Look for line boundaries at newlines.
        </p></li><li class="listitem"><p>
          Do not skip over any line prefix.
        </p></li><li class="listitem"><p>
          Break lines into fields at tabs.
        </p></li><li class="listitem"><p>
          Do not expect fields to be enclosed within any quoting
          characters.
        </p></li><li class="listitem"><p>
          Interpret characters preceded by the escape character
          <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span> as escape sequences. For
          example, <span class="quote">“<span class="quote"><code class="literal">\t</code></span>”</span>,
          <span class="quote">“<span class="quote"><code class="literal">\n</code></span>”</span>, and
          <span class="quote">“<span class="quote"><code class="literal">\\</code></span>”</span> signify tab, newline, and
          backslash, respectively. See the discussion of <code class="literal">FIELDS
          ESCAPED BY</code> later for the full list of escape
          sequences.
</p></li></ul>
</div>
<p>
      Conversely, the defaults cause
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a> to act as follows when writing output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Write tabs between fields.
        </p></li><li class="listitem"><p>
          Do not enclose fields within any quoting characters.
        </p></li><li class="listitem"><p>
          Use <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span> to escape instances of
          tab, newline, or <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span> that
          occur within field values.
        </p></li><li class="listitem"><p>
          Write newlines at the ends of lines.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
        If you have generated the text file on a Windows system, you
        might have to use <code class="literal">LINES TERMINATED BY '\r\n'</code>
        to read the file properly, because Windows programs typically
        use two characters as a line terminator. Some programs, such as
        <span class="command"><strong>WordPad</strong></span>, might use <code class="literal">\r</code> as a
        line terminator when writing files. To read such files, use
        <code class="literal">LINES TERMINATED BY '\r'</code>.
</p>
</div>
<p>
      If all the lines you want to read in have a common prefix that you
      want to ignore, you can use <code class="literal">LINES STARTING BY
      '<em class="replaceable"><code>prefix_string</code></em>'</code> to skip over
      the prefix, <span class="emphasis"><em>and anything before it</em></span>. If a line
      does not include the prefix, the entire line is skipped. Suppose
      that you issue the following statement:
    </p><pre class="programlisting">
LOAD DATA INFILE '/tmp/test.txt' INTO TABLE test
  FIELDS TERMINATED BY ','  LINES STARTING BY 'xxx';
</pre><p>
      If the data file looks like this:
    </p><pre class="programlisting">
xxx"abc",1
something xxx"def",2
"ghi",3
</pre><p>
      The resulting rows will be <code class="literal">("abc",1)</code> and
      <code class="literal">("def",2)</code>. The third row in the file is skipped
      because it does not contain the prefix.
    </p><p>
      The <code class="literal">IGNORE <em class="replaceable"><code>number</code></em>
      LINES</code> option can be used to ignore lines at the start of
      the file. For example, you can use <code class="literal">IGNORE 1
      LINES</code> to skip over an initial header line containing
      column names:
    </p><pre class="programlisting">
LOAD DATA INFILE '/tmp/test.txt' INTO TABLE test IGNORE 1 LINES;
</pre><p>
      When you use <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT
      ... INTO OUTFILE</code></a> in tandem with
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> to write data from a database into a file and
      then read the file back into the database later, the field- and
      line-handling options for both statements must match. Otherwise,
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> will not interpret the contents of the file
      properly. Suppose that you use
      <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a> to write a file with fields delimited by commas:
    </p><pre class="programlisting">
SELECT * INTO OUTFILE 'data.txt'
  FIELDS TERMINATED BY ','
  FROM table2;
</pre><p>
      To read the comma-delimited file back in, the correct statement
      would be:
    </p><pre class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE table2
  FIELDS TERMINATED BY ',';
</pre><p>
      If instead you tried to read in the file with the statement shown
      following, it wouldn't work because it instructs
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> to look for tabs between fields:
    </p><pre class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE table2
  FIELDS TERMINATED BY '\t';
</pre><p>
      The likely result is that each input line would be interpreted as
      a single field.
    </p><a class="indexterm" name="idm139737148855456"></a><a class="indexterm" name="idm139737148854384"></a><p>
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> can be used to read files obtained from external
      sources. For example, many programs can export data in
      comma-separated values (CSV) format, such that lines have fields
      separated by commas and enclosed within double quotation marks,
      with an initial line of column names. If the lines in such a file
      are terminated by carriage return/newline pairs, the statement
      shown here illustrates the field- and line-handling options you
      would use to load the file:
    </p><pre class="programlisting">
LOAD DATA INFILE 'data.txt' INTO TABLE <em class="replaceable"><code>tbl_name</code></em>
  FIELDS TERMINATED BY ',' ENCLOSED BY '"'
  LINES TERMINATED BY '\r\n'
  IGNORE 1 LINES;
</pre><p>
      If the input values are not necessarily enclosed within quotation
      marks, use <code class="literal">OPTIONALLY</code> before the
      <code class="literal">ENCLOSED BY</code> keywords.
    </p><p>
      Any of the field- or line-handling options can specify an empty
      string (<code class="literal">''</code>). If not empty, the <code class="literal">FIELDS
      [OPTIONALLY] ENCLOSED BY</code> and <code class="literal">FIELDS ESCAPED
      BY</code> values must be a single character. The
      <code class="literal">FIELDS TERMINATED BY</code>, <code class="literal">LINES STARTING
      BY</code>, and <code class="literal">LINES TERMINATED BY</code> values
      can be more than one character. For example, to write lines that
      are terminated by carriage return/linefeed pairs, or to read a
      file containing such lines, specify a <code class="literal">LINES TERMINATED BY
      '\r\n'</code> clause.
    </p><p>
      To read a file containing jokes that are separated by lines
      consisting of <code class="literal">%%</code>, you can do this
    </p><pre class="programlisting">
CREATE TABLE jokes
  (a INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  joke TEXT NOT NULL);
LOAD DATA INFILE '/tmp/jokes.txt' INTO TABLE jokes
  FIELDS TERMINATED BY ''
  LINES TERMINATED BY '\n%%\n' (joke);
</pre><p>
      <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code> controls
      quoting of fields. For output
      (<a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
      OUTFILE</code></a>), if you omit the word
      <code class="literal">OPTIONALLY</code>, all fields are enclosed by the
      <code class="literal">ENCLOSED BY</code> character. An example of such
      output (using a comma as the field delimiter) is shown here:
    </p><pre class="programlisting">
"1","a string","100.20"
"2","a string containing a , comma","102.20"
"3","a string containing a \" quote","102.20"
"4","a string containing a \", quote and comma","102.20"
</pre><p>
      If you specify <code class="literal">OPTIONALLY</code>, the
      <code class="literal">ENCLOSED BY</code> character is used only to enclose
      values from columns that have a string data type (such as
      <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>,
      <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">BINARY</code></a>,
      <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a>, or
      <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a>):
    </p><pre class="programlisting">
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a \" quote",102.20
4,"a string containing a \", quote and comma",102.20
</pre><p>
      Occurrences of the <code class="literal">ENCLOSED BY</code> character within
      a field value are escaped by prefixing them with the
      <code class="literal">ESCAPED BY</code> character. Also, if you specify an
      empty <code class="literal">ESCAPED BY</code> value, it is possible to
      inadvertently generate output that cannot be read properly by
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>. For example, the preceding output just shown
      would appear as follows if the escape character is empty. Observe
      that the second field in the fourth line contains a comma
      following the quote, which (erroneously) appears to terminate the
      field:
    </p><pre class="programlisting">
1,"a string",100.20
2,"a string containing a , comma",102.20
3,"a string containing a " quote",102.20
4,"a string containing a ", quote and comma",102.20
</pre><p>
      For input, the <code class="literal">ENCLOSED BY</code> character, if
      present, is stripped from the ends of field values. (This is true
      regardless of whether <code class="literal">OPTIONALLY</code> is specified;
      <code class="literal">OPTIONALLY</code> has no effect on input
      interpretation.) Occurrences of the <code class="literal">ENCLOSED BY</code>
      character preceded by the <code class="literal">ESCAPED BY</code> character
      are interpreted as part of the current field value.
    </p><p>
      If the field begins with the <code class="literal">ENCLOSED BY</code>
      character, instances of that character are recognized as
      terminating a field value only if followed by the field or line
      <code class="literal">TERMINATED BY</code> sequence. To avoid ambiguity,
      occurrences of the <code class="literal">ENCLOSED BY</code> character within
      a field value can be doubled and are interpreted as a single
      instance of the character. For example, if <code class="literal">ENCLOSED BY
      '"'</code> is specified, quotation marks are handled as shown
      here:
    </p><pre class="programlisting">
"The ""BIG"" boss"  -&gt; The "BIG" boss
The "BIG" boss      -&gt; The "BIG" boss
The ""BIG"" boss    -&gt; The ""BIG"" boss
</pre><p>
      <code class="literal">FIELDS ESCAPED BY</code> controls how to read or write
      special characters:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For input, if the <code class="literal">FIELDS ESCAPED BY</code>
          character is not empty, occurrences of that character are
          stripped and the following character is taken literally as
          part of a field value. Some two-character sequences that are
          exceptions, where the first character is the escape character.
          These sequences are shown in the following table (using
          <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span> for the escape character).
          The rules for <code class="literal">NULL</code> handling are described
          later in this section.
</p>
<div class="informaltable">
<table summary="This table lists two-character sequences for which
            the first character (a \)
            is the escape character." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Character</th><th scope="col">Escape Sequence</th></tr></thead><tbody><tr><td scope="row"><code class="literal">\0</code>

                  <a class="indexterm" name="idm139737148802832"></a>

                  <a class="indexterm" name="idm139737148801760"></a></td><td>An ASCII NUL (<code class="literal">0x00</code>) character</td></tr><tr><td scope="row"><code class="literal">\b</code>

                  <a class="indexterm" name="idm139737148798416"></a>

                  <a class="indexterm" name="idm139737148797344"></a></td><td>A backspace character</td></tr><tr><td scope="row"><code class="literal">\n</code>

                  <a class="indexterm" name="idm139737148794688"></a>

                  <a class="indexterm" name="idm139737148793616"></a>

                  <a class="indexterm" name="idm139737148792544"></a>

                  <a class="indexterm" name="idm139737148791472"></a></td><td>A newline (linefeed) character</td></tr><tr><td scope="row"><code class="literal">\r</code>

                  <a class="indexterm" name="idm139737148788800"></a>

                  <a class="indexterm" name="idm139737148787728"></a>

                  <a class="indexterm" name="idm139737148786656"></a></td><td>A carriage return character</td></tr><tr><td scope="row"><code class="literal">\t</code>

                  <a class="indexterm" name="idm139737148783984"></a>

                  <a class="indexterm" name="idm139737148782912"></a></td><td>A tab character.</td></tr><tr><td scope="row"><code class="literal">\Z</code>

                  <a class="indexterm" name="idm139737148780256"></a>

                  <a class="indexterm" name="idm139737148779184"></a></td><td>ASCII 26 (Control+Z)</td></tr><tr><td scope="row"><code class="literal">\N</code>

<a class="indexterm" name="idm139737148776528"></a></td><td>NULL</td></tr></tbody></table>
</div>
<p>
          For more information about
          <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span>-escape syntax, see
          <a class="xref" href="language-structure.html#string-literals" title="9.1.1 String Literals">Section 9.1.1, “String Literals”</a>.
        </p><p>
          If the <code class="literal">FIELDS ESCAPED BY</code> character is
          empty, escape-sequence interpretation does not occur.
        </p></li><li class="listitem"><p>
          For output, if the <code class="literal">FIELDS ESCAPED BY</code>
          character is not empty, it is used to prefix the following
          characters on output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              The <code class="literal">FIELDS ESCAPED BY</code> character
            </p></li><li class="listitem"><p>
              The <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code>
              character
            </p></li><li class="listitem"><p>
              The first character of the <code class="literal">FIELDS TERMINATED
              BY</code> and <code class="literal">LINES TERMINATED BY</code>
              values
            </p></li><li class="listitem"><p>
              ASCII <code class="literal">0</code> (what is actually written
              following the escape character is ASCII
              <span class="quote">“<span class="quote"><code class="literal">0</code></span>”</span>, not a zero-valued
              byte)
</p></li></ul>
</div>
<p>
          If the <code class="literal">FIELDS ESCAPED BY</code> character is
          empty, no characters are escaped and <code class="literal">NULL</code>
          is output as <code class="literal">NULL</code>, not
          <code class="literal">\N</code>. It is probably not a good idea to
          specify an empty escape character, particularly if field
          values in your data contain any of the characters in the list
          just given.
</p></li></ul>
</div>
<p>
      In certain cases, field- and line-handling options interact:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If <code class="literal">LINES TERMINATED BY</code> is an empty string
          and <code class="literal">FIELDS TERMINATED BY</code> is nonempty, lines
          are also terminated with <code class="literal">FIELDS TERMINATED
          BY</code>.
        </p></li><li class="listitem"><p>
          If the <code class="literal">FIELDS TERMINATED BY</code> and
          <code class="literal">FIELDS ENCLOSED BY</code> values are both empty
          (<code class="literal">''</code>), a fixed-row (nondelimited) format is
          used. With fixed-row format, no delimiters are used between
          fields (but you can still have a line terminator). Instead,
          column values are read and written using a field width wide
          enough to hold all values in the field. For
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">TINYINT</code></a>,
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">SMALLINT</code></a>,
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">MEDIUMINT</code></a>,
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">INT</code></a>, and
          <a class="link" href="data-types.html#integer-types" title="11.2.1 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT"><code class="literal">BIGINT</code></a>, the field widths are 4,
          6, 8, 11, and 20, respectively, no matter what the declared
          display width is.
        </p><p>
          <code class="literal">LINES TERMINATED BY</code> is still used to
          separate lines. If a line does not contain all fields, the
          rest of the columns are set to their default values. If you do
          not have a line terminator, you should set this to
          <code class="literal">''</code>. In this case, the text file must
          contain all fields for each row.
        </p><p>
          Fixed-row format also affects handling of
          <code class="literal">NULL</code> values, as described later.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            Fixed-size format does not work if you are using a multibyte
            character set.
</p>
</div>
</li></ul>
</div>
<p>
      Handling of <code class="literal">NULL</code> values varies according to the
      <code class="literal">FIELDS</code> and <code class="literal">LINES</code> options in
      use:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For the default <code class="literal">FIELDS</code> and
          <code class="literal">LINES</code> values, <code class="literal">NULL</code> is
          written as a field value of <code class="literal">\N</code> for output,
          and a field value of <code class="literal">\N</code> is read as
          <code class="literal">NULL</code> for input (assuming that the
          <code class="literal">ESCAPED BY</code> character is
          <span class="quote">“<span class="quote"><code class="literal">\</code></span>”</span>).
        </p></li><li class="listitem"><p>
          If <code class="literal">FIELDS ENCLOSED BY</code> is not empty, a field
          containing the literal word <code class="literal">NULL</code> as its
          value is read as a <code class="literal">NULL</code> value. This differs
          from the word <code class="literal">NULL</code> enclosed within
          <code class="literal">FIELDS ENCLOSED BY</code> characters, which is
          read as the string <code class="literal">'NULL'</code>.
        </p></li><li class="listitem"><p>
          If <code class="literal">FIELDS ESCAPED BY</code> is empty,
          <code class="literal">NULL</code> is written as the word
          <code class="literal">NULL</code>.
        </p></li><li class="listitem"><p>
          With fixed-row format (which is used when <code class="literal">FIELDS
          TERMINATED BY</code> and <code class="literal">FIELDS ENCLOSED
          BY</code> are both empty), <code class="literal">NULL</code> is
          written as an empty string. This causes both
          <code class="literal">NULL</code> values and empty strings in the table
          to be indistinguishable when written to the file because both
          are written as empty strings. If you need to be able to tell
          the two apart when reading the file back in, you should not
          use fixed-row format.
</p></li></ul>
</div>
<p>
      An attempt to load <code class="literal">NULL</code> into a <code class="literal">NOT
      NULL</code> column causes assignment of the implicit default
      value for the column's data type and a warning, or an error in
      strict SQL mode. Implicit default values are discussed in
      <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>.
    </p><p>
      Some cases are not supported by
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Fixed-size rows (<code class="literal">FIELDS TERMINATED BY</code> and
          <code class="literal">FIELDS ENCLOSED BY</code> both empty) and
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> or
          <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns.
        </p></li><li class="listitem"><p>
          If you specify one separator that is the same as or a prefix
          of another, <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD
          DATA INFILE</code></a> cannot interpret the input properly. For
          example, the following <code class="literal">FIELDS</code> clause would
          cause problems:
        </p><pre class="programlisting">
FIELDS TERMINATED BY '"' ENCLOSED BY '"'
</pre></li><li class="listitem"><p>
          If <code class="literal">FIELDS ESCAPED BY</code> is empty, a field
          value that contains an occurrence of <code class="literal">FIELDS ENCLOSED
          BY</code> or <code class="literal">LINES TERMINATED BY</code>
          followed by the <code class="literal">FIELDS TERMINATED BY</code> value
          causes <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> to stop reading a field or line too early.
          This happens because
          <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> cannot properly determine where the field or
          line value ends.
</p></li></ul>
</div>
<p>
      The following example loads all columns of the
      <code class="literal">persondata</code> table:
    </p><pre class="programlisting">
LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata;
</pre><p>
      By default, when no column list is provided at the end of the
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> statement, input lines are expected to contain a
      field for each table column. If you want to load only some of a
      table's columns, specify a column list:
    </p><pre class="programlisting">
LOAD DATA INFILE 'persondata.txt' INTO TABLE persondata (col1,col2,...);
</pre><p>
      You must also specify a column list if the order of the fields in
      the input file differs from the order of the columns in the table.
      Otherwise, MySQL cannot tell how to match input fields with table
      columns.
    </p><p>
      The column list can contain either column names or user variables.
      With user variables, the <code class="literal">SET</code> clause enables you
      to perform transformations on their values before assigning the
      result to columns.
    </p><p>
      User variables in the <code class="literal">SET</code> clause can be used in
      several ways. The following example uses the first input column
      directly for the value of <code class="literal">t1.column1</code>, and
      assigns the second input column to a user variable that is
      subjected to a division operation before being used for the value
      of <code class="literal">t1.column2</code>:
    </p><pre class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, @var1)
  SET column2 = @var1/100;
</pre><p>
      The <code class="literal">SET</code> clause can be used to supply values not
      derived from the input file. The following statement sets
      <code class="literal">column3</code> to the current date and time:
    </p><pre class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, column2)
  SET column3 = CURRENT_TIMESTAMP;
</pre><p>
      You can also discard an input value by assigning it to a user
      variable and not assigning the variable to a table column:
    </p><pre class="programlisting">
LOAD DATA INFILE 'file.txt'
  INTO TABLE t1
  (column1, @dummy, column2, @dummy, column3);
</pre><p>
      Use of the column/variable list and <code class="literal">SET</code> clause
      is subject to the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Assignments in the <code class="literal">SET</code> clause should have
          only column names on the left hand side of assignment
          operators.
        </p></li><li class="listitem"><p>
          You can use subqueries in the right hand side of
          <code class="literal">SET</code> assignments. A subquery that returns a
          value to be assigned to a column may be a scalar subquery
          only. Also, you cannot use a subquery to select from the table
          that is being loaded.
        </p></li><li class="listitem"><p>
          Lines ignored by an <code class="literal">IGNORE</code> clause are not
          processed for the column/variable list or
          <code class="literal">SET</code> clause.
        </p></li><li class="listitem"><p>
          User variables cannot be used when loading data with fixed-row
          format because user variables do not have a display width.
</p></li></ul>
</div>
<p>
      When processing an input line, <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD
      DATA</code></a> splits it into fields and uses the values according
      to the column/variable list and the <code class="literal">SET</code> clause,
      if they are present. Then the resulting row is inserted into the
      table. If there are <code class="literal">BEFORE INSERT</code> or
      <code class="literal">AFTER INSERT</code> triggers for the table, they are
      activated before or after inserting the row, respectively.
    </p><p>
      If an input line has too many fields, the extra fields are ignored
      and the number of warnings is incremented.
    </p><p>
      If an input line has too few fields, the table columns for which
      input fields are missing are set to their default values. Default
      value assignment is described in
      <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>.
    </p><p>
      An empty field value is interpreted different from a missing
      field:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          For string types, the column is set to the empty string.
        </p></li><li class="listitem"><p>
          For numeric types, the column is set to <code class="literal">0</code>.
        </p></li><li class="listitem"><p>
          For date and time types, the column is set to the appropriate
          <span class="quote">“<span class="quote">zero</span>”</span> value for the type. See
          <a class="xref" href="data-types.html#date-and-time-types" title="11.3 Date and Time Types">Section 11.3, “Date and Time Types”</a>.
</p></li></ul>
</div>
<p>
      These are the same values that result if you assign an empty
      string explicitly to a string, numeric, or date or time type
      explicitly in an <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> or
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement.
    </p><p>
      Treatment of empty or incorrect field values differs from that
      just described if the SQL mode is set to a restrictive value. For
      example, if <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> is set to
      <a class="link" href="server-administration.html#sqlmode_traditional"><code class="literal">TRADITIONAL</code></a>, conversion of an
      empty value or a value such as <code class="literal">'x'</code> for a
      numeric column results in an error, not conversion to 0. (With
      <code class="literal">LOCAL</code> or <code class="literal">IGNORE</code>, warnings
      occur rather than errors, even with a restrictive
      <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> value, and the row is
      inserted using the same closest-value behavior used for
      nonrestrictive SQL modes. This occurs because the server has no
      way to stop transmission of the file in the middle of the
      operation.)
    </p><p>
      <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> columns are set to the
      current date and time only if there is a <code class="literal">NULL</code>
      value for the column (that is, <code class="literal">\N</code>) and the
      column is not declared to permit <code class="literal">NULL</code> values,
      or if the <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> column's
      default value is the current timestamp and it is omitted from the
      field list when a field list is specified.
    </p><p>
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> regards all input as strings, so you cannot use
      numeric values for <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> or
      <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> columns the way you can with
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements. All
      <a class="link" href="data-types.html#enum" title="11.4.4 The ENUM Type"><code class="literal">ENUM</code></a> and
      <a class="link" href="data-types.html#set" title="11.4.5 The SET Type"><code class="literal">SET</code></a> values must be specified as
      strings.
    </p><p>
      <a class="link" href="data-types.html#bit-type" title="11.2.4 Bit-Value Type - BIT"><code class="literal">BIT</code></a> values cannot be loaded using
      binary notation (for example, <code class="literal">b'011010'</code>). To
      work around this, specify the values as regular integers and use
      the <code class="literal">SET</code> clause to convert them so that MySQL
      performs a numeric type conversion and loads them into the
      <a class="link" href="data-types.html#bit-type" title="11.2.4 Bit-Value Type - BIT"><code class="literal">BIT</code></a> column properly:
    </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>cat /tmp/bit_test.txt</code></strong>
2
127
shell&gt; <strong class="userinput"><code>mysql test</code></strong>
mysql&gt; <strong class="userinput"><code>LOAD DATA INFILE '/tmp/bit_test.txt'</code></strong>
    -&gt; <strong class="userinput"><code>INTO TABLE bit_test (@var1) SET b = CAST(@var1 AS UNSIGNED);</code></strong>
Query OK, 2 rows affected (0.00 sec)
Records: 2  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT BIN(b+0) FROM bit_test;</code></strong>
+----------+
| bin(b+0) |
+----------+
| 10       |
| 1111111  |
+----------+
2 rows in set (0.00 sec)
</pre><p>
      On Unix, if you need <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> to
      read from a pipe, you can use the following technique (the example
      loads a listing of the <code class="filename">/</code> directory into the
      table <code class="literal">db1.t1</code>):
    </p><pre class="programlisting">
mkfifo /mysql/data/db1/ls.dat
chmod 666 /mysql/data/db1/ls.dat
find / -ls &gt; /mysql/data/db1/ls.dat &amp;
mysql -e "LOAD DATA INFILE 'ls.dat' INTO TABLE t1" db1
</pre><p>
      Here you must run the command that generates the data to be loaded
      and the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> commands either on separate
      terminals, or run the data generation process in the background
      (as shown in the preceding example). If you do not do this, the
      pipe will block until data is read by the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a>
      process.
    </p><p>
      When the <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> statement finishes, it returns an information
      string in the following format:
    </p><pre class="programlisting">
Records: 1  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      Warnings occur under the same circumstances as when values are
      inserted using the <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statement
      (see <a class="xref" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax">Section 13.2.5, “INSERT Syntax”</a>), except that
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a> also generates warnings when there are too few or
      too many fields in the input row.
    </p><p>
      You can use <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> to get a
      list of the first <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>
      warnings as information about what went wrong. See
      <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
    </p><a class="indexterm" name="idm139737148616272"></a><p>
      If you are using the C API, you can get information about the
      statement by calling the
      <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a> function. See
      <a class="xref" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()">Section 23.8.7.35, “mysql_info()”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="load-xml"></a>13.2.7 LOAD XML Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737148611552"></a><pre class="programlisting">
LOAD XML [LOW_PRIORITY | CONCURRENT] [LOCAL] INFILE '<em class="replaceable"><code>file_name</code></em>'
    [REPLACE | IGNORE]
    INTO TABLE [<em class="replaceable"><code>db_name</code></em>.]<em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]
    [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
    [ROWS IDENTIFIED BY '&lt;<em class="replaceable"><code>tagname</code></em>&gt;']
    [IGNORE <em class="replaceable"><code>number</code></em> {LINES | ROWS}]
    [(<em class="replaceable"><code>column_or_user_var</code></em>,...)]
    [SET <em class="replaceable"><code>col_name</code></em> = <em class="replaceable"><code>expr</code></em>,...]
</pre><p>
      The <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement reads data
      from an XML file into a table. The
      <em class="replaceable"><code>file_name</code></em> must be given as a literal
      string. The <em class="replaceable"><code>tagname</code></em> in the optional
      <code class="literal">ROWS IDENTIFIED BY</code> clause must also be given as
      a literal string, and must be surrounded by angle brackets
      (<code class="literal">&lt;</code> and <code class="literal">&gt;</code>).
    </p><p>
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> acts as the complement of
      running the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client in XML output mode
      (that is, starting the client with the
      <a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a> option). To write data from a
      table to an XML file, use a command such as the following one from
      the system shell:
    </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysql --xml -e 'SELECT * FROM mytable' &gt; file.xml</code></strong>
</pre><p>
      To read the file back into a table, use
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML
      INFILE</code></a>. By default, the <code class="literal">&lt;row&gt;</code>
      element is considered to be the equivalent of a database table
      row; this can be changed using the <code class="literal">ROWS IDENTIFIED
      BY</code> clause.
    </p><p>
      This statement supports three different XML formats:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Column names as attributes and column values as attribute
          values:
        </p><pre class="programlisting">
&lt;<em class="replaceable"><code>row</code></em> <em class="replaceable"><code>column1</code></em>="<em class="replaceable"><code>value1</code></em>" <em class="replaceable"><code>column2</code></em>="<em class="replaceable"><code>value2</code></em>" .../&gt;
</pre></li><li class="listitem"><p>
          Column names as tags and column values as the content of these
          tags:
        </p><pre class="programlisting">
&lt;<em class="replaceable"><code>row</code></em>&gt;
  &lt;<em class="replaceable"><code>column1</code></em>&gt;<em class="replaceable"><code>value1</code></em>&lt;/<em class="replaceable"><code>column1</code></em>&gt;
  &lt;<em class="replaceable"><code>column2</code></em>&gt;<em class="replaceable"><code>value2</code></em>&lt;/<em class="replaceable"><code>column2</code></em>&gt;
&lt;/<em class="replaceable"><code>row</code></em>&gt;
</pre></li><li class="listitem"><p>
          Column names are the <code class="literal">name</code> attributes of
          <code class="literal">&lt;field&gt;</code> tags, and values are the
          contents of these tags:
        </p><pre class="programlisting">
&lt;row&gt;
  &lt;field name='<em class="replaceable"><code>column1</code></em>'&gt;<em class="replaceable"><code>value1</code></em>&lt;/field&gt;
  &lt;field name='<em class="replaceable"><code>column2</code></em>'&gt;<em class="replaceable"><code>value2</code></em>&lt;/field&gt;
&lt;/row&gt;
</pre><p>
          This is the format used by other MySQL tools, such as
          <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a>.
</p></li></ul>
</div>
<p>
      All three formats can be used in the same XML file; the import
      routine automatically detects the format for each row and
      interprets it correctly. Tags are matched based on the tag or
      attribute name and the column name.
    </p><p>
      The following clauses work essentially the same way for
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> as they do for
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">LOW_PRIORITY</code> or
          <code class="literal">CONCURRENT</code>
        </p></li><li class="listitem"><p>
          <code class="literal">LOCAL</code>
        </p></li><li class="listitem"><p>
          <code class="literal">REPLACE</code> or <code class="literal">IGNORE</code>
        </p></li><li class="listitem"><p>
          <code class="literal">PARTITION</code>
        </p></li><li class="listitem"><p>
          <code class="literal">CHARACTER SET</code>
        </p></li><li class="listitem"><p>
          <code class="literal">(<em class="replaceable"><code>column_or_user_var</code></em>,...)</code>
        </p></li><li class="listitem"><p>
          <code class="literal">SET</code>
</p></li></ul>
</div>
<p>
      See <a class="xref" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax">Section 13.2.6, “LOAD DATA INFILE Syntax”</a>, for more information about these
      clauses.
    </p><p>
      The <code class="literal">IGNORE <em class="replaceable"><code>number</code></em>
      LINES</code> or <code class="literal">IGNORE
      <em class="replaceable"><code>number</code></em> ROWS</code> clause causes the
      first <em class="replaceable"><code>number</code></em> rows in the XML file to be
      skipped. It is analogous to the <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD
      DATA</code></a> statement's <code class="literal">IGNORE ... LINES</code>
      clause.
    </p><p>
      To illustrate how this statement is used, suppose that we have a
      table created as follows:
    </p><pre class="programlisting">
USE test;

CREATE TABLE person (
    person_id INT NOT NULL PRIMARY KEY,
    fname VARCHAR(40) NULL,
    lname VARCHAR(40) NULL,
    created TIMESTAMP
);
</pre><p>
      Suppose further that this table is initially empty.
    </p><p>
      Now suppose that we have a simple XML file
      <code class="filename">person.xml</code>, whose contents are as shown here:
    </p><pre class="programlisting">
&lt;?xml version="1.0"?&gt;
&lt;list&gt;
  &lt;person person_id="1" fname="Pekka" lname="Nousiainen"/&gt;
  &lt;person person_id="2" fname="Jonas" lname="Oreland"/&gt;
  &lt;person person_id="3"&gt;&lt;fname&gt;Mikael&lt;/fname&gt;&lt;lname&gt;Ronström&lt;/lname&gt;&lt;/person&gt;
  &lt;person person_id="4"&gt;&lt;fname&gt;Lars&lt;/fname&gt;&lt;lname&gt;Thalmann&lt;/lname&gt;&lt;/person&gt;
  &lt;person&gt;&lt;field name="person_id"&gt;5&lt;/field&gt;&lt;field name="fname"&gt;Tomas&lt;/field&gt;
  &lt;field name="lname"&gt;Ulin&lt;/field&gt;&lt;/person&gt;
  &lt;person&gt;&lt;field name="person_id"&gt;6&lt;/field&gt;&lt;field name="fname"&gt;Martin&lt;/field&gt;
  &lt;field name="lname"&gt;Sköld&lt;/field&gt;&lt;/person&gt;
&lt;/list&gt;
</pre><p>
      Each of the permissible XML formats discussed previously is
      represented in this example file.
    </p><p>
      To import the data in <code class="filename">person.xml</code> into the
      <code class="literal">person</code> table, you can use this statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'person.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;person&gt;';</code></strong>

Query OK, 6 rows affected (0.00 sec)
Records: 6  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      Here, we assume that <code class="filename">person.xml</code> is located in
      the MySQL data directory. If the file cannot be found, the
      following error results:
    </p><pre class="programlisting">
<span class="errortext">ERROR 2 (HY000): File '/person.xml' not found (Errcode: 2)</span>
</pre><p>
      The <code class="literal">ROWS IDENTIFIED BY '&lt;person&gt;'</code> clause
      means that each <code class="literal">&lt;person&gt;</code> element in the
      XML file is considered equivalent to a row in the table into which
      the data is to be imported. In this case, this is the
      <code class="literal">person</code> table in the <code class="literal">test</code>
      database.
    </p><p>
      As can be seen by the response from the server, 6 rows were
      imported into the <code class="literal">test.person</code> table. This can
      be verified by a simple <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
      statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM person;</code></strong>
+-----------+--------+------------+---------------------+
| person_id | fname  | lname      | created             |
+-----------+--------+------------+---------------------+
|         1 | Pekka  | Nousiainen | 2007-07-13 16:18:47 |
|         2 | Jonas  | Oreland    | 2007-07-13 16:18:47 |
|         3 | Mikael | Ronström   | 2007-07-13 16:18:47 |
|         4 | Lars   | Thalmann   | 2007-07-13 16:18:47 |
|         5 | Tomas  | Ulin       | 2007-07-13 16:18:47 |
|         6 | Martin | Sköld      | 2007-07-13 16:18:47 |
+-----------+--------+------------+---------------------+
6 rows in set (0.00 sec)
</pre><p>
      This shows, as stated earlier in this section, that any or all of
      the 3 permitted XML formats may appear in a single file and be
      read in using <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a>.
    </p><p>
      The inverse of the above operation—that is, dumping MySQL
      table data into an XML file—can be accomplished using the
      mysql client from the system shell, as shown here:
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <a class="link" href="programs.html#option_mysql_xml"><code class="option">--xml</code></a> option causes the
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client to use XML formatting for its
        output; the <code class="option">-e</code> option causes the client to
        execute the SQL statement immediately following the option.
</p>
</div>
<pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysql --xml -e "SELECT * FROM test.person" &gt; person-dump.xml</code></strong>
shell&gt; <strong class="userinput"><code>cat person-dump.xml</code></strong>
&lt;?xml version="1.0"?&gt;

&lt;resultset statement="SELECT * FROM test.person" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
  &lt;row&gt;
        &lt;field name="person_id"&gt;1&lt;/field&gt;
        &lt;field name="fname"&gt;Pekka&lt;/field&gt;
        &lt;field name="lname"&gt;Nousiainen&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
        &lt;field name="person_id"&gt;2&lt;/field&gt;
        &lt;field name="fname"&gt;Jonas&lt;/field&gt;
        &lt;field name="lname"&gt;Oreland&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
        &lt;field name="person_id"&gt;3&lt;/field&gt;
        &lt;field name="fname"&gt;Mikael&lt;/field&gt;
        &lt;field name="lname"&gt;Ronström&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
        &lt;field name="person_id"&gt;4&lt;/field&gt;
        &lt;field name="fname"&gt;Lars&lt;/field&gt;
        &lt;field name="lname"&gt;Thalmann&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
        &lt;field name="person_id"&gt;5&lt;/field&gt;
        &lt;field name="fname"&gt;Tomas&lt;/field&gt;
        &lt;field name="lname"&gt;Ulin&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;

  &lt;row&gt;
        &lt;field name="person_id"&gt;6&lt;/field&gt;
        &lt;field name="fname"&gt;Martin&lt;/field&gt;
        &lt;field name="lname"&gt;Sköld&lt;/field&gt;
        &lt;field name="created"&gt;2007-07-13 16:18:47&lt;/field&gt;
  &lt;/row&gt;
&lt;/resultset&gt;
</pre><p>
      You can verify that the dump is valid by creating a copy of the
      <code class="literal">person</code> and then importing the dump file into
      the new table, like this:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE person2 LIKE person;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'person-dump.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person2;</code></strong>
Query OK, 6 rows affected (0.01 sec)
Records: 6  Deleted: 0  Skipped: 0  Warnings: 0

mysql&gt; <strong class="userinput"><code>SELECT * FROM person2;</code></strong>
+-----------+--------+------------+---------------------+
| person_id | fname  | lname      | created             |
+-----------+--------+------------+---------------------+
|         1 | Pekka  | Nousiainen | 2007-07-13 16:18:47 |
|         2 | Jonas  | Oreland    | 2007-07-13 16:18:47 |
|         3 | Mikael | Ronström   | 2007-07-13 16:18:47 |
|         4 | Lars   | Thalmann   | 2007-07-13 16:18:47 |
|         5 | Tomas  | Ulin       | 2007-07-13 16:18:47 |
|         6 | Martin | Sköld      | 2007-07-13 16:18:47 |
+-----------+--------+------------+---------------------+
6 rows in set (0.00 sec)
</pre><p>
      Using a <code class="literal">ROWS IDENTIFIED BY
      '&lt;<em class="replaceable"><code>tagname</code></em>&gt;'</code> clause, it
      is possible to import data from the same XML file into database
      tables with different definitions. For this example, suppose that
      you have a file named <code class="filename">address.xml</code> which
      contains the following XML:
    </p><pre class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;list&gt;
  &lt;person person_id="1"&gt;
    &lt;fname&gt;Robert&lt;/fname&gt;
    &lt;lname&gt;Jones&lt;/lname&gt;
    &lt;address address_id="1" street="Mill Creek Road" zip="45365" city="Sidney"/&gt;
    &lt;address address_id="2" street="Main Street" zip="28681" city="Taylorsville"/&gt;
  &lt;/person&gt;

  &lt;person person_id="2"&gt;
    &lt;fname&gt;Mary&lt;/fname&gt;
    &lt;lname&gt;Smith&lt;/lname&gt;
    &lt;address address_id="3" street="River Road" zip="80239" city="Denver"/&gt;
    &lt;!-- &lt;address address_id="4" street="North Street" zip="37920" city="Knoxville"/&gt; --&gt;
  &lt;/person&gt;

&lt;/list&gt;
</pre><p>
      You can again use the <code class="literal">test.person</code> table as
      defined previously in this section, after clearing all the
      existing records from the table and then showing its structure as
      shown here:
    </p><pre class="programlisting">
mysql&lt; <strong class="userinput"><code>TRUNCATE person;</code></strong>
Query OK, 0 rows affected (0.04 sec)

mysql&lt; <strong class="userinput"><code>SHOW CREATE TABLE person\G</code></strong>
*************************** 1. row ***************************
       Table: person
Create Table: CREATE TABLE `person` (
  `person_id` int(11) NOT NULL,
  `fname` varchar(40) DEFAULT NULL,
  `lname` varchar(40) DEFAULT NULL,
  `created` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`person_id`)
) ENGINE=MyISAM DEFAULT CHARSET=latin1
1 row in set (0.00 sec)
</pre><p>
      Now create an <code class="literal">address</code> table in the
      <code class="literal">test</code> database using the following
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
    </p><pre class="programlisting">
CREATE TABLE address (
    address_id INT NOT NULL PRIMARY KEY,
    person_id INT NULL,
    street VARCHAR(40) NULL,
    zip INT NULL,
    city VARCHAR(40) NULL,
    created TIMESTAMP
);
</pre><p>
      To import the data from the XML file into the
      <code class="literal">person</code> table, execute the following
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement, which specifies
      that rows are to be specified by the
      <code class="literal">&lt;person&gt;</code> element, as shown here;
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'address.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE person</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;person&gt;';</code></strong>
Query OK, 2 rows affected (0.00 sec)
Records: 2  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      You can verify that the records were imported using a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM person;</code></strong>
+-----------+--------+-------+---------------------+
| person_id | fname  | lname | created             |
+-----------+--------+-------+---------------------+
|         1 | Robert | Jones | 2007-07-24 17:37:06 |
|         2 | Mary   | Smith | 2007-07-24 17:37:06 |
+-----------+--------+-------+---------------------+
2 rows in set (0.00 sec)
</pre><p>
      Since the <code class="literal">&lt;address&gt;</code> elements in the XML
      file have no corresponding columns in the
      <code class="literal">person</code> table, they are skipped.
    </p><p>
      To import the data from the <code class="literal">&lt;address&gt;</code>
      elements into the <code class="literal">address</code> table, use the
      <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> statement shown here:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD XML LOCAL INFILE 'address.xml'</code></strong>
    -&gt;   <strong class="userinput"><code>INTO TABLE address</code></strong>
    -&gt;   <strong class="userinput"><code>ROWS IDENTIFIED BY '&lt;address&gt;';</code></strong>
Query OK, 3 rows affected (0.00 sec)
Records: 3  Deleted: 0  Skipped: 0  Warnings: 0
</pre><p>
      You can see that the data was imported using a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement such as this one:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM address;</code></strong>
+------------+-----------+-----------------+-------+--------------+---------------------+
| address_id | person_id | street          | zip   | city         | created             |
+------------+-----------+-----------------+-------+--------------+---------------------+
|          1 |         1 | Mill Creek Road | 45365 | Sidney       | 2007-07-24 17:37:37 |
|          2 |         1 | Main Street     | 28681 | Taylorsville | 2007-07-24 17:37:37 |
|          3 |         2 | River Road      | 80239 | Denver       | 2007-07-24 17:37:37 |
+------------+-----------+-----------------+-------+--------------+---------------------+
3 rows in set (0.00 sec)
</pre><p>
      The data from the <code class="literal">&lt;address&gt;</code> element that
      is enclosed in XML comments is not imported. However, since there
      is a <code class="literal">person_id</code> column in the
      <code class="literal">address</code> table, the value of the
      <code class="literal">person_id</code> attribute from the parent
      <code class="literal">&lt;person&gt;</code> element for each
      <code class="literal">&lt;address&gt;</code> <span class="emphasis"><em>is</em></span>
      imported into the <code class="literal">address</code> table.
    </p><p><b>Security Considerations. </b>
        As with the <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA</code></a> statement,
        the transfer of the XML file from the client host to the server
        host is initiated by the MySQL server. In theory, a patched
        server could be built that would tell the client program to
        transfer a file of the server's choosing rather than the file
        named by the client in the <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD
        XML</code></a> statement. Such a server could access any file on
        the client host to which the client user has read access.
      </p><p>
      In a Web environment, clients usually connect to MySQL from a Web
      server. A user that can run any command against the MySQL server
      can use <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML
      LOCAL</code></a> to read any files to which the Web server process
      has read access. In this environment, the client with respect to
      the MySQL server is actually the Web server, not the remote
      program being run by the user who connects to the Web server.
    </p><p>
      You can disable loading of XML files from clients by starting the
      server with <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">--local-infile=0</code></a> or
      <a class="link" href="server-administration.html#sysvar_local_infile"><code class="literal">--local-infile=OFF</code></a>. This option
      can also be used when starting the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client
      to disable <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML</code></a> for the
      duration of the client session.
    </p><p>
      To prevent a client from loading XML files from the server, do not
      grant the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to the
      corresponding MySQL user account, or revoke this privilege if the
      client user account already has it.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Revoking the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege (or
        not granting it in the first place) keeps the user only from
        executing the <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML
        INFILE</code></a> statement (as well as the
        <a class="link" href="functions.html#function_load-file"><code class="literal">LOAD_FILE()</code></a> function; it does
        <span class="emphasis"><em>not</em></span> prevent the user from executing
        <a class="link" href="sql-syntax.html#load-xml" title="13.2.7 LOAD XML Syntax"><code class="literal">LOAD XML LOCAL
        INFILE</code></a>. To disallow this statement, you must start the
        server or the client with <code class="option">--local-infile=OFF</code>.
      </p><p>
        In other words, the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>
        privilege affects only whether the client can read files on the
        server; it has no bearing on whether the client can read files
        on the local file system.
</p>
</div>
<p>
      For partitioned tables using storage engines that employ table
      locks, such as <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, <code class="literal">LOAD
      XML</code> cannot prune any partition locks. This does not
      apply to tables using storage engines which employ row-level
      locking, such as <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>. For more
      information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replace"></a>13.2.8 REPLACE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737148443120"></a><pre class="programlisting">
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)] 
    [(<em class="replaceable"><code>col_name</code></em>,...)]
    {VALUES | VALUE} ({<em class="replaceable"><code>expr</code></em> | DEFAULT},...),(...),...
</pre><p>
      Or:
    </p><pre class="programlisting">
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)] 
    SET <em class="replaceable"><code>col_name</code></em>={<em class="replaceable"><code>expr</code></em> | DEFAULT}, ...
</pre><p>
      Or:
    </p><pre class="programlisting">
REPLACE [LOW_PRIORITY | DELAYED]
    [INTO] <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_name</code></em>,...)]  
    [(<em class="replaceable"><code>col_name</code></em>,...)]
    SELECT ...
</pre><p>
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> works exactly like
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, except that if an old row
      in the table has the same value as a new row for a
      <code class="literal">PRIMARY KEY</code> or a <code class="literal">UNIQUE</code>
      index, the old row is deleted before the new row is inserted. See
      <a class="xref" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax">Section 13.2.5, “INSERT Syntax”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> is a MySQL extension to the
      SQL standard. It either inserts, or <span class="emphasis"><em>deletes</em></span>
      and inserts. For another MySQL extension to standard
      SQL—that either inserts or
      <span class="emphasis"><em>updates</em></span>—see
      <a class="xref" href="sql-syntax.html#insert-on-duplicate" title="13.2.5.3 INSERT ... ON DUPLICATE KEY UPDATE Syntax">Section 13.2.5.3, “INSERT ... ON DUPLICATE KEY UPDATE Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> makes sense only if a
        table has a <code class="literal">PRIMARY KEY</code> or
        <code class="literal">UNIQUE</code> index. Otherwise, it becomes
        equivalent to <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, because
        there is no index to be used to determine whether a new row
        duplicates another.
</p>
</div>
<p>
      Values for all columns are taken from the values specified in the
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement. Any missing
      columns are set to their default values, just as happens for
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>. You cannot refer to values
      from the current row and use them in the new row. If you use an
      assignment such as <code class="literal">SET
      <em class="replaceable"><code>col_name</code></em> =
      <em class="replaceable"><code>col_name</code></em> + 1</code>, the reference
      to the column name on the right hand side is treated as
      <a class="link" href="functions.html#function_default"><code class="literal">DEFAULT(<em class="replaceable"><code>col_name</code></em>)</code></a>,
      so the assignment is equivalent to <code class="literal">SET
      <em class="replaceable"><code>col_name</code></em> =
      DEFAULT(<em class="replaceable"><code>col_name</code></em>) + 1</code>.
    </p><p>
      To use <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>, you must have both
      the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> and
      <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privileges for the table.
    </p><p>
      Beginning with MySQL 5.6.2, <code class="literal">REPLACE</code> supports
      explicit partition selection using the
      <code class="literal">PARTITION</code> option with a comma-separated list of
      names of partitions, subpartitions, or both. As with
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, if it is not possible to
      insert the new row into any of these partitions or subpartitions,
      the <code class="literal">REPLACE</code> statement fails with the error
      <span class="errortext">Found a row not matching the given partition
      set</span>. See <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>, for
      more information.
    </p><p>
      The <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement returns a
      count to indicate the number of rows affected. This is the sum of
      the rows deleted and inserted. If the count is 1 for a single-row
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>, a row was inserted and no
      rows were deleted. If the count is greater than 1, one or more old
      rows were deleted before the new row was inserted. It is possible
      for a single row to replace more than one old row if the table
      contains multiple unique indexes and the new row duplicates values
      for different old rows in different unique indexes.
    </p><p>
      The affected-rows count makes it easy to determine whether
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> only added a row or whether
      it also replaced any rows: Check whether the count is 1 (added) or
      greater (replaced).
    </p><p>
      If you are using the C API, the affected-rows count can be
      obtained using the
      <a class="link" href="connectors-apis.html#mysql-affected-rows" title="23.8.7.1 mysql_affected_rows()"><code class="literal">mysql_affected_rows()</code></a> function.
    </p><p>
      Currently, you cannot replace into a table and select from the
      same table in a subquery.
    </p><p>
      MySQL uses the following algorithm for
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> (and <code class="literal">LOAD DATA ...
      REPLACE</code>):
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Try to insert the new row into the table
        </p></li><li class="listitem"><p>
          While the insertion fails because a duplicate-key error occurs
          for a primary key or unique index:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="a"><li class="listitem"><p>
              Delete from the table the conflicting row that has the
              duplicate key value
            </p></li><li class="listitem"><p>
              Try again to insert the new row into the table
</p></li></ol>
</div>
</li></ol>
</div>
<p>
      It is possible that in the case of a duplicate-key error, a
      storage engine may perform the <code class="literal">REPLACE</code> as an
      update rather than a delete plus insert, but the semantics are the
      same. There are no user-visible effects other than a possible
      difference in how the storage engine increments
      <code class="literal">Handler_<em class="replaceable"><code>xxx</code></em></code> status
      variables.
    </p><p>
      Because the results of <code class="literal">REPLACE ... SELECT</code>
      statements depend on the ordering of rows from the
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and this order cannot always
      be guaranteed, it is possible when logging these statements for
      the master and the slave to diverge. For this reason, in MySQL
      5.6.4 and later, <code class="literal">REPLACE ... SELECT</code> statements
      are flagged as unsafe for statement-based replication. With this
      change, such statements produce a warning in the log when using
      the <code class="literal">STATEMENT</code> binary logging mode, and are
      logged using the row-based format when using
      <code class="literal">MIXED</code> mode. See also
      <a class="xref" href="replication.html#replication-sbr-rbr" title="17.1.2.1 Advantages and Disadvantages of Statement-Based and Row-Based Replication">Section 17.1.2.1, “Advantages and Disadvantages of Statement-Based and Row-Based
        Replication”</a>.
    </p><p>
      When modifying an existing table that is not partitioned to
      accommodate partitioning, or, when modifying the partitioning of
      an already partitioned table, you may consider altering the
      table's primary key (see
      <a class="xref" href="partitioning.html#partitioning-limitations-partitioning-keys-unique-keys" title="19.6.1 Partitioning Keys, Primary Keys, and Unique Keys">Section 19.6.1, “Partitioning Keys, Primary Keys, and Unique Keys”</a>).
      You should be aware that, if you do this, the results of
      <code class="literal">REPLACE</code> statements may be affected, just as
      they would be if you modified the primary key of a nonpartitioned
      table. Consider the table created by the following
      <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement:
    </p><pre class="programlisting">
CREATE TABLE test (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  data VARCHAR(64) DEFAULT NULL,
  ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (id)
);
</pre><p>
      When we create this table and run the statements shown in the
      mysql client, the result is as follows:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>REPLACE INTO test VALUES (1, 'Old', '2014-08-20 18:47:00');</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>REPLACE INTO test VALUES (1, 'New', '2014-08-20 18:47:42');</code></strong>
Query OK, 2 rows affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM test;</code></strong> 
+----+------+---------------------+
| id | data | ts                  |
+----+------+---------------------+
|  1 | New  | 2014-08-20 18:47:42 |
+----+------+---------------------+
1 row in set (0.00 sec)
</pre><p>
      Now we create a second table almost identical to the first, except
      that the primary key now covers 2 columns, as shown here
      (emphasized text):
    </p><pre class="programlisting">
CREATE TABLE test2 (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  data VARCHAR(64) DEFAULT NULL,
  ts TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  <span class="emphasis"><em>PRIMARY KEY (id, ts)</em></span>
);
</pre><p>
      When we run on <code class="literal">test2</code> the same two
      <code class="literal">REPLACE</code> statements as we did on the original
      <code class="literal">test</code> table, we obtain a different result:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>REPLACE INTO test2 VALUES (1, 'Old', '2014-08-20 18:47:00');</code></strong>
Query OK, 1 row affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>REPLACE INTO test2 VALUES (1, 'New', '2014-08-20 18:47:42');</code></strong>
Query OK, 1 row affected (0.06 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM test2;</code></strong>
+----+------+---------------------+
| id | data | ts                  |
+----+------+---------------------+
|  1 | Old  | 2014-08-20 18:47:00 |
|  1 | New  | 2014-08-20 18:47:42 |
+----+------+---------------------+
2 rows in set (0.00 sec)
</pre><p>
      This is due to the fact that, when run on
      <code class="literal">test2</code>, both the <code class="literal">id</code> and
      <code class="literal">ts</code> column values must match those of an
      existing row for the row to be replaced; otherwise, a row is
      inserted.
    </p><p>
      Prior to MySQL 5.6.6, a <code class="literal">REPLACE</code> that affected a
      partitioned table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locked all partitions of the table. This was true even for
      <code class="literal">REPLACE ... PARTITION</code> statements. (This did not
      and does not occur with storage engines such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level
      locking.) In MySQL 5.6.6 and later, MySQL uses partition lock
      pruning, so that only partitions containing rows matching the
      <code class="literal">REPLACE</code> statement's
      <code class="literal">WHERE</code> clause are actually locked, as long as
      none of the table's partitioning columns are updated;
      otherwise the entire table is locked. For more information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="select"></a>13.2.9 SELECT Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#select-into">13.2.9.1 SELECT ... INTO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#join">13.2.9.2 JOIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#union">13.2.9.3 UNION Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737148349264"></a><pre class="programlisting">
SELECT
    [ALL | DISTINCT | DISTINCTROW ]
      [HIGH_PRIORITY]
      [STRAIGHT_JOIN]
      [SQL_SMALL_RESULT] [SQL_BIG_RESULT] [SQL_BUFFER_RESULT]
      [SQL_CACHE | SQL_NO_CACHE] [SQL_CALC_FOUND_ROWS]
    <em class="replaceable"><code>select_expr</code></em> [, <em class="replaceable"><code>select_expr</code></em> ...]
    [FROM <em class="replaceable"><code>table_references</code></em>
      [PARTITION <em class="replaceable"><code>partition_list</code></em>]
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [GROUP BY {<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>position</code></em>}
      [ASC | DESC], ... [WITH ROLLUP]]
    [HAVING <em class="replaceable"><code>where_condition</code></em>]
    [ORDER BY {<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>expr</code></em> | <em class="replaceable"><code>position</code></em>}
      [ASC | DESC], ...]
    [LIMIT {[<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em> | <em class="replaceable"><code>row_count</code></em> OFFSET <em class="replaceable"><code>offset</code></em>}]
    [PROCEDURE <em class="replaceable"><code>procedure_name</code></em>(<em class="replaceable"><code>argument_list</code></em>)]
    [INTO OUTFILE '<em class="replaceable"><code>file_name</code></em>'
        [CHARACTER SET <em class="replaceable"><code>charset_name</code></em>]
        <em class="replaceable"><code>export_options</code></em>
      | INTO DUMPFILE '<em class="replaceable"><code>file_name</code></em>'
      | INTO <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>]]
    [FOR UPDATE | LOCK IN SHARE MODE]]
</pre><p>
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> is used to retrieve rows
      selected from one or more tables, and can include
      <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> statements and subqueries.
      See <a class="xref" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax">Section 13.2.9.3, “UNION Syntax”</a>, and <a class="xref" href="sql-syntax.html#subqueries" title="13.2.10 Subquery Syntax">Section 13.2.10, “Subquery Syntax”</a>.
    </p><p>
      The most commonly used clauses of
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements are these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Each <em class="replaceable"><code>select_expr</code></em> indicates a column
          that you want to retrieve. There must be at least one
          <em class="replaceable"><code>select_expr</code></em>.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>table_references</code></em> indicates the
          table or tables from which to retrieve rows. Its syntax is
          described in <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>.
        </p></li><li class="listitem"><p>
          Starting in MySQL 5.6.2, <code class="literal">SELECT</code> supports
          explicit partition selection using the
          <code class="literal">PARTITION</code> keyword with a list of partitions
          or subpartitions (or both) following the name of the table in
          a <em class="replaceable"><code>table_reference</code></em> (see
          <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>). In this case, rows are selected only
          from the partitions listed, and any other partitions of the
          table are ignored. For more information and examples, see
          <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>.
        </p><p>
          In MySQL 5.6.6 and later, <code class="literal">SELECT ...
          PARTITION</code> from tables using storage engines such as
          <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that perform table-level
          locks (and thus partition locks) lock only the partitions or
          subpartitions named by the <code class="literal">PARTITION</code>
          option.
        </p><p>
          See <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>, for
          more information.
        </p></li><li class="listitem"><p>
          The <code class="literal">WHERE</code> clause, if given, indicates the
          condition or conditions that rows must satisfy to be selected.
          <em class="replaceable"><code>where_condition</code></em> is an expression
          that evaluates to true for each row to be selected. The
          statement selects all rows if there is no
          <code class="literal">WHERE</code> clause.
        </p><p>
          In the <code class="literal">WHERE</code> expression, you can use any of
          the functions and operators that MySQL supports, except for
          aggregate (summary) functions. See
          <a class="xref" href="language-structure.html#expressions" title="9.5 Expression Syntax">Section 9.5, “Expression Syntax”</a>, and
          <a class="xref" href="functions.html" title="Chapter 12 Functions and Operators">Chapter 12, <i>Functions and Operators</i></a>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> can also be used to retrieve
      rows computed without reference to any table.
    </p><p>
      For example:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 + 1;</code></strong>
        -&gt; 2
</pre><p>
      <a class="indexterm" name="idm139737148302432"></a>

      You are permitted to specify <code class="literal">DUAL</code> as a dummy
      table name in situations where no tables are referenced:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1 + 1 FROM DUAL;</code></strong>
        -&gt; 2
</pre><p>
      <code class="literal">DUAL</code> is purely for the convenience of people
      who require that all <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
      statements should have <code class="literal">FROM</code> and possibly other
      clauses. MySQL may ignore the clauses. MySQL does not require
      <code class="literal">FROM DUAL</code> if no tables are referenced.
    </p><p>
      In general, clauses used must be given in exactly the order shown
      in the syntax description. For example, a
      <code class="literal">HAVING</code> clause must come after any
      <code class="literal">GROUP BY</code> clause and before any <code class="literal">ORDER
      BY</code> clause. The exception is that the
      <code class="literal">INTO</code> clause can appear either as shown in the
      syntax description or immediately following the
      <em class="replaceable"><code>select_expr</code></em> list. For more information
      about <code class="literal">INTO</code>, see <a class="xref" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax">Section 13.2.9.1, “SELECT ... INTO Syntax”</a>.
    </p><p>
      The list of <em class="replaceable"><code>select_expr</code></em> terms comprises
      the select list that indicates which columns to retrieve. Terms
      specify a column or expression or can use
      <code class="literal">*</code>-shorthand:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A select list consisting only of a single unqualified
          <code class="literal">*</code> can be used as shorthand to select all
          columns from all tables:
        </p><pre class="programlisting">
SELECT * FROM t1 INNER JOIN t2 ...
</pre></li><li class="listitem"><p>
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.*</code> can
          be used as a qualified shorthand to select all columns from
          the named table:
        </p><pre class="programlisting">
SELECT t1.*, t2.* FROM t1 INNER JOIN t2 ...
</pre></li><li class="listitem"><p>
          Use of an unqualified <code class="literal">*</code> with other items in
          the select list may produce a parse error. To avoid this
          problem, use a qualified
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.*</code>
          reference
        </p><pre class="programlisting">
SELECT AVG(score), t1.* FROM t1 ...
</pre></li></ul>
</div>
<p>
      The following list provides additional information about other
      <code class="literal">SELECT</code> clauses:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm139737148276896"></a>

          <a class="indexterm" name="idm139737148275408"></a>

          A <em class="replaceable"><code>select_expr</code></em> can be given an alias
          using <code class="literal">AS
          <em class="replaceable"><code>alias_name</code></em></code>. The alias is
          used as the expression's column name and can be used in
          <code class="literal">GROUP BY</code>, <code class="literal">ORDER BY</code>, or
          <code class="literal">HAVING</code> clauses. For example:
        </p><pre class="programlisting">
SELECT CONCAT(last_name,', ',first_name) AS full_name
  FROM mytable ORDER BY full_name;
</pre><p>
          The <code class="literal">AS</code> keyword is optional when aliasing a
          <em class="replaceable"><code>select_expr</code></em> with an identifier. The
          preceding example could have been written like this:
        </p><pre class="programlisting">
SELECT CONCAT(last_name,', ',first_name) full_name
  FROM mytable ORDER BY full_name;
</pre><p>
          However, because the <code class="literal">AS</code> is optional, a
          subtle problem can occur if you forget the comma between two
          <em class="replaceable"><code>select_expr</code></em> expressions: MySQL
          interprets the second as an alias name. For example, in the
          following statement, <code class="literal">columnb</code> is treated as
          an alias name:
        </p><pre class="programlisting">
SELECT columna columnb FROM mytable;
</pre><p>
          For this reason, it is good practice to be in the habit of
          using <code class="literal">AS</code> explicitly when specifying column
          aliases.
        </p><p>
          It is not permissible to refer to a column alias in a
          <code class="literal">WHERE</code> clause, because the column value
          might not yet be determined when the <code class="literal">WHERE</code>
          clause is executed. See <a class="xref" href="error-handling.html#problems-with-alias" title="B.5.5.4 Problems with Column Aliases">Section B.5.5.4, “Problems with Column Aliases”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148259376"></a>

          <a class="indexterm" name="idm139737148258304"></a>

          The <code class="literal">FROM
          <em class="replaceable"><code>table_references</code></em></code> clause
          indicates the table or tables from which to retrieve rows. If
          you name more than one table, you are performing a join. For
          information on join syntax, see <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>. For
          each table specified, you can optionally specify an alias.
        </p><pre class="programlisting">
<em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] [<em class="replaceable"><code>index_hint</code></em>]
</pre><a class="indexterm" name="idm139737148253248"></a><a class="indexterm" name="idm139737148252176"></a><p>
          The use of index hints provides the optimizer with information
          about how to choose indexes during query processing. For a
          description of the syntax for specifying these hints, see
          <a class="xref" href="optimization.html#index-hints" title="8.9.3 Index Hints">Section 8.9.3, “Index Hints”</a>.
        </p><p>
          You can use <code class="literal">SET
          max_seeks_for_key=<em class="replaceable"><code>value</code></em></code>
          as an alternative way to force MySQL to prefer key scans
          instead of table scans. See
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
        </p></li><li class="listitem"><p>
          You can refer to a table within the default database as
          <em class="replaceable"><code>tbl_name</code></em>, or as
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>
          to specify a database explicitly. You can refer to a column as
          <em class="replaceable"><code>col_name</code></em>,
          <em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>,
          or
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>.
          You need not specify a <em class="replaceable"><code>tbl_name</code></em> or
          <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>
          prefix for a column reference unless the reference would be
          ambiguous. See <a class="xref" href="language-structure.html#identifier-qualifiers" title="9.2.1 Identifier Qualifiers">Section 9.2.1, “Identifier Qualifiers”</a>, for
          examples of ambiguity that require the more explicit column
          reference forms.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148239360"></a>

          <a class="indexterm" name="idm139737148237904"></a>

          A table reference can be aliased using
          <code class="literal"><em class="replaceable"><code>tbl_name</code></em> AS
          <em class="replaceable"><code>alias_name</code></em></code> or
          <em class="replaceable"><code>tbl_name alias_name</code></em>:
        </p><pre class="programlisting">
SELECT t1.name, t2.salary FROM employee AS t1, info AS t2
  WHERE t1.name = t2.name;

SELECT t1.name, t2.salary FROM employee t1, info t2
  WHERE t1.name = t2.name;
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148233408"></a>

          Columns selected for output can be referred to in
          <code class="literal">ORDER BY</code> and <code class="literal">GROUP BY</code>
          clauses using column names, column aliases, or column
          positions. Column positions are integers and begin with 1:
        </p><pre class="programlisting">
SELECT college, region, seed FROM tournament
  ORDER BY region, seed;

SELECT college, region AS r, seed AS s FROM tournament
  ORDER BY r, s;

SELECT college, region, seed FROM tournament
  ORDER BY 2, 3;
</pre><p>
          To sort in reverse order, add the <code class="literal">DESC</code>
          (descending) keyword to the name of the column in the
          <code class="literal">ORDER BY</code> clause that you are sorting by.
          The default is ascending order; this can be specified
          explicitly using the <code class="literal">ASC</code> keyword.
        </p><p>
          If <code class="literal">ORDER BY</code> occurs within a subquery and
          also is applied in the outer query, the outermost
          <code class="literal">ORDER BY</code> takes precedence. For example,
          results for the following statement are sorted in descending
          order, not ascending order:
        </p><pre class="programlisting">
(SELECT ... ORDER BY a) ORDER BY a DESC;
</pre><p>
          Use of column positions is deprecated because the syntax has
          been removed from the SQL standard.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148222960"></a>

          <a class="indexterm" name="idm139737148221472"></a>

          If you use <code class="literal">GROUP BY</code>, output rows are sorted
          according to the <code class="literal">GROUP BY</code> columns as if you
          had an <code class="literal">ORDER BY</code> for the same columns. To
          avoid the overhead of sorting that <code class="literal">GROUP BY</code>
          produces, add <code class="literal">ORDER BY NULL</code>:
        </p><pre class="programlisting">
SELECT a, COUNT(b) FROM test_table GROUP BY a ORDER BY NULL;
</pre><p>
          Relying on implicit <code class="literal">GROUP BY</code> sorting in
          MySQL 5.6 is deprecated. To achieve a specific
          sort order of grouped results, it is preferable to use an
          explicit <code class="literal">ORDER BY</code> clause. <code class="literal">GROUP
          BY</code> sorting is a MySQL extension that may change in a
          future release; for example, to make it possible for the
          optimizer to order groupings in whatever manner it deems most
          efficient and to avoid the sorting overhead.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148211760"></a>

          MySQL extends the <code class="literal">GROUP BY</code> clause so that
          you can also specify <code class="literal">ASC</code> and
          <code class="literal">DESC</code> after columns named in the clause:
        </p><pre class="programlisting">
SELECT a, COUNT(b) FROM test_table GROUP BY a DESC;
</pre></li><li class="listitem"><p>
          MySQL extends the use of <code class="literal">GROUP BY</code> to permit
          selecting fields that are not mentioned in the <code class="literal">GROUP
          BY</code> clause. If you are not getting the results that
          you expect from your query, please read the description of
          <code class="literal">GROUP BY</code> found in
          <a class="xref" href="functions.html#group-by-functions-and-modifiers" title="12.19 Functions and Modifiers for Use with GROUP BY Clauses">Section 12.19, “Functions and Modifiers for Use with GROUP BY Clauses”</a>.
        </p></li><li class="listitem"><p>
          <code class="literal">GROUP BY</code> permits a <code class="literal">WITH
          ROLLUP</code> modifier. See
          <a class="xref" href="functions.html#group-by-modifiers" title="12.19.2 GROUP BY Modifiers">Section 12.19.2, “GROUP BY Modifiers”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148199664"></a>

          The <code class="literal">HAVING</code> clause is applied nearly last,
          just before items are sent to the client, with no
          optimization. (<code class="literal">LIMIT</code> is applied after
          <code class="literal">HAVING</code>.)
        </p><p>
          The SQL standard requires that <code class="literal">HAVING</code> must
          reference only columns in the <code class="literal">GROUP BY</code>
          clause or columns used in aggregate functions. However, MySQL
          supports an extension to this behavior, and permits
          <code class="literal">HAVING</code> to refer to columns in the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> list and columns in
          outer subqueries as well.
        </p><p>
          If the <code class="literal">HAVING</code> clause refers to a column
          that is ambiguous, a warning occurs. In the following
          statement, <code class="literal">col2</code> is ambiguous because it is
          used as both an alias and a column name:
        </p><pre class="programlisting">
SELECT COUNT(col1) AS col2 FROM t GROUP BY col2 HAVING col2 = 2;
</pre><p>
          Preference is given to standard SQL behavior, so if a
          <code class="literal">HAVING</code> column name is used both in
          <code class="literal">GROUP BY</code> and as an aliased column in the
          output column list, preference is given to the column in the
          <code class="literal">GROUP BY</code> column.
        </p></li><li class="listitem"><p>
          Do not use <code class="literal">HAVING</code> for items that should be
          in the <code class="literal">WHERE</code> clause. For example, do not
          write the following:
        </p><pre class="programlisting">
SELECT <em class="replaceable"><code>col_name</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> HAVING <em class="replaceable"><code>col_name</code></em> &gt; 0;
</pre><p>
          Write this instead:
        </p><pre class="programlisting">
SELECT <em class="replaceable"><code>col_name</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>col_name</code></em> &gt; 0;
</pre></li><li class="listitem"><p>
          The <code class="literal">HAVING</code> clause can refer to aggregate
          functions, which the <code class="literal">WHERE</code> clause cannot:
        </p><pre class="programlisting">
SELECT user, MAX(salary) FROM users
  GROUP BY user HAVING MAX(salary) &gt; 10;
</pre><p>
          (This did not work in some older versions of MySQL.)
        </p></li><li class="listitem"><p>
          MySQL permits duplicate column names. That is, there can be
          more than one <em class="replaceable"><code>select_expr</code></em> with the
          same name. This is an extension to standard SQL. Because MySQL
          also permits <code class="literal">GROUP BY</code> and
          <code class="literal">HAVING</code> to refer to
          <em class="replaceable"><code>select_expr</code></em> values, this can result
          in an ambiguity:
        </p><pre class="programlisting">
SELECT 12 AS a, a FROM t GROUP BY a;
</pre><p>
          In that statement, both columns have the name
          <code class="literal">a</code>. To ensure that the correct column is
          used for grouping, use different names for each
          <em class="replaceable"><code>select_expr</code></em>.
        </p></li><li class="listitem"><p>
          MySQL resolves unqualified column or alias references in
          <code class="literal">ORDER BY</code> clauses by searching in the
          <em class="replaceable"><code>select_expr</code></em> values, then in the
          columns of the tables in the <code class="literal">FROM</code> clause.
          For <code class="literal">GROUP BY</code> or <code class="literal">HAVING</code>
          clauses, it searches the <code class="literal">FROM</code> clause before
          searching in the <em class="replaceable"><code>select_expr</code></em>
          values. (For <code class="literal">GROUP BY</code> and
          <code class="literal">HAVING</code>, this differs from the pre-MySQL 5.0
          behavior that used the same rules as for <code class="literal">ORDER
          BY</code>.)
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148162048"></a>

          The <code class="literal">LIMIT</code> clause can be used to constrain
          the number of rows returned by the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
          <code class="literal">LIMIT</code> takes one or two numeric arguments,
          which must both be nonnegative integer constants, with these
          exceptions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              Within prepared statements, <code class="literal">LIMIT</code>
              parameters can be specified using <code class="literal">?</code>
              placeholder markers.
            </p></li><li class="listitem"><p>
              Within stored programs, <code class="literal">LIMIT</code>
              parameters can be specified using integer-valued routine
              parameters or local variables.
</p></li></ul>
</div>
<p>
          With two arguments, the first argument specifies the offset of
          the first row to return, and the second specifies the maximum
          number of rows to return. The offset of the initial row is 0
          (not 1):
        </p><pre class="programlisting">
SELECT * FROM tbl LIMIT 5,10;  # Retrieve rows 6-15
</pre><p>
          To retrieve all rows from a certain offset up to the end of
          the result set, you can use some large number for the second
          parameter. This statement retrieves all rows from the 96th row
          to the last:
        </p><pre class="programlisting">
SELECT * FROM tbl LIMIT 95,18446744073709551615;
</pre><p>
          With one argument, the value specifies the number of rows to
          return from the beginning of the result set:
        </p><pre class="programlisting">
SELECT * FROM tbl LIMIT 5;     # Retrieve first 5 rows
</pre><p>
          In other words, <code class="literal">LIMIT
          <em class="replaceable"><code>row_count</code></em></code> is equivalent
          to <code class="literal">LIMIT 0,
          <em class="replaceable"><code>row_count</code></em></code>.
        </p><p>
          For prepared statements, you can use placeholders. The
          following statements will return one row from the
          <code class="literal">tbl</code> table:
        </p><pre class="programlisting">
SET @a=1;
PREPARE STMT FROM 'SELECT * FROM tbl LIMIT ?';
EXECUTE STMT USING @a;
</pre><p>
          The following statements will return the second to sixth row
          from the <code class="literal">tbl</code> table:
        </p><pre class="programlisting">
SET @skip=1; SET @numrows=5;
PREPARE STMT FROM 'SELECT * FROM tbl LIMIT ?, ?';
EXECUTE STMT USING @skip, @numrows;
</pre><p>
          For compatibility with PostgreSQL, MySQL also supports the
          <code class="literal">LIMIT <em class="replaceable"><code>row_count</code></em> OFFSET
          <em class="replaceable"><code>offset</code></em></code> syntax.
        </p><p>
          If <code class="literal">LIMIT</code> occurs within a subquery and also
          is applied in the outer query, the outermost
          <code class="literal">LIMIT</code> takes precedence. For example, the
          following statement produces two rows, not one:
        </p><pre class="programlisting">
(SELECT ... LIMIT 1) LIMIT 2;
</pre></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148137904"></a>

          A <code class="literal">PROCEDURE</code> clause names a procedure that
          should process the data in the result set. For an example, see
          <a class="xref" href="optimization.html#procedure-analyse" title="8.4.2.4 Using PROCEDURE ANALYSE">Section 8.4.2.4, “Using PROCEDURE ANALYSE”</a>, which describes
          <code class="literal">ANALYSE</code>, a procedure that can be used to
          obtain suggestions for optimal column data types that may help
          reduce table sizes.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
          INTO</code></a> form of <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
          enables the query result to be written to a file or stored in
          variables. For more information, see
          <a class="xref" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax">Section 13.2.9.1, “SELECT ... INTO Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148129616"></a>

          <a class="indexterm" name="idm139737148128544"></a>

          If you use <code class="literal">FOR UPDATE</code> with a storage engine
          that uses page or row locks, rows examined by the query are
          write-locked until the end of the current transaction. Using
          <code class="literal">LOCK IN SHARE MODE</code> sets a shared lock that
          permits other transactions to read the examined rows but not
          to update or delete them. See
          <a class="xref" href="innodb-storage-engine.html#innodb-locking-reads" title="14.2.2.3 Locking Reads (SELECT ... FOR UPDATE and SELECT ... LOCK IN SHARE MODE)">Section 14.2.2.3, “Locking Reads (SELECT ... FOR UPDATE and SELECT ... LOCK IN SHARE MODE)”</a>.
        </p><p>
          In addition, you cannot use <code class="literal">FOR UPDATE</code> as
          part of the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> in a
          statement such as
          <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
          TABLE <em class="replaceable"><code>new_table</code></em> SELECT ... FROM
          <em class="replaceable"><code>old_table</code></em> ...</code></a>. (If you
          attempt to do so, the statement is rejected with the error
          <span class="errortext">Can't update table
          '<em class="replaceable"><code>old_table</code></em>' while
          '<em class="replaceable"><code>new_table</code></em>' is being
          created</span>.) This is a change in behavior from MySQL
          5.5 and earlier, which permitted
          <a class="link" href="sql-syntax.html#create-table-select" title="13.1.17.2 CREATE TABLE ... SELECT Syntax"><code class="literal">CREATE
          TABLE ... SELECT</code></a> statements to make changes in
          tables other than the table being created.
</p></li></ul>
</div>
<p>
      Following the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> keyword, you
      can use a number of options that affect the operation of the
      statement. <code class="literal">HIGH_PRIORITY</code>,
      <code class="literal">STRAIGHT_JOIN</code>, and options beginning with
      <code class="literal">SQL_</code> are MySQL extensions to standard SQL.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm139737148112336"></a>

          <a class="indexterm" name="idm139737148111296"></a>

          <a class="indexterm" name="idm139737148110224"></a>

          The <code class="literal">ALL</code> and <code class="literal">DISTINCT</code>
          options specify whether duplicate rows should be returned.
          <code class="literal">ALL</code> (the default) specifies that all
          matching rows should be returned, including duplicates.
          <code class="literal">DISTINCT</code> specifies removal of duplicate
          rows from the result set. It is an error to specify both
          options. <code class="literal">DISTINCTROW</code> is a synonym for
          <code class="literal">DISTINCT</code>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148103824"></a>

          <code class="literal">HIGH_PRIORITY</code> gives the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> higher priority than a
          statement that updates a table. You should use this only for
          queries that are very fast and must be done at once. A
          <code class="literal">SELECT HIGH_PRIORITY</code> query that is issued
          while the table is locked for reading runs even if there is an
          update statement waiting for the table to be free. This
          affects only storage engines that use only table-level locking
          (such as <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>,
          and <code class="literal">MERGE</code>).
        </p><p>
          <code class="literal">HIGH_PRIORITY</code> cannot be used with
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements that are part
          of a <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148093168"></a>

          <code class="literal">STRAIGHT_JOIN</code> forces the optimizer to join
          the tables in the order in which they are listed in the
          <code class="literal">FROM</code> clause. You can use this to speed up a
          query if the optimizer joins the tables in nonoptimal order.
          <code class="literal">STRAIGHT_JOIN</code> also can be used in the
          <em class="replaceable"><code>table_references</code></em> list. See
          <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>.
        </p><p>
          <a class="indexterm" name="idm139737148088208"></a>

          <a class="indexterm" name="idm139737148086720"></a>

          <code class="literal">STRAIGHT_JOIN</code> does not apply to any table
          that the optimizer treats as a
          <a class="link" href="optimization.html#jointype_const"><code class="literal">const</code></a> or
          <a class="link" href="optimization.html#jointype_system"><code class="literal">system</code></a> table. Such a table
          produces a single row, is read during the optimization phase
          of query execution, and references to its columns are replaced
          with the appropriate column values before query execution
          proceeds. These tables will appear first in the query plan
          displayed by <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>. See
          <a class="xref" href="optimization.html#using-explain" title="8.8.1 Optimizing Queries with EXPLAIN">Section 8.8.1, “Optimizing Queries with EXPLAIN”</a>. This exception may not apply
          to <a class="link" href="optimization.html#jointype_const"><code class="literal">const</code></a> or
          <a class="link" href="optimization.html#jointype_system"><code class="literal">system</code></a> tables that are used
          on the <code class="literal">NULL</code>-complemented side of an outer
          join (that is, the right-side table of a <code class="literal">LEFT
          JOIN</code> or the left-side table of a <code class="literal">RIGHT
          JOIN</code>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148074256"></a>

          <a class="indexterm" name="idm139737148073184"></a>

          <code class="literal">SQL_BIG_RESULT</code> or
          <code class="literal">SQL_SMALL_RESULT</code> can be used with
          <code class="literal">GROUP BY</code> or <code class="literal">DISTINCT</code> to
          tell the optimizer that the result set has many rows or is
          small, respectively. For <code class="literal">SQL_BIG_RESULT</code>,
          MySQL directly uses disk-based temporary tables if needed, and
          prefers sorting to using a temporary table with a key on the
          <code class="literal">GROUP BY</code> elements. For
          <code class="literal">SQL_SMALL_RESULT</code>, MySQL uses fast temporary
          tables to store the resulting table instead of using sorting.
          This should not normally be needed.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148065888"></a>

          <code class="literal">SQL_BUFFER_RESULT</code> forces the result to be
          put into a temporary table. This helps MySQL free the table
          locks early and helps in cases where it takes a long time to
          send the result set to the client. This option can be used
          only for top-level <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
          statements, not for subqueries or following
          <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148060560"></a>

          <code class="literal">SQL_CALC_FOUND_ROWS</code> tells MySQL to
          calculate how many rows there would be in the result set,
          disregarding any <code class="literal">LIMIT</code> clause. The number
          of rows can then be retrieved with <code class="literal">SELECT
          FOUND_ROWS()</code>. See
          <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737148055728"></a>

          <a class="indexterm" name="idm139737148054656"></a>

          The <code class="literal">SQL_CACHE</code> and
          <code class="literal">SQL_NO_CACHE</code> options affect caching of
          query results in the query cache (see
          <a class="xref" href="optimization.html#query-cache" title="8.10.3 The MySQL Query Cache">Section 8.10.3, “The MySQL Query Cache”</a>). <code class="literal">SQL_CACHE</code>
          tells MySQL to store the result in the query cache if it is
          cacheable and the value of the
          <a class="link" href="server-administration.html#sysvar_query_cache_type"><code class="literal">query_cache_type</code></a> system
          variable is <code class="literal">2</code> or <code class="literal">DEMAND</code>.
          With <code class="literal">SQL_NO_CACHE</code>, the server does not use
          the query cache. It neither checks the query cache to see
          whether the result is already cached, nor does it cache the
          query result. (Due to a limitation in the parser, a space
          character must precede and follow the
          <code class="literal">SQL_NO_CACHE</code> keyword; a nonspace such as a
          newline causes the server to check the query cache to see
          whether the result is already cached.)
        </p><p>
          For views, <code class="literal">SQL_NO_CACHE</code> applies if it
          appears in any <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> in the
          query. For a cacheable query, <code class="literal">SQL_CACHE</code>
          applies if it appears in the first
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> of a view referred to by
          the query.
        </p><p>
          In MySQL 5.6, these two options are mutually
          exclusive and an error occurs if they are both specified.
          Also, these options are not permitted in subqueries (including
          subqueries in the <code class="literal">FROM</code> clause), and
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements in unions
          other than the first <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>.
</p></li></ul>
</div>
<p>
      Prior to MySQL 5.6.6, a <code class="literal">SELECT</code> from a
      partitioned table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locked all partitions of the table. This was true even for
      <code class="literal">SELECT ... PARTITION</code> queries. (This did not and
      does not occur with storage engines such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level
      locking.) In MySQL 5.6.6 and later, MySQL uses partition lock
      pruning, so that only partitions containing rows matching the
      <code class="literal">SELECT</code> statement's
      <code class="literal">WHERE</code> clause are actually locked. For more
      information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="select-into"></a>13.2.9.1 SELECT ... INTO Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737148029344"></a><a class="indexterm" name="idm139737148027856"></a><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
        INTO</code></a> form of <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        enables a query result to be stored in variables or written to a
        file:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">SELECT ... INTO
            <em class="replaceable"><code>var_list</code></em></code> selects column
            values and stores them into variables.
          </p></li><li class="listitem"><p>
            <code class="literal">SELECT ... INTO OUTFILE</code> writes the
            selected rows to a file. Column and line terminators can be
            specified to produce a specific output format.
          </p></li><li class="listitem"><p>
            <code class="literal">SELECT ... INTO DUMPFILE</code> writes a single
            row to a file without any formatting.
</p></li></ul>
</div>
<p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> syntax description
        (see <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>) shows the <code class="literal">INTO</code>
        clause near the end of the statement. It is also possible to use
        <code class="literal">INTO</code> immediately following the
        <em class="replaceable"><code>select_expr</code></em> list.
      </p><p>
        An <code class="literal">INTO</code> clause should not be used in a nested
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> because such a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> must return its result to
        the outer context.
      </p><p>
        The <code class="literal">INTO</code> clause can name a list of one or
        more variables, which can be user-defined variables, stored
        procedure or function parameters, or stored program local
        variables. (Within a prepared <code class="literal">SELECT ... INTO
        OUTFILE</code> statement, only user-defined variables are
        permitted;see <a class="xref" href="sql-syntax.html#local-variable-scope" title="13.6.4.2 Local Variable Scope and Resolution">Section 13.6.4.2, “Local Variable Scope and Resolution”</a>.)
      </p><p>
        The selected values are assigned to the variables. The number of
        variables must match the number of columns. The query should
        return a single row. If the query returns no rows, a warning
        with error code 1329 occurs (<code class="literal">No data</code>), and
        the variable values remain unchanged. If the query returns
        multiple rows, error 1172 occurs (<code class="literal">Result consisted of
        more than one row</code>). If it is possible that the
        statement may retrieve multiple rows, you can use <code class="literal">LIMIT
        1</code> to limit the result set to a single row.
      </p><pre class="programlisting">
SELECT id, data INTO @x, @y FROM test.t1 LIMIT 1;
</pre><p>
        User variable names are not case sensitive. See
        <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
      </p><a class="indexterm" name="idm139737148002144"></a><a class="indexterm" name="idm139737148001072"></a><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE '<em class="replaceable"><code>file_name</code></em>'</code></a> form of
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> writes the selected rows
        to a file. The file is created on the server host, so you must
        have the <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a> privilege to use
        this syntax. <em class="replaceable"><code>file_name</code></em> cannot be an
        existing file, which among other things prevents files such as
        <code class="filename">/etc/passwd</code> and database tables from being
        destroyed. The
        <a class="link" href="server-administration.html#sysvar_character_set_filesystem"><code class="literal">character_set_filesystem</code></a> system
        variable controls the interpretation of the file name.
      </p><p>
        The <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> statement is intended primarily to let you
        very quickly dump a table to a text file on the server machine.
        If you want to create the resulting file on some other host than
        the server host, you normally cannot use
        <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> since there is no way to write a path to the
        file relative to the server host's file system.
      </p><p>
        However, if the MySQL client software is installed on the remote
        machine, you can instead use a client command such as
        <code class="literal">mysql -e "SELECT ..." &gt;
        <em class="replaceable"><code>file_name</code></em></code> to generate the
        file on the client host.
      </p><p>
        It is also possible to create the resulting file on a different
        host other than the server host, if the location of the file on
        the remote host can be accessed using a network-mapped path on
        the server's file system. In this case, the presence of
        <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> (or some other MySQL client program) is
        not required on the target host.
      </p><p>
        <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ... INTO
        OUTFILE</code></a> is the complement of
        <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
        INFILE</code></a>. Column values are written converted to the
        character set specified in the <code class="literal">CHARACTER SET</code>
        clause. If no such clause is present, values are dumped using
        the <code class="literal">binary</code> character set. In effect, there is
        no character set conversion. If a result set contains columns in
        several character sets, the output data file will as well and
        you may not be able to reload the file correctly.
      </p><p>
        The syntax for the <em class="replaceable"><code>export_options</code></em>
        part of the statement consists of the same
        <code class="literal">FIELDS</code> and <code class="literal">LINES</code> clauses
        that are used with the
        <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> statement. See <a class="xref" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax">Section 13.2.6, “LOAD DATA INFILE Syntax”</a>, for
        information about the <code class="literal">FIELDS</code> and
        <code class="literal">LINES</code> clauses, including their default values
        and permissible values.
      </p><p>
        <code class="literal">FIELDS ESCAPED BY</code> controls how to write
        special characters. If the <code class="literal">FIELDS ESCAPED BY</code>
        character is not empty, it is used when necessary to avoid
        ambiguity as a prefix that precedes following characters on
        output:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The <code class="literal">FIELDS ESCAPED BY</code> character
          </p></li><li class="listitem"><p>
            The <code class="literal">FIELDS [OPTIONALLY] ENCLOSED BY</code>
            character
          </p></li><li class="listitem"><p>
            The first character of the <code class="literal">FIELDS TERMINATED
            BY</code> and <code class="literal">LINES TERMINATED BY</code>
            values
          </p></li><li class="listitem"><p>
            ASCII <code class="literal">NUL</code> (the zero-valued byte; what is
            actually written following the escape character is ASCII
            <span class="quote">“<span class="quote"><code class="literal">0</code></span>”</span>, not a zero-valued byte)
</p></li></ul>
</div>
<p>
        The <code class="literal">FIELDS TERMINATED BY</code>, <code class="literal">ENCLOSED
        BY</code>, <code class="literal">ESCAPED BY</code>, or <code class="literal">LINES
        TERMINATED BY</code> characters <span class="emphasis"><em>must</em></span> be
        escaped so that you can read the file back in reliably. ASCII
        <code class="literal">NUL</code> is escaped to make it easier to view with
        some pagers.
      </p><p>
        The resulting file does not have to conform to SQL syntax, so
        nothing else need be escaped.
      </p><p>
        If the <code class="literal">FIELDS ESCAPED BY</code> character is empty,
        no characters are escaped and <code class="literal">NULL</code> is output
        as <code class="literal">NULL</code>, not <code class="literal">\N</code>. It is
        probably not a good idea to specify an empty escape character,
        particularly if field values in your data contain any of the
        characters in the list just given.
      </p><a class="indexterm" name="idm139737147956624"></a><a class="indexterm" name="idm139737147955552"></a><p>
        Here is an example that produces a file in the comma-separated
        values (CSV) format used by many programs:
      </p><pre class="programlisting">
SELECT a,b,a+b INTO OUTFILE '/tmp/result.txt'
  FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"'
  LINES TERMINATED BY '\n'
  FROM test_table;
</pre><a class="indexterm" name="idm139737147953120"></a><p>
        If you use <code class="literal">INTO DUMPFILE</code> instead of
        <code class="literal">INTO OUTFILE</code>, MySQL writes only one row into
        the file, without any column or line termination and without
        performing any escape processing. This is useful if you want to
        store a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> value in a file.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Any file created by <code class="literal">INTO OUTFILE</code> or
          <code class="literal">INTO DUMPFILE</code> is writable by all users on
          the server host. The reason for this is that the MySQL server
          cannot create a file that is owned by anyone other than the
          user under whose account it is running. (You should
          <span class="emphasis"><em>never</em></span> run <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> as
          <code class="literal">root</code> for this and other reasons.) The file
          thus must be world-writable so that you can manipulate its
          contents.
        </p><p>
          If the <a class="link" href="server-administration.html#sysvar_secure_file_priv"><code class="literal">secure_file_priv</code></a>
          system variable is set to a nonempty directory name, the file
          to be written must be located in that directory.
</p>
</div>
<p>
        In the context of
        <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
        INTO</code></a> statements that occur as part of events executed
        by the Event Scheduler, diagnostics messages (not only errors,
        but also warnings) are written to the error log, and, on
        Windows, to the application event log. For additional
        information, see <a class="xref" href="stored-programs-views.html#events-status-info" title="20.4.5 Event Scheduler Status">Section 20.4.5, “Event Scheduler Status”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="join"></a>13.2.9.2 JOIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147938160"></a><a class="indexterm" name="idm139737147937088"></a><a class="indexterm" name="idm139737147936016"></a><a class="indexterm" name="idm139737147934944"></a><a class="indexterm" name="idm139737147933872"></a><a class="indexterm" name="idm139737147932800"></a><a class="indexterm" name="idm139737147931728"></a><a class="indexterm" name="idm139737147930656"></a><a class="indexterm" name="idm139737147929584"></a><a class="indexterm" name="idm139737147928512"></a><a class="indexterm" name="idm139737147927440"></a><a class="indexterm" name="idm139737147926352"></a><a class="indexterm" name="idm139737147925280"></a><p>
        MySQL supports the following <code class="literal">JOIN</code> syntaxes
        for the <em class="replaceable"><code>table_references</code></em> part of
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements and
        multiple-table <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> and
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements:
      </p><pre class="programlisting">
<em class="replaceable"><code>table_references:</code></em>
    <em class="replaceable"><code>escaped_table_reference</code></em> [, <em class="replaceable"><code>escaped_table_reference</code></em>] ...

<em class="replaceable"><code>escaped_table_reference</code></em>:
    <em class="replaceable"><code>table_reference</code></em>
  | { OJ <em class="replaceable"><code>table_reference</code></em> }

<em class="replaceable"><code>table_reference</code></em>:
    <em class="replaceable"><code>table_factor</code></em>
  | <em class="replaceable"><code>join_table</code></em>

<em class="replaceable"><code>table_factor</code></em>:
    <em class="replaceable"><code>tbl_name</code></em> [PARTITION (<em class="replaceable"><code>partition_names</code></em>)] 
        [[AS] <em class="replaceable"><code>alias</code></em>] [<em class="replaceable"><code>index_hint_list</code></em>]
  | <em class="replaceable"><code>table_subquery</code></em> [AS] <em class="replaceable"><code>alias</code></em>
  | ( <em class="replaceable"><code>table_references</code></em> )

<em class="replaceable"><code>join_table</code></em>:
    <em class="replaceable"><code>table_reference</code></em> [INNER | CROSS] JOIN <em class="replaceable"><code>table_factor</code></em> [<em class="replaceable"><code>join_condition</code></em>]
  | <em class="replaceable"><code>table_reference</code></em> STRAIGHT_JOIN <em class="replaceable"><code>table_factor</code></em>
  | <em class="replaceable"><code>table_reference</code></em> STRAIGHT_JOIN <em class="replaceable"><code>table_factor</code></em> ON <em class="replaceable"><code>conditional_expr</code></em>
  | <em class="replaceable"><code>table_reference</code></em> {LEFT|RIGHT} [OUTER] JOIN <em class="replaceable"><code>table_reference</code></em> <em class="replaceable"><code>join_condition</code></em>
  | <em class="replaceable"><code>table_reference</code></em> NATURAL [{LEFT|RIGHT} [OUTER]] JOIN <em class="replaceable"><code>table_factor</code></em>

<em class="replaceable"><code>join_condition</code></em>:
    ON <em class="replaceable"><code>conditional_expr</code></em>
  | USING (<em class="replaceable"><code>column_list</code></em>)

<em class="replaceable"><code>index_hint_list</code></em>:
    <em class="replaceable"><code>index_hint</code></em> [, <em class="replaceable"><code>index_hint</code></em>] ...

<em class="replaceable"><code>index_hint</code></em>:
    USE {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] ([<em class="replaceable"><code>index_list</code></em>])
  | IGNORE {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] (<em class="replaceable"><code>index_list</code></em>)
  | FORCE {INDEX|KEY}
      [FOR {JOIN|ORDER BY|GROUP BY}] (<em class="replaceable"><code>index_list</code></em>)

<em class="replaceable"><code>index_list</code></em>:
    <em class="replaceable"><code>index_name</code></em> [, <em class="replaceable"><code>index_name</code></em>] ...
</pre><p>
        A table reference is also known as a join expression.
      </p><p>
        In MySQL 5.6.2 and later, a table reference (when it refers to a
        partitioned table) may contain a <code class="literal">PARTITION</code>
        option, including a comma-separated list of partitions,
        subpartitions, or both. This option follows the name of the
        table and precedes any alias declaration. The effect of this
        option is that rows are selected only from the listed partitions
        or subpartitions—in other words, any partitions or
        subpartitions not named in the list are ignored For more
        information, see <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>.
      </p><p>
        The syntax of <em class="replaceable"><code>table_factor</code></em> is
        extended in comparison with the SQL Standard. The latter accepts
        only <em class="replaceable"><code>table_reference</code></em>, not a list of
        them inside a pair of parentheses.
      </p><p>
        This is a conservative extension if we consider each comma in a
        list of <em class="replaceable"><code>table_reference</code></em> items as
        equivalent to an inner join. For example:
      </p><pre class="programlisting">
SELECT * FROM t1 LEFT JOIN (t2, t3, t4)
                 ON (t2.a=t1.a AND t3.b=t1.b AND t4.c=t1.c)
</pre><p>
        is equivalent to:
      </p><pre class="programlisting">
SELECT * FROM t1 LEFT JOIN (t2 CROSS JOIN t3 CROSS JOIN t4)
                 ON (t2.a=t1.a AND t3.b=t1.b AND t4.c=t1.c)
</pre><p>
        In MySQL, <code class="literal">JOIN</code>, <code class="literal">CROSS
        JOIN</code>, and <code class="literal">INNER JOIN</code> are syntactic
        equivalents (they can replace each other). In standard SQL, they
        are not equivalent. <code class="literal">INNER JOIN</code> is used with
        an <code class="literal">ON</code> clause, <code class="literal">CROSS JOIN</code>
        is used otherwise.
      </p><p>
        In general, parentheses can be ignored in join expressions
        containing only inner join operations. MySQL also supports
        nested joins (see <a class="xref" href="optimization.html#nested-join-optimization" title="8.2.1.11 Nested Join Optimization">Section 8.2.1.11, “Nested Join Optimization”</a>).
      </p><p>
        Index hints can be specified to affect how the MySQL optimizer
        makes use of indexes. For more information, see
        <a class="xref" href="optimization.html#index-hints" title="8.9.3 Index Hints">Section 8.9.3, “Index Hints”</a>.
      </p><p>
        The following list describes general factors to take into
        account when writing joins.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A table reference can be aliased using
            <code class="literal"><em class="replaceable"><code>tbl_name</code></em> AS
            <em class="replaceable"><code>alias_name</code></em></code> or
            <em class="replaceable"><code>tbl_name alias_name</code></em>:
          </p><pre class="programlisting">
SELECT t1.name, t2.salary
  FROM employee AS t1 INNER JOIN info AS t2 ON t1.name = t2.name;

SELECT t1.name, t2.salary
  FROM employee t1 INNER JOIN info t2 ON t1.name = t2.name;
</pre></li><li class="listitem"><p>
            A <em class="replaceable"><code>table_subquery</code></em> is also known as
            a subquery in the <code class="literal">FROM</code> clause. Such
            subqueries <span class="emphasis"><em>must</em></span> include an alias to
            give the subquery result a table name. A trivial example
            follows; see also <a class="xref" href="sql-syntax.html#from-clause-subqueries" title="13.2.10.8 Subqueries in the FROM Clause">Section 13.2.10.8, “Subqueries in the FROM Clause”</a>.
          </p><pre class="programlisting">
SELECT * FROM (SELECT 1, 2, 3) AS t1;
</pre></li><li class="listitem"><p>
            <code class="literal">INNER JOIN</code> and <code class="literal">,</code>
            (comma) are semantically equivalent in the absence of a join
            condition: both produce a Cartesian product between the
            specified tables (that is, each and every row in the first
            table is joined to each and every row in the second table).
          </p><p>
            However, the precedence of the comma operator is less than
            of <code class="literal">INNER JOIN</code>, <code class="literal">CROSS
            JOIN</code>, <code class="literal">LEFT JOIN</code>, and so on. If
            you mix comma joins with the other join types when there is
            a join condition, an error of the form <code class="literal">Unknown
            column '<em class="replaceable"><code>col_name</code></em>' in 'on
            clause'</code> may occur. Information about dealing with
            this problem is given later in this section.
          </p></li><li class="listitem"><p>
            The <em class="replaceable"><code>conditional_expr</code></em> used with
            <code class="literal">ON</code> is any conditional expression of the
            form that can be used in a <code class="literal">WHERE</code> clause.
            Generally, you should use the <code class="literal">ON</code> clause
            for conditions that specify how to join tables, and the
            <code class="literal">WHERE</code> clause to restrict which rows you
            want in the result set.
          </p></li><li class="listitem"><p>
            If there is no matching row for the right table in the
            <code class="literal">ON</code> or <code class="literal">USING</code> part in a
            <code class="literal">LEFT JOIN</code>, a row with all columns set to
            <code class="literal">NULL</code> is used for the right table. You can
            use this fact to find rows in a table that have no
            counterpart in another table:
          </p><pre class="programlisting">
SELECT left_tbl.*
  FROM left_tbl LEFT JOIN right_tbl ON left_tbl.id = right_tbl.id
  WHERE right_tbl.id IS NULL;
</pre><p>
            This example finds all rows in <code class="literal">left_tbl</code>
            with an <code class="literal">id</code> value that is not present in
            <code class="literal">right_tbl</code> (that is, all rows in
            <code class="literal">left_tbl</code> with no corresponding row in
            <code class="literal">right_tbl</code>). This assumes that
            <code class="literal">right_tbl.id</code> is declared <code class="literal">NOT
            NULL</code>. See
            <a class="xref" href="optimization.html#left-join-optimization" title="8.2.1.9 LEFT JOIN and RIGHT JOIN Optimization">Section 8.2.1.9, “LEFT JOIN and RIGHT JOIN Optimization”</a>.
          </p></li><li class="listitem"><p>
            The
            <code class="literal">USING(<em class="replaceable"><code>column_list</code></em>)</code>
            clause names a list of columns that must exist in both
            tables. If tables <code class="literal">a</code> and
            <code class="literal">b</code> both contain columns
            <code class="literal">c1</code>, <code class="literal">c2</code>, and
            <code class="literal">c3</code>, the following join compares
            corresponding columns from the two tables:
          </p><pre class="programlisting">
a LEFT JOIN b USING (c1,c2,c3)
</pre></li><li class="listitem"><p>
            The <code class="literal">NATURAL [LEFT] JOIN</code> of two tables is
            defined to be semantically equivalent to an <code class="literal">INNER
            JOIN</code> or a <code class="literal">LEFT JOIN</code> with a
            <code class="literal">USING</code> clause that names all columns that
            exist in both tables.
          </p></li><li class="listitem"><p>
            <code class="literal">RIGHT JOIN</code> works analogously to
            <code class="literal">LEFT JOIN</code>. To keep code portable across
            databases, it is recommended that you use <code class="literal">LEFT
            JOIN</code> instead of <code class="literal">RIGHT JOIN</code>.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737147836192"></a>

            <a class="indexterm" name="idm139737147835120"></a>

            The <code class="literal">{ OJ ... }</code> syntax shown in the join
            syntax description exists only for compatibility with ODBC.
            The curly braces in the syntax should be written literally;
            they are not metasyntax as used elsewhere in syntax
            descriptions.
          </p><pre class="programlisting">
SELECT left_tbl.*
    FROM { OJ left_tbl LEFT OUTER JOIN right_tbl ON left_tbl.id = right_tbl.id }
    WHERE right_tbl.id IS NULL;
</pre><p>
            You can use other types of joins within <code class="literal">{ OJ ...
            }</code>, such as <code class="literal">INNER JOIN</code> or
            <code class="literal">RIGHT OUTER JOIN</code>. This helps with
            compatibility with some third-party applications, but is not
            official ODBC syntax.
          </p></li><li class="listitem"><p>
            <code class="literal">STRAIGHT_JOIN</code> is similar to
            <code class="literal">JOIN</code>, except that the left table is
            always read before the right table. This can be used for
            those (few) cases for which the join optimizer puts the
            tables in the wrong order.
</p></li></ul>
</div>
<p>
        Some join examples:
      </p><pre class="programlisting">
SELECT * FROM table1, table2;

SELECT * FROM table1 INNER JOIN table2 ON table1.id=table2.id;

SELECT * FROM table1 LEFT JOIN table2 ON table1.id=table2.id;

SELECT * FROM table1 LEFT JOIN table2 USING (id);

SELECT * FROM table1 LEFT JOIN table2 ON table1.id=table2.id
  LEFT JOIN table3 ON table2.id=table3.id;
</pre><p>
        <span class="bold"><strong>Join Processing Changes in MySQL
        5.0.12</strong></span>
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Natural joins and joins with <code class="literal">USING</code>,
          including outer join variants, are processed according to the
          SQL:2003 standard. The goal was to align the syntax and
          semantics of MySQL with respect to <code class="literal">NATURAL
          JOIN</code> and <code class="literal">JOIN ... USING</code> according
          to SQL:2003. However, these changes in join processing can
          result in different output columns for some joins. Also, some
          queries that appeared to work correctly in older versions
          (prior to 5.0.12) must be rewritten to comply with the
          standard.
</p>
</div>
<p>
        These changes have five main aspects:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The way that MySQL determines the result columns of
            <code class="literal">NATURAL</code> or <code class="literal">USING</code> join
            operations (and thus the result of the entire
            <code class="literal">FROM</code> clause).
          </p></li><li class="listitem"><p>
            Expansion of <code class="literal">SELECT *</code> and <code class="literal">SELECT
            <em class="replaceable"><code>tbl_name</code></em>.*</code> into a list
            of selected columns.
          </p></li><li class="listitem"><p>
            Resolution of column names in <code class="literal">NATURAL</code> or
            <code class="literal">USING</code> joins.
          </p></li><li class="listitem"><p>
            Transformation of <code class="literal">NATURAL</code> or
            <code class="literal">USING</code> joins into <code class="literal">JOIN ...
            ON</code>.
          </p></li><li class="listitem"><p>
            Resolution of column names in the <code class="literal">ON</code>
            condition of a <code class="literal">JOIN ... ON</code>.
</p></li></ul>
</div>
<p>
        The following list provides more detail about several effects of
        current join processing versus join processing in older
        versions. The term <span class="quote">“<span class="quote">previously</span>”</span> means <span class="quote">“<span class="quote">prior
        to MySQL 5.0.12.</span>”</span>
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The columns of a <code class="literal">NATURAL</code> join or a
            <code class="literal">USING</code> join may be different from
            previously. Specifically, redundant output columns no longer
            appear, and the order of columns for <code class="literal">SELECT
            *</code> expansion may be different from before.
          </p><p>
            Consider this set of statements:
          </p><pre class="programlisting">
CREATE TABLE t1 (i INT, j INT);
CREATE TABLE t2 (k INT, j INT);
INSERT INTO t1 VALUES(1,1);
INSERT INTO t2 VALUES(1,1);
SELECT * FROM t1 NATURAL JOIN t2;
SELECT * FROM t1 JOIN t2 USING (j);
</pre><p>
            Previously, the statements produced this output:
          </p><pre class="programlisting">
+------+------+------+------+
| i    | j    | k    | j    |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
+------+------+------+------+
+------+------+------+------+
| i    | j    | k    | j    |
+------+------+------+------+
|    1 |    1 |    1 |    1 |
+------+------+------+------+
</pre><p>
            In the first <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
            statement, column <code class="literal">j</code> appears in both
            tables and thus becomes a join column, so, according to
            standard SQL, it should appear only once in the output, not
            twice. Similarly, in the second SELECT statement, column
            <code class="literal">j</code> is named in the
            <code class="literal">USING</code> clause and should appear only once
            in the output, not twice. But in both cases, the redundant
            column is not eliminated. Also, the order of the columns is
            not correct according to standard SQL.
          </p><p>
            Now the statements produce this output:
          </p><pre class="programlisting">
+------+------+------+
| j    | i    | k    |
+------+------+------+
|    1 |    1 |    1 |
+------+------+------+
+------+------+------+
| j    | i    | k    |
+------+------+------+
|    1 |    1 |    1 |
+------+------+------+
</pre><p>
            The redundant column is eliminated and the column order is
            correct according to standard SQL:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                First, coalesced common columns of the two joined
                tables, in the order in which they occur in the first
                table
              </p></li><li class="listitem"><p>
                Second, columns unique to the first table, in order in
                which they occur in that table
              </p></li><li class="listitem"><p>
                Third, columns unique to the second table, in order in
                which they occur in that table
</p></li></ul>
</div>
<p>
            The single result column that replaces two common columns is
            defined using the coalesce operation. That is, for two
            <code class="literal">t1.a</code> and <code class="literal">t2.a</code> the
            resulting single join column <code class="literal">a</code> is defined
            as <code class="literal">a = COALESCE(t1.a, t2.a)</code>, where:
          </p><pre class="programlisting">
COALESCE(x, y) = (CASE WHEN V1 IS NOT NULL THEN V1 ELSE V2 END)
</pre><p>
            If the join operation is any other join, the result columns
            of the join consists of the concatenation of all columns of
            the joined tables. This is the same as previously.
          </p><p>
            A consequence of the definition of coalesced columns is
            that, for outer joins, the coalesced column contains the
            value of the non-<code class="literal">NULL</code> column if one of
            the two columns is always <code class="literal">NULL</code>. If
            neither or both columns are <code class="literal">NULL</code>, both
            common columns have the same value, so it doesn't matter
            which one is chosen as the value of the coalesced column. A
            simple way to interpret this is to consider that a coalesced
            column of an outer join is represented by the common column
            of the inner table of a <code class="literal">JOIN</code>. Suppose
            that the tables <code class="literal">t1(a,b)</code> and
            <code class="literal">t2(a,c)</code> have the following contents:
          </p><pre class="programlisting">
t1    t2
----  ----
1 x   2 z
2 y   3 w
</pre><p>
            Then:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 NATURAL LEFT JOIN t2;</code></strong>
+------+------+------+
| a    | b    | c    |
+------+------+------+
|    1 | x    | NULL |
|    2 | y    | z    |
+------+------+------+
</pre><p>
            Here column <code class="literal">a</code> contains the values of
            <code class="literal">t1.a</code>.
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 NATURAL RIGHT JOIN t2;</code></strong>
+------+------+------+
| a    | c    | b    |
+------+------+------+
|    2 | z    | y    |
|    3 | w    | NULL |
+------+------+------+
</pre><p>
            Here column <code class="literal">a</code> contains the values of
            <code class="literal">t2.a</code>.
          </p><p>
            Compare these results to the otherwise equivalent queries
            with <code class="literal">JOIN ... ON</code>:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 LEFT JOIN t2 ON (t1.a = t2.a);</code></strong>
+------+------+------+------+
| a    | b    | a    | c    |
+------+------+------+------+
|    1 | x    | NULL | NULL |
|    2 | y    |    2 | z    |
+------+------+------+------+
</pre><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t1 RIGHT JOIN t2 ON (t1.a = t2.a);</code></strong>
+------+------+------+------+
| a    | b    | a    | c    |
+------+------+------+------+
|    2 | y    |    2 | z    |
| NULL | NULL |    3 | w    |
+------+------+------+------+
</pre></li><li class="listitem"><p>
            Previously, a <code class="literal">USING</code> clause could be
            rewritten as an <code class="literal">ON</code> clause that compares
            corresponding columns. For example, the following two
            clauses were semantically identical:
          </p><pre class="programlisting">
a LEFT JOIN b USING (c1,c2,c3)
a LEFT JOIN b ON a.c1=b.c1 AND a.c2=b.c2 AND a.c3=b.c3
</pre><p>
            Now the two clauses no longer are quite the same:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                With respect to determining which rows satisfy the join
                condition, both joins remain semantically identical.
              </p></li><li class="listitem"><p>
                With respect to determining which columns to display for
                <code class="literal">SELECT *</code> expansion, the two joins are
                not semantically identical. The <code class="literal">USING</code>
                join selects the coalesced value of corresponding
                columns, whereas the <code class="literal">ON</code> join selects
                all columns from all tables. For the preceding
                <code class="literal">USING</code> join, <code class="literal">SELECT
                *</code> selects these values:
              </p><pre class="programlisting">
COALESCE(a.c1,b.c1), COALESCE(a.c2,b.c2), COALESCE(a.c3,b.c3)
</pre><p>
                For the <code class="literal">ON</code> join, <code class="literal">SELECT
                *</code> selects these values:
              </p><pre class="programlisting">
a.c1, a.c2, a.c3, b.c1, b.c2, b.c3
</pre><p>
                With an inner join,
                <a class="link" href="functions.html#function_coalesce"><code class="literal">COALESCE(a.c1,b.c1)</code></a> is
                the same as either <code class="literal">a.c1</code> or
                <code class="literal">b.c1</code> because both columns will have
                the same value. With an outer join (such as
                <code class="literal">LEFT JOIN</code>), one of the two columns
                can be <code class="literal">NULL</code>. That column will be
                omitted from the result.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            The evaluation of multi-way natural joins differs in a very
            important way that affects the result of
            <code class="literal">NATURAL</code> or <code class="literal">USING</code> joins
            and that can require query rewriting. Suppose that you have
            three tables <code class="literal">t1(a,b)</code>,
            <code class="literal">t2(c,b)</code>, and <code class="literal">t3(a,c)</code>
            that each have one row: <code class="literal">t1(1,2)</code>,
            <code class="literal">t2(10,2)</code>, and
            <code class="literal">t3(7,10)</code>. Suppose also that you have this
            <code class="literal">NATURAL JOIN</code> on the three tables:
          </p><pre class="programlisting">
SELECT ... FROM t1 NATURAL JOIN t2 NATURAL JOIN t3;
</pre><p>
            Previously, the left operand of the second join was
            considered to be <code class="literal">t2</code>, whereas it should be
            the nested join <code class="literal">(t1 NATURAL JOIN t2)</code>. As
            a result, the columns of <code class="literal">t3</code> are checked
            for common columns only in <code class="literal">t2</code>, and, if
            <code class="literal">t3</code> has common columns with
            <code class="literal">t1</code>, these columns are not used as
            equi-join columns. Thus, previously, the preceding query was
            transformed to the following equi-join:
          </p><pre class="programlisting">
SELECT ... FROM t1, t2, t3
  WHERE t1.b = t2.b AND t2.c = t3.c;
</pre><p>
            That join is missing one more equi-join predicate
            <code class="literal">(t1.a = t3.a)</code>. As a result, it produces
            one row, not the empty result that it should. The correct
            equivalent query is this:
          </p><pre class="programlisting">
SELECT ... FROM t1, t2, t3
  WHERE t1.b = t2.b AND t2.c = t3.c AND t1.a = t3.a;
</pre><p>
            If you require the same query result in current versions of
            MySQL as in older versions, rewrite the natural join as the
            first equi-join.
          </p></li><li class="listitem"><p>
            Previously, the comma operator (<code class="literal">,</code>) and
            <code class="literal">JOIN</code> both had the same precedence, so the
            join expression <code class="literal">t1, t2 JOIN t3</code> was
            interpreted as <code class="literal">((t1, t2) JOIN t3)</code>. Now
            <code class="literal">JOIN</code> has higher precedence, so the
            expression is interpreted as <code class="literal">(t1, (t2 JOIN
            t3))</code>. This change affects statements that use an
            <code class="literal">ON</code> clause, because that clause can refer
            only to columns in the operands of the join, and the change
            in precedence changes interpretation of what those operands
            are.
          </p><p>
            Example:
          </p><pre class="programlisting">
CREATE TABLE t1 (i1 INT, j1 INT);
CREATE TABLE t2 (i2 INT, j2 INT);
CREATE TABLE t3 (i3 INT, j3 INT);
INSERT INTO t1 VALUES(1,1);
INSERT INTO t2 VALUES(1,1);
INSERT INTO t3 VALUES(1,1);
SELECT * FROM t1, t2 JOIN t3 ON (t1.i1 = t3.i3);
</pre><p>
            Previously, the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> was
            legal due to the implicit grouping of
            <code class="literal">t1,t2</code> as <code class="literal">(t1,t2)</code>. Now
            the <code class="literal">JOIN</code> takes precedence, so the
            operands for the <code class="literal">ON</code> clause are
            <code class="literal">t2</code> and <code class="literal">t3</code>. Because
            <code class="literal">t1.i1</code> is not a column in either of the
            operands, the result is an <code class="literal">Unknown column 't1.i1'
            in 'on clause'</code> error. To allow the join to be
            processed, group the first two tables explicitly with
            parentheses so that the operands for the
            <code class="literal">ON</code> clause are <code class="literal">(t1,t2)</code>
            and <code class="literal">t3</code>:
          </p><pre class="programlisting">
SELECT * FROM (t1, t2) JOIN t3 ON (t1.i1 = t3.i3);
</pre><p>
            Alternatively, avoid the use of the comma operator and use
            <code class="literal">JOIN</code> instead:
          </p><pre class="programlisting">
SELECT * FROM t1 JOIN t2 JOIN t3 ON (t1.i1 = t3.i3);
</pre><p>
            This change also applies to statements that mix the comma
            operator with <code class="literal">INNER JOIN</code>, <code class="literal">CROSS
            JOIN</code>, <code class="literal">LEFT JOIN</code>, and
            <code class="literal">RIGHT JOIN</code>, all of which now have higher
            precedence than the comma operator.
          </p></li><li class="listitem"><p>
            Previously, the <code class="literal">ON</code> clause could refer to
            columns in tables named to its right. Now an
            <code class="literal">ON</code> clause can refer only to its operands.
          </p><p>
            Example:
          </p><pre class="programlisting">
CREATE TABLE t1 (i1 INT);
CREATE TABLE t2 (i2 INT);
CREATE TABLE t3 (i3 INT);
SELECT * FROM t1 JOIN t2 ON (i1 = i3) JOIN t3;
</pre><p>
            Previously, the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
            statement was legal. Now the statement fails with an
            <code class="literal">Unknown column 'i3' in 'on clause'</code> error
            because <code class="literal">i3</code> is a column in
            <code class="literal">t3</code>, which is not an operand of the
            <code class="literal">ON</code> clause. The statement should be
            rewritten as follows:
          </p><pre class="programlisting">
SELECT * FROM t1 JOIN t2 JOIN t3 ON (i1 = i3);
</pre></li><li class="listitem"><p>
            Resolution of column names in <code class="literal">NATURAL</code> or
            <code class="literal">USING</code> joins is different than previously.
            For column names that are outside the
            <code class="literal">FROM</code> clause, MySQL now handles a superset
            of the queries compared to previously. That is, in cases
            when MySQL formerly issued an error that some column is
            ambiguous, the query now is handled correctly. This is due
            to the fact that MySQL now treats the common columns of
            <code class="literal">NATURAL</code> or <code class="literal">USING</code> joins
            as a single column, so when a query refers to such columns,
            the query compiler does not consider them as ambiguous.
          </p><p>
            Example:
          </p><pre class="programlisting">
SELECT * FROM t1 NATURAL JOIN t2 WHERE b &gt; 1;
</pre><p>
            Previously, this query would produce an error <code class="literal">ERROR
            1052 (23000): Column 'b' in where clause is
            ambiguous</code>. Now the query produces the correct
            result:
          </p><pre class="programlisting">
+------+------+------+
| b    | c    | y    |
+------+------+------+
|    4 |    2 |    3 |
+------+------+------+
</pre><p>
            One extension of MySQL compared to the SQL:2003 standard is
            that MySQL enables you to qualify the common (coalesced)
            columns of <code class="literal">NATURAL</code> or
            <code class="literal">USING</code> joins (just as previously), while
            the standard disallows that.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="union"></a>13.2.9.3 UNION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147688400"></a><pre class="programlisting">
SELECT ...
UNION [ALL | DISTINCT] SELECT ...
[UNION [ALL | DISTINCT] SELECT ...]
</pre><p>
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> is used to combine the
        result from multiple <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        statements into a single result set.
      </p><p>
        The column names from the first
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement are used as the
        column names for the results returned. Selected columns listed
        in corresponding positions of each
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement should have the
        same data type. (For example, the first column selected by the
        first statement should have the same type as the first column
        selected by the other statements.)
      </p><p>
        If the data types of corresponding
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> columns do not match, the
        types and lengths of the columns in the
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> result take into account
        the values retrieved by all of the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements. For example,
        consider the following:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT REPEAT('a',1) UNION SELECT REPEAT('b',10);</code></strong>
+---------------+
| REPEAT('a',1) |
+---------------+
| a             |
| bbbbbbbbbb    |
+---------------+
</pre><p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements are normal
        select statements, but with the following restrictions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Only the last <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
            statement can use <code class="literal">INTO OUTFILE</code>. (However,
            the entire <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> result is
            written to the file.)
          </p></li><li class="listitem"><p>
            <code class="literal">HIGH_PRIORITY</code> cannot be used with
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements that are
            part of a <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a>. If you
            specify it for the first
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>, it has no effect. If
            you specify it for any subsequent
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements, a syntax
            error results.
</p></li></ul>
</div>
<p>
        The default behavior for <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> is
        that duplicate rows are removed from the result. The optional
        <code class="literal">DISTINCT</code> keyword has no effect other than the
        default because it also specifies duplicate-row removal. With
        the optional <code class="literal">ALL</code> keyword, duplicate-row
        removal does not occur and the result includes all matching rows
        from all the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
      </p><p>
        You can mix <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION
        ALL</code></a> and <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION
        DISTINCT</code></a> in the same query. Mixed
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> types are treated such that
        a <code class="literal">DISTINCT</code> union overrides any
        <code class="literal">ALL</code> union to its left. A
        <code class="literal">DISTINCT</code> union can be produced explicitly by
        using <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION
        DISTINCT</code></a> or implicitly by using
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> with no following
        <code class="literal">DISTINCT</code> or <code class="literal">ALL</code> keyword.
      </p><p>
        To apply <code class="literal">ORDER BY</code> or <code class="literal">LIMIT</code>
        to an individual <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>, place
        the clause inside the parentheses that enclose the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre class="programlisting">
(SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10);
</pre><p>
        However, use of <code class="literal">ORDER BY</code> for individual
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements implies nothing
        about the order in which the rows appear in the final result
        because <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> by default produces
        an unordered set of rows. Therefore, the use of <code class="literal">ORDER
        BY</code> in this context is typically in conjunction with
        <code class="literal">LIMIT</code>, so that it is used to determine the
        subset of the selected rows to retrieve for the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>, even though it does not
        necessarily affect the order of those rows in the final
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> result. If <code class="literal">ORDER
        BY</code> appears without <code class="literal">LIMIT</code> in a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>, it is optimized away
        because it will have no effect anyway.
      </p><p>
        To use an <code class="literal">ORDER BY</code> or
        <code class="literal">LIMIT</code> clause to sort or limit the entire
        <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> result, parenthesize the
        individual <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements and
        place the <code class="literal">ORDER BY</code> or
        <code class="literal">LIMIT</code> after the last one. The following
        example uses both clauses:
      </p><pre class="programlisting">
(SELECT a FROM t1 WHERE a=10 AND B=1)
UNION
(SELECT a FROM t2 WHERE a=11 AND B=2)
ORDER BY a LIMIT 10;
</pre><p>
        A statement without parentheses is equivalent to one
        parenthesized as just shown.
      </p><p>
        This kind of <code class="literal">ORDER BY</code> cannot use column
        references that include a table name (that is, names in
        <em class="replaceable"><code>tbl_name</code></em>.<em class="replaceable"><code>col_name</code></em>
        format). Instead, provide a column alias in the first
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement and refer to the
        alias in the <code class="literal">ORDER BY</code>. (Alternatively, refer
        to the column in the <code class="literal">ORDER BY</code> using its
        column position. However, use of column positions is
        deprecated.)
      </p><p>
        Also, if a column to be sorted is aliased, the <code class="literal">ORDER
        BY</code> clause <span class="emphasis"><em>must</em></span> refer to the
        alias, not the column name. The first of the following
        statements will work, but the second will fail with an
        <code class="literal">Unknown column 'a' in 'order clause'</code> error:
      </p><pre class="programlisting">
(SELECT a AS b FROM t) UNION (SELECT ...) ORDER BY b;
(SELECT a AS b FROM t) UNION (SELECT ...) ORDER BY a;
</pre><p>
        To cause rows in a <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> result
        to consist of the sets of rows retrieved by each
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> one after the other,
        select an additional column in each
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> to use as a sort column
        and add an <code class="literal">ORDER BY</code> following the last
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre class="programlisting">
(SELECT 1 AS sort_col, col1a, col1b, ... FROM t1)
UNION
(SELECT 2, col2a, col2b, ... FROM t2) ORDER BY sort_col;
</pre><p>
        To additionally maintain sort order within individual
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> results, add a secondary
        column to the <code class="literal">ORDER BY</code> clause:
      </p><pre class="programlisting">
(SELECT 1 AS sort_col, col1a, col1b, ... FROM t1)
UNION
(SELECT 2, col2a, col2b, ... FROM t2) ORDER BY sort_col, col1a;
</pre><p>
        Use of an additional column also enables you to determine which
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> each row comes from. Extra
        columns can provide other identifying information as well, such
        as a string that indicates a table name.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="subqueries"></a>13.2.10 Subquery Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#scalar-subqueries">13.2.10.1 The Subquery as Scalar Operand</a></span></dt><dt><span class="section"><a href="sql-syntax.html#comparisons-using-subqueries">13.2.10.2 Comparisons Using Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#any-in-some-subqueries">13.2.10.3 Subqueries with ANY, IN, or SOME</a></span></dt><dt><span class="section"><a href="sql-syntax.html#all-subqueries">13.2.10.4 Subqueries with ALL</a></span></dt><dt><span class="section"><a href="sql-syntax.html#row-subqueries">13.2.10.5 Row Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#exists-and-not-exists-subqueries">13.2.10.6 Subqueries with EXISTS or NOT EXISTS</a></span></dt><dt><span class="section"><a href="sql-syntax.html#correlated-subqueries">13.2.10.7 Correlated Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#from-clause-subqueries">13.2.10.8 Subqueries in the FROM Clause</a></span></dt><dt><span class="section"><a href="sql-syntax.html#subquery-errors">13.2.10.9 Subquery Errors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#optimizing-subqueries">13.2.10.10 Optimizing Subqueries</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rewriting-subqueries">13.2.10.11 Rewriting Subqueries as Joins</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737147599088"></a><a class="indexterm" name="idm139737147598016"></a><a class="indexterm" name="idm139737147596944"></a><a class="indexterm" name="idm139737147595456"></a><p>
      A subquery is a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement
      within another statement.
    </p><p>
      Starting with MySQL 4.1, all subquery forms and operations that
      the SQL standard requires are supported, as well as a few features
      that are MySQL-specific.
    </p><p>
      Here is an example of a subquery:
    </p><pre class="programlisting">
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</pre><p>
      In this example, <code class="literal">SELECT * FROM t1 ...</code> is the
      <span class="emphasis"><em>outer query</em></span> (or <span class="emphasis"><em>outer
      statement</em></span>), and <code class="literal">(SELECT column1 FROM
      t2)</code> is the <span class="emphasis"><em>subquery</em></span>. We say that
      the subquery is <span class="emphasis"><em>nested</em></span> within the outer
      query, and in fact it is possible to nest subqueries within other
      subqueries, to a considerable depth. A subquery must always appear
      within parentheses.
    </p><p>
      The main advantages of subqueries are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          They allow queries that are <span class="emphasis"><em>structured</em></span> so
          that it is possible to isolate each part of a statement.
        </p></li><li class="listitem"><p>
          They provide alternative ways to perform operations that would
          otherwise require complex joins and unions.
        </p></li><li class="listitem"><p>
          Many people find subqueries more readable than complex joins
          or unions. Indeed, it was the innovation of subqueries that
          gave people the original idea of calling the early SQL
          <span class="quote">“<span class="quote">Structured Query Language.</span>”</span>
</p></li></ul>
</div>
<p>
      Here is an example statement that shows the major points about
      subquery syntax as specified by the SQL standard and supported in
      MySQL:
    </p><pre class="programlisting">
DELETE FROM t1
WHERE s11 &gt; ANY
 (SELECT COUNT(*) /* no hint */ FROM t2
  WHERE NOT EXISTS
   (SELECT * FROM t3
    WHERE ROW(5*t2.s1,77)=
     (SELECT 50,11*s1 FROM t4 UNION SELECT 50,77 FROM
      (SELECT * FROM t5) AS t5)));
</pre><p>
      A subquery can return a scalar (a single value), a single row, a
      single column, or a table (one or more rows of one or more
      columns). These are called scalar, column, row, and table
      subqueries. Subqueries that return a particular kind of result
      often can be used only in certain contexts, as described in the
      following sections.
    </p><p>
      There are few restrictions on the type of statements in which
      subqueries can be used. A subquery can contain many of the
      keywords or clauses that an ordinary
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> can contain:
      <code class="literal">DISTINCT</code>, <code class="literal">GROUP BY</code>,
      <code class="literal">ORDER BY</code>, <code class="literal">LIMIT</code>, joins,
      index hints, <a class="link" href="sql-syntax.html#union" title="13.2.9.3 UNION Syntax"><code class="literal">UNION</code></a> constructs,
      comments, functions, and so on.
    </p><p>
      A subquery's outer statement can be any one of:
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>,
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>, or
      <a class="link" href="sql-syntax.html#do" title="13.2.3 DO Syntax"><code class="literal">DO</code></a>.
    </p><p>
      In MySQL, you cannot modify a table and select from the same table
      in a subquery. This applies to statements such as
      <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
      <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>,
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and (because subqueries can
      be used in the <code class="literal">SET</code> clause)
      <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
      INFILE</code></a>.
    </p><p>
      For information about how the optimizer handles subqueries, see
      <a class="xref" href="optimization.html#subquery-optimization" title="8.2.1.18 Subquery Optimization">Section 8.2.1.18, “Subquery Optimization”</a>. For a discussion of
      restrictions on subquery use, including performance issues for
      certain forms of subquery syntax, see
      <a class="xref" href="restrictions.html#subquery-restrictions" title="D.4 Restrictions on Subqueries">Section D.4, “Restrictions on Subqueries”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="scalar-subqueries"></a>13.2.10.1 The Subquery as Scalar Operand</h4>
</div>
</div>
</div>
<p>
        In its simplest form, a subquery is a scalar subquery that
        returns a single value. A scalar subquery is a simple operand,
        and you can use it almost anywhere a single column value or
        literal is legal, and you can expect it to have those
        characteristics that all operands have: a data type, a length,
        an indication that it can be <code class="literal">NULL</code>, and so on.
        For example:
      </p><pre class="programlisting">
CREATE TABLE t1 (s1 INT, s2 CHAR(5) NOT NULL);
INSERT INTO t1 VALUES(100, 'abcde');
SELECT (SELECT s2 FROM t1);
</pre><p>
        The subquery in this <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        returns a single value (<code class="literal">'abcde'</code>) that has a
        data type of <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">CHAR</code></a>, a length of 5,
        a character set and collation equal to the defaults in effect at
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> time, and an
        indication that the value in the column can be
        <code class="literal">NULL</code>. Nullability of the value selected by a
        scalar subquery is not copied because if the subquery result is
        empty, the result is <code class="literal">NULL</code>. For the subquery
        just shown, if <code class="literal">t1</code> were empty, the result
        would be <code class="literal">NULL</code> even though
        <code class="literal">s2</code> is <code class="literal">NOT NULL</code>.
      </p><p>
        There are a few contexts in which a scalar subquery cannot be
        used. If a statement permits only a literal value, you cannot
        use a subquery. For example, <code class="literal">LIMIT</code> requires
        literal integer arguments, and
        <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> requires a literal string file name. You cannot
        use subqueries to supply these values.
      </p><p>
        When you see examples in the following sections that contain the
        rather spartan construct <code class="literal">(SELECT column1 FROM
        t1)</code>, imagine that your own code contains much more
        diverse and complex constructions.
      </p><p>
        Suppose that we make two tables:
      </p><pre class="programlisting">
CREATE TABLE t1 (s1 INT);
INSERT INTO t1 VALUES (1);
CREATE TABLE t2 (s1 INT);
INSERT INTO t2 VALUES (2);
</pre><p>
        Then perform a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre class="programlisting">
SELECT (SELECT s1 FROM t2) FROM t1;
</pre><p>
        The result is <code class="literal">2</code> because there is a row in
        <code class="literal">t2</code> containing a column <code class="literal">s1</code>
        that has a value of <code class="literal">2</code>.
      </p><p>
        A scalar subquery can be part of an expression, but remember the
        parentheses, even if the subquery is an operand that provides an
        argument for a function. For example:
      </p><pre class="programlisting">
SELECT UPPER((SELECT s1 FROM t1)) FROM t2;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="comparisons-using-subqueries"></a>13.2.10.2 Comparisons Using Subqueries</h4>

</div>

</div>

</div>
<p>
        The most common use of a subquery is in the form:
      </p><pre class="programlisting">
<em class="replaceable"><code>non_subquery_operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        Where <em class="replaceable"><code>comparison_operator</code></em> is one of
        these operators:
      </p><pre class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=  &lt;=&gt;
</pre><p>
        For example:
      </p><pre class="programlisting">
... WHERE 'a' = (SELECT column1 FROM t1)
</pre><p>
        MySQL also permits this construct:
      </p><pre class="programlisting">
<em class="replaceable"><code>non_subquery_operand</code></em> LIKE (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        At one time the only legal place for a subquery was on the right
        side of a comparison, and you might still find some old DBMSs
        that insist on this.
      </p><p>
        Here is an example of a common-form subquery comparison that you
        cannot do with a join. It finds all the rows in table
        <code class="literal">t1</code> for which the <code class="literal">column1</code>
        value is equal to a maximum value in table
        <code class="literal">t2</code>:
      </p><pre class="programlisting">
SELECT * FROM t1
  WHERE column1 = (SELECT MAX(column2) FROM t2);
</pre><p>
        Here is another example, which again is impossible with a join
        because it involves aggregating for one of the tables. It finds
        all rows in table <code class="literal">t1</code> containing a value that
        occurs twice in a given column:
      </p><pre class="programlisting">
SELECT * FROM t1 AS t
  WHERE 2 = (SELECT COUNT(*) FROM t1 WHERE t1.id = t.id);
</pre><p>
        For a comparison of the subquery to a scalar, the subquery must
        return a scalar. For a comparison of the subquery to a row
        constructor, the subquery must be a row subquery that returns a
        row with the same number of values as the row constructor. See
        <a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.10.5 Row Subqueries">Section 13.2.10.5, “Row Subqueries”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="any-in-some-subqueries"></a>13.2.10.3 Subqueries with ANY, IN, or SOME</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147514704"></a><a class="indexterm" name="idm139737147513248"></a><a class="indexterm" name="idm139737147512208"></a><a class="indexterm" name="idm139737147511168"></a><p>
        Syntax:
      </p><pre class="programlisting">
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> ANY (<em class="replaceable"><code>subquery</code></em>)
<em class="replaceable"><code>operand</code></em> IN (<em class="replaceable"><code>subquery</code></em>)
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> SOME (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        Where <em class="replaceable"><code>comparison_operator</code></em> is one of
        these operators:
      </p><pre class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=
</pre><p>
        The <code class="literal">ANY</code> keyword, which must follow a
        comparison operator, means <span class="quote">“<span class="quote">return <code class="literal">TRUE</code>
        if the comparison is <code class="literal">TRUE</code> for
        <code class="literal">ANY</code> of the values in the column that the
        subquery returns.</span>”</span> For example:
      </p><pre class="programlisting">
SELECT s1 FROM t1 WHERE s1 &gt; ANY (SELECT s1 FROM t2);
</pre><p>
        Suppose that there is a row in table <code class="literal">t1</code>
        containing <code class="literal">(10)</code>. The expression is
        <code class="literal">TRUE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(21,14,7)</code> because there is a value
        <code class="literal">7</code> in <code class="literal">t2</code> that is less than
        <code class="literal">10</code>. The expression is
        <code class="literal">FALSE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(20,10)</code>, or if table <code class="literal">t2</code> is
        empty. The expression is <span class="emphasis"><em>unknown</em></span> (that is,
        <code class="literal">NULL</code>) if table <code class="literal">t2</code> contains
        <code class="literal">(NULL,NULL,NULL)</code>.
      </p><p>
        When used with a subquery, the word <code class="literal">IN</code> is an
        alias for <code class="literal">= ANY</code>. Thus, these two statements
        are the same:
      </p><pre class="programlisting">
SELECT s1 FROM t1 WHERE s1 = ANY (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 IN    (SELECT s1 FROM t2);
</pre><p>
        <code class="literal">IN</code> and <code class="literal">= ANY</code> are not
        synonyms when used with an expression list.
        <code class="literal">IN</code> can take an expression list, but
        <code class="literal">= ANY</code> cannot. See
        <a class="xref" href="functions.html#comparison-operators" title="12.3.2 Comparison Functions and Operators">Section 12.3.2, “Comparison Functions and Operators”</a>.
      </p><p>
        <code class="literal">NOT IN</code> is not an alias for <code class="literal">&lt;&gt;
        ANY</code>, but for <code class="literal">&lt;&gt; ALL</code>. See
        <a class="xref" href="sql-syntax.html#all-subqueries" title="13.2.10.4 Subqueries with ALL">Section 13.2.10.4, “Subqueries with ALL”</a>.
      </p><p>
        The word <code class="literal">SOME</code> is an alias for
        <code class="literal">ANY</code>. Thus, these two statements are the same:
      </p><pre class="programlisting">
SELECT s1 FROM t1 WHERE s1 &lt;&gt; ANY  (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 &lt;&gt; SOME (SELECT s1 FROM t2);
</pre><p>
        Use of the word <code class="literal">SOME</code> is rare, but this
        example shows why it might be useful. To most people, the
        English phrase <span class="quote">“<span class="quote">a is not equal to any b</span>”</span> means
        <span class="quote">“<span class="quote">there is no b which is equal to a,</span>”</span> but that is
        not what is meant by the SQL syntax. The syntax means
        <span class="quote">“<span class="quote">there is some b to which a is not equal.</span>”</span> Using
        <code class="literal">&lt;&gt; SOME</code> instead helps ensure that
        everyone understands the true meaning of the query.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="all-subqueries"></a>13.2.10.4 Subqueries with ALL</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147470256"></a><a class="indexterm" name="idm139737147468768"></a><p>
        Syntax:
      </p><pre class="programlisting">
<em class="replaceable"><code>operand</code></em> <em class="replaceable"><code>comparison_operator</code></em> ALL (<em class="replaceable"><code>subquery</code></em>)
</pre><p>
        The word <code class="literal">ALL</code>, which must follow a comparison
        operator, means <span class="quote">“<span class="quote">return <code class="literal">TRUE</code> if the
        comparison is <code class="literal">TRUE</code> for <code class="literal">ALL</code>
        of the values in the column that the subquery returns.</span>”</span>
        For example:
      </p><pre class="programlisting">
SELECT s1 FROM t1 WHERE s1 &gt; ALL (SELECT s1 FROM t2);
</pre><p>
        Suppose that there is a row in table <code class="literal">t1</code>
        containing <code class="literal">(10)</code>. The expression is
        <code class="literal">TRUE</code> if table <code class="literal">t2</code> contains
        <code class="literal">(-5,0,+5)</code> because <code class="literal">10</code> is
        greater than all three values in <code class="literal">t2</code>. The
        expression is <code class="literal">FALSE</code> if table
        <code class="literal">t2</code> contains
        <code class="literal">(12,6,NULL,-100)</code> because there is a single
        value <code class="literal">12</code> in table <code class="literal">t2</code> that
        is greater than <code class="literal">10</code>. The expression is
        <span class="emphasis"><em>unknown</em></span> (that is, <code class="literal">NULL</code>)
        if table <code class="literal">t2</code> contains
        <code class="literal">(0,NULL,1)</code>.
      </p><p>
        Finally, the expression is <code class="literal">TRUE</code> if table
        <code class="literal">t2</code> is empty. So, the following expression is
        <code class="literal">TRUE</code> when table <code class="literal">t2</code> is
        empty:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; ALL (SELECT s1 FROM t2);
</pre><p>
        But this expression is <code class="literal">NULL</code> when table
        <code class="literal">t2</code> is empty:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; (SELECT s1 FROM t2);
</pre><p>
        In addition, the following expression is <code class="literal">NULL</code>
        when table <code class="literal">t2</code> is empty:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE 1 &gt; ALL (SELECT MAX(s1) FROM t2);
</pre><p>
        In general, <span class="emphasis"><em>tables containing <code class="literal">NULL</code>
        values</em></span> and <span class="emphasis"><em>empty tables</em></span> are
        <span class="quote">“<span class="quote">edge cases.</span>”</span> When writing subqueries, always
        consider whether you have taken those two possibilities into
        account.
      </p><p>
        <code class="literal">NOT IN</code> is an alias for <code class="literal">&lt;&gt;
        ALL</code>. Thus, these two statements are the same:
      </p><pre class="programlisting">
SELECT s1 FROM t1 WHERE s1 &lt;&gt; ALL (SELECT s1 FROM t2);
SELECT s1 FROM t1 WHERE s1 NOT IN (SELECT s1 FROM t2);
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="row-subqueries"></a>13.2.10.5 Row Subqueries</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147432640"></a><a class="indexterm" name="idm139737147431568"></a><a class="indexterm" name="idm139737147430528"></a><p>
        Scalar or column subqueries return a single value or a column of
        values. A <span class="emphasis"><em>row subquery</em></span> is a subquery
        variant that returns a single row and can thus return more than
        one column value. Legal operators for row subquery comparisons
        are:
      </p><pre class="programlisting">
=  &gt;  &lt;  &gt;=  &lt;=  &lt;&gt;  !=  &lt;=&gt;
</pre><p>
        Here are two examples:
      </p><pre class="programlisting">
SELECT * FROM t1
  WHERE (col1,col2) = (SELECT col3, col4 FROM t2 WHERE id = 10);
SELECT * FROM t1
  WHERE ROW(col1,col2) = (SELECT col3, col4 FROM t2 WHERE id = 10);
</pre><p>
        For both queries, if the table <code class="literal">t2</code> contains a
        single row with <code class="literal">id = 10</code>, the subquery returns
        a single row. If this row has <code class="literal">col3</code> and
        <code class="literal">col4</code> values equal to the
        <code class="literal">col1</code> and <code class="literal">col2</code> values of
        any rows in <code class="literal">t1</code>, the <code class="literal">WHERE</code>
        expression is <code class="literal">TRUE</code> and each query returns
        those <code class="literal">t1</code> rows. If the <code class="literal">t2</code>
        row <code class="literal">col3</code> and <code class="literal">col4</code> values
        are not equal the <code class="literal">col1</code> and
        <code class="literal">col2</code> values of any <code class="literal">t1</code> row,
        the expression is <code class="literal">FALSE</code> and the query returns
        an empty result set. The expression is
        <span class="emphasis"><em>unknown</em></span> (that is, <code class="literal">NULL</code>)
        if the subquery produces no rows. An error occurs if the
        subquery produces multiple rows because a row subquery can
        return at most one row.
      </p><p>
        For information about how each operator works for row
        comparisons, see <a class="xref" href="functions.html#comparison-operators" title="12.3.2 Comparison Functions and Operators">Section 12.3.2, “Comparison Functions and Operators”</a>.
      </p><p>
        The expressions <code class="literal">(1,2)</code> and
        <code class="literal">ROW(1,2)</code> are sometimes called <em class="firstterm">row
        constructors</em>. The two are equivalent. The row
        constructor and the row returned by the subquery must contain
        the same number of values.
      </p><p>
        A row constructor is used for comparisons with subqueries that
        return two or more columns. When a subquery returns a single
        column, this is regarded as a scalar value and not as a row, so
        a row constructor cannot be used with a subquery that does not
        return at least two columns. Thus, the following query fails
        with a syntax error:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE ROW(1) = (SELECT column1 FROM t2)
</pre><p>
        Row constructors are legal in other contexts. For example, the
        following two statements are semantically equivalent (and are
        handled in the same way by the optimizer):
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE (column1,column2) = (1,1);
SELECT * FROM t1 WHERE column1 = 1 AND column2 = 1;
</pre><p>
        The following query answers the request, <span class="quote">“<span class="quote">find all rows in
        table <code class="literal">t1</code> that also exist in table
        <code class="literal">t2</code></span>”</span>:
      </p><pre class="programlisting">
SELECT column1,column2,column3
  FROM t1
  WHERE (column1,column2,column3) IN
         (SELECT column1,column2,column3 FROM t2);
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="exists-and-not-exists-subqueries"></a>13.2.10.6 Subqueries with EXISTS or NOT EXISTS</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147401072"></a><a class="indexterm" name="idm139737147399584"></a><a class="indexterm" name="idm139737147398096"></a><a class="indexterm" name="idm139737147396608"></a><p>
        If a subquery returns any rows at all, <code class="literal">EXISTS
        <em class="replaceable"><code>subquery</code></em></code> is
        <code class="literal">TRUE</code>, and <code class="literal">NOT EXISTS
        <em class="replaceable"><code>subquery</code></em></code> is
        <code class="literal">FALSE</code>. For example:
      </p><pre class="programlisting">
SELECT column1 FROM t1 WHERE EXISTS (SELECT * FROM t2);
</pre><p>
        Traditionally, an <code class="literal">EXISTS</code> subquery starts with
        <code class="literal">SELECT *</code>, but it could begin with
        <code class="literal">SELECT 5</code> or <code class="literal">SELECT column1</code>
        or anything at all. MySQL ignores the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> list in such a subquery,
        so it makes no difference.
      </p><p>
        For the preceding example, if <code class="literal">t2</code> contains any
        rows, even rows with nothing but <code class="literal">NULL</code> values,
        the <code class="literal">EXISTS</code> condition is
        <code class="literal">TRUE</code>. This is actually an unlikely example
        because a <code class="literal">[NOT] EXISTS</code> subquery almost always
        contains correlations. Here are some more realistic examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            What kind of store is present in one or more cities?
          </p><pre class="programlisting">
SELECT DISTINCT store_type FROM stores
  WHERE EXISTS (SELECT * FROM cities_stores
                WHERE cities_stores.store_type = stores.store_type);
</pre></li><li class="listitem"><p>
            What kind of store is present in no cities?
          </p><pre class="programlisting">
SELECT DISTINCT store_type FROM stores
  WHERE NOT EXISTS (SELECT * FROM cities_stores
                    WHERE cities_stores.store_type = stores.store_type);
</pre></li><li class="listitem"><p>
            What kind of store is present in all cities?
          </p><pre class="programlisting">
SELECT DISTINCT store_type FROM stores s1
  WHERE NOT EXISTS (
    SELECT * FROM cities WHERE NOT EXISTS (
      SELECT * FROM cities_stores
       WHERE cities_stores.city = cities.city
       AND cities_stores.store_type = stores.store_type));
</pre></li></ul>
</div>
<p>
        The last example is a double-nested <code class="literal">NOT
        EXISTS</code> query. That is, it has a <code class="literal">NOT
        EXISTS</code> clause within a <code class="literal">NOT EXISTS</code>
        clause. Formally, it answers the question <span class="quote">“<span class="quote">does a city
        exist with a store that is not in
        <code class="literal">Stores</code></span>”</span>? But it is easier to say that
        a nested <code class="literal">NOT EXISTS</code> answers the question
        <span class="quote">“<span class="quote">is <em class="replaceable"><code>x</code></em> <code class="literal">TRUE</code>
        for all <em class="replaceable"><code>y</code></em>?</span>”</span>
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="correlated-subqueries"></a>13.2.10.7 Correlated Subqueries</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147368512"></a><a class="indexterm" name="idm139737147367440"></a><p>
        A <span class="emphasis"><em>correlated subquery</em></span> is a subquery that
        contains a reference to a table that also appears in the outer
        query. For example:
      </p><pre class="programlisting">
SELECT * FROM t1
  WHERE column1 = ANY (SELECT column1 FROM t2
                       WHERE t2.column2 = t1.column2);
</pre><p>
        Notice that the subquery contains a reference to a column of
        <code class="literal">t1</code>, even though the subquery's
        <code class="literal">FROM</code> clause does not mention a table
        <code class="literal">t1</code>. So, MySQL looks outside the subquery, and
        finds <code class="literal">t1</code> in the outer query.
      </p><p>
        Suppose that table <code class="literal">t1</code> contains a row where
        <code class="literal">column1 = 5</code> and <code class="literal">column2 =
        6</code>; meanwhile, table <code class="literal">t2</code> contains a
        row where <code class="literal">column1 = 5</code> and <code class="literal">column2 =
        7</code>. The simple expression <code class="literal">... WHERE column1 =
        ANY (SELECT column1 FROM t2)</code> would be
        <code class="literal">TRUE</code>, but in this example, the
        <code class="literal">WHERE</code> clause within the subquery is
        <code class="literal">FALSE</code> (because <code class="literal">(5,6)</code> is
        not equal to <code class="literal">(5,7)</code>), so the expression as a
        whole is <code class="literal">FALSE</code>.
      </p><p>
        <span class="bold"><strong>Scoping rule:</strong></span> MySQL evaluates
        from inside to outside. For example:
      </p><pre class="programlisting">
SELECT column1 FROM t1 AS x
  WHERE x.column1 = (SELECT column1 FROM t2 AS x
    WHERE x.column1 = (SELECT column1 FROM t3
      WHERE x.column2 = t3.column1));
</pre><p>
        In this statement, <code class="literal">x.column2</code> must be a column
        in table <code class="literal">t2</code> because <code class="literal">SELECT column1
        FROM t2 AS x ...</code> renames <code class="literal">t2</code>. It is
        not a column in table <code class="literal">t1</code> because
        <code class="literal">SELECT column1 FROM t1 ...</code> is an outer query
        that is <span class="emphasis"><em>farther out</em></span>.
      </p><p>
        For subqueries in <code class="literal">HAVING</code> or <code class="literal">ORDER
        BY</code> clauses, MySQL also looks for column names in the
        outer select list.
      </p><p>
        For certain cases, a correlated subquery is optimized. For
        example:
      </p><pre class="programlisting">
<em class="replaceable"><code>val</code></em> IN (SELECT <em class="replaceable"><code>key_val</code></em> FROM <em class="replaceable"><code>tbl_name</code></em> WHERE <em class="replaceable"><code>correlated_condition</code></em>)
</pre><p>
        Otherwise, they are inefficient and likely to be slow. Rewriting
        the query as a join might improve performance.
      </p><p>
        Aggregate functions in correlated subqueries may contain outer
        references, provided the function contains nothing but outer
        references, and provided the function is not contained in
        another function or expression.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="from-clause-subqueries"></a>13.2.10.8 Subqueries in the FROM Clause</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147336464"></a><a class="indexterm" name="idm139737147335424"></a><p>
        Subqueries are legal in a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement's <code class="literal">FROM</code> clause. The actual syntax
        is:
      </p><pre class="programlisting">
SELECT ... FROM (<em class="replaceable"><code>subquery</code></em>) [AS] <em class="replaceable"><code>name</code></em> ...
</pre><p>
        The <code class="literal">[AS] <em class="replaceable"><code>name</code></em></code>
        clause is mandatory, because every table in a
        <code class="literal">FROM</code> clause must have a name. Any columns in
        the <em class="replaceable"><code>subquery</code></em> select list must have
        unique names.
      </p><p>
        For the sake of illustration, assume that you have this table:
      </p><pre class="programlisting">
CREATE TABLE t1 (s1 INT, s2 CHAR(5), s3 FLOAT);
</pre><p>
        Here is how to use a subquery in the <code class="literal">FROM</code>
        clause, using the example table:
      </p><pre class="programlisting">
INSERT INTO t1 VALUES (1,'1',1.0);
INSERT INTO t1 VALUES (2,'2',2.0);
SELECT sb1,sb2,sb3
  FROM (SELECT s1 AS sb1, s2 AS sb2, s3*2 AS sb3 FROM t1) AS sb
  WHERE sb1 &gt; 1;
</pre><p>
        Result: <code class="literal">2, '2', 4.0</code>.
      </p><p>
        Here is another example: Suppose that you want to know the
        average of a set of sums for a grouped table. This does not
        work:
      </p><pre class="programlisting">
SELECT AVG(SUM(column1)) FROM t1 GROUP BY column1;
</pre><p>
        However, this query provides the desired information:
      </p><pre class="programlisting">
SELECT AVG(sum_column1)
  FROM (SELECT SUM(column1) AS sum_column1
        FROM t1 GROUP BY column1) AS t1;
</pre><p>
        Notice that the column name used within the subquery
        (<code class="literal">sum_column1</code>) is recognized in the outer
        query.
      </p><p>
        Subqueries in the <code class="literal">FROM</code> clause can return a
        scalar, column, row, or table. Subqueries in the
        <code class="literal">FROM</code> clause cannot be correlated subqueries,
        unless used within the <code class="literal">ON</code> clause of a
        <code class="literal">JOIN</code> operation.
      </p><p>
        Before MySQL 5.6.3, subqueries in the <code class="literal">FROM</code>
        clause are executed even for the
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statement (that is,
        derived temporary tables are materialized). This occurs because
        upper-level queries need information about all tables during the
        optimization phase, and the table represented by a subquery in
        the <code class="literal">FROM</code> clause is unavailable unless the
        subquery is executed. As of MySQL 5.6.3, the optimizer
        determines information about derived tables in a different way
        and materialization of them does not occur for
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>. See
        <a class="xref" href="optimization.html#derived-table-optimization" title="8.2.1.18.3 Optimizing Derived Tables (Subqueries) in the FROM Clause">Section 8.2.1.18.3, “Optimizing Derived Tables (Subqueries) in the FROM Clause”</a>.
      </p><p>
        It is possible under certain circumstances to modify table data
        using <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a>. This can occur if the outer query accesses any
        tables and an inner query invokes a stored function that changes
        one or more rows of a table. Suppose that there are two tables
        <code class="literal">t1</code> and <code class="literal">t2</code> in database
        <code class="literal">d1</code>, created as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE DATABASE d1;</code></strong>
Query OK, 1 row affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>USE d1;</code></strong>
Database changed

mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (c1 INT);</code></strong>
Query OK, 0 rows affected (0.15 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE t2 (c1 INT);</code></strong>
Query OK, 0 rows affected (0.08 sec)
</pre><p>
        Now we create a stored function <code class="literal">f1</code> which
        modifies <code class="literal">t2</code>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DELIMITER //</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE FUNCTION f1(p1 INT) RETURNS INT</code></strong>
mysql&gt;   <strong class="userinput"><code>BEGIN</code></strong>
mysql&gt;     <strong class="userinput"><code>INSERT INTO t2 VALUES (p1);</code></strong>
mysql&gt;     <strong class="userinput"><code>RETURN p1;</code></strong>
mysql&gt;   <strong class="userinput"><code>END //</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>DELIMITER ;</code></strong>
</pre><p>
        Referencing the function directly in an
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a> does not have any effect on
        <code class="literal">t2</code>, as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.00 sec)

mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT f1(5);</code></strong>
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra          |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | No tables used |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.00 sec)
</pre><p>
        This is because the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        statement did not reference any tables, as can be seen in the
        <code class="literal">table</code> and <code class="literal">Extra</code> columns of
        the output. This is also true of the following nested
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT NOW() AS a1, (SELECT f1(5)) AS a2;</code></strong>
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra          |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
|  1 | PRIMARY     | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | No tables used |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
1 row in set, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------------+
| Level | Code | Message                                  |
+-------+------+------------------------------------------+
| Note  | 1249 | Select 2 was reduced during optimization |
+-------+------+------------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
Empty set (0.00 sec)
</pre><p>
        However, if the outer <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
        references any tables, the optimizer executes the statement in
        the subquery as well:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>EXPLAIN SELECT * FROM t1 AS a1, (SELECT f1(5)) AS a2;</code></strong>
+----+-------------+------------+--------+---------------+------+---------+------+------+---------------------+
| id | select_type | table      | type   | possible_keys | key  | key_len | ref  | rows | Extra               |
+----+-------------+------------+--------+---------------+------+---------+------+------+---------------------+
|  1 | PRIMARY     | a1         | system | NULL          | NULL | NULL    | NULL |    0 | const row not found |
|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL          | NULL | NULL    | NULL |    1 |                     |
|  2 | DERIVED     | NULL       | NULL   | NULL          | NULL | NULL    | NULL | NULL | No tables used      |
+----+-------------+------------+--------+---------------+------+---------+------+------+---------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT * FROM t2;</code></strong>
+------+
| c1   |
+------+
|    5 |
+------+
1 row in set (0.00 sec)
</pre><p>
        This also means that an
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
        SELECT</code></a> statement such as the one shown here may take a
        long time to execute because the
        <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a> function is executed
        once for each row in <code class="literal">t1</code>:
      </p><pre class="programlisting">
EXPLAIN SELECT * FROM t1 AS a1, (SELECT BENCHMARK(1000000, MD5(NOW())));
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="subquery-errors"></a>13.2.10.9 Subquery Errors</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147268880"></a><a class="indexterm" name="idm139737147267392"></a><p>
        There are some errors that apply only to subqueries. This
        section describes them.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Unsupported subquery syntax:
          </p><pre class="programlisting">
ERROR 1235 (ER_NOT_SUPPORTED_YET)
SQLSTATE = 42000
Message = "This version of MySQL doesn't yet support
'LIMIT &amp; IN/ALL/ANY/SOME subquery'"
</pre><p>
            This means that MySQL does not support statements of the
            following form:
          </p><pre class="programlisting">
SELECT * FROM t1 WHERE s1 IN (SELECT s2 FROM t2 ORDER BY s1 LIMIT 1)
</pre></li><li class="listitem"><p>
            Incorrect number of columns from subquery:
          </p><pre class="programlisting">
ERROR 1241 (ER_OPERAND_COL)
SQLSTATE = 21000
Message = "Operand should contain 1 column(s)"
</pre><p>
            This error occurs in cases like this:
          </p><pre class="programlisting">
SELECT (SELECT column1, column2 FROM t2) FROM t1;
</pre><p>
            You may use a subquery that returns multiple columns, if the
            purpose is row comparison. In other contexts, the subquery
            must be a scalar operand. See
            <a class="xref" href="sql-syntax.html#row-subqueries" title="13.2.10.5 Row Subqueries">Section 13.2.10.5, “Row Subqueries”</a>.
          </p></li><li class="listitem"><p>
            Incorrect number of rows from subquery:
          </p><pre class="programlisting">
ERROR 1242 (ER_SUBSELECT_NO_1_ROW)
SQLSTATE = 21000
Message = "Subquery returns more than 1 row"
</pre><p>
            This error occurs for statements where the subquery must
            return at most one row but returns multiple rows. Consider
            the following example:
          </p><pre class="programlisting">
SELECT * FROM t1 WHERE column1 = (SELECT column1 FROM t2);
</pre><p>
            If <code class="literal">SELECT column1 FROM t2</code> returns just
            one row, the previous query will work. If the subquery
            returns more than one row, error 1242 will occur. In that
            case, the query should be rewritten as:
          </p><pre class="programlisting">
SELECT * FROM t1 WHERE column1 = ANY (SELECT column1 FROM t2);
</pre></li><li class="listitem"><p>
            Incorrectly used table in subquery:
          </p><pre class="programlisting">
Error 1093 (ER_UPDATE_TABLE_USED)
SQLSTATE = HY000
Message = "You can't specify target table 'x'
for update in FROM clause"
</pre><p>
            This error occurs in cases such as the following, which
            attempts to modify a table and select from the same table in
            the subquery:
          </p><pre class="programlisting">
UPDATE t1 SET column2 = (SELECT MAX(column1) FROM t1);
</pre><p>
            You can use a subquery for assignment within an
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement because
            subqueries are legal in
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> and
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements as well as
            in <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements.
            However, you cannot use the same table (in this case, table
            <code class="literal">t1</code>) for both the subquery
            <code class="literal">FROM</code> clause and the update target.
</p></li></ul>
</div>
<p>
        For transactional storage engines, the failure of a subquery
        causes the entire statement to fail. For nontransactional
        storage engines, data modifications made before the error was
        encountered are preserved.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="optimizing-subqueries"></a>13.2.10.10 Optimizing Subqueries</h4>

</div>

</div>

</div>
<p>
        Development is ongoing, so no optimization tip is reliable for
        the long term. The following list provides some interesting
        tricks that you might want to play with:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Use subquery clauses that affect the number or order of the
            rows in the subquery. For example:
          </p><pre class="programlisting">
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT column1 FROM t2 ORDER BY column1);
SELECT * FROM t1 WHERE t1.column1 IN
  (SELECT DISTINCT column1 FROM t2);
SELECT * FROM t1 WHERE EXISTS
  (SELECT * FROM t2 LIMIT 1);
</pre></li><li class="listitem"><p>
            Replace a join with a subquery. For example, try this:
          </p><pre class="programlisting">
SELECT DISTINCT column1 FROM t1 WHERE t1.column1 IN (
  SELECT column1 FROM t2);
</pre><p>
            Instead of this:
          </p><pre class="programlisting">
SELECT DISTINCT t1.column1 FROM t1, t2
  WHERE t1.column1 = t2.column1;
</pre></li><li class="listitem"><p>
            Some subqueries can be transformed to joins for
            compatibility with older versions of MySQL that do not
            support subqueries. However, in some cases, converting a
            subquery to a join may improve performance. See
            <a class="xref" href="sql-syntax.html#rewriting-subqueries" title="13.2.10.11 Rewriting Subqueries as Joins">Section 13.2.10.11, “Rewriting Subqueries as Joins”</a>.
          </p></li><li class="listitem"><p>
            Move clauses from outside to inside the subquery. For
            example, use this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1 UNION ALL SELECT s1 FROM t2);
</pre><p>
            Instead of this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE s1 IN (SELECT s1 FROM t1) OR s1 IN (SELECT s1 FROM t2);
</pre><p>
            For another example, use this query:
          </p><pre class="programlisting">
SELECT (SELECT column1 + 5 FROM t1) FROM t2;
</pre><p>
            Instead of this query:
          </p><pre class="programlisting">
SELECT (SELECT column1 FROM t1) + 5 FROM t2;
</pre></li><li class="listitem"><p>
            Use a row subquery instead of a correlated subquery. For
            example, use this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE (column1,column2) IN (SELECT column1,column2 FROM t2);
</pre><p>
            Instead of this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE EXISTS (SELECT * FROM t2 WHERE t2.column1=t1.column1
                AND t2.column2=t1.column2);
</pre></li><li class="listitem"><p>
            Use <code class="literal">NOT (a = ANY (...))</code> rather than
            <code class="literal">a &lt;&gt; ALL (...)</code>.
          </p></li><li class="listitem"><p>
            Use <code class="literal">x = ANY (<em class="replaceable"><code>table containing
            (1,2)</code></em>)</code> rather than <code class="literal">x=1 OR
            x=2</code>.
          </p></li><li class="listitem"><p>
            Use <code class="literal">= ANY</code> rather than
            <code class="literal">EXISTS</code>.
          </p></li><li class="listitem"><p>
            For uncorrelated subqueries that always return one row,
            <code class="literal">IN</code> is always slower than
            <code class="literal">=</code>. For example, use this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE t1.<em class="replaceable"><code>col_name</code></em> = (SELECT a FROM t2 WHERE b = <em class="replaceable"><code>some_const</code></em>);
</pre><p>
            Instead of this query:
          </p><pre class="programlisting">
SELECT * FROM t1
  WHERE t1.<em class="replaceable"><code>col_name</code></em> IN (SELECT a FROM t2 WHERE b = <em class="replaceable"><code>some_const</code></em>);
</pre></li></ul>
</div>
<p>
        These tricks might cause programs to go faster or slower. Using
        MySQL facilities like the
        <a class="link" href="functions.html#function_benchmark"><code class="literal">BENCHMARK()</code></a> function, you can get
        an idea about what helps in your own situation. See
        <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>.
      </p><p>
        Some optimizations that MySQL itself makes are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            MySQL executes uncorrelated subqueries only once. Use
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to make sure that a
            given subquery really is uncorrelated.
          </p></li><li class="listitem"><p>
            MySQL rewrites <code class="literal">IN</code>,
            <code class="literal">ALL</code>, <code class="literal">ANY</code>, and
            <code class="literal">SOME</code> subqueries in an attempt to take
            advantage of the possibility that the select-list columns in
            the subquery are indexed.
          </p></li><li class="listitem"><p>
            MySQL replaces subqueries of the following form with an
            index-lookup function, which
            <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> describes as a
            special join type
            (<a class="link" href="optimization.html#jointype_unique_subquery"><code class="literal">unique_subquery</code></a> or
            <a class="link" href="optimization.html#jointype_index_subquery"><code class="literal">index_subquery</code></a>):
          </p><pre class="programlisting">
... IN (SELECT <em class="replaceable"><code>indexed_column</code></em> FROM <em class="replaceable"><code>single_table</code></em> ...)
</pre></li><li class="listitem"><p>
            MySQL enhances expressions of the following form with an
            expression involving <a class="link" href="functions.html#function_min"><code class="literal">MIN()</code></a> or
            <a class="link" href="functions.html#function_max"><code class="literal">MAX()</code></a>, unless
            <code class="literal">NULL</code> values or empty sets are involved:
          </p><pre class="programlisting">
<em class="replaceable"><code>value</code></em> {ALL|ANY|SOME} {&gt; | &lt; | &gt;= | &lt;=} (<em class="replaceable"><code>uncorrelated subquery</code></em>)
</pre><p>
            For example, this <code class="literal">WHERE</code> clause:
          </p><pre class="programlisting">
WHERE 5 &gt; ALL (SELECT x FROM t)
</pre><p>
            might be treated by the optimizer like this:
          </p><pre class="programlisting">
WHERE 5 &gt; (SELECT MAX(x) FROM t)
</pre></li></ul>
</div>
<p>
        See also
        <a class="ulink" href="http://dev.mysql.com/doc/internals/en/transformations.html" target="_top">MySQL
        Internals: How MySQL Transforms Subqueries</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="rewriting-subqueries"></a>13.2.10.11 Rewriting Subqueries as Joins</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147185568"></a><p>
        Sometimes there are other ways to test membership in a set of
        values than by using a subquery. Also, on some occasions, it is
        not only possible to rewrite a query without a subquery, but it
        can be more efficient to make use of some of these techniques
        rather than to use subqueries. One of these is the
        <code class="literal">IN()</code> construct:
      </p><p>
        For example, this query:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE id IN (SELECT id FROM t2);
</pre><p>
        Can be rewritten as:
      </p><pre class="programlisting">
SELECT DISTINCT t1.* FROM t1, t2 WHERE t1.id=t2.id;
</pre><p>
        The queries:
      </p><pre class="programlisting">
SELECT * FROM t1 WHERE id NOT IN (SELECT id FROM t2);
SELECT * FROM t1 WHERE NOT EXISTS (SELECT id FROM t2 WHERE t1.id=t2.id);
</pre><p>
        Can be rewritten as:
      </p><pre class="programlisting">
SELECT table1.*
  FROM table1 LEFT JOIN table2 ON table1.id=table2.id
  WHERE table2.id IS NULL;
</pre><p>
        A <code class="literal">LEFT [OUTER] JOIN</code> can be faster than an
        equivalent subquery because the server might be able to optimize
        it better—a fact that is not specific to MySQL Server
        alone. Prior to SQL-92, outer joins did not exist, so subqueries
        were the only way to do certain things. Today, MySQL Server and
        many other modern database systems offer a wide range of outer
        join types.
      </p><p>
        MySQL Server supports multiple-table
        <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements that can be
        used to efficiently delete rows based on information from one
        table or even from many tables at the same time. Multiple-table
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements are also
        supported. See <a class="xref" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax">Section 13.2.2, “DELETE Syntax”</a>, and
        <a class="xref" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax">Section 13.2.11, “UPDATE Syntax”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="update"></a>13.2.11 UPDATE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737147170160"></a><a class="indexterm" name="idm139737147169088"></a><p>
      Single-table syntax:
    </p><pre class="programlisting">
UPDATE [LOW_PRIORITY] [IGNORE] <em class="replaceable"><code>table_reference</code></em>
    SET <em class="replaceable"><code>col_name1</code></em>={<em class="replaceable"><code>expr1</code></em>|DEFAULT} [, <em class="replaceable"><code>col_name2</code></em>={<em class="replaceable"><code>expr2</code></em>|DEFAULT}] ...
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
    [ORDER BY ...]
    [LIMIT <em class="replaceable"><code>row_count</code></em>]
</pre><p>
      Multiple-table syntax:
    </p><pre class="programlisting">
UPDATE [LOW_PRIORITY] [IGNORE] <em class="replaceable"><code>table_references</code></em>
    SET <em class="replaceable"><code>col_name1</code></em>={<em class="replaceable"><code>expr1</code></em>|DEFAULT} [, <em class="replaceable"><code>col_name2</code></em>={<em class="replaceable"><code>expr2</code></em>|DEFAULT}] ...
    [WHERE <em class="replaceable"><code>where_condition</code></em>]
</pre><p>
      For the single-table syntax, the
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement updates columns of
      existing rows in the named table with new values. The
      <code class="literal">SET</code> clause indicates which columns to modify
      and the values they should be given. Each value can be given as an
      expression, or the keyword <code class="literal">DEFAULT</code> to set a
      column explicitly to its default value. The
      <code class="literal">WHERE</code> clause, if given, specifies the
      conditions that identify which rows to update. With no
      <code class="literal">WHERE</code> clause, all rows are updated. If the
      <code class="literal">ORDER BY</code> clause is specified, the rows are
      updated in the order that is specified. The
      <code class="literal">LIMIT</code> clause places a limit on the number of
      rows that can be updated.
    </p><p>
      For the multiple-table syntax,
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> updates rows in each table
      named in <em class="replaceable"><code>table_references</code></em> that satisfy
      the conditions. Each matching row is updated once, even if it
      matches the conditions multiple times. For multiple-table syntax,
      <code class="literal">ORDER BY</code> and <code class="literal">LIMIT</code> cannot be
      used.
    </p><p>
      For partitioned tables, both the single-single and multiple-table
      forms of this statement support the use of a
      <code class="literal">PARTITION</code> option as part of a table reference.
      This option takes a list of one or more partitions or
      subpartitions (or both). Only the partitions (or subpartitions)
      listed are checked for matches, and a row that is not in any of
      these partitions or subpartitions is not updated, whether it
      satisfies the <em class="replaceable"><code>where_condition</code></em> or not.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Unlike the case when using <code class="literal">PARTITION</code> with an
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> or
        <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a> statement, an otherwise
        valid <code class="literal">UPDATE ... PARTITION</code> statement is
        considered successful even if no rows in the listed partitions
        (or subpartitions) match the
        <em class="replaceable"><code>where_condition</code></em>.
</p>
</div>
<p>
      See <a class="xref" href="partitioning.html#partitioning-selection" title="19.5 Partition Selection">Section 19.5, “Partition Selection”</a>, for more information
      and examples.
    </p><p>
      <em class="replaceable"><code>where_condition</code></em> is an expression that
      evaluates to true for each row to be updated. For expression
      syntax, see <a class="xref" href="language-structure.html#expressions" title="9.5 Expression Syntax">Section 9.5, “Expression Syntax”</a>.
    </p><p>
      <em class="replaceable"><code>table_references</code></em> and
      <em class="replaceable"><code>where_condition</code></em> are specified as
      described in <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
    </p><p>
      You need the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege only
      for columns referenced in an <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      that are actually updated. You need only the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for any columns
      that are read but not modified.
    </p><p>
      The <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement supports the
      following modifiers:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          With the <code class="literal">LOW_PRIORITY</code> keyword, execution of
          the <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> is delayed until no
          other clients are reading from the table. This affects only
          storage engines that use only table-level locking (such as
          <code class="literal">MyISAM</code>, <code class="literal">MEMORY</code>, and
          <code class="literal">MERGE</code>).
        </p></li><li class="listitem"><p>
          With the <code class="literal">IGNORE</code> keyword, the update
          statement does not abort even if errors occur during the
          update. Rows for which duplicate-key conflicts occur on a
          unique key value are not updated. Rows updated to values that
          would cause data conversion errors are updated to the closest
          valid values instead.
</p></li></ul>
</div>
<p>
      In MySQL 5.6.4 and later,
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE IGNORE</code></a>
      statements, including those having an <code class="literal">ORDER BY</code>
      clause, are flagged as unsafe for statement-based replication.
      (This is because the order in which the rows are updated
      determines which rows are ignored.) With this change, such
      statements produce a warning in the log when using statement-based
      mode and are logged using the row-based format when using
      <code class="literal">MIXED</code> mode. (Bug #11758262, Bug #50439) See
      <a class="xref" href="replication.html#replication-rbr-safe-unsafe" title="17.1.2.3 Determination of Safe and Unsafe Statements in Binary Logging">Section 17.1.2.3, “Determination of Safe and Unsafe Statements in Binary Logging”</a>, for more
      information.
    </p><p>
      If you access a column from the table to be updated in an
      expression, <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> uses the current
      value of the column. For example, the following statement sets
      <code class="literal">col1</code> to one more than its current value:
    </p><pre class="programlisting">
UPDATE t1 SET col1 = col1 + 1;
</pre><p>
      The second assignment in the following statement sets
      <code class="literal">col2</code> to the current (updated)
      <code class="literal">col1</code> value, not the original
      <code class="literal">col1</code> value. The result is that
      <code class="literal">col1</code> and <code class="literal">col2</code> have the same
      value. This behavior differs from standard SQL.
    </p><pre class="programlisting">
UPDATE t1 SET col1 = col1 + 1, col2 = col1;
</pre><p>
      Single-table <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> assignments are
      generally evaluated from left to right. For multiple-table
      updates, there is no guarantee that assignments are carried out in
      any particular order.
    </p><p>
      If you set a column to the value it currently has, MySQL notices
      this and does not update it.
    </p><p>
      If you update a column that has been declared <code class="literal">NOT
      NULL</code> by setting to <code class="literal">NULL</code>, an error
      occurs if strict SQL mode is enabled; otherwise, the column is set
      to the implicit default value for the column data type and the
      warning count is incremented. The implicit default value is
      <code class="literal">0</code> for numeric types, the empty string
      (<code class="literal">''</code>) for string types, and the
      <span class="quote">“<span class="quote">zero</span>”</span> value for date and time types. See
      <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>.
    </p><a class="indexterm" name="idm139737147101136"></a><p>
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> returns the number of rows
      that were actually changed. The
      <a class="link" href="connectors-apis.html#mysql-info" title="23.8.7.35 mysql_info()"><code class="literal">mysql_info()</code></a> C API function
      returns the number of rows that were matched and updated and the
      number of warnings that occurred during the
      <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>.
    </p><p>
      You can use <code class="literal">LIMIT
      <em class="replaceable"><code>row_count</code></em></code> to restrict the
      scope of the <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>. A
      <code class="literal">LIMIT</code> clause is a rows-matched restriction. The
      statement stops as soon as it has found
      <em class="replaceable"><code>row_count</code></em> rows that satisfy the
      <code class="literal">WHERE</code> clause, whether or not they actually were
      changed.
    </p><p>
      If an <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement includes an
      <code class="literal">ORDER BY</code> clause, the rows are updated in the
      order specified by the clause. This can be useful in certain
      situations that might otherwise result in an error. Suppose that a
      table <code class="literal">t</code> contains a column <code class="literal">id</code>
      that has a unique index. The following statement could fail with a
      duplicate-key error, depending on the order in which rows are
      updated:
    </p><pre class="programlisting">
UPDATE t SET id = id + 1;
</pre><p>
      For example, if the table contains 1 and 2 in the
      <code class="literal">id</code> column and 1 is updated to 2 before 2 is
      updated to 3, an error occurs. To avoid this problem, add an
      <code class="literal">ORDER BY</code> clause to cause the rows with larger
      <code class="literal">id</code> values to be updated before those with
      smaller values:
    </p><pre class="programlisting">
UPDATE t SET id = id + 1 ORDER BY id DESC;
</pre><p>
      You can also perform <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      operations covering multiple tables. However, you cannot use
      <code class="literal">ORDER BY</code> or <code class="literal">LIMIT</code> with a
      multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>. The
      <em class="replaceable"><code>table_references</code></em> clause lists the
      tables involved in the join. Its syntax is described in
      <a class="xref" href="sql-syntax.html#join" title="13.2.9.2 JOIN Syntax">Section 13.2.9.2, “JOIN Syntax”</a>. Here is an example:
    </p><pre class="programlisting">
UPDATE items,month SET items.price=month.price
WHERE items.id=month.id;
</pre><p>
      The preceding example shows an inner join that uses the comma
      operator, but multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      statements can use any type of join permitted in
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements, such as
      <code class="literal">LEFT JOIN</code>.
    </p><p>
      If you use a multiple-table <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>
      statement involving <code class="literal">InnoDB</code> tables for which
      there are foreign key constraints, the MySQL optimizer might
      process tables in an order that differs from that of their
      parent/child relationship. In this case, the statement fails and
      rolls back. Instead, update a single table and rely on the
      <code class="literal">ON UPDATE</code> capabilities that
      <code class="literal">InnoDB</code> provides to cause the other tables to be
      modified accordingly. See
      <a class="xref" href="innodb-storage-engine.html#innodb-foreign-key-constraints" title="14.5.6 InnoDB and FOREIGN KEY Constraints">Section 14.5.6, “InnoDB and FOREIGN KEY Constraints”</a>.
    </p><p>
      Currently, you cannot update a table and select from the same
      table in a subquery.
    </p><p>
      Prior to MySQL 5.6.6, an <code class="literal">UPDATE</code> on a
      partitioned table using a storage engine such as
      <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a> that employs table-level locks
      locked all partitions of the table. This was true even for
      <code class="literal">UPDATE ... PARTITION</code> queries. (This did not and
      does not occur with storage engines such as
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> that employ row-level
      locking.) In MySQL 5.6.6 and later, MySQL uses partition lock
      pruning, so that only partitions containing rows matching the
      <code class="literal">UPDATE</code> statement's
      <code class="literal">WHERE</code> clause are actually locked, as long as
      none of the table's partitioning columns are updated. For
      more information, see
      <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-transactions"></a>13.3 MySQL Transactional and Locking Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#commit">13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cannot-roll-back">13.3.2 Statements That Cannot Be Rolled Back</a></span></dt><dt><span class="section"><a href="sql-syntax.html#implicit-commit">13.3.3 Statements That Cause an Implicit Commit</a></span></dt><dt><span class="section"><a href="sql-syntax.html#savepoint">13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables">13.3.5 LOCK TABLES and UNLOCK TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-transaction">13.3.6 SET TRANSACTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa">13.3.7 XA Transactions</a></span></dt></dl>
</div>
<p>
    MySQL supports local transactions (within a given client session)
    through statements such as
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">SET autocommit</code></a>,
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START TRANSACTION</code></a>,
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>, and
    <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>. See
    <a class="xref" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax">Section 13.3.1, “START TRANSACTION, COMMIT, and ROLLBACK Syntax”</a>. XA transaction support enables MySQL to
    participate in distributed transactions as well. See
    <a class="xref" href="sql-syntax.html#xa" title="13.3.7 XA Transactions">Section 13.3.7, “XA Transactions”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="commit"></a>13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm139737147049968"></a><a class="indexterm" name="idm139737147048928"></a><a class="indexterm" name="idm139737147047856"></a><a class="indexterm" name="idm139737147046784"></a><pre class="programlisting">
START TRANSACTION
    [<em class="replaceable"><code>transaction_characteristic</code></em> [, <em class="replaceable"><code>transaction_characteristic</code></em>] ...]

<em class="replaceable"><code>transaction_characteristic</code></em>:
    WITH CONSISTENT SNAPSHOT
  | READ WRITE
  | READ ONLY

BEGIN [WORK]
COMMIT [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
ROLLBACK [WORK] [AND [NO] CHAIN] [[NO] RELEASE]
SET autocommit = {0 | 1}
</pre><p>
      These statements provide control over use of
      <a class="link" href="glossary.html#glos_transaction" title="transaction">transactions</a>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">START TRANSACTION</code> or
          <code class="literal">BEGIN</code> start a new transaction.
        </p></li><li class="listitem"><p>
          <code class="literal">COMMIT</code> commits the current transaction,
          making its changes permanent.
        </p></li><li class="listitem"><p>
          <code class="literal">ROLLBACK</code> rolls back the current
          transaction, canceling its changes.
        </p></li><li class="listitem"><p>
          <code class="literal">SET autocommit</code> disables or enables the
          default autocommit mode for the current session.
</p></li></ul>
</div>
<p>
      By default, MySQL runs with
      <a class="link" href="glossary.html#glos_autocommit" title="autocommit">autocommit</a> mode enabled.
      This means that as soon as you execute a statement that updates
      (modifies) a table, MySQL stores the update on disk to make it
      permanent. The change cannot be rolled back.
    </p><p>
      To disable autocommit mode implicitly for a single series of
      statements, use the <code class="literal">START TRANSACTION</code>
      statement:
    </p><pre class="programlisting">
START TRANSACTION;
SELECT @A:=SUM(salary) FROM table1 WHERE type=1;
UPDATE table2 SET summary=@A WHERE type=1;
COMMIT;
</pre><p>
      With <code class="literal">START TRANSACTION</code>, autocommit remains
      disabled until you end the transaction with
      <code class="literal">COMMIT</code> or <code class="literal">ROLLBACK</code>. The
      autocommit mode then reverts to its previous state.
    </p><p>
      <code class="literal">START TRANSACTION</code> permits several modifiers
      that control transaction characteristics. To specify multiple
      modifiers, separate them by commas.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <code class="literal">WITH CONSISTENT SNAPSHOT</code> modifier
          starts a
          <a class="link" href="glossary.html#glos_consistent_read" title="consistent read">consistent
          read</a> for storage engines that are capable of it. This
          applies only to <code class="literal">InnoDB</code>. The effect is the
          same as issuing a <code class="literal">START TRANSACTION</code>
          followed by a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> from any
          <code class="literal">InnoDB</code> table. See
          <a class="xref" href="innodb-storage-engine.html#innodb-consistent-read" title="14.2.2.2 Consistent Nonlocking Reads">Section 14.2.2.2, “Consistent Nonlocking Reads”</a>. The
          <code class="literal">WITH CONSISTENT SNAPSHOT</code> modifier does not
          change the current transaction
          <a class="link" href="glossary.html#glos_isolation_level" title="isolation level">isolation level</a>,
          so it provides a consistent snapshot only if the current
          isolation level is one that permits a consistent read. The
          only isolation level that permits a consistent read is
          <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>. For all
          other isolation levels, the <code class="literal">WITH CONSISTENT
          SNAPSHOT</code> clause is ignored.
        </p></li><li class="listitem"><p>
          The <code class="literal">READ WRITE</code> and <code class="literal">READ
          ONLY</code> modifiers set the transaction access mode. They
          permit or prohibit changes to tables used in the transaction.
          The <code class="literal">READ ONLY</code> restriction prevents the
          transaction from modifying or locking both transactional and
          nontransactional tables that are visible to other
          transactions; the transaction can still modify or lock
          temporary tables. These modifiers are available as of MySQL
          5.6.5.
        </p><p>
          MySQL enables extra optimizations for queries on
          <code class="literal">InnoDB</code> tables when the transaction is known
          to be read-only. Specifying <code class="literal">READ ONLY</code>
          ensures these optimizations are applied in cases where the
          read-only status cannot be determined automatically. See
          <a class="xref" href="optimization.html#innodb-performance-ro-txn" title="8.5.3 Optimizing InnoDB Read-Only Transactions">Section 8.5.3, “Optimizing InnoDB Read-Only Transactions”</a> for more
          information.
        </p><p>
          If no access mode is specified, the default mode applies.
          Unless the default has been changed, it is read/write. It is
          not permitted to specify both <code class="literal">READ WRITE</code>
          and <code class="literal">READ ONLY</code> in the same statement.
        </p><p>
          In read-only mode, it remains possible to change tables
          created with the <code class="literal">TEMPORARY</code> keyword using
          DML statements. Changes made with DDL statements are not
          permitted, just as with permanent tables.
        </p><p>
          For additional information about transaction access mode,
          including ways to change the default mode, see
          <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax">Section 13.3.6, “SET TRANSACTION Syntax”</a>.
        </p><p>
          If the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
          variable is enabled, explicitly starting a transaction with
          <code class="literal">START TRANSACTION READ WRITE</code> requires the
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
</p></li></ul>
</div>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Important
</div>
<p>
        Many APIs used for writing MySQL client applications (such as
        JDBC) provide their own methods for starting transactions that
        can (and sometimes should) be used instead of sending a
        <code class="literal">START TRANSACTION</code> statement from the client.
        See <a class="xref" href="connectors-apis.html" title="Chapter 23 Connectors and APIs">Chapter 23, <i>Connectors and APIs</i></a>, or the documentation for
        your API, for more information.
</p>
</div>
<p>
      To disable autocommit mode explicitly, use the following
      statement:
    </p><pre class="programlisting">
SET autocommit=0;
</pre><p>
      After disabling autocommit mode by setting the
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> variable to zero,
      changes to transaction-safe tables (such as those for
      <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> or
      <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a>) are not made permanent
      immediately. You must use <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> to
      store your changes to disk or <code class="literal">ROLLBACK</code> to
      ignore the changes.
    </p><p>
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> is a session variable
      and must be set for each session. To disable autocommit mode for
      each new connection, see the description of the
      <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> system variable at
      <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
    </p><p>
      <code class="literal">BEGIN</code> and <code class="literal">BEGIN WORK</code> are
      supported as aliases of <code class="literal">START TRANSACTION</code> for
      initiating a transaction. <code class="literal">START TRANSACTION</code> is
      standard SQL syntax, is the recommended way to start an ad-hoc
      transaction, and permits modifiers that <code class="literal">BEGIN</code>
      does not.
    </p><p>
      The <code class="literal">BEGIN</code> statement differs from the use of the
      <code class="literal">BEGIN</code> keyword that starts a
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement. The latter does not begin a transaction. See
      <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Within all stored programs (stored procedures and functions,
        triggers, and events), the parser treats <code class="literal">BEGIN
        [WORK]</code> as the beginning of a
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block. Begin a transaction in this context with
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a> instead.
</p>
</div>
<p>
      The optional <code class="literal">WORK</code> keyword is supported for
      <code class="literal">COMMIT</code> and <code class="literal">ROLLBACK</code>, as are
      the <code class="literal">CHAIN</code> and <code class="literal">RELEASE</code>
      clauses. <code class="literal">CHAIN</code> and <code class="literal">RELEASE</code>
      can be used for additional control over transaction completion.
      The value of the <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a>
      system variable determines the default completion behavior. See
      <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
    </p><p>
      The <code class="literal">AND CHAIN</code> clause causes a new transaction
      to begin as soon as the current one ends, and the new transaction
      has the same isolation level as the just-terminated transaction.
      The <code class="literal">RELEASE</code> clause causes the server to
      disconnect the current client session after terminating the
      current transaction. Including the <code class="literal">NO</code> keyword
      suppresses <code class="literal">CHAIN</code> or <code class="literal">RELEASE</code>
      completion, which can be useful if the
      <a class="link" href="server-administration.html#sysvar_completion_type"><code class="literal">completion_type</code></a> system variable
      is set to cause chaining or release completion by default.
    </p><p>
      Beginning a transaction causes any pending transaction to be
      committed. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>, for more
      information.
    </p><p>
      Beginning a transaction also causes table locks acquired with
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to be released, as
      though you had executed
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a>. Beginning a transaction does not release a
      global read lock acquired with
      <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
      LOCK</code></a>.
    </p><p>
      For best results, transactions should be performed using only
      tables managed by a single transaction-safe storage engine.
      Otherwise, the following problems can occur:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          If you use tables from more than one transaction-safe storage
          engine (such as <code class="literal">InnoDB</code>), and the
          transaction isolation level is not
          <a class="link" href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>, it is
          possible that when one transaction commits, another ongoing
          transaction that uses the same tables will see only some of
          the changes made by the first transaction. That is, the
          atomicity of transactions is not guaranteed with mixed engines
          and inconsistencies can result. (If mixed-engine transactions
          are infrequent, you can use
          <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET
          TRANSACTION ISOLATION LEVEL</code></a> to set the isolation
          level to <a class="link" href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a> on a
          per-transaction basis as necessary.)
        </p></li><li class="listitem"><p>
          If you use tables that are not transaction-safe within a
          transaction, changes to those tables are stored at once,
          regardless of the status of autocommit mode.
        </p></li><li class="listitem"><p>
          If you issue a
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
          statement after updating a nontransactional table within a
          transaction, an
          <a class="link" href="error-handling.html#error_er_warning_not_complete_rollback"><code class="literal">ER_WARNING_NOT_COMPLETE_ROLLBACK</code></a>
          warning occurs. Changes to transaction-safe tables are rolled
          back, but not changes to nontransaction-safe tables.
</p></li></ul>
</div>
<p>
      Each transaction is stored in the binary log in one chunk, upon
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>. Transactions that are
      rolled back are not logged.
      (<span class="bold"><strong>Exception</strong></span>: Modifications to
      nontransactional tables cannot be rolled back. If a transaction
      that is rolled back includes modifications to nontransactional
      tables, the entire transaction is logged with a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement at the end to ensure that modifications to the
      nontransactional tables are replicated.) See
      <a class="xref" href="server-administration.html#binary-log" title="5.2.4 The Binary Log">Section 5.2.4, “The Binary Log”</a>.
    </p><p>
      You can change the isolation level or access mode for transactions
      with the <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> statement.
      See <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax">Section 13.3.6, “SET TRANSACTION Syntax”</a>.
    </p><p>
      Rolling back can be a slow operation that may occur implicitly
      without the user having explicitly asked for it (for example, when
      an error occurs). Because of this, <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
      PROCESSLIST</code></a> displays <code class="literal">Rolling back</code> in
      the <code class="literal">State</code> column for the session, not only for
      explicit rollbacks performed with the
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement but also for implicit rollbacks.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        In MySQL 5.6, <code class="literal">BEGIN</code>,
        <code class="literal">COMMIT</code>, and <code class="literal">ROLLBACK</code> are
        not affected by <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a>
        or <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a> rules.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="cannot-roll-back"></a>13.3.2 Statements That Cannot Be Rolled Back</h3>

</div>

</div>

</div>
<p>
      Some statements cannot be rolled back. In general, these include
      data definition language (DDL) statements, such as those that
      create or drop databases, those that create, drop, or alter tables
      or stored routines.
    </p><p>
      You should design your transactions not to include such
      statements. If you issue a statement early in a transaction that
      cannot be rolled back, and then another statement later fails, the
      full effect of the transaction cannot be rolled back in such cases
      by issuing a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
      statement.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="implicit-commit"></a>13.3.3 Statements That Cause an Implicit Commit</h3>

</div>

</div>

</div>
<p>
      The statements listed in this section (and any synonyms for them)
      implicitly end any transaction active in the current session, as
      if you had done a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a> before
      executing the statement. As of MySQL 5.5.3, most of these
      statements also cause an implicit commit after executing; for
      additional details, see the end of this section.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <span class="bold"><strong>Data definition language (DDL)
          statements that define or modify database objects.</strong></span>
          <code class="literal">ALTER DATABASE ... UPGRADE DATA DIRECTORY
          NAME</code>, <a class="link" href="sql-syntax.html#alter-event" title="13.1.2 ALTER EVENT Syntax"><code class="literal">ALTER EVENT</code></a>,
          <a class="link" href="sql-syntax.html#alter-procedure" title="13.1.5 ALTER PROCEDURE Syntax"><code class="literal">ALTER PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#alter-server" title="13.1.6 ALTER SERVER Syntax"><code class="literal">ALTER SERVER</code></a>,
          <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>,
          <a class="link" href="sql-syntax.html#alter-view" title="13.1.9 ALTER VIEW Syntax"><code class="literal">ALTER VIEW</code></a>,
          <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>,
          <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE EVENT</code></a>,
          <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE INDEX</code></a>,
          <a class="link" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax"><code class="literal">CREATE PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#create-server" title="13.1.16 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a>,
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
          <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a>,
          <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a>,
          <a class="link" href="sql-syntax.html#drop-database" title="13.1.21 DROP DATABASE Syntax"><code class="literal">DROP DATABASE</code></a>,
          <a class="link" href="sql-syntax.html#drop-event" title="13.1.22 DROP EVENT Syntax"><code class="literal">DROP EVENT</code></a>,
          <a class="link" href="sql-syntax.html#drop-index" title="13.1.24 DROP INDEX Syntax"><code class="literal">DROP INDEX</code></a>,
          <a class="link" href="sql-syntax.html#drop-procedure" title="13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax"><code class="literal">DROP PROCEDURE</code></a>,
          <a class="link" href="sql-syntax.html#drop-server" title="13.1.27 DROP SERVER Syntax"><code class="literal">DROP SERVER</code></a>,
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>,
          <a class="link" href="sql-syntax.html#drop-trigger" title="13.1.30 DROP TRIGGER Syntax"><code class="literal">DROP TRIGGER</code></a>,
          <a class="link" href="sql-syntax.html#drop-view" title="13.1.31 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a>,
          <a class="link" href="sql-syntax.html#rename-table" title="13.1.32 RENAME TABLE Syntax"><code class="literal">RENAME TABLE</code></a>,
          <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>.
        </p><p>
          <a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a>,
          <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> and
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> also cause an
          implicit commit when used with stored functions, but not with
          UDFs. (<a class="link" href="sql-syntax.html#alter-function" title="13.1.4 ALTER FUNCTION Syntax"><code class="literal">ALTER FUNCTION</code></a> can only
          be used with stored functions.)
        </p><p>
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and
          <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statements do not
          commit a transaction if the <code class="literal">TEMPORARY</code>
          keyword is used. (This does not apply to other operations on
          temporary tables such as <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
          TABLE</code></a> and <a class="link" href="sql-syntax.html#create-index" title="13.1.13 CREATE INDEX Syntax"><code class="literal">CREATE
          INDEX</code></a>, which do cause a commit.) However, although
          no implicit commit occurs, neither can the statement be rolled
          back, which means that the use of such statements causes
          transactional atomicity to be violated. For example, if you
          use <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
          TEMPORARY TABLE</code></a> and then roll back the transaction,
          the table remains in existence.
        </p><p>
          The <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement in
          <code class="literal">InnoDB</code> is processed as a single
          transaction. This means that a
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
          from the user does not undo <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
          TABLE</code></a> statements the user made during that
          transaction.
        </p><p>
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          SELECT</code></a> causes an implicit commit before and after
          the statement is executed when you are creating nontemporary
          tables. (No commit occurs for <code class="literal">CREATE TEMPORARY TABLE
          ... SELECT</code>.) This is to prevent an issue during
          replication where the table could be created on the master
          after a rollback, but fail to be recorded in the binary log,
          and therefore not replicated to the slave. For more
          information, see Bug #22865.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Statements that implicitly use or modify
          tables in the <code class="literal">mysql</code> database.</strong></span>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>,
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
          <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>,
          <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>,
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a>,
          <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Transaction-control and locking
          statements.</strong></span>
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN</code></a>,
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, <code class="literal">SET
          autocommit = 1</code> (if the value is not already 1),
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
          TRANSACTION</code></a>,
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a>.
        </p><p>
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a> commits a transaction only if any tables
          currently have been locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
          TABLES</code></a> to acquire nontransactional table locks. A
          commit does not occur for
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a> following
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
          LOCK</code></a> because the latter statement does not acquire
          table-level locks.
        </p><p>
          Transactions cannot be nested. This is a consequence of the
          implicit commit performed for any current transaction when you
          issue a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
          TRANSACTION</code></a> statement or one of its synonyms.
        </p><p>
          Statements that cause an implicit commit cannot be used in an
          XA transaction while the transaction is in an
          <code class="literal">ACTIVE</code> state.
        </p><p>
          The <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN</code></a>
          statement differs from the use of the <code class="literal">BEGIN</code>
          keyword that starts a
          <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
          END</code></a> compound statement. The latter does not cause an
          implicit commit. See <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Data loading statements.</strong></span>
          <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          INFILE</code></a>.
          <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
          INFILE</code></a> causes an implicit commit only for tables
          using the <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engine. For
          more information, see Bug #11151.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Administrative statements.</strong></span>
          <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE TABLE</code></a>,
          <a class="link" href="sql-syntax.html#cache-index" title="13.7.6.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a>,
          <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a>,
          <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
          CACHE</code></a>, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
          TABLE</code></a>, <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>.
        </p></li><li class="listitem"><p>
          <span class="bold"><strong>Replication control
          statements</strong></span>. Beginning with MySQL 5.6.7:
          <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a>,
          <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>,
          <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>,
          <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>. (Bug
          #13858841)
</p></li></ul>
</div>
<p>
      As of MySQL 5.5.3, most statements that previously caused an
      implicit commit before executing also do so after executing. The
      intent is to handle each such statement in its own special
      transaction because it cannot be rolled back anyway. The following
      list provides additional details pertaining to this change:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> variants
          (<a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> for
          <code class="literal">InnoDB</code> tables and
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
          SELECT</code></a>) that previously were special cases no longer
          are so because <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>
          uniformly causes an implicit commit before and after
          executing.
        </p></li><li class="listitem"><p>
          The <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> and
          <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> statements cause an
          implicit commit.
        </p></li><li class="listitem"><p>
          Transaction-control and locking statements behave as before.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="savepoint"></a>13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146801616"></a><a class="indexterm" name="idm139737146800576"></a><a class="indexterm" name="idm139737146799504"></a><pre class="programlisting">
SAVEPOINT <em class="replaceable"><code>identifier</code></em>
ROLLBACK [WORK] TO [SAVEPOINT] <em class="replaceable"><code>identifier</code></em>
RELEASE SAVEPOINT <em class="replaceable"><code>identifier</code></em>
</pre><p>
      <code class="literal">InnoDB</code> supports the SQL statements
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">SAVEPOINT</code></a>,
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a>,
      <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">RELEASE
      SAVEPOINT</code></a> and the optional <code class="literal">WORK</code>
      keyword for
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>.
    </p><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">SAVEPOINT</code></a> statement sets a
      named transaction savepoint with a name of
      <em class="replaceable"><code>identifier</code></em>. If the current transaction
      has a savepoint with the same name, the old savepoint is deleted
      and a new one is set.
    </p><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a> statement rolls back a transaction to the
      named savepoint without terminating the transaction. Modifications
      that the current transaction made to rows after the savepoint was
      set are undone in the rollback, but <code class="literal">InnoDB</code> does
      <span class="emphasis"><em>not</em></span> release the row locks that were stored in
      memory after the savepoint. (For a new inserted row, the lock
      information is carried by the transaction ID stored in the row;
      the lock is not separately stored in memory. In this case, the row
      lock is released in the undo.) Savepoints that were set at a later
      time than the named savepoint are deleted.
    </p><p>
      If the <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">ROLLBACK TO
      SAVEPOINT</code></a> statement returns the following error, it
      means that no savepoint with the specified name exists:
    </p><pre class="programlisting">
ERROR 1305 (42000): SAVEPOINT <em class="replaceable"><code>identifier</code></em> does not exist
</pre><p>
      The <a class="link" href="sql-syntax.html#savepoint" title="13.3.4 SAVEPOINT, ROLLBACK TO SAVEPOINT, and RELEASE SAVEPOINT Syntax"><code class="literal">RELEASE
      SAVEPOINT</code></a> statement removes the named savepoint from the
      set of savepoints of the current transaction. No commit or
      rollback occurs. It is an error if the savepoint does not exist.
    </p><p>
      All savepoints of the current transaction are deleted if you
      execute a <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">COMMIT</code></a>, or a
      <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a> that
      does not name a savepoint.
    </p><p>
      A new savepoint level is created when a stored function is invoked
      or a trigger is activated. The savepoints on previous levels
      become unavailable and thus do not conflict with savepoints on the
      new level. When the function or trigger terminates, any savepoints
      it created are released and the previous savepoint level is
      restored.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="lock-tables"></a>13.3.5 LOCK TABLES and UNLOCK TABLES Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#lock-tables-and-transactions">13.3.5.1 Interaction of Table Locking and Transactions</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables-and-triggers">13.3.5.2 LOCK TABLES and Triggers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#lock-tables-restrictions">13.3.5.3 Table-Locking Restrictions and Conditions</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737146770240"></a><a class="indexterm" name="idm139737146769200"></a><pre class="programlisting">
LOCK TABLES
    <em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] <em class="replaceable"><code>lock_type</code></em>
    [, <em class="replaceable"><code>tbl_name</code></em> [[AS] <em class="replaceable"><code>alias</code></em>] <em class="replaceable"><code>lock_type</code></em>] ...

<em class="replaceable"><code>lock_type</code></em>:
    READ [LOCAL]
  | [LOW_PRIORITY] WRITE

UNLOCK TABLES
</pre><p>
      MySQL enables client sessions to acquire table locks explicitly
      for the purpose of cooperating with other sessions for access to
      tables, or to prevent other sessions from modifying tables during
      periods when a session requires exclusive access to them. A
      session can acquire or release locks only for itself. One session
      cannot acquire locks for another session or release locks held by
      another session.
    </p><p>
      Locks may be used to emulate transactions or to get more speed
      when updating tables. This is explained in more detail later in
      this section.
    </p><p>
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> explicitly acquires
      table locks for the current client session. Table locks can be
      acquired for base tables or views. You must have the
      <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a> privilege, and the
      <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for each object to
      be locked.
    </p><p>
      For view locking, <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> adds
      all base tables used in the view to the set of tables to be locked
      and locks them automatically. If you lock a table explicitly with
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, any tables used in
      triggers are also locked implicitly, as described in
      <a class="xref" href="sql-syntax.html#lock-tables-and-triggers" title="13.3.5.2 LOCK TABLES and Triggers">Section 13.3.5.2, “LOCK TABLES and Triggers”</a>.
    </p><p>
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a> explicitly releases any table locks held by the
      current session. <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
      implicitly releases any table locks held by the current session
      before acquiring new locks.
    </p><p>
      Another use for
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
      TABLES</code></a> is to release the global read lock acquired with
      the <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
      LOCK</code></a> statement, which enables you to lock all tables in
      all databases. See <a class="xref" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax">Section 13.7.6.3, “FLUSH Syntax”</a>. (This is a very
      convenient way to get backups if you have a file system such as
      Veritas that can take snapshots in time.)
    </p><p>
      A table lock only protects against inappropriate reads or writes
      by other sessions. A session holding a <code class="literal">WRITE</code>
      lock can perform table-level operations such as
      <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> or
      <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>. For sessions
      holding a <code class="literal">READ</code> lock, <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP
      TABLE</code></a> and <a class="link" href="sql-syntax.html#truncate-table" title="13.1.33 TRUNCATE TABLE Syntax"><code class="literal">TRUNCATE TABLE</code></a>
      operations are not permitted.
    </p><p>
      The following discussion applies only to
      non-<code class="literal">TEMPORARY</code> tables. <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
      TABLES</code></a> is permitted (but ignored) for a
      <code class="literal">TEMPORARY</code> table. The table can be accessed
      freely by the session within which it was created, regardless of
      what other locking may be in effect. No lock is necessary because
      no other session can see the table.
    </p><p>
      For information about other conditions on the use of
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and statements that
      cannot be used while <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> is
      in effect, see <a class="xref" href="sql-syntax.html#lock-tables-restrictions" title="13.3.5.3 Table-Locking Restrictions and Conditions">Section 13.3.5.3, “Table-Locking Restrictions and Conditions”</a>
    </p><p>
      <span class="bold"><strong>Rules for Lock Acquisition</strong></span>
    </p><p>
      To acquire table locks within the current session, use the
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement. The
      following lock types are available:
    </p><p>
      <code class="literal">READ [LOCAL]</code> lock:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The session that holds the lock can read the table (but not
          write it).
        </p></li><li class="listitem"><p>
          Multiple sessions can acquire a <code class="literal">READ</code> lock
          for the table at the same time.
        </p></li><li class="listitem"><p>
          Other sessions can read the table without explicitly acquiring
          a <code class="literal">READ</code> lock.
        </p></li><li class="listitem"><p>
          The <code class="literal">LOCAL</code> modifier enables nonconflicting
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> statements (concurrent
          inserts) by other sessions to execute while the lock is held.
          (See <a class="xref" href="optimization.html#concurrent-inserts" title="8.11.3 Concurrent Inserts">Section 8.11.3, “Concurrent Inserts”</a>.) However,
          <code class="literal">READ LOCAL</code> cannot be used if you are going
          to manipulate the database using processes external to the
          server while you hold the lock. For <code class="literal">InnoDB</code>
          tables, <code class="literal">READ LOCAL</code> is the same as
          <code class="literal">READ</code>.
</p></li></ul>
</div>
<p>
      <code class="literal">[LOW_PRIORITY] WRITE</code> lock:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          The session that holds the lock can read and write the table.
        </p></li><li class="listitem"><p>
          Only the session that holds the lock can access the table. No
          other session can access it until the lock is released.
        </p></li><li class="listitem"><p>
          Lock requests for the table by other sessions block while the
          <code class="literal">WRITE</code> lock is held.
        </p></li><li class="listitem"><p>
          The <code class="literal">LOW_PRIORITY</code> modifier has no effect. In
          previous versions of MySQL, it affected locking behavior, but
          this is no longer true. As of MySQL 5.6.5, it is deprecated
          and its use produces a warning. Use <code class="literal">WRITE</code>
          without <code class="literal">LOW_PRIORITY</code> instead.
</p></li></ul>
</div>
<p>
      If the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement must
      wait due to locks held by other sessions on any of the tables, it
      blocks until all locks can be acquired.
    </p><p>
      A session that requires locks must acquire all the locks that it
      needs in a single <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
      statement. While the locks thus obtained are held, the session can
      access only the locked tables. For example, in the following
      sequence of statements, an error occurs for the attempt to access
      <code class="literal">t2</code> because it was not locked in the
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLES t1 READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM t1;</code></strong>
+----------+
| COUNT(*) |
+----------+
|        3 |
+----------+
mysql&gt; <strong class="userinput"><code>SELECT COUNT(*) FROM t2;</code></strong>
ERROR 1100 (HY000): Table 't2' was not locked with LOCK TABLES
</pre><p>
      Tables in the <code class="literal">INFORMATION_SCHEMA</code> database are
      an exception. They can be accessed without being locked explicitly
      even while a session holds table locks obtained with
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>.
    </p><p>
      You cannot refer to a locked table multiple times in a single
      query using the same name. Use aliases instead, and obtain a
      separate lock for the table and each alias:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t WRITE, t AS t1 READ;</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t SELECT * FROM t;</code></strong>
ERROR 1100: Table 't' was not locked with LOCK TABLES
mysql&gt; <strong class="userinput"><code>INSERT INTO t SELECT * FROM t AS t1;</code></strong>
</pre><p>
      The error occurs for the first
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> because there are two
      references to the same name for a locked table. The second
      <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> succeeds because the
      references to the table use different names.
    </p><p>
      If your statements refer to a table by means of an alias, you must
      lock the table using that same alias. It does not work to lock the
      table without specifying the alias:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t AS myalias;</code></strong>
ERROR 1100: Table 'myalias' was not locked with LOCK TABLES
</pre><p>
      Conversely, if you lock a table using an alias, you must refer to
      it in your statements using that alias:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOCK TABLE t AS myalias READ;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT * FROM t;</code></strong>
ERROR 1100: Table 't' was not locked with LOCK TABLES
mysql&gt; <strong class="userinput"><code>SELECT * FROM t AS myalias;</code></strong>
</pre><p>
      <code class="literal">WRITE</code> locks normally have higher priority than
      <code class="literal">READ</code> locks to ensure that updates are processed
      as soon as possible. This means that if one session obtains a
      <code class="literal">READ</code> lock and then another session requests a
      <code class="literal">WRITE</code> lock, subsequent <code class="literal">READ</code>
      lock requests wait until the session that requested the
      <code class="literal">WRITE</code> lock has obtained the lock and released
      it.
    </p><p>
      <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> acquires locks as
      follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          Sort all tables to be locked in an internally defined order.
          From the user standpoint, this order is undefined.
        </p></li><li class="listitem"><p>
          If a table is to be locked with a read and a write lock, put
          the write lock request before the read lock request.
        </p></li><li class="listitem"><p>
          Lock one table at a time until the session gets all locks.
</p></li></ol>
</div>
<p>
      This policy ensures that table locking is deadlock free.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        <code class="literal">LOCK TABLES</code> or <code class="literal">UNLOCK
        TABLES</code>, when applied to a partitioned table, always
        locks or unlocks the entire table; these statements do not
        support partition lock pruning. See
        <a class="xref" href="partitioning.html#partitioning-limitations-locking" title="19.6.4 Partitioning and Locking">Section 19.6.4, “Partitioning and Locking”</a>.
</p>
</div>
<p>
      <span class="bold"><strong>Rules for Lock Release</strong></span>
    </p><p>
      When the table locks held by a session are released, they are all
      released at the same time. A session can release its locks
      explicitly, or locks may be released implicitly under certain
      conditions.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A session can release its locks explicitly with
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a>.
        </p></li><li class="listitem"><p>
          If a session issues a <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
          TABLES</code></a> statement to acquire a lock while already
          holding locks, its existing locks are released implicitly
          before the new locks are granted.
        </p></li><li class="listitem"><p>
          If a session begins a transaction (for example, with
          <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
          TRANSACTION</code></a>), an implicit
          <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
          TABLES</code></a> is performed, which causes existing locks to
          be released. (For additional information about the interaction
          between table locking and transactions, see
          <a class="xref" href="sql-syntax.html#lock-tables-and-transactions" title="13.3.5.1 Interaction of Table Locking and Transactions">Section 13.3.5.1, “Interaction of Table Locking and Transactions”</a>.)
</p></li></ul>
</div>
<p>
      If the connection for a client session terminates, whether
      normally or abnormally, the server implicitly releases all table
      locks held by the session (transactional and nontransactional). If
      the client reconnects, the locks will no longer be in effect. In
      addition, if the client had an active transaction, the server
      rolls back the transaction upon disconnect, and if reconnect
      occurs, the new session begins with autocommit enabled. For this
      reason, clients may wish to disable auto-reconnect. With
      auto-reconnect in effect, the client is not notified if reconnect
      occurs but any table locks or current transaction will have been
      lost. With auto-reconnect disabled, if the connection drops, an
      error occurs for the next statement issued. The client can detect
      the error and take appropriate action such as reacquiring the
      locks or redoing the transaction. See
      <a class="xref" href="connectors-apis.html#auto-reconnect" title="23.8.16 Controlling Automatic Reconnection Behavior">Section 23.8.16, “Controlling Automatic Reconnection Behavior”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        If you use <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on a
        locked table, it may become unlocked. For example, if you
        attempt a second <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
        operation, the result may be an error <code class="literal">Table
        '<em class="replaceable"><code>tbl_name</code></em>' was not locked with LOCK
        TABLES</code>. To handle this, lock the table again prior to
        the second alteration. See also
        <a class="xref" href="error-handling.html#alter-table-problems" title="B.5.7.1 Problems with ALTER TABLE">Section B.5.7.1, “Problems with ALTER TABLE”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="lock-tables-and-transactions"></a>13.3.5.1 Interaction of Table Locking and Transactions</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146649680"></a><p>
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
        TABLES</code></a> interact with the use of transactions as
        follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> is not
            transaction-safe and implicitly commits any active
            transaction before attempting to lock the tables.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> implicitly commits any active transaction,
            but only if <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> has
            been used to acquire table locks. For example, in the
            following set of statements,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> releases the global read lock but does not
            commit the transaction because no table locks are in effect:
          </p><pre class="programlisting">
FLUSH TABLES WITH READ LOCK;
START TRANSACTION;
SELECT ... ;
UNLOCK TABLES;
</pre></li><li class="listitem"><p>
            Beginning a transaction (for example, with
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a>) implicitly commits any current
            transaction and releases existing table locks.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> acquires a global read lock and not
            table locks, so it is not subject to the same behavior as
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with respect to table locking and implicit
            commits. For example,
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> does not release the global read lock.
            See <a class="xref" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax">Section 13.7.6.3, “FLUSH Syntax”</a>.
          </p></li><li class="listitem"><p>
            Other statements that implicitly cause transactions to be
            committed do not release existing table locks. For a list of
            such statements, see <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
          </p></li><li class="listitem"><p>
            The correct way to use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with transactional tables, such as
            <code class="literal">InnoDB</code> tables, is to begin a transaction
            with <code class="literal">SET autocommit = 0</code> (not
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a>) followed by <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a>, and to not call
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> until you commit the transaction
            explicitly. For example, if you need to write to table
            <code class="literal">t1</code> and read from table
            <code class="literal">t2</code>, you can do this:
          </p><pre class="programlisting">
SET autocommit=0;
LOCK TABLES t1 WRITE, t2 READ, ...;
<em class="replaceable"><code>... do something with tables t1 and t2 here ...</code></em>
COMMIT;
UNLOCK TABLES;
</pre><p>
            When you call <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>,
            <code class="literal">InnoDB</code> internally takes its own table
            lock, and MySQL takes its own table lock.
            <code class="literal">InnoDB</code> releases its internal table lock
            at the next commit, but for MySQL to release its table lock,
            you have to call
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a>. You should not have
            <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit = 1</code></a>, because
            then <code class="literal">InnoDB</code> releases its internal table
            lock immediately after the call of <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a>, and deadlocks can very easily happen.
            <code class="literal">InnoDB</code> does not acquire the internal
            table lock at all if <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit =
            1</code></a>, to help old applications avoid unnecessary
            deadlocks.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">ROLLBACK</code></a>
            does not release table locks.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="lock-tables-and-triggers"></a>13.3.5.2 LOCK TABLES and Triggers</h4>

</div>

</div>

</div>
<p>
        If you lock a table explicitly with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a>, any tables used in triggers are also locked
        implicitly:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The locks are taken as the same time as those acquired
            explicitly with the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> statement.
          </p></li><li class="listitem"><p>
            The lock on a table used in a trigger depends on whether the
            table is used only for reading. If so, a read lock suffices.
            Otherwise, a write lock is used.
          </p></li><li class="listitem"><p>
            If a table is locked explicitly for reading with
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, but needs to be
            locked for writing because it might be modified within a
            trigger, a write lock is taken rather than a read lock.
            (That is, an implicit write lock needed due to the table's
            appearance within a trigger causes an explicit read lock
            request for the table to be converted to a write lock
            request.)
</p></li></ul>
</div>
<p>
        Suppose that you lock two tables, <code class="literal">t1</code> and
        <code class="literal">t2</code>, using this statement:
      </p><pre class="programlisting">
LOCK TABLES t1 WRITE, t2 READ;
</pre><p>
        If <code class="literal">t1</code> or <code class="literal">t2</code> have any
        triggers, tables used within the triggers will also be locked.
        Suppose that <code class="literal">t1</code> has a trigger defined like
        this:
      </p><pre class="programlisting">
CREATE TRIGGER t1_a_ins AFTER INSERT ON t1 FOR EACH ROW
BEGIN
  UPDATE t4 SET count = count+1
      WHERE id = NEW.id AND EXISTS (SELECT a FROM t3);
  INSERT INTO t2 VALUES(1, 2);
END;
</pre><p>
        The result of the <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
        statement is that <code class="literal">t1</code> and
        <code class="literal">t2</code> are locked because they appear in the
        statement, and <code class="literal">t3</code> and <code class="literal">t4</code>
        are locked because they are used within the trigger:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">t1</code> is locked for writing per the
            <code class="literal">WRITE</code> lock request.
          </p></li><li class="listitem"><p>
            <code class="literal">t2</code> is locked for writing, even though the
            request is for a <code class="literal">READ</code> lock. This occurs
            because <code class="literal">t2</code> is inserted into within the
            trigger, so the <code class="literal">READ</code> request is converted
            to a <code class="literal">WRITE</code> request.
          </p></li><li class="listitem"><p>
            <code class="literal">t3</code> is locked for reading because it is
            only read from within the trigger.
          </p></li><li class="listitem"><p>
            <code class="literal">t4</code> is locked for writing because it might
            be updated within the trigger.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="lock-tables-restrictions"></a>13.3.5.3 Table-Locking Restrictions and Conditions</h4>

</div>

</div>

</div>
<p>
        You can safely use <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a> to
        terminate a session that is waiting for a table lock. See
        <a class="xref" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax">Section 13.7.6.4, “KILL Syntax”</a>.
      </p><p>
        Do <span class="emphasis"><em>not</em></span> lock any tables that you are using
        with <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a>. An
        <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> in this case
        results in an error because the insert must be handled by a
        separate thread, not by the session which holds the lock.
      </p><p>
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
        TABLES</code></a> cannot be used within stored programs.
      </p><p>
        Tables in the <code class="literal">performance_schema</code> database
        cannot be locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a>, except the
        <code class="literal">setup_<em class="replaceable"><code>xxx</code></em></code> tables.
      </p><p>
        The following statements are prohibited while a
        <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> statement is in
        effect: <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a>,
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE ...
        LIKE</code></a>, <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE VIEW</code></a>,
        <a class="link" href="sql-syntax.html#drop-view" title="13.1.31 DROP VIEW Syntax"><code class="literal">DROP VIEW</code></a>, and DDL statements on
        stored functions and procedures and events.
      </p><p>
        For some operations, system tables in the
        <code class="literal">mysql</code> database must be accessed. For example,
        the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement requires the
        contents of the server-side help tables, and
        <a class="link" href="functions.html#function_convert-tz"><code class="literal">CONVERT_TZ()</code></a> might need to read
        the time zone tables. The server implicitly locks the system
        tables for reading as necessary so that you need not lock them
        explicitly. These tables are treated as just described:
      </p><pre class="programlisting">
mysql.help_category
mysql.help_keyword
mysql.help_relation
mysql.help_topic
mysql.proc
mysql.time_zone
mysql.time_zone_leap_second
mysql.time_zone_name
mysql.time_zone_transition
mysql.time_zone_transition_type
</pre><p>
        If you want to explicitly place a <code class="literal">WRITE</code> lock
        on any of those tables with a <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
        TABLES</code></a> statement, the table must be the only one
        locked; no other table can be locked with the same statement.
      </p><p>
        Normally, you do not need to lock tables, because all single
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements are atomic; no
        other session can interfere with any other currently executing
        SQL statement. However, there are a few cases when locking
        tables may provide an advantage:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If you are going to run many operations on a set of
            <code class="literal">MyISAM</code> tables, it is much faster to lock
            the tables you are going to use. Locking
            <code class="literal">MyISAM</code> tables speeds up inserting,
            updating, or deleting on them because MySQL does not flush
            the key cache for the locked tables until
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> is called. Normally, the key cache is
            flushed after each SQL statement.
          </p><p>
            The downside to locking the tables is that no session can
            update a <code class="literal">READ</code>-locked table (including the
            one holding the lock) and no session can access a
            <code class="literal">WRITE</code>-locked table other than the one
            holding the lock.
          </p></li><li class="listitem"><p>
            If you are using tables for a nontransactional storage
            engine, you must use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK
            TABLES</code></a> if you want to ensure that no other session
            modifies the tables between a
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and an
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>. The example shown
            here requires <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to
            execute safely:
          </p><pre class="programlisting">
LOCK TABLES trans READ, customer WRITE;
SELECT SUM(value) FROM trans WHERE customer_id=<em class="replaceable"><code>some_id</code></em>;
UPDATE customer
  SET total_value=<em class="replaceable"><code>sum_from_previous_statement</code></em>
  WHERE customer_id=<em class="replaceable"><code>some_id</code></em>;
UNLOCK TABLES;
</pre><p>
            Without <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>, it is
            possible that another session might insert a new row in the
            <code class="literal">trans</code> table between execution of the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> and
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements.
</p></li></ul>
</div>
<p>
        You can avoid using <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>
        in many cases by using relative updates (<code class="literal">UPDATE
        customer SET
        <em class="replaceable"><code>value</code></em>=<em class="replaceable"><code>value</code></em>+<em class="replaceable"><code>new_value</code></em></code>)
        or the <a class="link" href="functions.html#function_last-insert-id"><code class="literal">LAST_INSERT_ID()</code></a> function.
      </p><p>
        You can also avoid locking tables in some cases by using the
        user-level advisory lock functions
        <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> and
        <a class="link" href="functions.html#function_release-lock"><code class="literal">RELEASE_LOCK()</code></a>. These locks are
        saved in a hash table in the server and implemented with
        <code class="literal">pthread_mutex_lock()</code> and
        <code class="literal">pthread_mutex_unlock()</code> for high speed. See
        <a class="xref" href="functions.html#miscellaneous-functions" title="12.18 Miscellaneous Functions">Section 12.18, “Miscellaneous Functions”</a>.
      </p><p>
        See <a class="xref" href="optimization.html#internal-locking" title="8.11.1 Internal Locking Methods">Section 8.11.1, “Internal Locking Methods”</a>, for more information on
        locking policy.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="set-transaction"></a>13.3.6 SET TRANSACTION Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146512880"></a><a class="indexterm" name="idm139737146511792"></a><a class="indexterm" name="idm139737146510720"></a><a class="indexterm" name="idm139737146509648"></a><pre class="programlisting">
SET [GLOBAL | SESSION] TRANSACTION
    <em class="replaceable"><code>transaction_characteristic</code></em> [, <em class="replaceable"><code>transaction_characteristic</code></em>] ...

<em class="replaceable"><code>transaction_characteristic</code></em>:
    ISOLATION LEVEL <em class="replaceable"><code>level</code></em>
  | READ WRITE
  | READ ONLY

<em class="replaceable"><code>level</code></em>:
     REPEATABLE READ
   | READ COMMITTED
   | READ UNCOMMITTED
   | SERIALIZABLE
</pre><p>
      This statement specifies
      <a class="link" href="glossary.html#glos_transaction" title="transaction">transaction</a>
      characteristics. It takes a list of one or more characteristic
      values separated by commas. These characteristics set the
      transaction <a class="link" href="glossary.html#glos_isolation_level" title="isolation level">isolation
      level</a> or access mode. The isolation level is used for
      operations on <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> tables. The
      access mode may be specified as of MySQL 5.6.5 and indicates
      whether transactions operate in read/write or read-only mode.
    </p><p>
      In addition, <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> can
      include an optional <code class="literal">GLOBAL</code> or
      <code class="literal">SESSION</code> keyword to indicate the scope of the
      statement.
</p>
<h4><a name="set-transaction-scope"></a>Scope of Transaction Characteristics</h4>
<p>
      You can set transaction characteristics globally, for the current
      session, or for the next transaction:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          With the <code class="literal">GLOBAL</code> keyword, the statement
          applies globally for all subsequent sessions. Existing
          sessions are unaffected.
        </p></li><li class="listitem"><p>
          With the <code class="literal">SESSION</code> keyword, the statement
          applies to all subsequent transactions performed within the
          current session.
        </p></li><li class="listitem"><p>
          Without any <code class="literal">SESSION</code> or
          <code class="literal">GLOBAL</code> keyword, the statement applies to
          the next (not started) transaction performed within the
          current session.
</p></li></ul>
</div>
<p>
      A global change to transaction characteristics requires the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. Any session is
      free to change its session characteristics (even in the middle of
      a transaction), or the characteristics for its next transaction.
    </p><p>
      <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a> without
      <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code> is not
      permitted while there is an active transaction:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>START TRANSACTION;</code></strong>
Query OK, 0 rows affected (0.02 sec)

mysql&gt; <strong class="userinput"><code>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;</code></strong>
ERROR 1568 (25001): Transaction characteristics can't be changed
while a transaction is in progress
</pre><p>
      To set the global default isolation level at server startup, use
      the
      <a class="link" href="server-administration.html#option_mysqld_transaction-isolation"><code class="option">--transaction-isolation=<em class="replaceable"><code>level</code></em></code></a>
      option to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> on the command line or in an
      option file. Values of <em class="replaceable"><code>level</code></em> for this
      option use dashes rather than spaces, so the permissible values
      are <a class="link" href="sql-syntax.html#isolevel_read-uncommitted"><code class="literal">READ-UNCOMMITTED</code></a>,
      <a class="link" href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ-COMMITTED</code></a>,
      <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE-READ</code></a>, or
      <a class="link" href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>. For example, to
      set the default isolation level to
      <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>, use these
      lines in the <code class="literal">[mysqld]</code> section of an option
      file:
    </p><pre class="programlisting">
[mysqld]
transaction-isolation = REPEATABLE-READ
</pre><p>
      It is possible to check or set the global and session transaction
      isolation levels at runtime by using the
      <a class="link" href="server-administration.html#sysvar_tx_isolation"><code class="literal">tx_isolation</code></a> system variable:
    </p><pre class="programlisting">
SELECT @@GLOBAL.tx_isolation, @@tx_isolation;
SET GLOBAL tx_isolation='REPEATABLE-READ';
SET SESSION tx_isolation='SERIALIZABLE';
</pre><p>
      Similarly, to set the transaction access mode at server startup or
      at runtime, use the
      <a class="link" href="server-administration.html#option_mysqld_transaction-read-only"><code class="option">--transaction-read-only</code></a> option or
      <a class="link" href="server-administration.html#sysvar_tx_read_only"><code class="literal">tx_read_only</code></a> system variable. By
      default, these are <code class="literal">OFF</code> (the mode is read/write)
      but can be set to <code class="literal">ON</code> for a default mode of read
      only.
    </p><p>
      Setting the global or session value of
      <a class="link" href="server-administration.html#sysvar_tx_isolation"><code class="literal">tx_isolation</code></a> or
      <a class="link" href="server-administration.html#sysvar_tx_read_only"><code class="literal">tx_read_only</code></a> is equivalent to
      setting the isolation level or access mode with
      <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET GLOBAL
      TRANSACTION</code></a> or
      <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET SESSION
      TRANSACTION</code></a>.
</p>
<h4><a name="set-transaction-isolation-level"></a>Details and Usage of Isolation Levels</h4>
<p>
      <code class="literal">InnoDB</code> supports each of the transaction
      isolation levels described here using different
      <a class="link" href="glossary.html#glos_locking" title="locking">locking</a> strategies. You can
      enforce a high degree of consistency with the default
      <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a> level, for
      operations on crucial data where
      <a class="link" href="glossary.html#glos_acid" title="ACID">ACID</a> compliance is important. Or
      you can relax the consistency rules with
      <a class="link" href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ COMMITTED</code></a> or even
      <a class="link" href="sql-syntax.html#isolevel_read-uncommitted"><code class="literal">READ UNCOMMITTED</code></a>, in situations
      such as bulk reporting where precise consistency and repeatable
      results are less important than minimizing the amount of overhead
      for locking. <a class="link" href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a>
      enforces even stricter rules than
      <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a>, and is used
      mainly in specialized situations, such as with
      <a class="link" href="glossary.html#glos_xa" title="XA">XA</a> transactions and for
      troubleshooting issues with concurrency and
      <a class="link" href="glossary.html#glos_deadlock" title="deadlock">deadlocks</a>.
    </p><p>
      For full information about how these isolation levels work with
      <code class="literal">InnoDB</code> transactions, see
      <a class="xref" href="innodb-storage-engine.html#innodb-transaction-model" title="14.2.2 The InnoDB Transaction Model and Locking">Section 14.2.2, “The InnoDB Transaction Model and Locking”</a>. In particular, for
      additional information about <code class="literal">InnoDB</code>
      record-level locks and how it uses them to execute various types
      of statements, see <a class="xref" href="innodb-storage-engine.html#innodb-record-level-locks" title="14.2.2.4 InnoDB Record, Gap, and Next-Key Locks">Section 14.2.2.4, “InnoDB Record, Gap, and Next-Key Locks”</a> and
      <a class="xref" href="innodb-storage-engine.html#innodb-locks-set" title="14.2.2.6 Locks Set by Different SQL Statements in InnoDB">Section 14.2.2.6, “Locks Set by Different SQL Statements in InnoDB”</a>.
    </p><p>
      The following list describes how MySQL supports the different
      transaction levels. The list goes from the most commonly used
      level to the least used.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="isolevel_repeatable-read"></a>
          <a class="indexterm" name="idm139737146438128"></a>

          <a class="indexterm" name="idm139737146436672"></a>

          <code class="literal">REPEATABLE READ</code>
        </p><p>
          This is the default isolation level for
          <code class="literal">InnoDB</code>. For
          <a class="link" href="glossary.html#glos_consistent_read" title="consistent read">consistent reads</a>,
          there is an important difference from the
          <a class="link" href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ COMMITTED</code></a> isolation
          level: All consistent reads within the same transaction read
          the snapshot established by the first read. This convention
          means that if you issue several plain (nonlocking)
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements within the
          same transaction, these <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
          statements are consistent also with respect to each other. See
          <a class="xref" href="innodb-storage-engine.html#innodb-consistent-read" title="14.2.2.2 Consistent Nonlocking Reads">Section 14.2.2.2, “Consistent Nonlocking Reads”</a>.
        </p><p>
          For <a class="link" href="glossary.html#glos_locking_read" title="locking read">locking reads</a>
          (<a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> with <code class="literal">FOR
          UPDATE</code> or <code class="literal">LOCK IN SHARE MODE</code>),
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements, locking
          depends on whether the statement uses a unique index with a
          unique search condition, or a range-type search condition. For
          a unique index with a unique search condition,
          <code class="literal">InnoDB</code> locks only the index record found,
          not the <a class="link" href="glossary.html#glos_gap" title="gap">gap</a> before it. For
          other search conditions, <code class="literal">InnoDB</code> locks the
          index range scanned, using <a class="link" href="glossary.html#glos_gap_lock" title="gap lock">gap
          locks</a> or <a class="link" href="glossary.html#glos_next_key_lock" title="next-key lock">next-key
          locks</a> to block insertions by other sessions into the
          gaps covered by the range.
        </p></li><li class="listitem"><p><a name="isolevel_read-committed"></a>
          <a class="indexterm" name="idm139737146415392"></a>

          <a class="indexterm" name="idm139737146413920"></a>

          <code class="literal">READ COMMITTED</code>
        </p><p>
          A somewhat Oracle-like isolation level with respect to
          consistent (nonlocking) reads: Each
          <a class="link" href="glossary.html#glos_consistent_read" title="consistent read">consistent read</a>,
          even within the same transaction, sets and reads its own fresh
          <a class="link" href="glossary.html#glos_snapshot" title="snapshot">snapshot</a>. See
          <a class="xref" href="innodb-storage-engine.html#innodb-consistent-read" title="14.2.2.2 Consistent Nonlocking Reads">Section 14.2.2.2, “Consistent Nonlocking Reads”</a>.
        </p><p>
          For <a class="link" href="glossary.html#glos_locking_read" title="locking read">locking reads</a>
          (<a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> with <code class="literal">FOR
          UPDATE</code> or <code class="literal">LOCK IN SHARE MODE</code>),
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statements, and
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> statements,
          <code class="literal">InnoDB</code> locks only index records, not the
          <a class="link" href="glossary.html#glos_gap" title="gap">gaps</a> before them, and thus
          permits the free insertion of new records next to locked
          records.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
            In MySQL 5.6, when <code class="literal">READ
            COMMITTED</code> isolation level is used, or the
            deprecated
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_locks_unsafe_for_binlog"><code class="literal">innodb_locks_unsafe_for_binlog</code></a>
            system variable is enabled, there is no
            <code class="literal">InnoDB</code> gap locking except for foreign-key
            constraint checking and duplicate-key checking. Also, record
            locks for nonmatching rows are released after MySQL has
            evaluated the <code class="literal">WHERE</code> condition.
          </p><p>
            If you use <code class="literal">READ COMMITTED</code> or enable
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_locks_unsafe_for_binlog"><code class="literal">innodb_locks_unsafe_for_binlog</code></a>,
            you <span class="emphasis"><em>must</em></span> use row-based binary logging.
</p>
</div>
</li><li class="listitem"><p><a name="isolevel_read-uncommitted"></a>
          <a class="indexterm" name="idm139737146391792"></a>

          <a class="indexterm" name="idm139737146390336"></a>

          <code class="literal">READ UNCOMMITTED</code>
        </p><p>
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statements are performed
          in a nonlocking fashion, but a possible earlier version of a
          row might be used. Thus, using this isolation level, such
          reads are not consistent. This is also called a
          <a class="link" href="glossary.html#glos_dirty_read" title="dirty read">dirty read</a>. Otherwise,
          this isolation level works like <a class="link" href="sql-syntax.html#isolevel_read-committed"><code class="literal">READ
          COMMITTED</code></a>.
        </p></li><li class="listitem"><p><a name="isolevel_serializable"></a>
          <a class="indexterm" name="idm139737146383024"></a>

          <a class="indexterm" name="idm139737146381552"></a>

          <code class="literal">SERIALIZABLE</code>
        </p><p>
          This level is like <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE
          READ</code></a>, but <code class="literal">InnoDB</code> implicitly
          converts all plain <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>
          statements to <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT
          ... LOCK IN SHARE MODE</code></a> if
          <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a>is disabled. If
          <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a> is enabled, the
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> is its own transaction.
          It therefore is known to be read only and can be serialized if
          performed as a consistent (nonlocking) read and need not block
          for other transactions. (To force a plain
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> to block if other
          transactions have modified the selected rows, disable
          <a class="link" href="server-administration.html#sysvar_autocommit"><code class="literal">autocommit</code></a>.)
</p></li></ul>
</div>
<h4><a name="set-transaction-access-mode"></a>Transaction Access Mode</h4>
<p>
      As of MySQL 5.6.5, the transaction access mode may be specified
      with <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET TRANSACTION</code></a>. By default, a
      transaction takes place in read/write mode, with both reads and
      writes permitted to tables used in the transaction. This mode may
      be specified explicitly using an access mode of <code class="literal">READ
      WRITE</code>.
    </p><p>
      If the transaction access mode is set to <code class="literal">READ
      ONLY</code>, changes to tables are prohibited. This may enable
      storage engines to make performance improvements that are possible
      when writes are not permitted.
    </p><p>
      It is not permitted to specify both <code class="literal">READ WRITE</code>
      and <code class="literal">READ ONLY</code> in the same statement.
    </p><p>
      In read-only mode, it remains possible to change tables created
      with the <code class="literal">TEMPORARY</code> keyword using DML
      statements. Changes made with DDL statements are not permitted,
      just as with permanent tables.
    </p><p>
      The <code class="literal">READ WRITE</code> and <code class="literal">READ ONLY</code>
      access modes also may be specified for an individual transaction
      using the <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
      TRANSACTION</code></a> statement.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="xa"></a>13.3.7 XA Transactions</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#xa-statements">13.3.7.1 XA Transaction SQL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#xa-states">13.3.7.2 XA Transaction States</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737146354400"></a><p>
      Support for <a class="link" href="glossary.html#glos_xa" title="XA">XA</a> transactions is
      available for the <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> storage
      engine. The MySQL XA implementation is based on the X/Open CAE
      document <em class="citetitle">Distributed Transaction Processing: The XA
      Specification</em>. This document is published by The Open
      Group and available at
      <a class="ulink" href="http://www.opengroup.org/public/pubs/catalog/c193.htm" target="_top">http://www.opengroup.org/public/pubs/catalog/c193.htm</a>.
      Limitations of the current XA implementation are described in
      <a class="xref" href="restrictions.html#xa-restrictions" title="D.6 Restrictions on XA Transactions">Section D.6, “Restrictions on XA Transactions”</a>.
    </p><p>
      On the client side, there are no special requirements. The XA
      interface to a MySQL server consists of SQL statements that begin
      with the <code class="literal">XA</code> keyword. MySQL client programs must
      be able to send SQL statements and to understand the semantics of
      the XA statement interface. They do not need be linked against a
      recent client library. Older client libraries also will work.
    </p><p>
      Currently, among the MySQL Connectors, MySQL Connector/J 5.0.0 and
      higher supports XA directly, by means of a class interface that
      handles the XA SQL statement interface for you.
    </p><p>
      XA supports distributed transactions, that is, the ability to
      permit multiple separate transactional resources to participate in
      a global transaction. Transactional resources often are RDBMSs but
      may be other kinds of resources.
    </p><p>
      A global transaction involves several actions that are
      transactional in themselves, but that all must either complete
      successfully as a group, or all be rolled back as a group. In
      essence, this extends ACID properties <span class="quote">“<span class="quote">up a level</span>”</span> so
      that multiple ACID transactions can be executed in concert as
      components of a global operation that also has ACID properties.
      (However, for a distributed transaction, you must use the
      <a class="link" href="sql-syntax.html#isolevel_serializable"><code class="literal">SERIALIZABLE</code></a> isolation level to
      achieve ACID properties. It is enough to use
      <a class="link" href="sql-syntax.html#isolevel_repeatable-read"><code class="literal">REPEATABLE READ</code></a> for a
      nondistributed transaction, but not for a distributed
      transaction.)
    </p><p>
      Some examples of distributed transactions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          An application may act as an integration tool that combines a
          messaging service with an RDBMS. The application makes sure
          that transactions dealing with message sending, retrieval, and
          processing that also involve a transactional database all
          happen in a global transaction. You can think of this as
          <span class="quote">“<span class="quote">transactional email.</span>”</span>
        </p></li><li class="listitem"><p>
          An application performs actions that involve different
          database servers, such as a MySQL server and an Oracle server
          (or multiple MySQL servers), where actions that involve
          multiple servers must happen as part of a global transaction,
          rather than as separate transactions local to each server.
        </p></li><li class="listitem"><p>
          A bank keeps account information in an RDBMS and distributes
          and receives money through automated teller machines (ATMs).
          It is necessary to ensure that ATM actions are correctly
          reflected in the accounts, but this cannot be done with the
          RDBMS alone. A global transaction manager integrates the ATM
          and database resources to ensure overall consistency of
          financial transactions.
</p></li></ul>
</div>
<p>
      Applications that use global transactions involve one or more
      Resource Managers and a Transaction Manager:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A Resource Manager (RM) provides access to transactional
          resources. A database server is one kind of resource manager.
          It must be possible to either commit or roll back transactions
          managed by the RM.
        </p></li><li class="listitem"><p>
          A Transaction Manager (TM) coordinates the transactions that
          are part of a global transaction. It communicates with the RMs
          that handle each of these transactions. The individual
          transactions within a global transaction are
          <span class="quote">“<span class="quote">branches</span>”</span> of the global transaction. Global
          transactions and their branches are identified by a naming
          scheme described later.
</p></li></ul>
</div>
<p>
      The MySQL implementation of XA MySQL enables a MySQL server to act
      as a Resource Manager that handles XA transactions within a global
      transaction. A client program that connects to the MySQL server
      acts as the Transaction Manager.
    </p><p>
      To carry out a global transaction, it is necessary to know which
      components are involved, and bring each component to a point when
      it can be committed or rolled back. Depending on what each
      component reports about its ability to succeed, they must all
      commit or roll back as an atomic group. That is, either all
      components must commit, or all components must roll back. To
      manage a global transaction, it is necessary to take into account
      that any component or the connecting network might fail.
    </p><p>
      The process for executing a global transaction uses two-phase
      commit (2PC). This takes place after the actions performed by the
      branches of the global transaction have been executed.
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
          In the first phase, all branches are prepared. That is, they
          are told by the TM to get ready to commit. Typically, this
          means each RM that manages a branch records the actions for
          the branch in stable storage. The branches indicate whether
          they are able to do this, and these results are used for the
          second phase.
        </p></li><li class="listitem"><p>
          In the second phase, the TM tells the RMs whether to commit or
          roll back. If all branches indicated when they were prepared
          that they will be able to commit, all branches are told to
          commit. If any branch indicated when it was prepared that it
          will not be able to commit, all branches are told to roll
          back.
</p></li></ol>
</div>
<p>
      In some cases, a global transaction might use one-phase commit
      (1PC). For example, when a Transaction Manager finds that a global
      transaction consists of only one transactional resource (that is,
      a single branch), that resource can be told to prepare and commit
      at the same time.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="xa-statements"></a>13.3.7.1 XA Transaction SQL Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737146325856"></a><a class="indexterm" name="idm139737146324816"></a><a class="indexterm" name="idm139737146323328"></a><a class="indexterm" name="idm139737146322256"></a><a class="indexterm" name="idm139737146320768"></a><a class="indexterm" name="idm139737146319696"></a><a class="indexterm" name="idm139737146318208"></a><a class="indexterm" name="idm139737146317136"></a><a class="indexterm" name="idm139737146315648"></a><a class="indexterm" name="idm139737146314576"></a><a class="indexterm" name="idm139737146313088"></a><a class="indexterm" name="idm139737146312016"></a><a class="indexterm" name="idm139737146310528"></a><a class="indexterm" name="idm139737146309008"></a><p>
        To perform XA transactions in MySQL, use the following
        statements:
      </p><pre class="programlisting">
XA {START|BEGIN} <em class="replaceable"><code>xid</code></em> [JOIN|RESUME]

XA END <em class="replaceable"><code>xid</code></em> [SUSPEND [FOR MIGRATE]]

XA PREPARE <em class="replaceable"><code>xid</code></em>

XA COMMIT <em class="replaceable"><code>xid</code></em> [ONE PHASE]

XA ROLLBACK <em class="replaceable"><code>xid</code></em>

XA RECOVER
</pre><p>
        For <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a>, the <code class="literal">JOIN</code> and
        <code class="literal">RESUME</code> clauses are not supported.
      </p><p>
        For <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        END</code></a> the <code class="literal">SUSPEND [FOR MIGRATE]</code>
        clause is not supported.
      </p><p>
        Each XA statement begins with the <code class="literal">XA</code> keyword,
        and most of them require an <em class="replaceable"><code>xid</code></em>
        value. An <em class="replaceable"><code>xid</code></em> is an XA transaction
        identifier. It indicates which transaction the statement applies
        to. <em class="replaceable"><code>xid</code></em> values are supplied by the
        client, or generated by the MySQL server. An
        <em class="replaceable"><code>xid</code></em> value has from one to three
        parts:
      </p><pre class="programlisting">
<em class="replaceable"><code>xid</code></em>: <em class="replaceable"><code>gtrid</code></em> [, <em class="replaceable"><code>bqual</code></em> [, <em class="replaceable"><code>formatID</code></em> ]]
</pre><p>
        <em class="replaceable"><code>gtrid</code></em> is a global transaction
        identifier, <em class="replaceable"><code>bqual</code></em> is a branch
        qualifier, and <em class="replaceable"><code>formatID</code></em> is a number
        that identifies the format used by the
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values. As indicated by the
        syntax, <em class="replaceable"><code>bqual</code></em> and
        <em class="replaceable"><code>formatID</code></em> are optional. The default
        <em class="replaceable"><code>bqual</code></em> value is <code class="literal">''</code>
        if not given. The default <em class="replaceable"><code>formatID</code></em>
        value is 1 if not given.
      </p><p>
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> must be string literals, each
        up to 64 bytes (not characters) long.
        <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> can be specified in several
        ways. You can use a quoted string (<code class="literal">'ab'</code>), hex
        string (<code class="literal">0x6162</code>, <code class="literal">X'ab'</code>), or
        bit value
        (<code class="literal">b'<em class="replaceable"><code>nnnn</code></em>'</code>).
      </p><p>
        <em class="replaceable"><code>formatID</code></em> is an unsigned integer.
      </p><p>
        The <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values are interpreted in bytes
        by the MySQL server's underlying XA support routines. However,
        while an SQL statement containing an XA statement is being
        parsed, the server works with some specific character set. To be
        safe, write <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> as hex strings.
      </p><p>
        <em class="replaceable"><code>xid</code></em> values typically are generated by
        the Transaction Manager. Values generated by one TM must be
        different from values generated by other TMs. A given TM must be
        able to recognize its own <em class="replaceable"><code>xid</code></em> values
        in a list of values returned by the
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> statement.
      </p><p>
        For <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA START
        <em class="replaceable"><code>xid</code></em></code></a> starts an XA
        transaction with the given <em class="replaceable"><code>xid</code></em> value.
        Each XA transaction must have a unique
        <em class="replaceable"><code>xid</code></em> value, so the value must not
        currently be used by another XA transaction. Uniqueness is
        assessed using the <em class="replaceable"><code>gtrid</code></em> and
        <em class="replaceable"><code>bqual</code></em> values. All following XA
        statements for the XA transaction must be specified using the
        same <em class="replaceable"><code>xid</code></em> value as that given in the
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a> statement. If you use any of those statements
        but specify an <em class="replaceable"><code>xid</code></em> value that does
        not correspond to some existing XA transaction, an error occurs.
      </p><p>
        One or more XA transactions can be part of the same global
        transaction. All XA transactions within a given global
        transaction must use the same <em class="replaceable"><code>gtrid</code></em>
        value in the <em class="replaceable"><code>xid</code></em> value. For this
        reason, <em class="replaceable"><code>gtrid</code></em> values must be globally
        unique so that there is no ambiguity about which global
        transaction a given XA transaction is part of. The
        <em class="replaceable"><code>bqual</code></em> part of the
        <em class="replaceable"><code>xid</code></em> value must be different for each
        XA transaction within a global transaction. (The requirement
        that <em class="replaceable"><code>bqual</code></em> values be different is a
        limitation of the current MySQL XA implementation. It is not
        part of the XA specification.)
      </p><p>
        The <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> statement returns information for those XA
        transactions on the MySQL server that are in the
        <code class="literal">PREPARED</code> state. (See
        <a class="xref" href="sql-syntax.html#xa-states" title="13.3.7.2 XA Transaction States">Section 13.3.7.2, “XA Transaction States”</a>.) The output includes a row for each
        such XA transaction on the server, regardless of which client
        started it.
      </p><p>
        <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        RECOVER</code></a> output rows look like this (for an example
        <em class="replaceable"><code>xid</code></em> value consisting of the parts
        <code class="literal">'abc'</code>, <code class="literal">'def'</code>, and
        <code class="literal">7</code>):
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>XA RECOVER;</code></strong>
+----------+--------------+--------------+--------+
| formatID | gtrid_length | bqual_length | data   |
+----------+--------------+--------------+--------+
|        7 |            3 |            3 | abcdef |
+----------+--------------+--------------+--------+
</pre><p>
        The output columns have the following meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">formatID</code> is the
            <em class="replaceable"><code>formatID</code></em> part of the transaction
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">gtrid_length</code> is the length in bytes of
            the <em class="replaceable"><code>gtrid</code></em> part of the
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">bqual_length</code> is the length in bytes of
            the <em class="replaceable"><code>bqual</code></em> part of the
            <em class="replaceable"><code>xid</code></em>
          </p></li><li class="listitem"><p>
            <code class="literal">data</code> is the concatenation of the
            <em class="replaceable"><code>gtrid</code></em> and
            <em class="replaceable"><code>bqual</code></em> parts of the
            <em class="replaceable"><code>xid</code></em>
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="xa-states"></a>13.3.7.2 XA Transaction States</h4>

</div>

</div>

</div>
<p>
        An XA transaction progresses through the following states:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Use <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            START</code></a> to start an XA transaction and put it in the
            <code class="literal">ACTIVE</code> state.
          </p></li><li class="listitem"><p>
            For an <code class="literal">ACTIVE</code> XA transaction, issue the
            SQL statements that make up the transaction, and then issue
            an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            END</code></a> statement.
            <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            END</code></a> puts the transaction in the
            <code class="literal">IDLE</code> state.
          </p></li><li class="listitem"><p>
            For an <code class="literal">IDLE</code> XA transaction, you can issue
            either an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            PREPARE</code></a> statement or an <code class="literal">XA COMMIT ... ONE
            PHASE</code> statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
                PREPARE</code></a> puts the transaction in the
                <code class="literal">PREPARED</code> state. An
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> statement at this point will include
                the transaction's <em class="replaceable"><code>xid</code></em> value
                in its output, because
                <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> lists all XA transactions that are in
                the <code class="literal">PREPARED</code> state.
              </p></li><li class="listitem"><p>
                <code class="literal">XA COMMIT ... ONE PHASE</code> prepares and
                commits the transaction. The
                <em class="replaceable"><code>xid</code></em> value will not be listed
                by <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
                RECOVER</code></a> because the transaction terminates.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            For a <code class="literal">PREPARED</code> XA transaction, you can
            issue an <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            COMMIT</code></a> statement to commit and terminate the
            transaction, or
            <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
            ROLLBACK</code></a> to roll back and terminate the
            transaction.
</p></li></ol>
</div>
<p>
        Here is a simple XA transaction that inserts a row into a table
        as part of a global transaction:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>XA START 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO mytable (i) VALUES(10);</code></strong>
Query OK, 1 row affected (0.04 sec)

mysql&gt; <strong class="userinput"><code>XA END 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>XA PREPARE 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>XA COMMIT 'xatest';</code></strong>
Query OK, 0 rows affected (0.00 sec)
</pre><p>
        Within the context of a given client connection, XA transactions
        and local (non-XA) transactions are mutually exclusive. For
        example, if <a class="link" href="sql-syntax.html#xa-statements" title="13.3.7.1 XA Transaction SQL Syntax"><code class="literal">XA
        START</code></a> has been issued to begin an XA transaction, a
        local transaction cannot be started until the XA transaction has
        been committed or rolled back. Conversely, if a local
        transaction has been started with
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a>, no XA statements can be used until the
        transaction has been committed or rolled back.
      </p><p>
        If an XA transaction is in the <code class="literal">ACTIVE</code> state,
        you cannot issue any statements that cause an implicit commit.
        That would violate the XA contract because you could not roll
        back the XA transaction. You will receive the following error if
        you try to execute such a statement:
      </p><pre class="programlisting">
ERROR 1399 (XAE07): XAER_RMFAIL: The command cannot be executed
when global transaction is in the ACTIVE state
</pre><p>
        Statements to which the preceding remark applies are listed at
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-replication"></a>13.4 Replication Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#replication-master-sql">13.4.1 SQL Statements for Controlling Master Servers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#replication-slave-sql">13.4.2 SQL Statements for Controlling Slave Servers</a></span></dt></dl>
</div>
<p>
    Replication can be controlled through the SQL interface using the
    statements described in this section. One group of statements
    controls master servers, the other controls slave servers.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replication-master-sql"></a>13.4.1 SQL Statements for Controlling Master Servers</h3>

</div>

</div>

</div>

<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#purge-binary-logs">13.4.1.1 PURGE BINARY LOGS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset-master">13.4.1.2 RESET MASTER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-sql-log-bin">13.4.1.3 SET sql_log_bin Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737146199440"></a><a class="indexterm" name="idm139737146197984"></a><a class="indexterm" name="idm139737146196496"></a><p>
      This section discusses statements for managing master replication
      servers. <a class="xref" href="sql-syntax.html#replication-slave-sql" title="13.4.2 SQL Statements for Controlling Slave Servers">Section 13.4.2, “SQL Statements for Controlling Slave Servers”</a>, discusses
      statements for managing slave servers.
    </p><p>
      In addition to the statements described here, the following
      <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> statements are used with
      master servers in replication. For information about these
      statements, see <a class="xref" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax">Section 13.7.5, “SHOW Syntax”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.5.2 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY LOGS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-master-status" title="13.7.5.24 SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a>
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#show-slave-hosts" title="13.7.5.34 SHOW SLAVE HOSTS Syntax"><code class="literal">SHOW SLAVE HOSTS</code></a>
</p></li></ul>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="purge-binary-logs"></a>13.4.1.1 PURGE BINARY LOGS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146181440"></a><a class="indexterm" name="idm139737146180400"></a><pre class="programlisting">
PURGE { BINARY | MASTER } LOGS
    { TO '<em class="replaceable"><code>log_name</code></em>' | BEFORE <em class="replaceable"><code>datetime_expr</code></em> }
</pre><p>
        The binary log is a set of files that contain information about
        data modifications made by the MySQL server. The log consists of
        a set of binary log files, plus an index file (see
        <a class="xref" href="server-administration.html#binary-log" title="5.2.4 The Binary Log">Section 5.2.4, “The Binary Log”</a>).
      </p><p>
        The <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a> statement
        deletes all the binary log files listed in the log index file
        prior to the specified log file name or date.
        <code class="literal">BINARY</code> and <code class="literal">MASTER</code> are
        synonyms. Deleted log files also are removed from the list
        recorded in the index file, so that the given log file becomes
        the first in the list.
      </p><p>
        This statement has no effect if the server was not started with
        the <a class="link" href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> option to enable
        binary logging.
      </p><p>
        Examples:
      </p><pre class="programlisting">
PURGE BINARY LOGS TO 'mysql-bin.010';
PURGE BINARY LOGS BEFORE '2008-04-02 22:46:26';
</pre><p>
        The <code class="literal">BEFORE</code> variant's
        <em class="replaceable"><code>datetime_expr</code></em> argument should
        evaluate to a <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value (a
        value in <code class="literal">'YYYY-MM-DD hh:mm:ss'</code> format).
      </p><p>
        This statement is safe to run while slaves are replicating. You
        need not stop them. If you have an active slave that currently
        is reading one of the log files you are trying to delete, this
        statement does nothing. In MySQL 5.6.12 and later, it fails with
        an error in such cases. (Bug #13727933) However, if a slave is
        not connected and you happen to purge one of the log files it
        has yet to read, the slave will be unable to replicate after it
        reconnects.
      </p><p>
        To safely purge binary log files, follow this procedure:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            On each slave server, use <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE
            STATUS</code></a> to check which log file it is reading.
          </p></li><li class="listitem"><p>
            Obtain a listing of the binary log files on the master
            server with <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.5.2 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY LOGS</code></a>.
          </p></li><li class="listitem"><p>
            Determine the earliest log file among all the slaves. This
            is the target file. If all the slaves are up to date, this
            is the last log file on the list.
          </p></li><li class="listitem"><p>
            Make a backup of all the log files you are about to delete.
            (This step is optional, but always advisable.)
          </p></li><li class="listitem"><p>
            Purge all log files up to but not including the target file.
</p></li></ol>
</div>
<p>
        You can also set the
        <a class="link" href="server-administration.html#sysvar_expire_logs_days"><code class="literal">expire_logs_days</code></a> system
        variable to expire binary log files automatically after a given
        number of days (see <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>).
        If you are using replication, you should set the variable no
        lower than the maximum number of days your slaves might lag
        behind the master.
      </p><p>
        <code class="literal">PURGE BINARY LOGS TO</code> and <code class="literal">PURGE
        BINARY LOGS BEFORE</code> both fail with an error when binary
        log files listed in the <code class="filename">.index</code> file had
        been removed from the system by some other means (such as using
        <span class="command"><strong>rm</strong></span> on Linux). (Bug #18199, Bug #18453) To
        handle such errors, edit the <code class="filename">.index</code> file
        (which is a simple text file) manually to ensure that it lists
        only the binary log files that are actually present, then run
        again the <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>
        statement that failed.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset-master"></a>13.4.1.2 RESET MASTER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146144608"></a><pre class="programlisting">
RESET MASTER
</pre><p>
        Deletes all binary log files listed in the index file, resets
        the binary log index file to be empty, and creates a new binary
        log file.
      </p><p>
        In MySQL 5.6.5 and later, <code class="literal">RESET MASTER</code> also
        clears the values of the
        <a class="link" href="replication.html#sysvar_gtid_purged"><code class="literal">gtid_purged</code></a> system variable
        (known as <a class="link" href="replication.html#sysvar_gtid_lost"><code class="literal">gtid_lost</code></a> in MySQL
        5.6.8 and earlier) as well as the global value of the
        <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a>
        (<a class="link" href="replication.html#sysvar_gtid_done"><code class="literal">gtid_done</code></a>, prior to MySQL
        5.6.9) system variable (but not its session value); that is,
        executing this statement sets each of these values to an empty
        string (<code class="literal">''</code>).
      </p><p>
        This statement is intended to be used only when the master is
        started for the first time.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          The effects of <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a>
          differ from those of <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY
          LOGS</code></a> in 2 key ways:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> removes
              <span class="emphasis"><em>all</em></span> binary log files that are listed
              in the index file, leaving only a single, empty binary log
              file with a numeric suffix of <code class="literal">.000001</code>,
              whereas the numbering is not reset by
              <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>.
            </p></li><li class="listitem"><p>
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> is
              <span class="emphasis"><em>not</em></span> intended to be used while any
              replication slaves are running. The behavior of
              <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> when used
              while slaves are running is undefined (and thus
              unsupported), whereas <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY
              LOGS</code></a> may be safely used while replication slaves
              are running.
</p></li></ol>
</div>
<p>
          See also <a class="xref" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax">Section 13.4.1.1, “PURGE BINARY LOGS Syntax”</a>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> can prove useful
        when you first set up the master and the slave, so that you can
        verify the setup as follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            Start the master and slave, and start replication (see
            <a class="xref" href="replication.html#replication-howto" title="17.1.1 How to Set Up Replication">Section 17.1.1, “How to Set Up Replication”</a>).
          </p></li><li class="listitem"><p>
            Execute a few test queries on the master.
          </p></li><li class="listitem"><p>
            Check that the queries were replicated to the slave.
          </p></li><li class="listitem"><p>
            When replication is running correctly, issue
            <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> followed by
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> on the slave,
            then verify that any unwanted data no longer exists on the
            slave.
          </p></li><li class="listitem"><p>
            Issue <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> on the
            master to clean up the test queries.
</p></li></ol>
</div>
<p>
        After verifying the setup and getting rid of any unwanted and
        log files generated by testing, you can start the slave and
        begin replicating.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-sql-log-bin"></a>13.4.1.3 SET sql_log_bin Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737146103168"></a><pre class="programlisting">
SET sql_log_bin = {0|1}
</pre><p>
        The <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> variable
        controls whether logging to the binary log is done. The default
        value is 1 (do logging). To change logging for the current
        session, change the session value of this variable. The session
        user must have the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a>
        privilege to set this variable. Set this variable to 0 for a
        session to temporarily disable binary logging while making
        changes to the master which you do not want to replicate to the
        slave.
      </p><p>
        As of MySQL 5.5, <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a>
        can be set as a global or session variable. Setting
        <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> globally is only
        detected when a new session is started. Any sessions previously
        running are not impacted when setting
        <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a> globally.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
          Incorrect use of <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a>
          with a global scope means any changes made in an already
          running session are <span class="emphasis"><em>still</em></span> being recorded
          to the binary log and therefore replicated. Exercise extreme
          caution using <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a>
          with a global scope as the above situation could cause
          unexpected results including replication failure.
</p>
</div>
<p>
        In MySQL 5.6, it is not possible to set
        <code class="literal">@@session.sql_log_bin</code> within a transaction or
        subquery. (Bug #53437)
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="replication-slave-sql"></a>13.4.2 SQL Statements for Controlling Slave Servers</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#change-master-to">13.4.2.1 CHANGE MASTER TO Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#master-pos-wait">13.4.2.2 MASTER_POS_WAIT() Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset-slave">13.4.2.3 RESET SLAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-global-sql-slave-skip-counter">13.4.2.4 SET GLOBAL sql_slave_skip_counter Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#start-slave">13.4.2.5 START SLAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stop-slave">13.4.2.6 STOP SLAVE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737146084064"></a><a class="indexterm" name="idm139737146082608"></a><a class="indexterm" name="idm139737146081120"></a><p>
      This section discusses statements for managing slave replication
      servers. <a class="xref" href="sql-syntax.html#replication-master-sql" title="13.4.1 SQL Statements for Controlling Master Servers">Section 13.4.1, “SQL Statements for Controlling Master Servers”</a>, discusses
      statements for managing master servers.
    </p><p>
      In addition to the statements described here,
      <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> and
      <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.5.33 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> are also used
      with replication slaves. For information about these statements,
      see <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax">Section 13.7.5.35, “SHOW SLAVE STATUS Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#show-relaylog-events" title="13.7.5.33 SHOW RELAYLOG EVENTS Syntax">Section 13.7.5.33, “SHOW RELAYLOG EVENTS Syntax”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="change-master-to"></a>13.4.2.1 CHANGE MASTER TO Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737146072672"></a><pre class="programlisting">
CHANGE MASTER TO <em class="replaceable"><code>option</code></em> [, <em class="replaceable"><code>option</code></em>] ...

<em class="replaceable"><code>option</code></em>:
    MASTER_BIND = '<em class="replaceable"><code>interface_name</code></em>'
  | MASTER_HOST = '<em class="replaceable"><code>host_name</code></em>'
  | MASTER_USER = '<em class="replaceable"><code>user_name</code></em>'
  | MASTER_PASSWORD = '<em class="replaceable"><code>password</code></em>'
  | MASTER_PORT = <em class="replaceable"><code>port_num</code></em>
  | MASTER_CONNECT_RETRY = <em class="replaceable"><code>interval</code></em>
  | MASTER_RETRY_COUNT = <em class="replaceable"><code>count</code></em>
  | MASTER_DELAY = <em class="replaceable"><code>interval</code></em>
  | MASTER_HEARTBEAT_PERIOD = <em class="replaceable"><code>interval</code></em>
  | MASTER_LOG_FILE = '<em class="replaceable"><code>master_log_name</code></em>'
  | MASTER_LOG_POS = <em class="replaceable"><code>master_log_pos</code></em>
  | MASTER_AUTO_POSITION = {0|1}
  | RELAY_LOG_FILE = '<em class="replaceable"><code>relay_log_name</code></em>'
  | RELAY_LOG_POS = <em class="replaceable"><code>relay_log_pos</code></em>
  | MASTER_SSL = {0|1}
  | MASTER_SSL_CA = '<em class="replaceable"><code>ca_file_name</code></em>'
  | MASTER_SSL_CAPATH = '<em class="replaceable"><code>ca_directory_name</code></em>'
  | MASTER_SSL_CERT = '<em class="replaceable"><code>cert_file_name</code></em>'
  | MASTER_SSL_CRL = '<em class="replaceable"><code>crl_file_name</code></em>'
  | MASTER_SSL_CRLPATH = '<em class="replaceable"><code>crl_directory_name</code></em>'
  | MASTER_SSL_KEY = '<em class="replaceable"><code>key_file_name</code></em>'
  | MASTER_SSL_CIPHER = '<em class="replaceable"><code>cipher_list</code></em>'
  | MASTER_SSL_VERIFY_SERVER_CERT = {0|1}
  | IGNORE_SERVER_IDS = (<em class="replaceable"><code>server_id_list</code></em>)

<em class="replaceable"><code>server_id_list</code></em>:
    [<em class="replaceable"><code>server_id</code></em> [, <em class="replaceable"><code>server_id</code></em>] ... ]
</pre><p>
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> changes the
        parameters that the slave server uses for connecting to the
        master server, for reading the master binary log, and reading
        the slave relay log. It also updates the contents of the master
        info and relay log info repositories (see
        <a class="xref" href="replication.html#slave-logs" title="17.2.2 Replication Relay and Status Logs">Section 17.2.2, “Replication Relay and Status Logs”</a>). To use
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>, the slave
        replication threads must be stopped (use
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> if necessary). In
        MySQL 5.6.11 and later,
        <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a> must also be set to
        <code class="literal">AUTOMATIC</code> (Bug #16062608).
      </p><p>
        Options not specified retain their value, except as indicated in
        the following discussion. Thus, in most cases, there is no need
        to specify options that do not change. For example, if the
        password to connect to your MySQL master has changed, you just
        need to issue these statements to tell the slave about the new
        password:
      </p><pre class="programlisting">
STOP SLAVE; -- if replication was running
CHANGE MASTER TO MASTER_PASSWORD='new3cret';
START SLAVE; -- if you want to restart replication
</pre><p>
        <code class="literal">MASTER_HOST</code>, <code class="literal">MASTER_USER</code>,
        <code class="literal">MASTER_PASSWORD</code>, and
        <code class="literal">MASTER_PORT</code> provide information to the slave
        about how to connect to its master:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MASTER_HOST</code> and
            <code class="literal">MASTER_PORT</code> are the host name (or IP
            address) of the master host and its TCP/IP port.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              Replication cannot use Unix socket files. You must be able
              to connect to the master MySQL server using TCP/IP.
</p>
</div>
<p>
            If you specify the <code class="literal">MASTER_HOST</code> or
            <code class="literal">MASTER_PORT</code> option, the slave assumes
            that the master server is different from before (even if the
            option value is the same as its current value.) In this
            case, the old values for the master binary log file name and
            position are considered no longer applicable, so if you do
            not specify <code class="literal">MASTER_LOG_FILE</code> and
            <code class="literal">MASTER_LOG_POS</code> in the statement,
            <code class="literal">MASTER_LOG_FILE=''</code> and
            <code class="literal">MASTER_LOG_POS=4</code> are silently appended to
            it.
          </p><p>
            Setting <code class="literal">MASTER_HOST=''</code> (that is, setting
            its value explicitly to an empty string) is
            <span class="emphasis"><em>not</em></span> the same as not setting
            <code class="literal">MASTER_HOST</code> at all. Beginning with MySQL
            5.5, trying to set <code class="literal">MASTER_HOST</code> to an
            empty string fails with an error. Previously, setting
            <code class="literal">MASTER_HOST</code> to an empty string caused
            <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> subsequently to
            fail. (Bug #28796)
          </p><p>
            In MySQL 5.6.5 and later, values used for
            <code class="literal">MASTER_HOST</code> and other <code class="literal">CHANGE
            MASTER TO</code> options are checked for linefeed
            (<code class="literal">\n</code> or <code class="literal">0x0A</code>)
            characters; the presence of such characters in these values
            causes the statement to fail with
            <span class="errorname">ER_MASTER_INFO</span>. (Bug #11758581, Bug
            #50801)
          </p></li><li class="listitem"><p>
            <code class="literal">MASTER_USER</code> and
            <code class="literal">MASTER_PASSWORD</code> are the user name and
            password of the account to use for connecting to the master.
          </p><p>
            In MySQL 5.6.4 and later, <code class="literal">MASTER_USER</code>
            cannot be made empty; setting <code class="literal">MASTER_USER =
            ''</code> or leaving it unset when setting a value for
            <code class="literal">MASTER_PASSWORD</code> causes an error (Bug
            #13427949).
          </p><p>
            The password used for a MySQL Replication slave account in a
            <code class="literal">CHANGE MASTER TO</code> statement is limited to
            32 characters in length; if the password is longer, the
            statement succeeds, but any excess characters are silently
            truncated. This is an issue specific to MySQL Replication,
            which is fixed in MySQL 5.7. (Bug #11752299, Bug #43439)
          </p><p>
            The text of a running <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement, including values for
            <code class="literal">MASTER_USER</code> and
            <code class="literal">MASTER_PASSWORD</code>, can be seen in the
            output of a concurrent <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
            PROCESSLIST</code></a> statement. (The complete text of a
            <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement is also
            visible to <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>.)
</p></li></ul>
</div>
<p>
        The <code class="literal">MASTER_SSL_<em class="replaceable"><code>xxx</code></em></code>
        options provide information about using SSL for the connection.
        They correspond to the
        <code class="option">--ssl-<em class="replaceable"><code>xxx</code></em></code> options
        described in <a class="xref" href="security.html#ssl-options" title="6.3.10.4 SSL Command Options">Section 6.3.10.4, “SSL Command Options”</a>, and
        <a class="xref" href="replication.html#replication-solutions-ssl" title="17.3.7 Setting Up Replication Using SSL">Section 17.3.7, “Setting Up Replication Using SSL”</a>. These options can
        be changed even on slaves that are compiled without SSL support.
        They are saved to the master info repository, but are ignored if
        the slave does not have SSL support enabled.
        <code class="literal">MASTER_SSL_CRL</code> and
        <code class="literal">MASTER_SSL_CRLPATH</code> were added in MySQL 5.6.3.
      </p><p>
        <code class="literal">MASTER_CONNECT_RETRY</code> specifies how many
        seconds to wait between connect retries. The default is 60.
      </p><p>
        <code class="literal">MASTER_RETRY_COUNT</code>, added in MySQL 5.6.1,
        limits the <span class="emphasis"><em>number</em></span> of reconnection attempts
        and updates the value of the
        <code class="literal">Master_Retry_Count</code> column in the output of
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> (also added in
        MySQL 5.6.1). The default value is 24 * 3600 = 86400.
        <code class="literal">MASTER_RETRY_COUNT</code> is intended to replace the
        older <a class="link" href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a> server
        option, and is now the preferred method for setting this limit.
        You are encouraged not to rely on
        <a class="link" href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a> in new
        applications and, when upgrading to MySQL 5.6.1 or later from
        earlier versions of MySQL, to update any existing applications
        that rely on it, so that they use <code class="literal">CHANGE MASTER TO ...
        MASTER_RETRY_COUNT</code> instead.
      </p><p>
        <code class="literal">MASTER_DELAY</code> specifies how many seconds
        behind the master the slave must lag. An event received from the
        master is not executed until at least
        <em class="replaceable"><code>interval</code></em> seconds later than its
        execution on the master. The default is 0. An error occurs if
        <em class="replaceable"><code>interval</code></em> is not a nonnegative integer
        in the range from 0 to 2<sup>31</sup>−1.
        For more information, see <a class="xref" href="replication.html#replication-delayed" title="17.3.9 Delayed Replication">Section 17.3.9, “Delayed Replication”</a>.
        This option was added in MySQL 5.6.0.
      </p><p>
        <code class="literal">MASTER_BIND</code> is for use on replication slaves
        having multiple network interfaces, and determines which of the
        slave's network interfaces is chosen for connecting to the
        master.
      </p><p>
        The address configured with this option, if any, can be seen in
        the <code class="literal">Master_Bind</code> column of the output from
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. If you are
        using slave status log tables (server started with
        <a class="link" href="replication.html#option_mysqld_master-info-repository"><code class="option">--master-info-repository=TABLE</code></a>),
        the value can also be seen as the <code class="literal">Master_bind</code>
        column of the <code class="literal">mysql.slave_master_info</code> table.
      </p><p>
        The ability to bind a replication slave to a specific network
        interface was added in MySQL 5.6.2. This is also supported by
        MySQL Cluster NDB 7.3.1 and later.
      </p><p>
        <code class="literal">MASTER_HEARTBEAT_PERIOD</code> sets the interval in
        seconds between replication heartbeats. Whenever the master's
        binary log is updated with an event, the waiting period for the
        next heartbeat is reset. <em class="replaceable"><code>interval</code></em> is
        a decimal value having the range 0 to 4294967 seconds and a
        resolution in milliseconds; the smallest nonzero value is 0.001.
        Heartbeats are sent by the master only if there are no unsent
        events in the binary log file for a period longer than
        <em class="replaceable"><code>interval</code></em>.
      </p><p>
        If you are logging master connection information to tables,
        <code class="literal">MASTER_HEARTBEAT_PERIOD</code> can be seen as the
        value of the <code class="literal">Heartbeat</code> column of the
        <code class="literal">mysql.slave_master_info</code> table.
      </p><p>
        Setting <em class="replaceable"><code>interval</code></em> to 0 disables
        heartbeats altogether. The default value for
        <em class="replaceable"><code>interval</code></em> is equal to the value of
        <a class="link" href="replication.html#sysvar_slave_net_timeout"><code class="literal">slave_net_timeout</code></a> divided by 2.
      </p><p>
        Setting <code class="literal">@@global.slave_net_timeout</code> to a value
        less than that of the current heartbeat interval results in a
        warning being issued. The effect of issuing
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> on the heartbeat
        interval is to reset it to the default value.
      </p><p>
        <code class="literal">MASTER_LOG_FILE</code> and
        <code class="literal">MASTER_LOG_POS</code> are the coordinates at which
        the slave I/O thread should begin reading from the master the
        next time the thread starts. <code class="literal">RELAY_LOG_FILE</code>
        and <code class="literal">RELAY_LOG_POS</code> are the coordinates at
        which the slave SQL thread should begin reading from the relay
        log the next time the thread starts. If you specify either of
        <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POS</code>, you cannot specify
        <code class="literal">RELAY_LOG_FILE</code> or
        <code class="literal">RELAY_LOG_POS</code>. In MySQL 5.6.5 and later, if
        you specify either of <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POS</code>, you also cannot specify
        <code class="literal">MASTER_AUTO_POSITION = 1</code> (described later in
        this section). If neither of <code class="literal">MASTER_LOG_FILE</code>
        or <code class="literal">MASTER_LOG_POS</code> is specified, the slave
        uses the last coordinates of the <span class="emphasis"><em>slave SQL
        thread</em></span> before <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> was issued. This ensures that there is no
        discontinuity in replication, even if the slave SQL thread was
        late compared to the slave I/O thread, when you merely want to
        change, say, the password to use.
      </p><p>
        <code class="literal">MASTER_AUTO_POSITION</code> was added in MySQL
        5.6.5. If <code class="literal">MASTER_AUTO_POSITION = 1</code> is used
        with <code class="literal">CHANGE MASTER TO</code>, the slave attempts to
        connect to the master using the GTID-based replication protocol.
      </p><p>
        When using GTIDs, the slave tells the master which transactions
        it has already received, executed, or both. To compute this set,
        it reads the global value of
        <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> and the value of
        the <code class="literal">Retrieved_gtid_set</code> column from
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. Since the GTID
        of the last transmitted transaction is included in
        <code class="literal">Retrieved_gtid_set</code> even if the transaction
        was only partially transmitted, the last received GTID is
        subtracted from this set. Thus, the slave computes the following
        set:
      </p><pre class="programlisting">
UNION(@@global.gtid_executed, Retrieved_gtid_set - <em class="replaceable"><code>last_received_GTID</code></em>)
</pre><p>
        This set is sent to the master as part of the initial handshake,
        and the master sends back all transactions that it has executed
        which are not part of the set. If any of these transactions have
        been already purged from the master's binary log, the
        master sends the error
        <span class="errorname">ER_MASTER_HAS_PURGED_REQUIRED_GTIDS</span> to
        the slave, and replication does not start.
      </p><p>
        When GTID-based replication is employed, the coordinates
        represented by <code class="literal">MASTER_LOG_FILE</code> and
        <code class="literal">MASTER_LOG_POS</code> are not used, and global
        transaction identifiers are used instead. Thus the use of either
        or both of these options together with
        <code class="literal">MASTER_AUTO_POSITION</code> causes an error.
      </p><p>
        Beginning with MySQL 5.6.10, you can see whether replication is
        running with autopositioning enabled by checking the output of
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. (Bug
        #15992220)
      </p><p>
        <a class="link" href="replication.html#sysvar_gtid_mode"><code class="literal">gtid_mode</code></a> must also be enabled
        before issuing <code class="literal">CHANGE MASTER TO ...
        MASTER_AUTO_POSITION = 1</code>. Otherwise, the statement
        fails with an error.
      </p><p>
        To revert to the older file-based replication protocol after
        using GTIDs, you can issue a new <code class="literal">CHANGE MASTER
        TO</code> statement that specifies
        <code class="literal">MASTER_AUTO_POSITION = 0</code>, as well as at least
        one of <code class="literal">MASTER_LOG_FILE</code> or
        <code class="literal">MASTER_LOG_POSITION</code>.
      </p><p>
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
        <span class="emphasis"><em>deletes all relay log files</em></span> and starts a
        new one, unless you specify <code class="literal">RELAY_LOG_FILE</code> or
        <code class="literal">RELAY_LOG_POS</code>. In that case, relay log files
        are kept; the <a class="link" href="server-administration.html#sysvar_relay_log_purge"><code class="literal">relay_log_purge</code></a>
        global variable is set silently to 0.
      </p><p>
        Prior to MySQL 5.6.2, <code class="literal">RELAY_LOG_FILE</code> required
        an absolute path. Beginning with MySQL 5.6.2, the path can be
        relative, in which case it is assumed to be relative to the
        slave's data directory. (Bug #12190)
      </p><p>
        <code class="literal">IGNORE_SERVER_IDS</code> takes a comma-separated
        list of 0 or more server IDs. Events originating from the
        corresponding servers are ignored, with the exception of log
        rotation and deletion events, which are still recorded in the
        relay log.
      </p><p>
        In circular replication, the originating server normally acts as
        the terminator of its own events, so that they are not applied
        more than once. Thus, this option is useful in circular
        replication when one of the servers in the circle is removed.
        Suppose that you have a circular replication setup with 4
        servers, having server IDs 1, 2, 3, and 4, and server 3 fails.
        When bridging the gap by starting replication from server 2 to
        server 4, you can include <code class="literal">IGNORE_SERVER_IDS =
        (3)</code> in the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
        TO</code></a> statement that you issue on server 4 to tell it to
        use server 2 as its master instead of server 3. Doing so causes
        it to ignore and not to propagate any statements that originated
        with the server that is no longer in use.
      </p><p>
        When a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement
        is issued without any <code class="literal">IGNORE_SERVER_IDS</code>
        option, any existing list is preserved. To clear the list of
        ignored servers, it is necessary to use the option with an empty
        list:
      </p><pre class="programlisting">
CHANGE MASTER TO IGNORE_SERVER_IDS = ();
</pre><p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE
        ALL</code></a> has no effect on the server ID list. This issue is
        fixed in MySQL 5.7. (Bug #18816897)
      </p><p>
        If <code class="literal">IGNORE_SERVER_IDS</code> contains the
        server's own ID and the server was started with the
        <a class="link" href="replication.html#option_mysqld_replicate-same-server-id"><code class="option">--replicate-same-server-id</code></a> option
        enabled, an error results.
      </p><p>
        In MySQL 5.6, the master info repository and the
        output of <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>
        provide the list of servers that are currently ignored. For more
        information, see <a class="xref" href="replication.html#slave-logs-status" title="17.2.2.2 Slave Status Logs">Section 17.2.2.2, “Slave Status Logs”</a>, and
        <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax">Section 13.7.5.35, “SHOW SLAVE STATUS Syntax”</a>.
      </p><p>
        In MySQL 5.6, invoking <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE
        MASTER TO</code></a> causes the previous values for
        <code class="literal">MASTER_HOST</code>, <code class="literal">MASTER_PORT</code>,
        <code class="literal">MASTER_LOG_FILE</code>, and
        <code class="literal">MASTER_LOG_POS</code> to be written to the error
        log, along with other information about the slave's state
        prior to execution.
      </p><p>
        In MySQL 5.6.7 and later, <code class="literal">CHANGE MASTER TO</code>
        causes an implicit commit of an ongoing transaction. See
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> is useful for
        setting up a slave when you have the snapshot of the master and
        have recorded the master binary log coordinates corresponding to
        the time of the snapshot. After loading the snapshot into the
        slave to synchronize it with the master, you can run
        <code class="literal">CHANGE MASTER TO
        MASTER_LOG_FILE='<em class="replaceable"><code>log_name</code></em>',
        MASTER_LOG_POS=<em class="replaceable"><code>log_pos</code></em></code> on
        the slave to specify the coordinates at which the slave should
        begin reading the master binary log.
      </p><p>
        The following example changes the master server the slave uses
        and establishes the master binary log coordinates from which the
        slave begins reading. This is used when you want to set up the
        slave to replicate the master:
      </p><pre class="programlisting">
CHANGE MASTER TO
  MASTER_HOST='master2.mycompany.com',
  MASTER_USER='replication',
  MASTER_PASSWORD='bigs3cret',
  MASTER_PORT=3306,
  MASTER_LOG_FILE='master2-bin.001',
  MASTER_LOG_POS=4,
  MASTER_CONNECT_RETRY=10;
</pre><p>
        The next example shows an operation that is less frequently
        employed. It is used when the slave has relay log files that you
        want it to execute again for some reason. To do this, the master
        need not be reachable. You need only use
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> and start the
        SQL thread (<code class="literal">START SLAVE SQL_THREAD</code>):
      </p><pre class="programlisting">
CHANGE MASTER TO
  RELAY_LOG_FILE='slave-relay-bin.006',
  RELAY_LOG_POS=4025;
</pre><p>
        You can even use the second operation in a nonreplication setup
        with a standalone, nonslave server for recovery following a
        crash. Suppose that your server has crashed and you have
        restored it from a backup. You want to replay the server's own
        binary log files (not relay log files, but regular binary log
        files), named (for example) <code class="filename">myhost-bin.*</code>.
        First, make a backup copy of these binary log files in some safe
        place, in case you don't exactly follow the procedure below and
        accidentally have the server purge the binary log. Use
        <code class="literal">SET GLOBAL relay_log_purge=0</code> for additional
        safety. Then start the server without the
        <a class="link" href="replication.html#option_mysqld_log-bin"><code class="option">--log-bin</code></a> option, Instead, use
        the <a class="link" href="replication.html#option_mysqld_replicate-same-server-id"><code class="option">--replicate-same-server-id</code></a>,
        <a class="link" href="replication.html#option_mysqld_relay-log"><code class="option">--relay-log=myhost-bin</code></a> (to make
        the server believe that these regular binary log files are relay
        log files) and <a class="link" href="replication.html#option_mysqld_skip-slave-start"><code class="option">--skip-slave-start</code></a>
        options. After the server starts, issue these statements:
      </p><pre class="programlisting">
CHANGE MASTER TO
  RELAY_LOG_FILE='myhost-bin.153',
  RELAY_LOG_POS=410,
  MASTER_HOST='some_dummy_string';
START SLAVE SQL_THREAD;
</pre><p>
        The server reads and executes its own binary log files, thus
        achieving crash recovery. Once the recovery is finished, run
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a>, shut down the server,
        clear the master info and relay log info repositories, and
        restart the server with its original options.
      </p><p>
        Specifying the <code class="literal">MASTER_HOST</code> option (even with
        a dummy value) is required to make the server think it is a
        slave.
      </p><p>
        The following table shows the maximum permissible length for the
        string-valued options.
</p>
<div class="informaltable">
<table summary="This table shows the maximum permissible length for
          MASTER_POS_WAIT() string-valued
options." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Option</th><th scope="col">Maximum Length</th></tr></thead><tbody><tr><td scope="row"><code class="literal">MASTER_HOST</code></td><td>60</td></tr><tr><td scope="row"><code class="literal">MASTER_USER</code></td><td>16</td></tr><tr><td scope="row"><code class="literal">MASTER_PASSWORD</code></td><td>32</td></tr><tr><td scope="row"><code class="literal">MASTER_LOG_FILE</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">RELAY_LOG_FILE</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CA</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CAPATH</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CERT</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CRL</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CRLPATH</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_KEY</code></td><td>255</td></tr><tr><td scope="row"><code class="literal">MASTER_SSL_CIPHER</code></td><td>511</td></tr></tbody></table>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="master-pos-wait"></a>13.4.2.2 MASTER_POS_WAIT() Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145871152"></a><pre class="programlisting">
SELECT MASTER_POS_WAIT('<em class="replaceable"><code>master_log_file</code></em>', <em class="replaceable"><code>master_log_pos</code></em> [, <em class="replaceable"><code>timeout</code></em>])
</pre><p>
        This is actually a function, not a statement. It is used to
        ensure that the slave has read and executed events up to a given
        position in the master's binary log. See
        <a class="xref" href="functions.html#miscellaneous-functions" title="12.18 Miscellaneous Functions">Section 12.18, “Miscellaneous Functions”</a>, for a full
        description.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset-slave"></a>13.4.2.3 RESET SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145865552"></a><a class="indexterm" name="idm139737145864480"></a><pre class="programlisting">
RESET SLAVE [ALL]
</pre><p>
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> makes the slave
        forget its replication position in the master's binary log. This
        statement is meant to be used for a clean start: It clears the
        master info and relay log info repositories, deletes all the
        relay log files, and starts a new relay log file. It also resets
        to 0 the replication delay specified with the
        <code class="literal">MASTER_DELAY</code> option to <code class="literal">CHANGE MASTER
        TO</code>. To use <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>,
        the slave replication threads must be stopped (use
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> if necessary).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          All relay log files are deleted, even if they have not been
          completely executed by the slave SQL thread. (This is a
          condition likely to exist on a replication slave if you have
          issued a <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> statement
          or if the slave is highly loaded.)
</p>
</div>
<p>
        In MySQL 5.6 (unlike the case in MySQL 5.1 and
        earlier), <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> does not
        change any replication connection parameters such as master
        host, master port, master user, or master password, which are
        retained in memory. This means that <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START
        SLAVE</code></a> can be issued without requiring a
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement
        following <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a>.
      </p><p>
        Connection parameters are reset if the slave
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is shut down following <code class="literal">RESET
        SLAVE</code>. In MySQL 5.6.3 and later, you can instead use
        <code class="literal">RESET SLAVE ALL</code> to reset these connection
        parameters (Bug #11809016).
      </p><p>
        <code class="literal">RESET SLAVE ALL</code> does not clear the
        <code class="literal">IGNORE_SERVER_IDS</code> list set by
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>. This issue is
        fixed in MySQL 5.7. (Bug #18816897)
      </p><p>
        In MySQL 5.6.7 and later, <code class="literal">RESET SLAVE</code> causes
        an implicit commit of an ongoing transaction. See
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        If the slave SQL thread was in the middle of replicating
        temporary tables when it was stopped, and
        <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> is issued, these
        replicated temporary tables are deleted on the slave.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-global-sql-slave-skip-counter"></a>13.4.2.4 SET GLOBAL sql_slave_skip_counter Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145834352"></a><a class="indexterm" name="idm139737145833312"></a><a class="indexterm" name="idm139737145832240"></a><a class="indexterm" name="idm139737145831168"></a><pre class="programlisting">
SET GLOBAL sql_slave_skip_counter = <em class="replaceable"><code>N</code></em>
</pre><p>
        This statement skips the next <em class="replaceable"><code>N</code></em>
        events from the master. This is useful for recovering from
        replication stops caused by a statement.
      </p><p>
        This statement is valid only when the slave threads are not
        running. Otherwise, it produces an error.
      </p><p>
        When using this statement, it is important to understand that
        the binary log is actually organized as a sequence of groups
        known as <em class="firstterm">event groups</em>. Each event group
        consists of a sequence of events.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For transactional tables, an event group corresponds to a
            transaction.
          </p></li><li class="listitem"><p>
            For nontransactional tables, an event group corresponds to a
            single SQL statement.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          A single transaction can contain changes to both transactional
          and nontransactional tables.
</p>
</div>
<p>
        When you use <a class="link" href="sql-syntax.html#set-global-sql-slave-skip-counter" title="13.4.2.4 SET GLOBAL sql_slave_skip_counter Syntax"><code class="literal">SET GLOBAL
        sql_slave_skip_counter</code></a> to skip events and the result
        is in the middle of a group, the slave continues to skip events
        until it reaches the end of the group. Execution then starts
        with the next event group.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="start-slave"></a>13.4.2.5 START SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145816592"></a><pre class="programlisting">
START SLAVE [<em class="replaceable"><code>thread_types</code></em>] [<em class="replaceable"><code>until_option</code></em>] [<em class="replaceable"><code>connection_options</code></em>]

<em class="replaceable"><code>thread_types</code></em>:
    [<em class="replaceable"><code>thread_type</code></em> [, <em class="replaceable"><code>thread_type</code></em>] ... ]

<em class="replaceable"><code>thread_type</code></em>: 
    IO_THREAD | SQL_THREAD

<em class="replaceable"><code>until_option</code></em>:
    UNTIL {   {SQL_BEFORE_GTIDS | SQL_AFTER_GTIDS} = <em class="replaceable"><code>gtid_set</code></em>
          |   MASTER_LOG_FILE = '<em class="replaceable"><code>log_name</code></em>', MASTER_LOG_POS = <em class="replaceable"><code>log_pos</code></em>
          |   RELAY_LOG_FILE = '<em class="replaceable"><code>log_name</code></em>', RELAY_LOG_POS = <em class="replaceable"><code>log_pos</code></em>
          |   SQL_AFTER_MTS_GAPS  }

<em class="replaceable"><code>connection_options</code></em>: 
    [USER='<em class="replaceable"><code>user_name</code></em>'] [PASSWORD='<em class="replaceable"><code>user_pass</code></em>'] [DEFAULT_AUTH='<em class="replaceable"><code>plugin_name</code></em>'] [PLUGIN_DIR='<em class="replaceable"><code>plugin_dir</code></em>']


<em class="replaceable"><code>gtid_set</code></em>:
    <em class="replaceable"><code>uuid_set</code></em> [, <em class="replaceable"><code>uuid_set</code></em>] ...
    | ''

<em class="replaceable"><code>uuid_set</code></em>:
    <em class="replaceable"><code>uuid</code></em>:<em class="replaceable"><code>interval</code></em>[:<em class="replaceable"><code>interval</code></em>]...

<em class="replaceable"><code>uuid</code></em>:
    <em class="replaceable"><code>hhhhhhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhh</code></em>-<em class="replaceable"><code>hhhhhhhhhhhh</code></em>

<em class="replaceable"><code>h</code></em>:
    [0-9,A-F]

<em class="replaceable"><code>interval</code></em>:
    <em class="replaceable"><code>n</code></em>[-<em class="replaceable"><code>n</code></em>]

    (<em class="replaceable"><code>n</code></em> &gt;= 1) 
</pre><p>
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> with no
        <em class="replaceable"><code>thread_type</code></em> options starts both of
        the slave threads. The I/O thread reads events from the master
        server and stores them in the relay log. The SQL thread reads
        events from the relay log and executes them.
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> requires the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        If <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> succeeds in
        starting the slave threads, it returns without any error.
        However, even in that case, it might be that the slave threads
        start and then later stop (for example, because they do not
        manage to connect to the master or read its binary log, or some
        other problem). <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> does
        not warn you about this. You must check the slave's error log
        for error messages generated by the slave threads, or check that
        they are running satisfactorily with <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW
        SLAVE STATUS</code></a>.
      </p><p>
        In MySQL 5.6.7 and later, <code class="literal">START SLAVE</code> causes
        an implicit commit of an ongoing transaction. See
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        Beginning with MySQL 5.6.11,
        <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a> must be set to
        <code class="literal">AUTOMATIC</code> before issuing this statement (Bug
        #16062608).
      </p><p>
        MySQL 5.6.4 and later supports pluggable user-password
        authentication with <code class="literal">START SLAVE</code> with the
        <code class="literal">USER</code>, <code class="literal">PASSWORD</code>,
        <code class="literal">DEFAULT_AUTH</code> and
        <code class="literal">PLUGIN_DIR</code> options, as described in the
        following list:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">USER</code>: User name. Cannot be set to an
            empty or null string, or left unset if
            <code class="literal">PASSWORD</code> is used.
          </p></li><li class="listitem"><p>
            <code class="literal">PASSWORD</code>: Password.
          </p></li><li class="listitem"><p>
            <code class="literal">DEFAULT_AUTH</code>: Name of plugin; default is
            MySQL native authentication.
          </p></li><li class="listitem"><p>
            <code class="literal">PLUGIN_DIR</code>: Location of plugin.
</p></li></ul>
</div>
<p>
        Starting with MySQL 5.6.4, you cannot use the
        <code class="literal">SQL_THREAD</code> option when specifying any of
        <code class="literal">USER</code>, <code class="literal">PASSWORD</code>,
        <code class="literal">DEFAULT_AUTH</code>, or
        <code class="literal">PLUGIN_DIR</code>, unless the
        <code class="literal">IO_THREAD</code> option is also provided (Bug
        #13083642).
      </p><p>
        See <a class="xref" href="security.html#pluggable-authentication" title="6.3.7 Pluggable Authentication">Section 6.3.7, “Pluggable Authentication”</a>, for more
        information.
      </p><p>
        If an insecure connection is used with any these options, the
        server issues the warning <span class="errortext">Sending passwords in plain
        text without SSL/TLS is extremely insecure</span>.
      </p><p>
        Starting with MySQL 5.6.6, <code class="literal">START SLAVE ...
        UNTIL</code> supports two additional options for use with
        global transaction identifiers (GTIDs) (see
        <a class="xref" href="replication.html#replication-gtids" title="17.1.3 Replication with Global Transaction Identifiers">Section 17.1.3, “Replication with Global Transaction Identifiers”</a>). Each of these takes a set
        of one or more global transaction identifiers
        <em class="replaceable"><code>gtid_set</code></em> as an argument (see
        <a class="xref" href="replication.html#replication-gtids-concepts-gtid-sets" title="GTID Sets">GTID Sets</a>, for more
        information).
      </p><p>
        When no <em class="replaceable"><code>thread_type</code></em> is specified,
        <code class="literal">START SLAVE UNTIL SQL_BEFORE_GTIDS</code> causes the
        slave SQL thread to process transactions until it has reached
        the <span class="emphasis"><em>first</em></span> transaction whose GTID is listed
        in the <em class="replaceable"><code>gtid_set</code></em>. <code class="literal">START SLAVE
        UNTIL SQL_AFTER_GTIDS</code> causes the slave threads to
        process all transactions until the
        <em class="replaceable"><code>last</code></em> transaction in the
        <em class="replaceable"><code>gtid_set</code></em> has been processed by both
        threads. In other words, <code class="literal">START SLAVE UNTIL
        SQL_BEFORE_GTIDS</code> causes the slave SQL thread to
        process all transactions occurring before the first GTID in the
        <em class="replaceable"><code>gtid_set</code></em> is reached, and
        <code class="literal">START SLAVE UNTIL SQL_AFTER_GTIDS</code> causes the
        slave threads to handle all transactions, including those whose
        GTIDs are found in <em class="replaceable"><code>gtid_set</code></em>, until
        each has encountered a transaction whose GTID is not part of the
        set. <code class="literal">SQL_BEFORE_GTIDS</code> and
        <code class="literal">SQL_AFTER_GTIDS</code> each support the
        <code class="literal">SQL_THREAD</code> and <code class="literal">IO_THREAD</code>
        options, although using <code class="literal">IO_THREAD</code> with them
        currently has no effect.
      </p><p>
        For example, <code class="literal">START SLAVE SQL_THREAD UNTIL
        SQL_BEFORE_GTIDS =
        3E11FA47-71CA-11E1-9E33-C80AA9429562:11-56</code> causes the
        slave SQL thread to process all transactions originating from
        the master whose <a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> is
        <code class="literal">3E11FA47-71CA-11E1-9E33-C80AA9429562</code> until it
        encounters the transaction having sequence number 11; it then
        stops without processing this transaction. In other words, all
        transactions up to and including the transaction with sequence
        number 10 are processed. Executing <code class="literal">START SLAVE
        SQL_THREAD UNTIL SQL_AFTER_GTIDS =
        3E11FA47-71CA-11E1-9E33-C80AA9429562:11-56</code>, on the
        other hand, would cause the slave SQL thread to obtain all
        transactions just mentioned from the master, including all of
        the transactions having the sequence numbers 11 through 56, and
        then to stop without processing any additional transactions;
        that is, the transaction having sequence number 56 would be the
        last transaction fetched by the slave SQL thread.
      </p><p>
        Prior to MySQL 5.6.14, <code class="literal">SQL_AFTER_GTIDS</code> did
        not stop the slave once the indicated transaction was completed,
        but waited until another GTID event was received (Bug
        #14767986).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          The <code class="literal">SQL_BEFORE_GTIDS</code> and
          <code class="literal">SQL_AFTER_GTIDS</code> keywords are present in the
          MySQL 5.6.5 server; however, neither of them functioned
          correctly as options with <code class="literal">START SLAVE [SQL_THREAD |
          IO_THREAD] UNTIL</code> in that version, and are therefore
          supported beginning only with MySQL 5.6.6. (Bug#13810456)
</p>
</div>
<p>
        <code class="literal">START SLAVE UNTIL SQL_AFTER_MTS_GAPS</code> is
        available in MySQL 5.6.6 or later. This statement causes a
        multi-threaded slave's SQL threads to run until no more
        gaps are found in the relay log, and then to stop. This
        statement can take an <code class="literal">SQL_THREAD</code> option, but
        the effects of the statement remain unchanged. It has no effect
        on the slave I/O thread (and cannot be used with the
        <code class="literal">IO_THREAD</code> option). <code class="literal">START SLAVE UNTIL
        SQL_AFTER_MTS_GAPS</code> should be used before switching the
        slave from multi-threaded mode to single-threaded mode (that is,
        when resetting
        <a class="link" href="replication.html#sysvar_slave_parallel_workers"><code class="literal">slave_parallel_workers</code></a> back to
        0 from a positive, nonzero value) after slave has failed with
        errors in multi-threaded mode.
      </p><p>
        To change a failed multi-threaded slave to single-threaded mode,
        you can issue the following series of statements, in the order
        shown:
      </p><pre class="programlisting">
START SLAVE UNTIL SQL_AFTER_MTS_GAPS;

SET @@GLOBAL.slave_parallel_workers = 0;

START SLAVE SQL_THREAD;
</pre><p>
        If you were running the failed multi-threaded slave with
        <a class="link" href="replication.html#sysvar_relay_log_recovery"><code class="literal">relay_log_recovery</code></a> enabled,
        then you must issue <code class="literal">START SLAVE UNTIL
        SQL_AFTER_MTS_GAPS</code> prior to executing
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>. Otherwise the
        latter statement fails.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is possible to view the entire text of a running
          <code class="literal">START SLAVE ...</code> statement, including any
          <code class="literal">USER</code> or <code class="literal">PASSWORD</code> values
          used, in the output of <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
          PROCESSLIST</code></a>. This is also true for the text of a
          running <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
          statement, including any values it employs for
          <code class="literal">MASTER_USER</code> or
          <code class="literal">MASTER_PASSWORD</code>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> sends an
        acknowledgment to the user after both the I/O thread and the SQL
        thread have started. However, the I/O thread may not yet have
        connected. For this reason, a successful
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> causes
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> to show
        <code class="literal">Slave_SQL_Running=Yes</code>, but this does not
        guarantee that <code class="literal">Slave_IO_Running=Yes</code> (because
        <code class="literal">Slave_IO_Running=Yes</code> only if the I/O thread
        is running <span class="emphasis"><em>and connected</em></span>). For more
        information, see <a class="xref" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax">Section 13.7.5.35, “SHOW SLAVE STATUS Syntax”</a>, and
        <a class="xref" href="replication.html#replication-administration-status" title="17.1.5.1 Checking Replication Status">Section 17.1.5.1, “Checking Replication Status”</a>.
      </p><p>
        You can add <code class="literal">IO_THREAD</code> and
        <code class="literal">SQL_THREAD</code> options to the statement to name
        which of the threads to start. In MySQL 5.6.4 and later, the
        <code class="literal">SQL_THREAD</code> option is disallowed when
        specifying any of <code class="literal">USER</code>,
        <code class="literal">PASSWORD</code>, <code class="literal">DEFAULT_AUTH</code>, or
        <code class="literal">PLUGIN_DIR</code>, unless the
        <code class="literal">IO_THREAD</code> option is also provided (Bug
        #13083642).
      </p><p>
        An <code class="literal">UNTIL</code> clause
        (<em class="replaceable"><code>until_option</code></em>, in the preceding
        grammar) may be added to specify that the slave should start and
        run until the SQL thread reaches a given point in the master
        binary log, specified by the <code class="literal">MASTER_LOG_POS</code>
        and MASTER_LOG_FILE options, or a given point in the slave relay
        log, indicated with the <code class="literal">RELAY_LOG_POS</code> and
        <code class="literal">RELAY_LOG_FILE</code> options. When the SQL thread
        reaches the point specified, it stops. If the
        <code class="literal">SQL_THREAD</code> option is specified in the
        statement, it starts only the SQL thread. Otherwise, it starts
        both slave threads. If the SQL thread is running, the
        <code class="literal">UNTIL</code> clause is ignored and a warning is
        issued. You cannot use an <code class="literal">UNTIL</code> clause with
        the <code class="literal">IO_THREAD</code> option.
      </p><p>
        In MySQL 5.6.6 and later, it is also possible with
        <code class="literal">START SLAVE UNTIL</code> to specify a stop point
        relative to a given GTID or set of GTIDs using one of the
        options <code class="literal">SQL_BEFORE_GTIDS</code> or
        <code class="literal">SQL_AFTER_GTIDS</code>, as explained previously in
        this section. When using one of these options, you can specify
        <code class="literal">SQL_THREAD</code>, <code class="literal">IO_THREAD</code>,
        both of these, or neither of them. If you specify only
        <code class="literal">SQL_THREAD</code>, then only the slave SQL thread is
        affected by the statement; if only <code class="literal">IO_THREAD</code>
        is used, then only the slave I/O is affected. If both
        <code class="literal">SQL_THREAD</code> and <code class="literal">IO_THREAD</code>
        are used, or if neither of them is used, then both the SQL and
        I/O threads are affected by the statement.
      </p><p>
        The <code class="literal">UNTIL</code> clause is not supported for
        multi-threaded slaves except when also using
        <code class="literal">SQL_AFTER_MTS_GAPS</code>. Prior to MySQL 5.6.6,
        <code class="literal">UNTIL</code> was not supported at all for
        multi-threaded slaves.
      </p><p>
        For an <code class="literal">UNTIL</code> clause, you must specify any one
        of the following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <span class="emphasis"><em>Both</em></span> a log file name and a position in
            that file
          </p></li><li class="listitem"><p>
            (MySQL 5.6.6 or later:) <span class="emphasis"><em>Either</em></span> of
            <code class="literal">SQL_BEFORE_GTIDS</code> or
            <code class="literal">SQL_AFTER_GTIDS</code>
          </p></li><li class="listitem"><p>
            (MySQL 5.6.6 or later:)
            <code class="literal">SQL_AFTER_MTS_GAPS</code>
</p></li></ul>
</div>
<p>
        Do not mix master and relay log options. In MySQL 5.6.6 and
        later, do not mix log file options with GTID options.
      </p><p>
        Any <code class="literal">UNTIL</code> condition is reset by a subsequent
        <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP SLAVE</code></a> statement, a
        <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement that
        includes no <code class="literal">UNTIL</code> clause, or a server
        restart.
      </p><p>
        When specifying a log file and position, you can use the
        <code class="literal">IO_THREAD</code> option with <code class="literal">START SLAVE
        ... UNTIL</code> even though only the SQL thread is affected
        by this statement. The <code class="literal">IO_THREAD</code> option is
        ignored in such cases. The preceding restriction does not apply
        when using one of the GTID options
        (<code class="literal">SQL_BEFORE_GTIDS</code> and
        <code class="literal">SQL_AFTER_GTIDS</code>) introduced in MySQL 5.6.6;
        the GTID options support both <code class="literal">SQL_THREAD</code> and
        <code class="literal">IO_THREAD</code>, as explained previously in this
        section.
      </p><p>
        The <code class="literal">UNTIL</code> clause can be useful for debugging
        replication, or to cause replication to proceed until just
        before the point where you want to avoid having the slave
        replicate an event. For example, if an unwise
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement was executed
        on the master, you can use <code class="literal">UNTIL</code> to tell the
        slave to execute up to that point but no farther. To find what
        the event is, use <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a> with the master
        binary log or slave relay log, or by using a
        <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a> statement.
      </p><p>
        If you are using <code class="literal">UNTIL</code> to have the slave
        process replicated queries in sections, it is recommended that
        you start the slave with the
        <a class="link" href="replication.html#option_mysqld_skip-slave-start"><code class="option">--skip-slave-start</code></a> option to
        prevent the SQL thread from running when the slave server
        starts. It is probably best to use this option in an option file
        rather than on the command line, so that an unexpected server
        restart does not cause it to be forgotten.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> statement
        includes output fields that display the current values of the
        <code class="literal">UNTIL</code> condition.
      </p><p>
        In very old versions of MySQL (before 4.0.5), this statement was
        called <code class="literal">SLAVE START</code>. That syntax is no longer
        accepted as of MySQL 5.6.1.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="stop-slave"></a>13.4.2.6 STOP SLAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145659792"></a><pre class="programlisting">
STOP SLAVE [<em class="replaceable"><code>thread_types</code></em>]

<em class="replaceable"><code>thread_types</code></em>:
    [<em class="replaceable"><code>thread_type</code></em> [, <em class="replaceable"><code>thread_type</code></em>] ... ]

<em class="replaceable"><code>thread_type</code></em>: IO_THREAD | SQL_THREAD
</pre><p>
        Stops the slave threads. <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP
        SLAVE</code></a> requires the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege. Recommended best
        practice is to execute <code class="literal">STOP SLAVE</code> on the
        slave before stopping the slave server (see
        <a class="xref" href="server-administration.html#server-shutdown" title="5.1.12 The Shutdown Process">Section 5.1.12, “The Shutdown Process”</a>, for more information).
      </p><p>
        <span class="emphasis"><em>When using the row-based logging format</em></span>:
        You should execute <code class="literal">STOP SLAVE</code> or
        <code class="literal">STOP SLAVE SQL_THREAD</code> on the slave prior to
        shutting down the slave server if you are replicating any tables
        that use a nontransactional storage engine (see the
        <em class="citetitle">Note</em> later in this section).
      </p><p>
        Like <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a>, this statement
        may be used with the <code class="literal">IO_THREAD</code> and
        <code class="literal">SQL_THREAD</code> options to name the thread or
        threads to be stopped.
      </p><p>
        In MySQL 5.6.7 and later, <code class="literal">STOP SLAVE</code> causes
        an implicit commit of an ongoing transaction. See
        <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        Beginning with MySQL 5.6.11,
        <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a> must be set to
        <code class="literal">AUTOMATIC</code> before issuing this statement (Bug
        #16062608).
      </p><p>
        In MySQL 5.6.13 and later, you can control how long
        <code class="literal">STOP SLAVE</code> waits before timing out by setting
        the <a class="link" href="replication.html#sysvar_rpl_stop_slave_timeout"><code class="literal">rpl_stop_slave_timeout</code></a>
        system variable. This can be used to avoid deadlocks between
        <code class="literal">STOP SLAVE</code> and other slave SQL statements
        using different client connections to the slave. (Bug #16856735)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          In MySQL 5.6, <a class="link" href="sql-syntax.html#stop-slave" title="13.4.2.6 STOP SLAVE Syntax"><code class="literal">STOP
          SLAVE</code></a> waits until the current replication event
          group affecting one or more nontransactional tables has
          finished executing (if there is any such replication group),
          or until the user issues a
          <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL QUERY</code></a> or
          <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL
          CONNECTION</code></a> statement. (Bug #319, Bug #38205)
</p>
</div>
<p>
        In old versions of MySQL (before 4.0.5), this statement was
        called <code class="literal">SLAVE STOP</code>. That syntax is no longer
        accepted as of MySQL 5.6.1.
</p>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-prepared-statements"></a>13.5 SQL Syntax for Prepared Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#prepare">13.5.1 PREPARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#execute">13.5.2 EXECUTE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#deallocate-prepare">13.5.3 DEALLOCATE PREPARE Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737145626832"></a><a class="indexterm" name="idm139737145625760"></a><a class="indexterm" name="idm139737145624688"></a><a class="indexterm" name="idm139737145623616"></a><p>
    MySQL 5.6 provides support for server-side prepared
    statements. This support takes advantage of the efficient
    client/server binary protocol available since MySQL 4.1. Using
    prepared statements with placeholders for parameter values has the
    following benefits:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Less overhead for parsing the statement each time it is
        executed. Typically, database applications process large volumes
        of almost-identical statements, with only changes to literal or
        variable values in clauses such as <code class="literal">WHERE</code> for
        queries and deletes, <code class="literal">SET</code> for updates, and
        <code class="literal">VALUES</code> for inserts.
      </p></li><li class="listitem"><p>
        Protection against SQL injection attacks. The parameter values
        can contain unescaped SQL quote and delimiter characters.
</p></li></ul>
</div>
<h3><a name="idm139737145617344"></a>Prepared Statements in Application Programs</h3>
<p>
    You can use server-side prepared statements through client
    programming interfaces, including the <a class="link" href="connectors-apis.html#c-api" title="23.8 MySQL C API">MySQL C
    API client library</a> or <a class="ulink" href="http://dev.mysql.com/doc/connector-c/en/index.html" target="_top">MySQL
    Connector/C</a> for C programs, <a class="ulink" href="http://dev.mysql.com/doc/connector-j/en/index.html" target="_top">MySQL
    Connector/J</a> for Java programs, and
    <a class="ulink" href="http://dev.mysql.com/doc/connector-net/en/index.html" target="_top">MySQL Connector/Net</a> for
    programs using .NET technologies. For example, the C API provides a
    set of function calls that make up its prepared statement API. See
    <a class="xref" href="connectors-apis.html#c-api-prepared-statements" title="23.8.8 C API Prepared Statements">Section 23.8.8, “C API Prepared Statements”</a>. Other language
    interfaces can provide support for prepared statements that use the
    binary protocol by linking in the C client library, one example
    being the
    <a class="ulink" href="http://php.net/mysqli" target="_top"><code class="literal">mysqli</code>
    extension</a>, available in PHP 5.0 and later.
</p>
<h3><a name="idm139737145610656"></a>Prepared Statements in SQL Scripts</h3>
<p>
    An alternative SQL interface to prepared statements is available.
    This interface is not as efficient as using the binary protocol
    through a prepared statement API, but requires no programming
    because it is available directly at the SQL level:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        You can use it when no programming interface is available to
        you.
      </p></li><li class="listitem"><p>
        You can use it from any program that can send SQL statements to
        the server to be executed, such as the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a>
        client program.
      </p></li><li class="listitem"><p>
        You can use it even if the client is using an old version of the
        client library, as long as you connect to a server running MySQL
        4.1 or higher.
</p></li></ul>
</div>
<p>
    SQL syntax for prepared statements is intended to be used for
    situations such as these:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        To test how prepared statements work in your application before
        coding it.
      </p></li><li class="listitem"><p>
        To use prepared statements when you do not have access to a
        programming API that supports them.
      </p></li><li class="listitem"><p>
        To interactively troubleshoot application issues with prepared
        statements.
      </p></li><li class="listitem"><p>
        To create a test case that reproduces a problem with prepared
        statements, so that you can file a bug report.
</p></li></ul>
</div>
<h3><a name="idm139737145600448"></a>PREPARE, EXECUTE, and DEALLOCATE PREPARE Statements</h3>
<p>
    SQL syntax for prepared statements is based on three SQL statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> prepares a statement for
        execution (see <a class="xref" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax">Section 13.5.1, “PREPARE Syntax”</a>).
      </p></li><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> executes a prepared
        statement (see <a class="xref" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax">Section 13.5.2, “EXECUTE Syntax”</a>).
      </p></li><li class="listitem"><p>
        <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> releases a
        prepared statement (see <a class="xref" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax">Section 13.5.3, “DEALLOCATE PREPARE Syntax”</a>).
</p></li></ul>
</div>
<p>
    The following examples show two equivalent ways of preparing a
    statement that computes the hypotenuse of a triangle given the
    lengths of the two sides.
  </p><p>
    The first example shows how to create a prepared statement by using
    a string literal to supply the text of the statement:
  </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>PREPARE stmt1 FROM 'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @a = 3;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @b = 4;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt1 USING @a, @b;</code></strong>
+------------+
| hypotenuse |
+------------+
|          5 |
+------------+
mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt1;</code></strong>
</pre><p>
    The second example is similar, but supplies the text of the
    statement as a user variable:
  </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @s = 'SELECT SQRT(POW(?,2) + POW(?,2)) AS hypotenuse';</code></strong>
mysql&gt; <strong class="userinput"><code>PREPARE stmt2 FROM @s;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @a = 6;</code></strong>
mysql&gt; <strong class="userinput"><code>SET @b = 8;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt2 USING @a, @b;</code></strong>
+------------+
| hypotenuse |
+------------+
|         10 |
+------------+
mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt2;</code></strong>
</pre><p>
    Here is an additional example that demonstrates how to choose the
    table on which to perform a query at runtime, by storing the name of
    the table as a user variable:
  </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>USE test;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (a INT NOT NULL);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES (4), (8), (11), (32), (80);</code></strong>

mysql&gt; <strong class="userinput"><code>SET @table = 't1';</code></strong>
mysql&gt; <strong class="userinput"><code>SET @s = CONCAT('SELECT * FROM ', @table);</code></strong>

mysql&gt; <strong class="userinput"><code>PREPARE stmt3 FROM @s;</code></strong>
mysql&gt; <strong class="userinput"><code>EXECUTE stmt3;</code></strong>
+----+
| a  |
+----+
|  4 |
|  8 |
| 11 |
| 32 |
| 80 |
+----+

mysql&gt; <strong class="userinput"><code>DEALLOCATE PREPARE stmt3;</code></strong>
</pre><p>
    A prepared statement is specific to the session in which it was
    created. If you terminate a session without deallocating a
    previously prepared statement, the server deallocates it
    automatically.
  </p><p>
    A prepared statement is also global to the session. If you create a
    prepared statement within a stored routine, it is not deallocated
    when the stored routine ends.
  </p><p>
    To guard against too many prepared statements being created
    simultaneously, set the
    <a class="link" href="server-administration.html#sysvar_max_prepared_stmt_count"><code class="literal">max_prepared_stmt_count</code></a> system
    variable. To prevent the use of prepared statements, set the value
    to 0.
</p>
<h3><a name="idm139737145569168"></a>SQL Syntax Allowed in Prepared Statements</h3>
<p>
    The following SQL statements can be used as prepared statements:
  </p><pre class="programlisting">
ALTER TABLE
ALTER USER (as of MySQL 5.6.8)
ANALYZE TABLE
CACHE INDEX
CALL
CHANGE MASTER
CHECKSUM {TABLE | TABLES}
COMMIT
{CREATE | RENAME | DROP} DATABASE
{CREATE | DROP} INDEX
{CREATE | RENAME | DROP} TABLE
{CREATE | RENAME | DROP} USER
{CREATE | DROP} VIEW
DELETE
DO
FLUSH {TABLE | TABLES | TABLES WITH READ LOCK | HOSTS | PRIVILEGES
  | LOGS | STATUS | MASTER | SLAVE | DES_KEY_FILE | USER_RESOURCES}
GRANT
INSERT
INSTALL PLUGIN
KILL
LOAD INDEX INTO CACHE
OPTIMIZE TABLE
REPAIR TABLE
REPLACE
RESET {MASTER | SLAVE | QUERY CACHE}
REVOKE
SELECT
SET
SHOW {AUTHORS | CONTRIBUTORS | WARNINGS | ERRORS}
SHOW BINLOG EVENTS
SHOW CREATE {PROCEDURE | FUNCTION | EVENT | TABLE | VIEW}
SHOW {MASTER | BINARY} LOGS
SHOW {MASTER | SLAVE} STATUS
SLAVE {START | STOP}
TRUNCATE TABLE
UNINSTALL PLUGIN
UPDATE
</pre><p>
    Other statements are not supported in MySQL 5.6.
  </p><p>
    Generally, statements not permitted in SQL prepared statements are
    also not permitted in stored programs. Exceptions are noted in
    <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
  </p><p>
    Metadata changes to tables or views referred to by prepared
    statements are detected and cause automatic repreparation of the
    statement when it is next executed. For more information, see
    <a class="xref" href="optimization.html#statement-caching" title="8.10.4 Caching of Prepared Statements and Stored Programs">Section 8.10.4, “Caching of Prepared Statements and Stored Programs”</a>.
  </p><p>
    Placeholders can be used for the arguments of the
    <code class="literal">LIMIT</code> clause when using prepared statements. See
    <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
  </p><p>
    In prepared <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a> statements used with
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, placeholder support for
    <code class="literal">OUT</code> and <code class="literal">INOUT</code> parameters is
    available beginning with MySQL 5.6. See
    <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>, for an example and a workaround for earlier
    versions. Placeholders can be used for <code class="literal">IN</code>
    parameters regardless of version.
  </p><p>
    SQL syntax for prepared statements cannot be used in nested fashion.
    That is, a statement passed to
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> cannot itself be a
    <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>,
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, or
    <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement.
  </p><p>
    SQL syntax for prepared statements is distinct from using prepared
    statement API calls. For example, you cannot use the
    <a class="link" href="connectors-apis.html#mysql-stmt-prepare" title="23.8.11.21 mysql_stmt_prepare()"><code class="literal">mysql_stmt_prepare()</code></a> C API function
    to prepare a <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>,
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>, or
    <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement.
  </p><p>
    SQL syntax for prepared statements can be used within stored
    procedures, but not in stored functions or triggers. However, a
    cursor cannot be used for a dynamic statement that is prepared and
    executed with <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> and
    <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a>. The statement for a cursor
    is checked at cursor creation time, so the statement cannot be
    dynamic.
  </p><p>
    SQL syntax for prepared statements does not support multi-statements
    (that is, multiple statements within a single string separated by
    <span class="quote">“<span class="quote"><code class="literal">;</code></span>”</span> characters).
  </p><p>
    Prepared statements use the query cache under the conditions
    described in <a class="xref" href="optimization.html#query-cache-operation" title="8.10.3.1 How the Query Cache Operates">Section 8.10.3.1, “How the Query Cache Operates”</a>.
  </p><p>
    To write C programs that use the <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
    SQL statement to execute stored procedures that contain prepared
    statements, the <code class="literal">CLIENT_MULTI_RESULTS</code> flag must be
    enabled. This is because each <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL</code></a>
    returns a result to indicate the call status, in addition to any
    result sets that might be returned by statements executed within the
    procedure.
  </p><p>
    <code class="literal">CLIENT_MULTI_RESULTS</code> can be enabled when you call
    <a class="link" href="connectors-apis.html#mysql-real-connect" title="23.8.7.53 mysql_real_connect()"><code class="literal">mysql_real_connect()</code></a>, either
    explicitly by passing the <code class="literal">CLIENT_MULTI_RESULTS</code>
    flag itself, or implicitly by passing
    <code class="literal">CLIENT_MULTI_STATEMENTS</code> (which also enables
    <code class="literal">CLIENT_MULTI_RESULTS</code>). For additional
    information, see <a class="xref" href="sql-syntax.html#call" title="13.2.1 CALL Syntax">Section 13.2.1, “CALL Syntax”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="prepare"></a>13.5.1 PREPARE Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm139737145527696"></a><a class="indexterm" name="idm139737145526624"></a><pre class="programlisting">
PREPARE <em class="replaceable"><code>stmt_name</code></em> FROM <em class="replaceable"><code>preparable_stmt</code></em>
</pre><p>
      The <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a> statement prepares a
      SQL statement and assigns it a name,
      <em class="replaceable"><code>stmt_name</code></em>, by which to refer to the
      statement later. The prepared statement is executed with
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> and released with
      <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a>. For examples,
      see <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 SQL Syntax for Prepared Statements">Section 13.5, “SQL Syntax for Prepared Statements”</a>.
    </p><p>
      Statement names are not case sensitive.
      <em class="replaceable"><code>preparable_stmt</code></em> is either a string
      literal or a user variable that contains the text of the SQL
      statement. The text must represent a single statement, not
      multiple statements. Within the statement, <code class="literal">?</code>
      characters can be used as parameter markers to indicate where data
      values are to be bound to the query later when you execute it. The
      <code class="literal">?</code> characters should not be enclosed within
      quotation marks, even if you intend to bind them to string values.
      Parameter markers can be used only where data values should
      appear, not for SQL keywords, identifiers, and so forth.
    </p><p>
      If a prepared statement with the given name already exists, it is
      deallocated implicitly before the new statement is prepared. This
      means that if the new statement contains an error and cannot be
      prepared, an error is returned and no statement with the given
      name exists.
    </p><p>
      The scope of a prepared statement is the session within which it
      is created, which as several implications:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          A prepared statement created in one session is not available
          to other sessions.
        </p></li><li class="listitem"><p>
          When a session ends, whether normally or abnormally, its
          prepared statements no longer exist. If auto-reconnect is
          enabled, the client is not notified that the connection was
          lost. For this reason, clients may wish to disable
          auto-reconnect. See <a class="xref" href="connectors-apis.html#auto-reconnect" title="23.8.16 Controlling Automatic Reconnection Behavior">Section 23.8.16, “Controlling Automatic Reconnection Behavior”</a>.
        </p></li><li class="listitem"><p>
          A prepared statement created within a stored program continues
          to exist after the program finishes executing and can be
          executed outside the program later.
        </p></li><li class="listitem"><p>
          A statement prepared in stored program context cannot refer to
          stored procedure or function parameters or local variables
          because they go out of scope when the program ends and would
          be unavailable were the statement to be executed later outside
          the program. As a workaround, refer instead to user-defined
          variables, which also have session scope; see
          <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="execute"></a>13.5.2 EXECUTE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145503776"></a><a class="indexterm" name="idm139737145502704"></a><pre class="programlisting">
EXECUTE <em class="replaceable"><code>stmt_name</code></em>
    [USING @<em class="replaceable"><code>var_name</code></em> [, @<em class="replaceable"><code>var_name</code></em>] ...]
</pre><p>
      After preparing a statement with
      <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>, you execute it with an
      <a class="link" href="sql-syntax.html#execute" title="13.5.2 EXECUTE Syntax"><code class="literal">EXECUTE</code></a> statement that refers to
      the prepared statement name. If the prepared statement contains
      any parameter markers, you must supply a <code class="literal">USING</code>
      clause that lists user variables containing the values to be bound
      to the parameters. Parameter values can be supplied only by user
      variables, and the <code class="literal">USING</code> clause must name
      exactly as many variables as the number of parameter markers in
      the statement.
    </p><p>
      You can execute a given prepared statement multiple times, passing
      different variables to it or setting the variables to different
      values before each execution.
    </p><p>
      For examples, see
      <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 SQL Syntax for Prepared Statements">Section 13.5, “SQL Syntax for Prepared Statements”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="deallocate-prepare"></a>13.5.3 DEALLOCATE PREPARE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145488224"></a><a class="indexterm" name="idm139737145487184"></a><a class="indexterm" name="idm139737145486112"></a><pre class="programlisting">
{DEALLOCATE | DROP} PREPARE <em class="replaceable"><code>stmt_name</code></em>
</pre><p>
      To deallocate a prepared statement produced with
      <a class="link" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax"><code class="literal">PREPARE</code></a>, use a
      <a class="link" href="sql-syntax.html#deallocate-prepare" title="13.5.3 DEALLOCATE PREPARE Syntax"><code class="literal">DEALLOCATE PREPARE</code></a> statement that
      refers to the prepared statement name. Attempting to execute a
      prepared statement after deallocating it results in an error. If
      too many prepared statements are created and not deallocated by
      either the <code class="literal">DEALLOCATE PREPARE</code> statement or the
      end of the session, you might encounter the upper limit enforced
      by the <a class="link" href="server-administration.html#sysvar_max_prepared_stmt_count"><code class="literal">max_prepared_stmt_count</code></a>
      system variable.
    </p><p>
      For examples, see
      <a class="xref" href="sql-syntax.html#sql-syntax-prepared-statements" title="13.5 SQL Syntax for Prepared Statements">Section 13.5, “SQL Syntax for Prepared Statements”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-compound-statements"></a>13.6 MySQL Compound-Statement Syntax</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#begin-end">13.6.1 BEGIN ... END Compound-Statement Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#statement-labels">13.6.2 Statement Label Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare">13.6.3 DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#stored-program-variables">13.6.4 Variables in Stored Programs</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flow-control-statements">13.6.5 Flow Control Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cursors">13.6.6 Cursors</a></span></dt><dt><span class="section"><a href="sql-syntax.html#condition-handling">13.6.7 Condition Handling</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737145472528"></a><a class="indexterm" name="idm139737145471456"></a><a class="indexterm" name="idm139737145469968"></a><a class="indexterm" name="idm139737145468896"></a><p>
    This section describes the syntax for the
    <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
    compound statement and other statements that can be used in the body
    of stored programs: Stored procedures and functions, triggers, and
    events. These objects are defined in terms of SQL code that is
    stored on the server for later invocation (see
    <a class="xref" href="stored-programs-views.html" title="Chapter 20 Stored Programs and Views">Chapter 20, <i>Stored Programs and Views</i></a>).
  </p><p>
    A compound statement is a block that can contain other blocks;
    declarations for variables, condition handlers, and cursors; and
    flow control constructs such as loops and conditional tests.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="begin-end"></a>13.6.1 BEGIN ... END Compound-Statement Syntax</h3>
</div>
</div>
</div>
<a class="indexterm" name="idm139737145462304"></a><a class="indexterm" name="idm139737145461264"></a><pre class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] BEGIN
    [<em class="replaceable"><code>statement_list</code></em>]
END [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      syntax is used for writing compound statements, which can appear
      within stored programs (stored procedures and functions, triggers,
      and events). A compound statement can contain multiple statements,
      enclosed by the <code class="literal">BEGIN</code> and
      <code class="literal">END</code> keywords.
      <em class="replaceable"><code>statement_list</code></em> represents a list of one
      or more statements, each terminated by a semicolon
      (<code class="literal">;</code>) statement delimiter. The
      <em class="replaceable"><code>statement_list</code></em> itself is optional, so
      the empty compound statement (<code class="literal">BEGIN END</code>) is
      legal.
    </p><p>
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      blocks can be nested.
    </p><p>
      Use of multiple statements requires that a client is able to send
      statement strings containing the <code class="literal">;</code> statement
      delimiter. In the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> command-line client,
      this is handled with the <code class="literal">delimiter</code> command.
      Changing the <code class="literal">;</code> end-of-statement delimiter (for
      example, to <code class="literal">//</code>) permit <code class="literal">;</code> to
      be used in a program body. For an example, see
      <a class="xref" href="stored-programs-views.html#stored-programs-defining" title="20.1 Defining Stored Programs">Section 20.1, “Defining Stored Programs”</a>.
    </p><p>
      A <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
      END</code></a> block can be labeled. See
      <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
    </p><p>
      The optional <code class="literal">[NOT] ATOMIC</code> clause is not
      supported. This means that no transactional savepoint is set at
      the start of the instruction block and the
      <code class="literal">BEGIN</code> clause used in this context has no effect
      on the current transaction.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Within all stored programs, the parser treats
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">BEGIN [WORK]</code></a>
        as the beginning of a
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block. To begin a transaction in this context, use
        <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
        TRANSACTION</code></a> instead.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="statement-labels"></a>13.6.2 Statement Label Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145431440"></a><a class="indexterm" name="idm139737145429952"></a><a class="indexterm" name="idm139737145428464"></a><a class="indexterm" name="idm139737145426976"></a><a class="indexterm" name="idm139737145425488"></a><pre class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] BEGIN
    [<em class="replaceable"><code>statement_list</code></em>]
END [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] LOOP
    <em class="replaceable"><code>statement_list</code></em>
END LOOP [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] REPEAT
    <em class="replaceable"><code>statement_list</code></em>
UNTIL <em class="replaceable"><code>search_condition</code></em>
END REPEAT [<em class="replaceable"><code>end_label</code></em>]

[<em class="replaceable"><code>begin_label</code></em>:] WHILE <em class="replaceable"><code>search_condition</code></em> DO
    <em class="replaceable"><code>statement_list</code></em>
END WHILE [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
      Labels are permitted for
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      blocks and for the <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
      <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>, and
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statements. Label use for
      those statements follows these rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <em class="replaceable"><code>begin_label</code></em> must be followed by a
          colon.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>begin_label</code></em> can be given without
          <em class="replaceable"><code>end_label</code></em>. If
          <em class="replaceable"><code>end_label</code></em> is present, it must be
          the same as <em class="replaceable"><code>begin_label</code></em>.
        </p></li><li class="listitem"><p>
          <em class="replaceable"><code>end_label</code></em> cannot be given without
          <em class="replaceable"><code>begin_label</code></em>.
        </p></li><li class="listitem"><p>
          Labels at the same nesting level must be distinct.
        </p></li><li class="listitem"><p>
          Labels can be up to 16 characters long.
</p></li></ul>
</div>
<p>
      To refer to a label within the labeled construct, use an
      <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> or
      <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement. The following
      example uses those statements to continue iterating or terminate
      the loop:
    </p><pre class="programlisting">
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 &lt; 10 THEN ITERATE label1; END IF;
    LEAVE label1;
  END LOOP label1;
END;
</pre><p>
      The scope of a block label does not include the code for handlers
      declared within the block. For details, see
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="declare"></a>13.6.3 DECLARE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145394560"></a><p>
      The <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> statement is used to
      define various items local to a program:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Local variables. See
          <a class="xref" href="sql-syntax.html#stored-program-variables" title="13.6.4 Variables in Stored Programs">Section 13.6.4, “Variables in Stored Programs”</a>.
        </p></li><li class="listitem"><p>
          Conditions and handlers. See
          <a class="xref" href="sql-syntax.html#condition-handling" title="13.6.7 Condition Handling">Section 13.6.7, “Condition Handling”</a>.
        </p></li><li class="listitem"><p>
          Cursors. See <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p></li></ul>
</div>
<p>
      <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a> is permitted only inside a
      <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ... END</code></a>
      compound statement and must be at its start, before any other
      statements.
    </p><p>
      Declarations must follow a certain order. Cursor declarations must
      appear before handler declarations. Variable and condition
      declarations must appear before cursor or handler declarations.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="stored-program-variables"></a>13.6.4 Variables in Stored Programs</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#declare-local-variable">13.6.4.1 Local Variable DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#local-variable-scope">13.6.4.2 Local Variable Scope and Resolution</a></span></dt></dl>
</div>
<p>
      System variables and user-defined variables can be used in stored
      programs, just as they can be used outside stored-program context.
      In addition, stored programs can use <code class="literal">DECLARE</code> to
      define local variables, and stored routines (procedures and
      functions) can be declared to take parameters that communicate
      values between the routine and its caller.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To declare local variables, use the
          <a class="link" href="sql-syntax.html#declare-local-variable" title="13.6.4.1 Local Variable DECLARE Syntax"><code class="literal">DECLARE</code></a>
          statement, as described in
          <a class="xref" href="sql-syntax.html#declare-local-variable" title="13.6.4.1 Local Variable DECLARE Syntax">Section 13.6.4.1, “Local Variable DECLARE Syntax”</a>.
        </p></li><li class="listitem"><p>
          Variables can be set directly with the
          <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
          statement. See <a class="xref" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax">Section 13.7.4, “SET Syntax”</a>.
        </p></li><li class="listitem"><p>
          Results from queries can be retrieved into local variables
          using <a class="link" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax"><code class="literal">SELECT ...
          INTO <em class="replaceable"><code>var_list</code></em></code></a> or by
          opening a cursor and using
          <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH ... INTO
          <em class="replaceable"><code>var_list</code></em></code></a>. See
          <a class="xref" href="sql-syntax.html#select-into" title="13.2.9.1 SELECT ... INTO Syntax">Section 13.2.9.1, “SELECT ... INTO Syntax”</a>, and <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p></li></ul>
</div>
<p>
      For information about the scope of local variables and how MySQL
      resolves ambiguous names, see
      <a class="xref" href="sql-syntax.html#local-variable-scope" title="13.6.4.2 Local Variable Scope and Resolution">Section 13.6.4.2, “Local Variable Scope and Resolution”</a>.
    </p><p>
      It is not permitted to assign the value <code class="literal">DEFAULT</code>
      to stored procedure or function parameters or stored program local
      variables (for example with a <code class="literal">SET
      <em class="replaceable"><code>var_name</code></em> = DEFAULT</code>
      statement). As of MySQL 5.6.6, this results in a syntax error.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-local-variable"></a>13.6.4.1 Local Variable DECLARE Syntax</h4>
</div>
</div>
</div>
<pre class="programlisting">
DECLARE <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>] ... <em class="replaceable"><code>type</code></em> [DEFAULT <em class="replaceable"><code>value</code></em>]
</pre><p>
        This statement declares local variables within stored programs.
        To provide a default value for a variable, include a
        <code class="literal">DEFAULT</code> clause. The value can be specified as
        an expression; it need not be a constant. If the
        <code class="literal">DEFAULT</code> clause is missing, the initial value
        is <code class="literal">NULL</code>.
      </p><p>
        Local variables are treated like stored routine parameters with
        respect to data type and overflow checking. See
        <a class="xref" href="sql-syntax.html#create-procedure" title="13.1.15 CREATE PROCEDURE and CREATE FUNCTION Syntax">Section 13.1.15, “CREATE PROCEDURE and CREATE FUNCTION Syntax”</a>.
      </p><p>
        Variable declarations must appear before cursor or handler
        declarations.
      </p><p>
        Local variable names are not case sensitive. Permissible
        characters and quoting rules are the same as for other
        identifiers, as described in <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
      </p><p>
        The scope of a local variable is the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block within which it is declared. The variable
        can be referred to in blocks nested within the declaring block,
        except those blocks that declare a variable with the same name.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="local-variable-scope"></a>13.6.4.2 Local Variable Scope and Resolution</h4>

</div>

</div>

</div>
<p>
        The scope of a local variable is the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block within which it is declared. The variable
        can be referred to in blocks nested within the declaring block,
        except those blocks that declare a variable with the same name.
      </p><p>
        Because local variables are in scope only during stored program
        execution, references to them are not permitted in prepared
        statements created within a stored program. Prepared statement
        scope is the current session, not the stored program, so the
        statement could be executed after the program ends, at which
        point the variables would no longer be in scope. For example,
        <code class="literal">SELECT ... INTO
        <em class="replaceable"><code>local_var</code></em></code> cannot be used as
        a prepared statement. This restriction also applies to stored
        procedure and function parameters. See
        <a class="xref" href="sql-syntax.html#prepare" title="13.5.1 PREPARE Syntax">Section 13.5.1, “PREPARE Syntax”</a>.
      </p><p>
        A local variable should not have the same name as a table
        column. If an SQL statement, such as a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT ...
        INTO</code></a> statement, contains a reference to a column and a
        declared local variable with the same name, MySQL currently
        interprets the reference as the name of a variable. Consider the
        following procedure definition:
      </p><pre class="programlisting">
CREATE PROCEDURE sp1 (x VARCHAR(5))
BEGIN
  DECLARE xname VARCHAR(5) DEFAULT 'bob';
  DECLARE newname VARCHAR(5);
  DECLARE xid INT;

  SELECT xname, id INTO newname, xid
    FROM table1 WHERE xname = xname;
  SELECT newname;
END;
</pre><p>
        MySQL interprets <code class="literal">xname</code> in the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement as a reference
        to the <code class="literal">xname</code> <span class="emphasis"><em>variable</em></span>
        rather than the <code class="literal">xname</code>
        <span class="emphasis"><em>column</em></span>. Consequently, when the procedure
        <code class="literal">sp1()</code>is called, the
        <code class="literal">newname</code> variable returns the value
        <code class="literal">'bob'</code> regardless of the value of the
        <code class="literal">table1.xname</code> column.
      </p><p>
        Similarly, the cursor definition in the following procedure
        contains a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement that
        refers to <code class="literal">xname</code>. MySQL interprets this as a
        reference to the variable of that name rather than a column
        reference.
      </p><pre class="programlisting">
CREATE PROCEDURE sp2 (x VARCHAR(5))
BEGIN
  DECLARE xname VARCHAR(5) DEFAULT 'bob';
  DECLARE newname VARCHAR(5);
  DECLARE xid INT;
  DECLARE done TINYINT DEFAULT 0;
  DECLARE cur1 CURSOR FOR SELECT xname, id FROM table1;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

  OPEN cur1;
  read_loop: LOOP
    FETCH FROM cur1 INTO newname, xid;
    IF done THEN LEAVE read_loop; END IF;
    SELECT newname;
  END LOOP;
  CLOSE cur1;
END;
</pre><p>
        See also <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="flow-control-statements"></a>13.6.5 Flow Control Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#case">13.6.5.1 CASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#if">13.6.5.2 IF Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#iterate">13.6.5.3 ITERATE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#leave">13.6.5.4 LEAVE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#loop">13.6.5.5 LOOP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#repeat">13.6.5.6 REPEAT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#return">13.6.5.7 RETURN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#while">13.6.5.8 WHILE Syntax</a></span></dt></dl>
</div>
<p>
      MySQL supports the <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>,
      <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a>,
      <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a>,
      <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a>
      <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>, and
      <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> constructs for flow control
      within stored programs. It also supports
      <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> within stored functions.
    </p><p>
      Many of these constructs contain other statements, as indicated by
      the grammar specifications in the following sections. Such
      constructs may be nested. For example, an
      <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement might contain a
      <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> loop, which itself contains a
      <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement.
    </p><p>
      MySQL does not support <code class="literal">FOR</code> loops.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="case"></a>13.6.5.1 CASE Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737145311472"></a><pre class="programlisting">
CASE <em class="replaceable"><code>case_value</code></em>
    WHEN <em class="replaceable"><code>when_value</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [WHEN <em class="replaceable"><code>when_value</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END CASE
</pre><p>
        Or:
      </p><pre class="programlisting">
CASE
    WHEN <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [WHEN <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END CASE
</pre><p>
        The <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement for stored
        programs implements a complex conditional construct.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          There is also a <a class="link" href="functions.html#operator_case"><code class="literal">CASE</code></a>
          <span class="emphasis"><em>expression</em></span>, which differs from the
          <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a>
          <span class="emphasis"><em>statement</em></span> described here. See
          <a class="xref" href="functions.html#control-flow-functions" title="12.4 Control Flow Functions">Section 12.4, “Control Flow Functions”</a>. The
          <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement cannot have an
          <code class="literal">ELSE NULL</code> clause, and it is terminated with
          <code class="literal">END CASE</code> instead of <code class="literal">END</code>.
</p>
</div>
<p>
        For the first syntax, <em class="replaceable"><code>case_value</code></em> is
        an expression. This value is compared to the
        <em class="replaceable"><code>when_value</code></em> expression in each
        <code class="literal">WHEN</code> clause until one of them is equal. When
        an equal <em class="replaceable"><code>when_value</code></em> is found, the
        corresponding <code class="literal">THEN</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>when_value</code></em> is equal, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes, if there is
        one.
      </p><p>
        This syntax cannot be used to test for equality with
        <code class="literal">NULL</code> because <code class="literal">NULL = NULL</code>
        is false. See <a class="xref" href="tutorial.html#working-with-null" title="3.3.4.6 Working with NULL Values">Section 3.3.4.6, “Working with NULL Values”</a>.
      </p><p>
        For the second syntax, each <code class="literal">WHEN</code> clause
        <em class="replaceable"><code>search_condition</code></em> expression is
        evaluated until one is true, at which point its corresponding
        <code class="literal">THEN</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>search_condition</code></em> is equal, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes, if there is
        one.
      </p><p>
        If no <em class="replaceable"><code>when_value</code></em> or
        <em class="replaceable"><code>search_condition</code></em> matches the value
        tested and the <a class="link" href="sql-syntax.html#case" title="13.6.5.1 CASE Syntax"><code class="literal">CASE</code></a> statement
        contains no <code class="literal">ELSE</code> clause, a <span class="errortext">Case
        not found for CASE statement</span> error results.
      </p><p>
        Each <em class="replaceable"><code>statement_list</code></em> consists of one
        or more SQL statements; an empty
        <em class="replaceable"><code>statement_list</code></em> is not permitted.
      </p><p>
        To handle situations where no value is matched by any
        <code class="literal">WHEN</code> clause, use an <code class="literal">ELSE</code>
        containing an empty
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block, as shown in this example. (The indentation
        used here in the <code class="literal">ELSE</code> clause is for purposes
        of clarity only, and is not otherwise significant.)
      </p><pre class="programlisting">
DELIMITER |

CREATE PROCEDURE p()
  BEGIN
    DECLARE v INT DEFAULT 1;

    CASE v
      WHEN 2 THEN SELECT v;
      WHEN 3 THEN SELECT 0;
      ELSE
        BEGIN
        END;
    END CASE;
  END;
  |
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="if"></a>13.6.5.2 IF Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145266368"></a><pre class="programlisting">
IF <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>
    [ELSEIF <em class="replaceable"><code>search_condition</code></em> THEN <em class="replaceable"><code>statement_list</code></em>] ...
    [ELSE <em class="replaceable"><code>statement_list</code></em>]
END IF
</pre><p>
        The <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement for stored
        programs implements a basic conditional construct.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          There is also an <a class="link" href="functions.html#function_if"><code class="literal">IF()</code></a>
          <span class="emphasis"><em>function</em></span>, which differs from the
          <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>
          <span class="emphasis"><em>statement</em></span> described here. See
          <a class="xref" href="functions.html#control-flow-functions" title="12.4 Control Flow Functions">Section 12.4, “Control Flow Functions”</a>. The
          <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement can have
          <code class="literal">THEN</code>, <code class="literal">ELSE</code>, and
          <code class="literal">ELSEIF</code> clauses, and it is terminated with
          <code class="literal">END IF</code>.
</p>
</div>
<p>
        If the <em class="replaceable"><code>search_condition</code></em> evaluates to
        true, the corresponding <code class="literal">THEN</code> or
        <code class="literal">ELSEIF</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes. If no
        <em class="replaceable"><code>search_condition</code></em> matches, the
        <code class="literal">ELSE</code> clause
        <em class="replaceable"><code>statement_list</code></em> executes.
      </p><p>
        Each <em class="replaceable"><code>statement_list</code></em> consists of one
        or more SQL statements; an empty
        <em class="replaceable"><code>statement_list</code></em> is not permitted.
      </p><p>
        An <code class="literal">IF ... END IF</code> block, like all other
        flow-control blocks used within stored programs, must be
        terminated with a semicolon, as shown in this example:
      </p><pre class="programlisting">
DELIMITER //

CREATE FUNCTION SimpleCompare(n INT, m INT)
  RETURNS VARCHAR(20)

  BEGIN
    DECLARE s VARCHAR(20);

    IF n &gt; m THEN SET s = '&gt;';
    ELSEIF n = m THEN SET s = '=';
    ELSE SET s = '&lt;';
    END IF;

    SET s = CONCAT(n, ' ', s, ' ', m);

    RETURN s;
  END //

DELIMITER ;
</pre><p>
        As with other flow-control constructs, <code class="literal">IF ... END
        IF</code> blocks may be nested within other flow-control
        constructs, including other <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a>
        statements. Each <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> must be
        terminated by its own <code class="literal">END IF</code> followed by a
        semicolon. You can use indentation to make nested flow-control
        blocks more easily readable by humans (although this is not
        required by MySQL), as shown here:
      </p><pre class="programlisting">
DELIMITER //

CREATE FUNCTION VerboseCompare (n INT, m INT)
  RETURNS VARCHAR(50)

  BEGIN
    DECLARE s VARCHAR(50);

    IF n = m THEN SET s = 'equals';
    ELSE
      IF n &gt; m THEN SET s = 'greater';
      ELSE SET s = 'less';
      END IF;

      SET s = CONCAT('is ', s, ' than');
    END IF;

    SET s = CONCAT(n, ' ', s, ' ', m, '.');

    RETURN s;
  END //

DELIMITER ;
</pre><p>
        In this example, the inner <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> is
        evaluated only if <code class="literal">n</code> is not equal to
        <code class="literal">m</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="iterate"></a>13.6.5.3 ITERATE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145229920"></a><pre class="programlisting">
ITERATE <em class="replaceable"><code>label</code></em>
</pre><p>
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> can appear only within
        <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>, and
        <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statements.
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> means <span class="quote">“<span class="quote">start the
        loop again.</span>”</span>
      </p><p>
        For an example, see <a class="xref" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax">Section 13.6.5.5, “LOOP Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="leave"></a>13.6.5.4 LEAVE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145215344"></a><pre class="programlisting">
LEAVE <em class="replaceable"><code>label</code></em>
</pre><p>
        This statement is used to exit the flow control construct that
        has the given label. If the label is for the outermost stored
        program block, <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> exits the
        program.
      </p><p>
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> can be used within
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> or loop constructs
        (<a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a>,
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a>,
        <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>).
      </p><p>
        For an example, see <a class="xref" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax">Section 13.6.5.5, “LOOP Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="loop"></a>13.6.5.5 LOOP Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145199440"></a><pre class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] LOOP
    <em class="replaceable"><code>statement_list</code></em>
END LOOP [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a> implements a simple loop
        construct, enabling repeated execution of the statement list,
        which consists of one or more statements, each terminated by a
        semicolon (<code class="literal">;</code>) statement delimiter. The
        statements within the loop are repeated until the loop is
        terminated. Usually, this is accomplished with a
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement. Within a stored
        function, <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> can also be
        used, which exits the function entirely.
      </p><p>
        Neglecting to include a loop-termination statement results in an
        infinite loop.
      </p><p>
        A <a class="link" href="sql-syntax.html#loop" title="13.6.5.5 LOOP Syntax"><code class="literal">LOOP</code></a> statement can be labeled.
        For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre class="programlisting">
CREATE PROCEDURE doiterate(p1 INT)
BEGIN
  label1: LOOP
    SET p1 = p1 + 1;
    IF p1 &lt; 10 THEN
      ITERATE label1;
    END IF;
    LEAVE label1;
  END LOOP label1;
  SET @x = p1;
END;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="repeat"></a>13.6.5.6 REPEAT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145181376"></a><a class="indexterm" name="idm139737145180304"></a><pre class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] REPEAT
    <em class="replaceable"><code>statement_list</code></em>
UNTIL <em class="replaceable"><code>search_condition</code></em>
END REPEAT [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        The statement list within a
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> statement is repeated
        until the <em class="replaceable"><code>search_condition</code></em> expression
        is true. Thus, a <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> always
        enters the loop at least once.
        <em class="replaceable"><code>statement_list</code></em> consists of one or
        more statements, each terminated by a semicolon
        (<code class="literal">;</code>) statement delimiter.
      </p><p>
        A <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> statement can be
        labeled. For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE dorepeat(p1 INT)</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>SET @x = 0;</code></strong>
    -&gt;   <strong class="userinput"><code>REPEAT</code></strong>
    -&gt;     <strong class="userinput"><code>SET @x = @x + 1;</code></strong>
    -&gt;   <strong class="userinput"><code>UNTIL @x &gt; p1 END REPEAT;</code></strong>
    -&gt; <strong class="userinput"><code>END</code></strong>
    -&gt; <strong class="userinput"><code>//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL dorepeat(1000)//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @x//</code></strong>
+------+
| @x   |
+------+
| 1001 |
+------+
1 row in set (0.00 sec)
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="return"></a>13.6.5.7 RETURN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145155136"></a><pre class="programlisting">
RETURN <em class="replaceable"><code>expr</code></em>
</pre><p>
        The <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a> statement terminates
        execution of a stored function and returns the value
        <em class="replaceable"><code>expr</code></em> to the function caller. There
        must be at least one <a class="link" href="sql-syntax.html#return" title="13.6.5.7 RETURN Syntax"><code class="literal">RETURN</code></a>
        statement in a stored function. There may be more than one if
        the function has multiple exit points.
      </p><p>
        This statement is not used in stored procedures, triggers, or
        events. The <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> statement can
        be used to exit a stored program of those types.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="while"></a>13.6.5.8 WHILE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145143296"></a><pre class="programlisting">
[<em class="replaceable"><code>begin_label</code></em>:] WHILE <em class="replaceable"><code>search_condition</code></em> DO
    <em class="replaceable"><code>statement_list</code></em>
END WHILE [<em class="replaceable"><code>end_label</code></em>]
</pre><p>
        The statement list within a <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a>
        statement is repeated as long as the
        <em class="replaceable"><code>search_condition</code></em> expression is true.
        <em class="replaceable"><code>statement_list</code></em> consists of one or
        more SQL statements, each terminated by a semicolon
        (<code class="literal">;</code>) statement delimiter.
      </p><p>
        A <a class="link" href="sql-syntax.html#while" title="13.6.5.8 WHILE Syntax"><code class="literal">WHILE</code></a> statement can be labeled.
        For the rules regarding label use, see
        <a class="xref" href="sql-syntax.html#statement-labels" title="13.6.2 Statement Label Syntax">Section 13.6.2, “Statement Label Syntax”</a>.
      </p><p>
        Example:
      </p><pre class="programlisting">
CREATE PROCEDURE dowhile()
BEGIN
  DECLARE v1 INT DEFAULT 5;

  WHILE v1 &gt; 0 DO
    ...
    SET v1 = v1 - 1;
  END WHILE;
END;
</pre>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="cursors"></a>13.6.6 Cursors</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#close">13.6.6.1 Cursor CLOSE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare-cursor">13.6.6.2 Cursor DECLARE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#fetch">13.6.6.3 Cursor FETCH Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#open">13.6.6.4 Cursor OPEN Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737145127280"></a><p>
      MySQL supports cursors inside stored programs. The syntax is as in
      embedded SQL. Cursors have these properties:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Asensitive: The server may or may not make a copy of its
          result table
        </p></li><li class="listitem"><p>
          Read only: Not updatable
        </p></li><li class="listitem"><p>
          Nonscrollable: Can be traversed only in one direction and
          cannot skip rows
</p></li></ul>
</div>
<p>
      Cursor declarations must appear before handler declarations and
      after variable and condition declarations.
    </p><p>
      Example:
    </p><pre class="programlisting">
CREATE PROCEDURE curdemo()
BEGIN
  DECLARE done INT DEFAULT FALSE;
  DECLARE a CHAR(16);
  DECLARE b, c INT;
  DECLARE cur1 CURSOR FOR SELECT id,data FROM test.t1;
  DECLARE cur2 CURSOR FOR SELECT i FROM test.t2;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

  OPEN cur1;
  OPEN cur2;

  read_loop: LOOP
    FETCH cur1 INTO a, b;
    FETCH cur2 INTO c;
    IF done THEN
      LEAVE read_loop;
    END IF;
    IF b &lt; c THEN
      INSERT INTO test.t3 VALUES (a,b);
    ELSE
      INSERT INTO test.t3 VALUES (a,c);
    END IF;
  END LOOP;

  CLOSE cur1;
  CLOSE cur2;
END;
</pre>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="close"></a>13.6.6.1 Cursor CLOSE Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737145119056"></a><pre class="programlisting">
CLOSE <em class="replaceable"><code>cursor_name</code></em>
</pre><p>
        This statement closes a previously opened cursor. For an
        example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
      </p><p>
        An error occurs if the cursor is not open.
      </p><p>
        If not closed explicitly, a cursor is closed at the end of the
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block in which it was declared.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-cursor"></a>13.6.6.2 Cursor DECLARE Syntax</h4>

</div>

</div>

</div>
<pre class="programlisting">
DECLARE <em class="replaceable"><code>cursor_name</code></em> CURSOR FOR <em class="replaceable"><code>select_statement</code></em>
</pre><p>
        This statement declares a cursor and associates it with a
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement that retrieves
        the rows to be traversed by the cursor. To fetch the rows later,
        use a <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement. The number
        of columns retrieved by the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement must match the
        number of output variables specified in the
        <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement.
      </p><p>
        The <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement cannot have
        an <code class="literal">INTO</code> clause.
      </p><p>
        Cursor declarations must appear before handler declarations and
        after variable and condition declarations.
      </p><p>
        A stored program may contain multiple cursor declarations, but
        each cursor declared in a given block must have a unique name.
        For an example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
      </p><p>
        For information available through
        <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> statements, it is possible
        in many cases to obtain equivalent information by using a cursor
        with an <code class="literal">INFORMATION_SCHEMA</code> table.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="fetch"></a>13.6.6.3 Cursor FETCH Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145091040"></a><pre class="programlisting">
FETCH [[NEXT] FROM] <em class="replaceable"><code>cursor_name</code></em> INTO <em class="replaceable"><code>var_name</code></em> [, <em class="replaceable"><code>var_name</code></em>] ...
</pre><p>
        This statement fetches the next row for the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement associated with
        the specified cursor (which must be open), and advances the
        cursor pointer. If a row exists, the fetched columns are stored
        in the named variables. The number of columns retrieved by the
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement must match the
        number of output variables specified in the
        <a class="link" href="sql-syntax.html#fetch" title="13.6.6.3 Cursor FETCH Syntax"><code class="literal">FETCH</code></a> statement.
      </p><p>
        If no more rows are available, a No Data condition occurs with
        SQLSTATE value <code class="literal">'02000'</code>. To detect this
        condition, you can set up a handler for it (or for a
        <code class="literal">NOT FOUND</code> condition). For an example, see
        <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="open"></a>13.6.6.4 Cursor OPEN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145076432"></a><pre class="programlisting">
OPEN <em class="replaceable"><code>cursor_name</code></em>
</pre><p>
        This statement opens a previously declared cursor. For an
        example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="condition-handling"></a>13.6.7 Condition Handling</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#declare-condition">13.6.7.1 DECLARE ... CONDITION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#declare-handler">13.6.7.2 DECLARE ... HANDLER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#get-diagnostics">13.6.7.3 GET DIAGNOSTICS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#resignal">13.6.7.4 RESIGNAL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#signal">13.6.7.5 SIGNAL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#handler-scope">13.6.7.6 Scope Rules for Handlers</a></span></dt><dt><span class="section"><a href="sql-syntax.html#diagnostics-area">13.6.7.7 The MySQL Diagnostics Area</a></span></dt></dl>
</div>
<p>
      Conditions may arise during stored program execution that require
      special handling, such as exiting the current program block or
      continuing execution. Handlers can be defined for general
      conditions such as warnings or exceptions, or for specific
      conditions such as a particular error code. Specific conditions
      can be assigned names and referred to that way in handlers.
    </p><p>
      To name a condition, use the
      <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
      CONDITION</code></a> statement. To declare a handler, use the
      <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
      HANDLER</code></a> statement. See
      <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>. For information about how the
      server chooses handlers when a condition occurs, see
      <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
    </p><p>
      To raise a condition, use the
      <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement. To modify
      condition information within a condition handler, use
      <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>. See
      <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>, and
      <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>.
    </p><p>
      To retrieve information from the diagnostics area, use the
      <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
      <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
      diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-condition"></a>13.6.7.1 DECLARE ... CONDITION Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737145053824"></a><pre class="programlisting">
DECLARE <em class="replaceable"><code>condition_name</code></em> CONDITION FOR <em class="replaceable"><code>condition_value</code></em>

<em class="replaceable"><code>condition_value</code></em>:
    <em class="replaceable"><code>mysql_error_code</code></em>
  | SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
</pre><p>
        The <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE
        ... CONDITION</code></a> statement declares a named error
        condition, associating a name with a condition that needs
        specific handling. The name can be referred to in a subsequent
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement (see
        <a class="xref" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax">Section 13.6.7.2, “DECLARE ... HANDLER Syntax”</a>).
      </p><p>
        Condition declarations must appear before cursor or handler
        declarations.
      </p><p>
        The <em class="replaceable"><code>condition_value</code></em> for
        <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
        CONDITION</code></a> can be a MySQL error code (a number) or an
        SQLSTATE value (a 5-character string literal). You should not
        use MySQL error code 0 or SQLSTATE values that begin with
        <code class="literal">'00'</code>, because those indicate success rather
        than an error condition. For a list of MySQL error codes and
        SQLSTATE values, see <a class="xref" href="error-handling.html#error-messages-server" title="B.3 Server Error Codes and Messages">Section B.3, “Server Error Codes and Messages”</a>.
      </p><p>
        Using names for conditions can help make stored program code
        clearer. For example, this handler applies to attempts to drop a
        nonexistent table, but that is apparent only if you know the
        meaning of MySQL error code 1051:
      </p><pre class="programlisting">
DECLARE CONTINUE HANDLER FOR 1051
  BEGIN
    -- body of handler
  END;
</pre><p>
        By declaring a name for the condition, the purpose of the
        handler is more readily seen:
      </p><pre class="programlisting">
DECLARE no_such_table CONDITION FOR 1051;
DECLARE CONTINUE HANDLER FOR no_such_table
  BEGIN
    -- body of handler
  END;
</pre><p>
        Here is a named condition for the same condition, but based on
        the corresponding SQLSTATE value rather than the MySQL error
        code:
      </p><pre class="programlisting">
DECLARE no_such_table CONDITION FOR SQLSTATE '42S02';
DECLARE CONTINUE HANDLER FOR no_such_table
  BEGIN
    -- body of handler
  END;
</pre><p>
        Condition names referred to in
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or use
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statements must be
        associated with SQLSTATE values, not MySQL error codes.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="declare-handler"></a>13.6.7.2 DECLARE ... HANDLER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737145030400"></a><pre class="programlisting">
DECLARE <em class="replaceable"><code>handler_action</code></em> HANDLER
    FOR <em class="replaceable"><code>condition_value</code></em> [, <em class="replaceable"><code>condition_value</code></em>] ...
    <em class="replaceable"><code>statement</code></em>

<em class="replaceable"><code>handler_action</code></em>:
    CONTINUE
  | EXIT
  | UNDO

<em class="replaceable"><code>condition_value</code></em>:
    <em class="replaceable"><code>mysql_error_code</code></em>
  | SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>
  | SQLWARNING
  | NOT FOUND
  | SQLEXCEPTION
</pre><p>
        The <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement specifies a handler that deals with
        one or more conditions. If one of these conditions occurs, the
        specified <em class="replaceable"><code>statement</code></em> executes.
        <em class="replaceable"><code>statement</code></em> can be a simple statement
        such as <code class="literal">SET <em class="replaceable"><code>var_name</code></em> =
        <em class="replaceable"><code>value</code></em></code>, or a compound
        statement written using <code class="literal">BEGIN</code> and
        <code class="literal">END</code> (see <a class="xref" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax">Section 13.6.1, “BEGIN ... END Compound-Statement Syntax”</a>).
      </p><p>
        Handler declarations must appear after variable or condition
        declarations.
      </p><p>
        The <em class="replaceable"><code>handler_action</code></em> value indicates
        what action the handler takes after execution of the handler
        statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">CONTINUE</code>: Execution of the current
            program continues.
          </p></li><li class="listitem"><p>
            <code class="literal">EXIT</code>: Execution terminates for the
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> compound statement in which the handler is
            declared. This is true even if the condition occurs in an
            inner block.
          </p></li><li class="listitem"><p>
            <code class="literal">UNDO</code>: Not supported.
</p></li></ul>
</div>
<p>
        The <em class="replaceable"><code>condition_value</code></em> for
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> indicates the specific condition or class of
        conditions that activates the handler:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A MySQL error code (a number) or an SQLSTATE value (a
            5-character string literal). You should not use MySQL error
            code 0 or SQLSTATE values that begin with
            <code class="literal">'00'</code>, because those indicate success
            rather than an error condition. For a list of MySQL error
            codes and SQLSTATE values, see
            <a class="xref" href="error-handling.html#error-messages-server" title="B.3 Server Error Codes and Messages">Section B.3, “Server Error Codes and Messages”</a>.
          </p></li><li class="listitem"><p>
            A condition name previously specified with
            <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE
            ... CONDITION</code></a>. A condition name can be associated
            with a MySQL error code or SQLSTATE value. See
            <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">SQLWARNING</code> is shorthand for the class of
            SQLSTATE values that begin with <code class="literal">'01'</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">NOT FOUND</code> is shorthand for the class of
            SQLSTATE values that begin with <code class="literal">'02'</code>.
            This is relevant within the context of cursors and is used
            to control what happens when a cursor reaches the end of a
            data set. If no more rows are available, a No Data condition
            occurs with SQLSTATE value <code class="literal">'02000'</code>. To
            detect this condition, you can set up a handler for it (or
            for a <code class="literal">NOT FOUND</code> condition). For an
            example, see <a class="xref" href="sql-syntax.html#cursors" title="13.6.6 Cursors">Section 13.6.6, “Cursors”</a>. This condition also
            occurs for <code class="literal">SELECT ... INTO
            <em class="replaceable"><code>var_list</code></em></code> statements
            that retrieve no rows.
          </p></li><li class="listitem"><p>
            <code class="literal">SQLEXCEPTION</code> is shorthand for the class
            of SQLSTATE values that do not begin with
            <code class="literal">'00'</code>, <code class="literal">'01'</code>, or
            <code class="literal">'02'</code>.
</p></li></ul>
</div>
<p>
        For information about how the server chooses handlers when a
        condition occurs, see <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
      </p><p>
        If a condition occurs for which no handler has been declared,
        the action taken depends on the condition class:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For <code class="literal">SQLEXCEPTION</code> conditions, the stored
            program terminates at the statement that raised the
            condition, as if there were an <code class="literal">EXIT</code>
            handler. If the program was called by another stored
            program, the calling program handles the condition using the
            handler selection rules applied to its own handlers.
          </p></li><li class="listitem"><p>
            For <code class="literal">SQLWARNING</code> conditions, the program
            continues executing, as if there were a
            <code class="literal">CONTINUE</code> handler.
          </p></li><li class="listitem"><p>
            For <code class="literal">NOT FOUND</code> conditions, if the
            condition was raised normally, the action is
            <code class="literal">CONTINUE</code>. If it was raised by
            <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>, the action is
            <code class="literal">EXIT</code>.
</p></li></ul>
</div>
<p>
        The following example uses a handler for <code class="literal">SQLSTATE
        '23000'</code>, which occurs for a duplicate-key error:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE test.t (s1 INT, PRIMARY KEY (s1));</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>

mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE handlerdemo ()</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @x2 = 1;</code></strong>
    -&gt;   <strong class="userinput"><code>SET @x = 1;</code></strong>
    -&gt;   <strong class="userinput"><code>INSERT INTO test.t VALUES (1);</code></strong>
    -&gt;   <strong class="userinput"><code>SET @x = 2;</code></strong>
    -&gt;   <strong class="userinput"><code>INSERT INTO test.t VALUES (1);</code></strong>
    -&gt;   <strong class="userinput"><code>SET @x = 3;</code></strong>
    -&gt; <strong class="userinput"><code>END;</code></strong>
    -&gt; <strong class="userinput"><code>//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL handlerdemo()//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @x//</code></strong>
    +------+
    | @x   |
    +------+
    | 3    |
    +------+
    1 row in set (0.00 sec)
</pre><p>
        Notice that <code class="literal">@x</code> is <code class="literal">3</code> after
        the procedure executes, which shows that execution continued to
        the end of the procedure after the error occurred. If the
        <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
        HANDLER</code></a> statement had not been present, MySQL would
        have taken the default action (<code class="literal">EXIT</code>) after
        the second <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> failed due to
        the <code class="literal">PRIMARY KEY</code> constraint, and
        <code class="literal">SELECT @x</code> would have returned
        <code class="literal">2</code>.
      </p><p>
        To ignore a condition, declare a <code class="literal">CONTINUE</code>
        handler for it and associate it with an empty block. For
        example:
      </p><pre class="programlisting">
DECLARE CONTINUE HANDLER FOR SQLWARNING BEGIN END;
</pre><p>
        The scope of a block label does not include the code for
        handlers declared within the block. Therefore, the statement
        associated with a handler cannot use
        <a class="link" href="sql-syntax.html#iterate" title="13.6.5.3 ITERATE Syntax"><code class="literal">ITERATE</code></a> or
        <a class="link" href="sql-syntax.html#leave" title="13.6.5.4 LEAVE Syntax"><code class="literal">LEAVE</code></a> to refer to labels for
        blocks that enclose the handler declaration. Consider the
        following example, where the
        <a class="link" href="sql-syntax.html#repeat" title="13.6.5.6 REPEAT Syntax"><code class="literal">REPEAT</code></a> block has a label of
        <code class="literal">retry</code>:
      </p><pre class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 3;
  retry:
    REPEAT
      BEGIN
        DECLARE CONTINUE HANDLER FOR SQLWARNING
          BEGIN
            ITERATE retry;    # illegal
          END;
        IF i &lt; 0 THEN
          LEAVE retry;        # legal
        END IF;
        SET i = i - 1;
      END;
    UNTIL FALSE END REPEAT;
END;
</pre><p>
        The <code class="literal">retry</code> label is in scope for the
        <a class="link" href="sql-syntax.html#if" title="13.6.5.2 IF Syntax"><code class="literal">IF</code></a> statement within the block. It
        is not in scope for the <code class="literal">CONTINUE</code> handler, so
        the reference there is invalid and results in an error:
      </p><pre class="programlisting">
ERROR 1308 (42000): LEAVE with no matching label: retry
</pre><p>
        To avoid references to outer labels in handlers, use one of
        these strategies:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To leave the block, use an <code class="literal">EXIT</code> handler.
            If no block cleanup is required, the
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> handler body can be empty:
          </p><pre class="programlisting">
DECLARE EXIT HANDLER FOR SQLWARNING BEGIN END;
</pre><p>
            Otherwise, put the cleanup statements in the handler body:
          </p><pre class="programlisting">
DECLARE EXIT HANDLER FOR SQLWARNING
  BEGIN
    <em class="replaceable"><code>block cleanup statements</code></em>
  END;
</pre></li><li class="listitem"><p>
            To continue execution, set a status variable in a
            <code class="literal">CONTINUE</code> handler that can be checked in
            the enclosing block to determine whether the handler was
            invoked. The following example uses the variable
            <code class="literal">done</code> for this purpose:
          </p><pre class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE i INT DEFAULT 3;
  DECLARE done INT DEFAULT FALSE;
  retry:
    REPEAT
      BEGIN
        DECLARE CONTINUE HANDLER FOR SQLWARNING
          BEGIN
            SET done = TRUE;
          END;
        IF done OR i &lt; 0 THEN
          LEAVE retry;
        END IF;
        SET i = i - 1;
      END;
    UNTIL FALSE END REPEAT;
END;
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="get-diagnostics"></a>13.6.7.3 GET DIAGNOSTICS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144931216"></a><pre class="programlisting">
GET [CURRENT] DIAGNOSTICS
{
    <em class="replaceable"><code>statement_information_item</code></em>
    [, <em class="replaceable"><code>statement_information_item</code></em>] ... 
  | CONDITION <em class="replaceable"><code>condition_number</code></em>
    <em class="replaceable"><code>condition_information_item</code></em>
    [, <em class="replaceable"><code>condition_information_item</code></em>] ...
}

<em class="replaceable"><code>statement_information_item</code></em>:
    <em class="replaceable"><code>target</code></em> = <em class="replaceable"><code>statement_information_item_name</code></em>

<em class="replaceable"><code>condition_information_item</code></em>:
    <em class="replaceable"><code>target</code></em> = <em class="replaceable"><code>condition_information_item_name</code></em>

<em class="replaceable"><code>statement_information_item_name</code></em>:
    NUMBER
  | ROW_COUNT

<em class="replaceable"><code>condition_information_item_name</code></em>:
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | RETURNED_SQLSTATE
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME

<em class="replaceable"><code>condition_number</code></em>, <em class="replaceable"><code>target</code></em>:
    (see following discussion)
</pre><p>
        SQL statements produce diagnostic information that populates the
        diagnostics area. The <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> statement enables applications to inspect
        this information. It is available as of MySQL 5.6.4. (You can
        also use <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> or
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> to see conditions or
        errors.)
      </p><p>
        No special privileges are required to execute
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a>.
      </p><p>
        The keyword <code class="literal">CURRENT</code> means to retrieve
        information from the current diagnostics area. In MySQL, it has
        no effect because that is the default behavior.
      </p><p>
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> is typically used
        in a handler within a stored program, but it is a MySQL
        extension that it is permitted outside handler context to check
        the execution of any SQL statement. For example, if you invoke
        the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client program, you can enter these
        statements at the prompt:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP TABLE test.no_such_table;</code></strong>
ERROR 1051 (42S02): Unknown table 'test.no_such_table'
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 1</code></strong>
    -&gt;   <strong class="userinput"><code>@p1 = RETURNED_SQLSTATE, @p2 = MESSAGE_TEXT;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @p1, @p2;</code></strong>
+-------+------------------------------------+
| @p1   | @p2                                |
+-------+------------------------------------+
| 42S02 | Unknown table 'test.no_such_table' |
+-------+------------------------------------+
</pre><p>
        For a description of the diagnostics area, see
        <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>. Briefly, it contains two
        kinds of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Statement information, such as the number of conditions that
            occurred or the affected-rows count.
          </p></li><li class="listitem"><p>
            Condition information, such as the error code and message.
            If a statement raises multiple conditions, this part of the
            diagnostics area has a condition area for each one. If a
            statement raises no conditions, this part of the diagnostics
            area is empty.
</p></li></ul>
</div>
<p>
        For a statement that produces three conditions, the diagnostics
        area contains statement and condition information like this:
      </p><pre class="programlisting">
Statement information:
  row count
  ... other statement information items ...
Condition area list:
  Condition area 1:
    error code for condition 1
    error message for condition 1
    ... other condition information items ...
  Condition area 2:
    error code for condition 2:
    error message for condition 2
    ... other condition information items ...
  Condition area 3:
    error code for condition 3
    error message for condition 3
    ... other condition information items ...
</pre><p>
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> can obtain either
        statement or condition information, but not both in the same
        statement:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To obtain statement information, retrieve the desired
            statement items into target variables. This instance of
            <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> assigns the
            number of available conditions and the rows-affected count
            to the user variables <code class="literal">@p1</code> and
            <code class="literal">@p2</code>:
          </p><pre class="programlisting">
GET DIAGNOSTICS @p1 = NUMBER, @p2 = ROW_COUNT;
</pre></li><li class="listitem"><p>
            To obtain condition information, specify the condition
            number and retrieve the desired condition items into target
            variables. This instance of <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
            DIAGNOSTICS</code></a> assigns the SQLSTATE value and error
            message to the user variables <code class="literal">@p3</code> and
            <code class="literal">@p4</code>:
          </p><pre class="programlisting">
GET DIAGNOSTICS CONDITION 1
  @p3 = RETURNED_SQLSTATE, @p4 = MESSAGE_TEXT;
</pre></li></ul>
</div>
<p>
        The retrieval list specifies one or more
        <code class="literal"><em class="replaceable"><code>target</code></em> =
        <em class="replaceable"><code>item_name</code></em></code> assignments,
        separated by commas. Each assignment names a target variable and
        either a
        <em class="replaceable"><code>statement_information_item_name</code></em> or
        <em class="replaceable"><code>condition_information_item_name</code></em>
        designator, depending on whether the statement retrieves
        statement or condition information.
      </p><p>
        Valid <em class="replaceable"><code>target</code></em> designators for storing
        item information can be stored procedure or function parameters,
        stored program local variables declared with
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, or user-defined
        variables.
      </p><p>
        Valid <em class="replaceable"><code>condition_number</code></em> designators
        can be stored procedure or function parameters, stored program
        local variables declared with
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, user-defined variables,
        system variables, or literals. A character literal may include a
        <em class="replaceable"><code>_charset</code></em> introducer. A warning occurs
        if the condition number is not in the range from 1 to the number
        of condition areas that have information. In this case, the
        warning is added to the diagnostics area without clearing it.
      </p><p>
        Currently, when a condition occurs, MySQL does not populate all
        condition items recognized by <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a>. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 1</code></strong>
    -&gt;   <strong class="userinput"><code>@p5 = SCHEMA_NAME, @p6 = TABLE_NAME;</code></strong>
mysql&gt; <strong class="userinput"><code>SELECT @p5, @p6;</code></strong>
+------+------+
| @p5  | @p6  |
+------+------+
|      |      |
+------+------+
</pre><p>
        In standard SQL, if there are multiple conditions, the first
        condition relates to the <code class="literal">SQLSTATE</code> value
        returned for the previous SQL statement. In MySQL, this is not
        guaranteed. To get the main error, you cannot do this:
      </p><pre class="programlisting">
GET DIAGNOSTICS CONDITION 1 @errno = MYSQL_ERRNO;
</pre><p>
        Instead, retrieve the condition count first, then use it to
        specify which condition number to inspect:
      </p><pre class="programlisting">
GET DIAGNOSTICS @cno = NUMBER;
GET DIAGNOSTICS CONDITION @cno @errno = MYSQL_ERRNO;
</pre><p>
        For information about permissible statement and condition
        information items, and which ones are populated when a condition
        occurs, see
        <a class="xref" href="sql-syntax.html#diagnostics-area-information-items" title="13.6.7.7.2 Diagnostics Area Information Items">Section 13.6.7.7.2, “Diagnostics Area Information Items”</a>.
      </p><p>
        Here is an example that uses <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> and an exception handler in stored
        procedure context to assess the outcome of an insert operation.
        If the insert was successful, the procedure uses
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> to get the
        rows-affected count. This shows that you can use
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> multiple times to
        retrieve information about a statement as long as the
        diagnostics area has not been cleared.
      </p><pre class="programlisting">
CREATE PROCEDURE do_insert(value INT)
BEGIN
  -- Declare variables to hold diagnostics area information
  DECLARE code CHAR(5) DEFAULT '00000';
  DECLARE msg TEXT;
  DECLARE rows INT;
  DECLARE result TEXT;
  -- Declare exception handler for failed insert
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    BEGIN
      GET DIAGNOSTICS CONDITION 1
        code = RETURNED_SQLSTATE, msg = MESSAGE_TEXT;
    END;

  -- Perform the insert
  INSERT INTO t1 (int_col) VALUES(value);
  -- Check whether the insert was successful
  IF code = '00000' THEN
    GET DIAGNOSTICS rows = ROW_COUNT;
    SET result = CONCAT('insert succeeded, row count = ',rows);
  ELSE
    SET result = CONCAT('insert failed, error = ',code,', message = ',msg);
  END IF;
  -- Say what happened
  SELECT result;
END;
</pre><p>
        Suppose that <code class="literal">t1.int_col</code> is an integer column
        that is declared as <code class="literal">NOT NULL</code>. The procedure
        produces these results when invoked to insert
        non-<code class="literal">NULL</code> and <code class="literal">NULL</code> values,
        respectively:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL do_insert(1);</code></strong>
+---------------------------------+
| result                          |
+---------------------------------+
| insert succeeded, row count = 1 |
+---------------------------------+

mysql&gt; <strong class="userinput"><code>CALL do_insert(NULL);</code></strong>
+-------------------------------------------------------------------------+
| result                                                                  |
+-------------------------------------------------------------------------+
| insert failed, error = 23000, message = Column 'int_col' cannot be null |
+-------------------------------------------------------------------------+
</pre><p>
        Within a condition handler, <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> should be used before other statements
        that might clear the diagnostics area and cause information to
        be lost about the condition that activated the handler. For
        information about when the diagnostics area is set and cleared,
        see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="resignal"></a>13.6.7.4 RESIGNAL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144854864"></a><pre class="programlisting">
RESIGNAL [<em class="replaceable"><code>condition_value</code></em>]
    [SET <em class="replaceable"><code>signal_information_item</code></em>
    [, <em class="replaceable"><code>signal_information_item</code></em>] ...]

<em class="replaceable"><code>condition_value</code></em>:
    SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>

<em class="replaceable"><code>signal_information_item</code></em>:
    <em class="replaceable"><code>condition_information_item_name</code></em> = <em class="replaceable"><code>simple_value_specification</code></em>

<em class="replaceable"><code>condition_information_item_name</code></em>:
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME

<em class="replaceable"><code>condition_name</code></em>, <em class="replaceable"><code>simple_value_specification</code></em>:
    (see following discussion)
</pre><p>
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> passes on the error
        condition information that is available during execution of a
        condition handler within a compound statement inside a stored
        procedure or function, trigger, or event.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> may change some or all
        information before passing it on.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is related to
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>, but instead of
        originating a condition as <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
        does, <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> relays existing
        condition information, possibly after modifying it.
      </p><p>
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> makes it possible to
        both handle an error and return the error information.
        Otherwise, by executing an SQL statement within the handler,
        information that caused the handler's activation is destroyed.
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> also can make some
        procedures shorter if a given handler can handle part of a
        situation, then pass the condition <span class="quote">“<span class="quote">up the line</span>”</span> to
        another handler.
      </p><p>
        No special privileges are required to execute the
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement.
      </p><p>
        All forms of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> require
        that the current context be a condition handler. Otherwise,
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is illegal and a
        <code class="literal">RESIGNAL when handler not active</code> error
        occurs.
      </p><p>
        To retrieve information from the diagnostics area, use the
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
        <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
        diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
      </p><p>
        For <em class="replaceable"><code>condition_value</code></em> and
        <em class="replaceable"><code>signal_information_item</code></em>, the
        definitions and rules are the same for
        <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> as for
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>. For example, the
        <em class="replaceable"><code>condition_value</code></em> can be an
        <code class="literal">SQLSTATE</code> value, and the value can indicate
        errors, warnings, or <span class="quote">“<span class="quote">not found.</span>”</span> For additional
        information, see <a class="xref" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax">Section 13.6.7.5, “SIGNAL Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement takes
        <em class="replaceable"><code>condition_value</code></em> and
        <code class="literal">SET</code> clauses, both of which are optional. This
        leads to several possible uses:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone:
          </p><pre class="programlisting">
RESIGNAL;
</pre></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with new signal
            information:
          </p><pre class="programlisting">
RESIGNAL SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...;
</pre></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a condition
            value and possibly new signal information:
          </p><pre class="programlisting">
RESIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...];
</pre></li></ul>
</div>
<p>
        These use cases all cause changes to the diagnostics and
        condition areas:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A diagnostics area contains one or more condition areas.
          </p></li><li class="listitem"><p>
            A condition area contains condition information items, such
            as the <code class="literal">SQLSTATE</code> value,
            <code class="literal">MYSQL_ERRNO</code>, or
            <code class="literal">MESSAGE_TEXT</code>.
</p></li></ul>
</div>
<p>
        The maximum number of condition areas in a diagnostics area is
        determined by the value of the
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> system
        variable. See
        <a class="xref" href="sql-syntax.html#diagnostics-area-system-variables" title="13.6.7.7.4 Diagnostics Area-Related System Variables">Section 13.6.7.7.4, “Diagnostics Area-Related System Variables”</a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="resignal-alone"></a>13.6.7.4.1 RESIGNAL Alone</h5>
</div>
</div>
</div>
<p>
          A simple <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone means
          <span class="quote">“<span class="quote">pass on the error with no change.</span>”</span> It restores
          the last diagnostics area and makes it the current diagnostics
          area. That is, it <span class="quote">“<span class="quote">pops</span>”</span> the diagnostics area
          stack.
        </p><p>
          Within a condition handler that catches a condition, one use
          for <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone is to
          perform some other actions, and then pass on without change
          the original condition information (the information that
          existed before entry into the handler).
        </p><p>
          Example:
        </p><pre class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
CALL p();
</pre><p>
          Suppose that the <code class="literal">DROP TABLE xx</code> statement
          fails. The diagnostics area stack looks like this:
        </p><pre class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          Then execution enters the <code class="literal">EXIT</code> handler. It
          starts by pushing a diagnostics area to the top of the stack,
          which now looks like this:
        </p><pre class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
DA 2. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          At this point, the contents of the first (current) and second
          (stacked) diagnostics areas are the same. The first
          diagnostics area may be modified by statements executing
          subsequently within the handler.
        </p><p>
          Usually a procedure statement clears the first diagnostics
          area. <code class="literal">BEGIN</code> is an exception, it does not
          clear, it does nothing. <code class="literal">SET</code> is not an
          exception, it clears, performs the operation, and produces a
          result of <span class="quote">“<span class="quote">success.</span>”</span> The diagnostics area stack
          now looks like this:
        </p><pre class="programlisting">
DA 1. ERROR 0000 (00000): Successful operation
DA 2. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          At this point, if <code class="literal">@a = 0</code>,
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> pops the diagnostics
          area stack, which now looks like this:
        </p><pre class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          And that is what the caller sees.
        </p><p>
          If <code class="literal">@a</code> is not 0, the handler simply ends,
          which means that there is no more use for the current
          diagnostics area (it has been <span class="quote">“<span class="quote">handled</span>”</span>), so it
          can be thrown away, causing the stacked diagnostics area to
          become the current diagnostics area again. The diagnostics
          area stack looks like this:
        </p><pre class="programlisting">
DA 1. ERROR 0000 (00000): Successful operation
</pre><p>
          The details make it look complex, but the end result is quite
          useful: Handlers can execute without destroying information
          about the condition that caused activation of the handler.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="resignal-with-new-signal"></a>13.6.7.4.2 RESIGNAL with New Signal Information</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a
          <code class="literal">SET</code> clause provides new signal information,
          so the statement means <span class="quote">“<span class="quote">pass on the error with
          changes</span>”</span>:
        </p><pre class="programlisting">
RESIGNAL SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...;
</pre><p>
          As with <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone, the
          idea is to pop the diagnostics area stack so that the original
          information will go out. Unlike
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone, anything
          specified in the <code class="literal">SET</code> clause changes.
        </p><p>
          Example:
        </p><pre class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL SET MYSQL_ERRNO = 5; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
CALL p();
</pre><p>
          Remember from the previous discussion that
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone results in a
          diagnostics area stack like this:
        </p><pre class="programlisting">
DA 1. ERROR 1051 (42S02): Unknown table 'xx'
</pre><p>
          The <code class="literal">RESIGNAL SET MYSQL_ERRNO = 5</code> statement
          results in this stack instead, which is what the caller sees:
        </p><pre class="programlisting">
DA 1. ERROR 5 (42S02): Unknown table 'xx'
</pre><p>
          In other words, it changes the error number, and nothing else.
        </p><p>
          The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement can
          change any or all of the signal information items, making the
          first condition area of the diagnostics area look quite
          different.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="resignal-with-condition"></a>13.6.7.4.3 RESIGNAL with a Condition Value and Optional New Signal Information</h5>

</div>

</div>

</div>
<p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> with a condition value
          means <span class="quote">“<span class="quote">push a condition into the current diagnostics
          area.</span>”</span> If the <code class="literal">SET</code> clause is present,
          it also changes the error information.
        </p><pre class="programlisting">
RESIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em> [, <em class="replaceable"><code>signal_information_item</code></em>] ...];
</pre><p>
          This form of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> restores
          the last diagnostics area and makes it the current diagnostics
          area. That is, it <span class="quote">“<span class="quote">pops</span>”</span> the diagnostics area
          stack, which is the same as what a simple
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> alone would do.
          However, it also changes the diagnostics area depending on the
          condition value or signal information.
        </p><p>
          Example:
        </p><pre class="programlisting">
DROP TABLE IF EXISTS xx;
delimiter //
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SET @error_count = @error_count + 1;
    IF @a = 0 THEN RESIGNAL SQLSTATE '45000' SET MYSQL_ERRNO=5; END IF;
  END;
  DROP TABLE xx;
END//
delimiter ;
SET @error_count = 0;
SET @a = 0;
SET @@max_error_count = 2;
CALL p();
SHOW ERRORS;
</pre><p>
          This is similar to the previous example, and the effects are
          the same, except that if
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> happens, the current
          condition area looks different at the end. (The reason the
          condition adds to rather than replaces the existing condition
          is the use of a condition value.)
        </p><p>
          The <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement includes
          a condition value (<code class="literal">SQLSTATE '45000'</code>), so it
          adds a new condition area, resulting in a diagnostics area
          stack that looks like this:
        </p><pre class="programlisting">
DA 1. (condition 2) ERROR 1051 (42S02): Unknown table 'xx'
      (condition 1) ERROR 5 (45000) Unknown table 'xx'
</pre><p>
          The result of <a class="link" href="sql-syntax.html#call" title="13.2.1 CALL Syntax"><code class="literal">CALL
          p()</code></a> and <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a>
          for this example is:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p();</code></strong>
ERROR 5 (45000): Unknown table 'xx'
mysql&gt; <strong class="userinput"><code>SHOW ERRORS;</code></strong>
+-------+------+----------------------------------+
| Level | Code | Message                          |
+-------+------+----------------------------------+
| Error | 1051 | Unknown table 'xx'               |
| Error |    5 | Unknown table 'xx'               |
+-------+------+----------------------------------+
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="resignal-handler"></a>13.6.7.4.4 RESIGNAL Requires Condition Handler Context</h5>

</div>

</div>

</div>
<p>
          All forms of <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> require
          that the current context be a condition handler. Otherwise,
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> is illegal and a
          <code class="literal">RESIGNAL when handler not active</code> error
          occurs. For example:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE p () RESIGNAL;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CALL p();</code></strong>
ERROR 1645 (0K000): RESIGNAL when handler not active
</pre><p>
          Here is a more difficult example:
        </p><pre class="programlisting">
delimiter //
CREATE FUNCTION f () RETURNS INT
BEGIN
  RESIGNAL;
  RETURN 5;
END//
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION SET @a=f();
  SIGNAL SQLSTATE '55555';
END//
delimiter ;
CALL p();
</pre><p>
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> occurs within the
          stored function <code class="literal">f()</code>. Although
          <code class="literal">f()</code> itself is invoked within the context of
          the <code class="literal">EXIT</code> handler, execution within
          <code class="literal">f()</code> has its own context, which is not
          handler context. Thus, <code class="literal">RESIGNAL</code> within
          <code class="literal">f()</code> results in a <span class="quote">“<span class="quote">handler not
          active</span>”</span> error.
        </p><p>
          In MySQL 5.5, handler scope rules are less developed.
          <code class="literal">f()</code> is considered to execute within handler
          context and <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> within
          <code class="literal">f()</code> is legal.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="signal"></a>13.6.7.5 SIGNAL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144715744"></a><pre class="programlisting">
SIGNAL <em class="replaceable"><code>condition_value</code></em>
    [SET <em class="replaceable"><code>signal_information_item</code></em>
    [, <em class="replaceable"><code>signal_information_item</code></em>] ...]

<em class="replaceable"><code>condition_value</code></em>:
    SQLSTATE [VALUE] <em class="replaceable"><code>sqlstate_value</code></em>
  | <em class="replaceable"><code>condition_name</code></em>

<em class="replaceable"><code>signal_information_item</code></em>:
    <em class="replaceable"><code>condition_information_item_name</code></em> = <em class="replaceable"><code>simple_value_specification</code></em>

<em class="replaceable"><code>condition_information_item_name</code></em>:
    CLASS_ORIGIN
  | SUBCLASS_ORIGIN
  | MESSAGE_TEXT
  | MYSQL_ERRNO
  | CONSTRAINT_CATALOG
  | CONSTRAINT_SCHEMA
  | CONSTRAINT_NAME
  | CATALOG_NAME
  | SCHEMA_NAME
  | TABLE_NAME
  | COLUMN_NAME
  | CURSOR_NAME

<em class="replaceable"><code>condition_name</code></em>, <em class="replaceable"><code>simple_value_specification</code></em>:
    (see following discussion)
</pre><p>
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is the way to
        <span class="quote">“<span class="quote">return</span>”</span> an error.
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> provides error information
        to a handler, to an outer portion of the application, or to the
        client. Also, it provides control over the error's
        characteristics (error number, <code class="literal">SQLSTATE</code>
        value, message). Without <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>,
        it is necessary to resort to workarounds such as deliberately
        referring to a nonexistent table to cause a routine to return an
        error.
      </p><p>
        No special privileges are required to execute the
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement.
      </p><p>
        To retrieve information from the diagnostics area, use the
        <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
        <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
        diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
      </p><p>
        The <em class="replaceable"><code>condition_value</code></em> in a
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement indicates the
        error value to be returned. It can be an
        <code class="literal">SQLSTATE</code> value (a 5-character string literal)
        or a <em class="replaceable"><code>condition_name</code></em> that refers to a
        named condition previously defined with
        <a class="link" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax"><code class="literal">DECLARE ...
        CONDITION</code></a> (see <a class="xref" href="sql-syntax.html#declare-condition" title="13.6.7.1 DECLARE ... CONDITION Syntax">Section 13.6.7.1, “DECLARE ... CONDITION Syntax”</a>).
      </p><p>
        An <code class="literal">SQLSTATE</code> value can indicate errors,
        warnings, or <span class="quote">“<span class="quote">not found.</span>”</span> The first two characters
        of the value indicate its error class, as discussed in
        <a class="xref" href="sql-syntax.html#signal-condition-information-items" title="13.6.7.5.1 Signal Condition Information Items">Section 13.6.7.5.1, “Signal Condition Information Items”</a>. Some
        signal values cause statement termination; see
        <a class="xref" href="sql-syntax.html#signal-effects" title="13.6.7.5.2 Effect of Signals on Handlers, Cursors, and Statements">Section 13.6.7.5.2, “Effect of Signals on Handlers, Cursors, and Statements”</a>.
      </p><p>
        The <code class="literal">SQLSTATE</code> value for a
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement should not start
        with <code class="literal">'00'</code> because such values indicate
        success and are not valid for signaling an error. This is true
        whether the <code class="literal">SQLSTATE</code> value is specified
        directly in the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement
        or in a named condition referred to in the statement. If the
        value is invalid, a <code class="literal">Bad SQLSTATE</code> error
        occurs.
      </p><p>
        To signal a generic <code class="literal">SQLSTATE</code> value, use
        <code class="literal">'45000'</code>, which means <span class="quote">“<span class="quote">unhandled
        user-defined exception.</span>”</span>
      </p><p>
        The <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement optionally
        includes a <code class="literal">SET</code> clause that contains multiple
        signal items, in a comma-separated list of
        <em class="replaceable"><code>condition_information_item_name</code></em> =
        <em class="replaceable"><code>simple_value_specification</code></em>
        assignments.
      </p><p>
        Each <em class="replaceable"><code>condition_information_item_name</code></em>
        may be specified only once in the <code class="literal">SET</code> clause.
        Otherwise, a <code class="literal">Duplicate condition information
        item</code> error occurs.
      </p><p>
        Valid <em class="replaceable"><code>simple_value_specification</code></em>
        designators can be specified using stored procedure or function
        parameters, stored program local variables declared with
        <a class="link" href="sql-syntax.html#declare" title="13.6.3 DECLARE Syntax"><code class="literal">DECLARE</code></a>, user-defined variables,
        system variables, or literals. A character literal may include a
        <em class="replaceable"><code>_charset</code></em> introducer.
      </p><p>
        For information about permissible
        <em class="replaceable"><code>condition_information_item_name</code></em>
        values, see
        <a class="xref" href="sql-syntax.html#signal-condition-information-items" title="13.6.7.5.1 Signal Condition Information Items">Section 13.6.7.5.1, “Signal Condition Information Items”</a>.
      </p><p>
        The following procedure signals an error or warning depending on
        the value of <code class="literal">pval</code>, its input parameter:
      </p><pre class="programlisting">
CREATE PROCEDURE p (pval INT)
BEGIN
  DECLARE specialty CONDITION FOR SQLSTATE '45000';
  IF pval = 0 THEN
    SIGNAL SQLSTATE '01000';
  ELSEIF pval = 1 THEN
    SIGNAL SQLSTATE '45000'
      SET MESSAGE_TEXT = 'An error occurred';
  ELSEIF pval = 2 THEN
    SIGNAL specialty
      SET MESSAGE_TEXT = 'An error occurred';
  ELSE
    SIGNAL SQLSTATE '01000'
      SET MESSAGE_TEXT = 'A warning occurred', MYSQL_ERRNO = 1000;
    SIGNAL SQLSTATE '45000'
      SET MESSAGE_TEXT = 'An error occurred', MYSQL_ERRNO = 1001;
  END IF;
END;
</pre><p>
        If <code class="literal">pval</code> is 0, <code class="literal">p()</code> signals
        a warning because <code class="literal">SQLSTATE</code> values that begin
        with <code class="literal">'01'</code> are signals in the warning class.
        The warning does not terminate the procedure, and can be seen
        with <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> after the
        procedure returns.
      </p><p>
        If <code class="literal">pval</code> is 1, <code class="literal">p()</code> signals
        an error and sets the <code class="literal">MESSAGE_TEXT</code> condition
        information item. The error terminates the procedure, and the
        text is returned with the error information.
      </p><p>
        If <code class="literal">pval</code> is 2, the same error is signaled,
        although the <code class="literal">SQLSTATE</code> value is specified
        using a named condition in this case.
      </p><p>
        If <code class="literal">pval</code> is anything else,
        <code class="literal">p()</code> first signals a warning and sets the
        message text and error number condition information items. This
        warning does not terminate the procedure, so execution continues
        and <code class="literal">p()</code> then signals an error. The error does
        terminate the procedure. The message text and error number set
        by the warning are replaced by the values set by the error,
        which are returned with the error information.
      </p><p>
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is typically used within
        stored programs, but it is a MySQL extension that it is
        permitted outside handler context. For example, if you invoke
        the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client program, you can enter any
        of these statements at the prompt:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SIGNAL SQLSTATE '77777';</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TRIGGER t_bi BEFORE INSERT ON t</code></strong>
    -&gt; <strong class="userinput"><code>FOR EACH ROW SIGNAL SQLSTATE '77777';</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE EVENT e ON SCHEDULE EVERY 1 SECOND</code></strong>
    -&gt; <strong class="userinput"><code>DO SIGNAL SQLSTATE '77777';</code></strong>
</pre><p>
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> executes according to the
        following rules:
      </p><p>
        If the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement indicates
        a particular <code class="literal">SQLSTATE</code> value, that value is
        used to signal the condition specified. Example:
      </p><pre class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  IF divisor = 0 THEN
    SIGNAL SQLSTATE '22012';
  END IF;
END;
</pre><p>
        If the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement uses a
        named condition, the condition must be declared in some scope
        that applies to the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
        statement, and must be defined using an
        <code class="literal">SQLSTATE</code> value, not a MySQL error number.
        Example:
      </p><pre class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  DECLARE divide_by_zero CONDITION FOR SQLSTATE '22012';
  IF divisor = 0 THEN
    SIGNAL divide_by_zero;
  END IF;
END;
</pre><p>
        If the named condition does not exist in the scope of the
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement, an
        <code class="literal">Undefined CONDITION</code> error occurs.
      </p><p>
        If <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> refers to a named
        condition that is defined with a MySQL error number rather than
        an <code class="literal">SQLSTATE</code> value, a <code class="literal">SIGNAL/RESIGNAL
        can only use a CONDITION defined with SQLSTATE</code> error
        occurs. The following statements cause that error because the
        named condition is associated with a MySQL error number:
      </p><pre class="programlisting">
DECLARE no_such_table CONDITION FOR 1051;
SIGNAL no_such_table;
</pre><p>
        If a condition with a given name is declared multiple times in
        different scopes, the declaration with the most local scope
        applies. Consider the following procedure:
      </p><pre class="programlisting">
CREATE PROCEDURE p (divisor INT)
BEGIN
  DECLARE my_error CONDITION FOR SQLSTATE '45000';
  IF divisor = 0 THEN
    BEGIN
      DECLARE my_error CONDITION FOR SQLSTATE '22012';
      SIGNAL my_error;
    END;
  END IF;
  SIGNAL my_error;
END;
</pre><p>
        If <code class="literal">divisor</code> is 0, the first
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement executes. The
        innermost <code class="literal">my_error</code> condition declaration
        applies, raising <code class="literal">SQLSTATE</code>
        <code class="literal">'22012'</code>.
      </p><p>
        If <code class="literal">divisor</code> is not 0, the second
        <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement executes. The
        outermost <code class="literal">my_error</code> condition declaration
        applies, raising <code class="literal">SQLSTATE</code>
        <code class="literal">'45000'</code>.
      </p><p>
        For information about how the server chooses handlers when a
        condition occurs, see <a class="xref" href="sql-syntax.html#handler-scope" title="13.6.7.6 Scope Rules for Handlers">Section 13.6.7.6, “Scope Rules for Handlers”</a>.
      </p><p>
        Signals can be raised within exception handlers:
      </p><pre class="programlisting">
CREATE PROCEDURE p ()
BEGIN
  DECLARE EXIT HANDLER FOR SQLEXCEPTION
  BEGIN
    SIGNAL SQLSTATE VALUE '99999'
      SET MESSAGE_TEXT = 'An error occurred';
  END;
  DROP TABLE no_such_table;
END;
</pre><p>
        <code class="literal">CALL p()</code> reaches the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement. There is no
        table named <code class="literal">no_such_table</code>, so the error
        handler is activated. The error handler destroys the original
        error (<span class="quote">“<span class="quote">no such table</span>”</span>) and makes a new error with
        <code class="literal">SQLSTATE</code> <code class="literal">'99999'</code> and
        message <code class="literal">An error occurred</code>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="signal-condition-information-items"></a>13.6.7.5.1 Signal Condition Information Items</h5>
</div>
</div>
</div>
<p>
          The following table lists the names of diagnostics area
          condition information items that can be set in a
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> (or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>) statement. All items
          are standard SQL except <code class="literal">MYSQL_ERRNO</code>, which
          is a MySQL extension. For more information about these items
          see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
        </p><pre class="programlisting">
Item Name             Definition
---------             ----------
CLASS_ORIGIN          VARCHAR(64)
SUBCLASS_ORIGIN       VARCHAR(64)
CONSTRAINT_CATALOG    VARCHAR(64)
CONSTRAINT_SCHEMA     VARCHAR(64)
CONSTRAINT_NAME       VARCHAR(64)
CATALOG_NAME          VARCHAR(64)
SCHEMA_NAME           VARCHAR(64)
TABLE_NAME            VARCHAR(64)
COLUMN_NAME           VARCHAR(64)
CURSOR_NAME           VARCHAR(64)
MESSAGE_TEXT          VARCHAR(128)
MYSQL_ERRNO           SMALLINT UNSIGNED
</pre><p>
          The character set for character items is UTF-8.
        </p><p>
          It is illegal to assign <code class="literal">NULL</code> to a condition
          information item in a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
          statement.
        </p><p>
          A <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement always
          specifies an <code class="literal">SQLSTATE</code> value, either
          directly, or indirectly by referring to a named condition
          defined with an <code class="literal">SQLSTATE</code> value. The first
          two characters of an <code class="literal">SQLSTATE</code> value are its
          class, and the class determines the default value for the
          condition information items:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Class = <code class="literal">'00'</code> (success)
            </p><p>
              Illegal. <code class="literal">SQLSTATE</code> values that begin
              with <code class="literal">'00'</code> indicate success and are not
              valid for <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'01'</code> (warning)
            </p><pre class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined warning condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_warn"><code class="literal">ER_SIGNAL_WARN</code></a>
</pre></li><li class="listitem"><p>
              Class = <code class="literal">'02'</code> (not found)
            </p><pre class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined not found condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_not_found"><code class="literal">ER_SIGNAL_NOT_FOUND</code></a>
</pre></li><li class="listitem"><p>
              Class &gt; <code class="literal">'02'</code> (exception)
            </p><pre class="programlisting">
MESSAGE_TEXT = 'Unhandled user-defined exception condition';
MYSQL_ERRNO = <a class="link" href="error-handling.html#error_er_signal_exception"><code class="literal">ER_SIGNAL_EXCEPTION</code></a>
</pre></li></ul>
</div>
<p>
          For legal classes, the other condition information items are
          set as follows:
        </p><pre class="programlisting">
CLASS_ORIGIN = SUBCLASS_ORIGIN = '';
CONSTRAINT_CATALOG = CONSTRAINT_SCHEMA = CONSTRAINT_NAME = '';
CATALOG_NAME = SCHEMA_NAME = TABLE_NAME = COLUMN_NAME = '';
CURSOR_NAME = '';
</pre><p>
          The error values that are accessible after
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> executes are the
          <code class="literal">SQLSTATE</code> value raised by the
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement and the
          <code class="literal">MESSAGE_TEXT</code> and
          <code class="literal">MYSQL_ERRNO</code> items. These values are
          available from the C API:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">SQLSTATE</code> value: Call
              <a class="link" href="connectors-apis.html#mysql-sqlstate" title="23.8.7.67 mysql_sqlstate()"><code class="literal">mysql_sqlstate()</code></a>
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code> value: Call
              <a class="link" href="connectors-apis.html#mysql-errno" title="23.8.7.14 mysql_errno()"><code class="literal">mysql_errno()</code></a>
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code> value: Call
              <a class="link" href="connectors-apis.html#mysql-error" title="23.8.7.15 mysql_error()"><code class="literal">mysql_error()</code></a>
</p></li></ul>
</div>
<p>
          From SQL, the output from <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> and <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW
          ERRORS</code></a> indicates the <code class="literal">MYSQL_ERRNO</code>
          and <code class="literal">MESSAGE_TEXT</code> values in the
          <code class="literal">Code</code> and <code class="literal">Message</code>
          columns.
        </p><p>
          To retrieve information from the diagnostics area, use the
          <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement (see
          <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>). For information about the
          diagnostics area, see <a class="xref" href="sql-syntax.html#diagnostics-area" title="13.6.7.7 The MySQL Diagnostics Area">Section 13.6.7.7, “The MySQL Diagnostics Area”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="signal-effects"></a>13.6.7.5.2 Effect of Signals on Handlers, Cursors, and Statements</h5>

</div>

</div>

</div>
<p>
          Signals have different effects on statement execution
          depending on the signal class. The class determines how severe
          an error is. MySQL ignores the value of the
          <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> system variable; in
          particular, strict SQL mode does not matter. MySQL also
          ignores <code class="literal">IGNORE</code>: The intent of
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> is to raise a
          user-generated error explicitly, so a signal is never ignored.
        </p><p>
          In the following descriptions, <span class="quote">“<span class="quote">unhandled</span>”</span> means
          that no handler for the signaled <code class="literal">SQLSTATE</code>
          value has been defined with
          <a class="link" href="sql-syntax.html#declare-handler" title="13.6.7.2 DECLARE ... HANDLER Syntax"><code class="literal">DECLARE ...
          HANDLER</code></a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Class = <code class="literal">'00'</code> (success)
            </p><p>
              Illegal. <code class="literal">SQLSTATE</code> values that begin
              with <code class="literal">'00'</code> indicate success and are not
              valid for <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'01'</code> (warning)
            </p><p>
              The value of the
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> system
              variable goes up. <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
              WARNINGS</code></a> shows the signal.
              <code class="literal">SQLWARNING</code> handlers catch the signal.
              If the signal is unhandled in a function, statements do
              not end.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'02'</code> (not found)
            </p><p>
              <code class="literal">NOT FOUND</code> handlers catch the signal.
              There is no effect on cursors. If the signal is unhandled
              in a function, statements end.
            </p></li><li class="listitem"><p>
              Class &gt; <code class="literal">'02'</code> (exception)
            </p><p>
              <code class="literal">SQLEXCEPTION</code> handlers catch the signal.
              If the signal is unhandled in a function, statements end.
            </p></li><li class="listitem"><p>
              Class = <code class="literal">'40'</code>
            </p><p>
              Treated as an ordinary exception.
</p></li></ul>
</div>
<p>
          Example:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>delimiter //</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE FUNCTION f () RETURNS INT</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>SIGNAL SQLSTATE '01234';  -- signal a warning</code></strong>
    -&gt;   <strong class="userinput"><code>RETURN 5;</code></strong>
    -&gt; <strong class="userinput"><code>END//</code></strong>
mysql&gt; <strong class="userinput"><code>delimiter ;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE TABLE t (s1 INT);</code></strong>
mysql&gt; <strong class="userinput"><code>INSERT INTO t VALUES (f());</code></strong>
</pre><p>
          The result is that a row containing 5 is inserted into table
          <code class="literal">t</code>. The warning that is signaled can be
          viewed with <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="handler-scope"></a>13.6.7.6 Scope Rules for Handlers</h4>

</div>

</div>

</div>
<p>
        A stored program may include handlers to be invoked when certain
        conditions occur within the program. The applicability of each
        handler depends on its location within the program definition
        and on the condition or conditions that it handles:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A handler declared in a
            <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
            END</code></a> block is in scope only for the SQL statements
            following the handler declarations in the block. If the
            handler itself raises a condition, it cannot handle that
            condition, nor can any other handlers declared in the block.
            In the following example, handlers <code class="literal">H1</code> and
            <code class="literal">H2</code> are in scope for conditions raised by
            statements <em class="replaceable"><code>stmt1</code></em> and
            <em class="replaceable"><code>stmt2</code></em>. But neither
            <code class="literal">H1</code> nor <code class="literal">H2</code> are in scope
            for conditions raised in the body of <code class="literal">H1</code>
            or <code class="literal">H2</code>.
          </p><pre class="programlisting">
BEGIN -- outer block
  DECLARE EXIT HANDLER FOR ...;  -- handler H1
  DECLARE EXIT HANDLER FOR ...;  -- handler H2
  <em class="replaceable"><code>stmt1</code></em>;
  <em class="replaceable"><code>stmt2</code></em>;
END;
</pre></li><li class="listitem"><p>
            A handler is in scope only for the block in which it is
            declared, and cannot be activated for conditions occurring
            outside that block. In the following example, handler
            <code class="literal">H1</code> is in scope for
            <em class="replaceable"><code>stmt1</code></em> in the inner block, but not
            for <em class="replaceable"><code>stmt2</code></em> in the outer block:
          </p><pre class="programlisting">
BEGIN -- outer block
  BEGIN -- inner block
    DECLARE EXIT HANDLER FOR ...;  -- handler H1
    <em class="replaceable"><code>stmt1</code></em>;
  END;
  <em class="replaceable"><code>stmt2</code></em>;
END;
</pre></li><li class="listitem"><p>
            A handler can be specific or general. A specific handler is
            for a MySQL error code, <code class="literal">SQLSTATE</code> value,
            or condition name. A general handler is for a condition in
            the <code class="literal">SQLWARNING</code>,
            <code class="literal">SQLEXCEPTION</code>, or <code class="literal">NOT
            FOUND</code> class. Condition specificity is related to
            condition precedence, as described later.
</p></li></ul>
</div>
<p>
        Multiple handlers can be declared in different scopes and with
        different specificities. For example, there might be a specific
        MySQL error code handler in an outer block, and a general
        <code class="literal">SQLWARNING</code> handler in an inner block. Or
        there might be handlers for a specific MySQL error code and the
        general <code class="literal">SQLWARNING</code> class in the same block.
      </p><p>
        Whether a handler is activated depends not only on its own scope
        and condition value, but on what other handlers are present.
        When a condition occurs in a stored program, the server searches
        for applicable handlers in the current scope (current
        <a class="link" href="sql-syntax.html#begin-end" title="13.6.1 BEGIN ... END Compound-Statement Syntax"><code class="literal">BEGIN ...
        END</code></a> block). If there are no applicable handlers, the
        search continues outward with the handlers in each successive
        containing scope (block). When the server finds one or more
        applicable handlers at a given scope, it chooses among them
        based on condition precedence:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            A MySQL error code handler takes precedence over an
            <code class="literal">SQLSTATE</code> value handler.
          </p></li><li class="listitem"><p>
            An <code class="literal">SQLSTATE</code> value handler takes
            precedence over general <code class="literal">SQLWARNING</code>,
            <code class="literal">SQLEXCEPTION</code>, or <code class="literal">NOT
            FOUND</code> handlers.
          </p></li><li class="listitem"><p>
            An <code class="literal">SQLEXCEPTION</code> handler takes precedence
            over an <code class="literal">SQLWARNING</code> handler.
          </p></li><li class="listitem"><p>
            The precedence of <code class="literal">NOT FOUND</code> depends on
            how the condition is raised:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                Normally, a condition in the <code class="literal">NOT
                FOUND</code> class can be handled by an
                <code class="literal">SQLWARNING</code> or <code class="literal">NOT
                FOUND</code> handler, with the
                <code class="literal">SQLWARNING</code> handler taking precedence
                if both are present. Normal occurrence of <code class="literal">NOT
                FOUND</code> takes place when a cursor used to fetch
                a set of rows reaches the end of the data set, or for
                instances of <code class="literal">SELECT ... INTO
                <em class="replaceable"><code>var_list</code></em></code> such that
                the <code class="literal">WHERE</code> clause finds no rows.
              </p></li><li class="listitem"><p>
                If a <code class="literal">NOT FOUND</code> condition is raised by
                a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> (or
                <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>) statement, the
                condition can be handled by a <code class="literal">NOT
                FOUND</code> handler but not an
                <code class="literal">SQLWARNING</code> handler.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            It is possible to have several applicable handlers with the
            same precedence. For example, a statement could generate
            multiple warnings with different error codes, for each of
            which an error-specific handler exists. In this case, the
            choice of which handler the server activates is
            indeterminate, and may change depending on the circumstances
            under which the condition occurs.
</p></li></ul>
</div>
<p>
        One implication of the handler selection rules is that if
        multiple applicable handlers occur in different scopes, handlers
        with the most local scope take precedence over handlers in outer
        scopes, even over those for more specific conditions.
      </p><p>
        If there is no appropriate handler when a condition occurs, the
        action taken depends on the class of the condition:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            For <code class="literal">SQLEXCEPTION</code> conditions, the stored
            program terminates at the statement that raised the
            condition, as if there were an <code class="literal">EXIT</code>
            handler. If the program was called by another stored
            program, the calling program handles the condition using the
            handler selection rules applied to its own handlers.
          </p></li><li class="listitem"><p>
            For <code class="literal">SQLWARNING</code> conditions, the program
            continues executing, as if there were a
            <code class="literal">CONTINUE</code> handler.
          </p></li><li class="listitem"><p>
            For <code class="literal">NOT FOUND</code> conditions, if the
            condition was raised normally, the action is
            <code class="literal">CONTINUE</code>. If it was raised by
            <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
            <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>, the action is
            <code class="literal">EXIT</code>.
</p></li></ul>
</div>
<p>
        The following examples demonstrate how MySQL applies the handler
        selection rules.
      </p><p>
        This procedure contains two handlers, one for the specific
        <code class="literal">SQLSTATE</code> value (<code class="literal">'42S02'</code>)
        that occurs for attempts to drop a nonexistent table, and one
        for the general <code class="literal">SQLEXCEPTION</code> class:
      </p><pre class="programlisting">
CREATE PROCEDURE p1()
BEGIN
  DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
    SELECT 'SQLSTATE handler was activated' AS msg;
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    SELECT 'SQLEXCEPTION handler was activated' AS msg;

  DROP TABLE test.t;
END;
</pre><p>
        Both handlers are declared in the same block and have the same
        scope. However, <code class="literal">SQLSTATE</code> handlers take
        precedence over <code class="literal">SQLEXCEPTION</code> handlers, so if
        the table <code class="literal">t</code> is nonexistent, the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement raises a
        condition that activates the <code class="literal">SQLSTATE</code>
        handler:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p1();</code></strong>
+--------------------------------+
| msg                            |
+--------------------------------+
| SQLSTATE handler was activated |
+--------------------------------+
</pre><p>
        This procedure contains the same two handlers. But this time,
        the <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement and
        <code class="literal">SQLEXCEPTION</code> handler are in an inner block
        relative to the <code class="literal">SQLSTATE</code> handler:
      </p><pre class="programlisting">
CREATE PROCEDURE p2()
BEGIN -- outer block
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
      SELECT 'SQLEXCEPTION handler was activated' AS msg;

    DROP TABLE test.t; -- occurs within inner block
  END;
END;
</pre><p>
        In this case, the handler that is more local to where the
        condition occurs takes precedence. The
        <code class="literal">SQLEXCEPTION</code> handler activates, even though
        it is more general than the <code class="literal">SQLSTATE</code> handler:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p2();</code></strong>
+------------------------------------+
| msg                                |
+------------------------------------+
| SQLEXCEPTION handler was activated |
+------------------------------------+
</pre><p>
        In this procedure, one of the handlers is declared in a block
        inner to the scope of the <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP
        TABLE</code></a> statement:
      </p><pre class="programlisting">
CREATE PROCEDURE p3()
BEGIN -- outer block
  DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
    SELECT 'SQLEXCEPTION handler was activated' AS msg;
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  END;

  DROP TABLE test.t; -- occurs within outer block
END;
</pre><p>
        Only the <code class="literal">SQLEXCEPTION</code> handler applies because
        the other one is not in scope for the condition raised by the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p3();</code></strong>
+------------------------------------+
| msg                                |
+------------------------------------+
| SQLEXCEPTION handler was activated |
+------------------------------------+
</pre><p>
        In this procedure, both handlers are declared in a block inner
        to the scope of the <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>
        statement:
      </p><pre class="programlisting">
CREATE PROCEDURE p4()
BEGIN -- outer block
  BEGIN -- inner block
    DECLARE CONTINUE HANDLER FOR SQLEXCEPTION
      SELECT 'SQLEXCEPTION handler was activated' AS msg;
    DECLARE CONTINUE HANDLER FOR SQLSTATE '42S02'
      SELECT 'SQLSTATE handler was activated' AS msg;
  END;

  DROP TABLE test.t; -- occurs within outer block
END;
</pre><p>
        Neither handler applies because they are not in scope for the
        <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a>. The condition raised
        by the statement goes unhandled and terminates the procedure
        with an error:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CALL p4();</code></strong>
ERROR 1051 (42S02): Unknown table 'test.t'
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="diagnostics-area"></a>13.6.7.7 The MySQL Diagnostics Area</h4>

</div>

</div>

</div>
<p>
        SQL statements produce diagnostic information that populates the
        diagnostics area. Standard SQL has a diagnostics area stack,
        containing a diagnostics area for each nested execution context.
        Standard SQL also supports <code class="literal">GET STACKED
        DIAGNOSTICS</code> syntax for referring to the second
        diagnostics area during condition handler execution. MySQL does
        not support the <code class="literal">STACKED</code> keyword until MySQL
        5.7. In MySQL 5.6, there is a single diagnostics area containing
        information from the most recent statement that wrote to it.
      </p><p>
        This section describes the structure of the diagnostics area in
        MySQL, the information items recognized by MySQL and how
        statements clear and set the diagnostics area.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="diagnostics-area-structure"></a>13.6.7.7.1 Diagnostics Area Structure</h5>
</div>
</div>
</div>
<p>
          The diagnostics area contains two kinds of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Statement information, such as the number of conditions
              that occurred or the affected-rows count.
            </p></li><li class="listitem"><p>
              Condition information, such as the error code and message.
              If a statement raises multiple conditions, this part of
              the diagnostics area has a condition area for each one. If
              a statement raises no conditions, this part of the
              diagnostics area is empty.
</p></li></ul>
</div>
<p>
          For a statement that produces three conditions, the
          diagnostics area contains statement and condition information
          like this:
        </p><pre class="programlisting">
Statement information:
  row count
  ... other statement information items ...
Condition area list:
  Condition area 1:
    error code for condition 1
    error message for condition 1
    ... other condition information items ...
  Condition area 2:
    error code for condition 2:
    error message for condition 2
    ... other condition information items ...
  Condition area 3:
    error code for condition 3
    error message for condition 3
    ... other condition information items ...
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="diagnostics-area-information-items"></a>13.6.7.7.2 Diagnostics Area Information Items</h5>

</div>

</div>

</div>
<p>
          The diagnostics area contains statement and condition
          information items. Numeric items are integers. The character
          set for character items is UTF-8. No item can be
          <code class="literal">NULL</code>. If a statement or condition item is
          not set by a statement that populates the diagnostics area,
          its value will be 0 or the empty string, depending on the item
          data type.
        </p><p>
          The statement information part of the diagnostics area
          contains these items:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NUMBER</code>: An integer indicating the
              number of condition areas that have information.
            </p></li><li class="listitem"><p>
              <code class="literal">ROW_COUNT</code>: An integer indicating the
              number of rows affected by the statement.
              <code class="literal">ROW_COUNT</code> has the same value as the
              <a class="link" href="functions.html#function_row-count"><code class="literal">ROW_COUNT()</code></a> function (see
              <a class="xref" href="functions.html#information-functions" title="12.14 Information Functions">Section 12.14, “Information Functions”</a>).
</p></li></ul>
</div>
<p>
          The condition information part of the diagnostics area
          contains a condition area for each condition. Condition areas
          are numbered from 1 to the value of the
          <code class="literal">NUMBER</code> statement condition item. If
          <code class="literal">NUMBER</code> is 0, there are no condition areas.
        </p><p>
          Each condition area contains the items in the following list.
          All items are standard SQL except
          <code class="literal">MYSQL_ERRNO</code>, which is a MySQL extension.
          The definitions apply for conditions generated other than by a
          signal (that is, by a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statement). For
          nonsignal conditions, MySQL populates only those condition
          items not described as always empty. The effects of signals on
          the condition area are described later.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">CLASS_ORIGIN</code>: A string containing the
              class of the <code class="literal">RETURNED_SQLSTATE</code> value.
              If the <code class="literal">RETURNED_SQLSTATE</code> value begins
              with a class value defined in SQL standards document ISO
              9075-2 (section 24.1, SQLSTATE),
              <code class="literal">CLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code>. Otherwise,
              <code class="literal">CLASS_ORIGIN</code> is
              <code class="literal">'MySQL'</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">SUBCLASS_ORIGIN</code>: A string containing
              the subclass of the <code class="literal">RETURNED_SQLSTATE</code>
              value. If <code class="literal">CLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code> or <code class="literal">RETURNED_SQLSTATE</code>
              ends with <code class="literal">'000'</code>,
              <code class="literal">SUBCLASS_ORIGIN</code> is <code class="literal">'ISO
              9075'</code>. Otherwise,
              <code class="literal">SUBCLASS_ORIGIN</code> is
              <code class="literal">'MySQL'</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">RETURNED_SQLSTATE</code>: A string that
              indicates the <code class="literal">SQLSTATE</code> value for the
              condition.
            </p></li><li class="listitem"><p>
              <code class="literal">MESSAGE_TEXT</code>: A string that indicates
              the error message for the condition.
            </p></li><li class="listitem"><p>
              <code class="literal">MYSQL_ERRNO</code>: An integer that indicates
              the MySQL error code for the condition.
            </p></li><li class="listitem"><p>
              <code class="literal">CONSTRAINT_CATALOG</code>,
              <code class="literal">CONSTRAINT_SCHEMA</code>,
              <code class="literal">CONSTRAINT_NAME</code>: Strings that indicate
              the catalog, schema, and name for a violated constraint.
              They are always empty.
            </p></li><li class="listitem"><p>
              <code class="literal">CATALOG_NAME</code>,
              <code class="literal">SCHEMA_NAME</code>,
              <code class="literal">TABLE_NAME</code>,
              <code class="literal">COLUMN_NAME</code>: Strings that indicate the
              catalog, schema, table, and column related to the
              condition. They are always empty.
            </p></li><li class="listitem"><p>
              <code class="literal">CURSOR_NAME</code>: A string that indicates
              the cursor name. This is always empty.
</p></li></ul>
</div>
<p>
          For the <code class="literal">RETURNED_SQLSTATE</code>,
          <code class="literal">MESSAGE_TEXT</code>, and
          <code class="literal">MYSQL_ERRNO</code> values for particular errors,
          see <a class="xref" href="error-handling.html#error-messages-server" title="B.3 Server Error Codes and Messages">Section B.3, “Server Error Codes and Messages”</a>.
        </p><p>
          If a <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> (or
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a>) statement populates
          the diagnostics area, its <code class="literal">SET</code> clause can
          assign to any condition information item except
          <code class="literal">RETURNED_SQLSTATE</code> any value that is legal
          for the item data type. <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a>
          also sets the <code class="literal">RETURNED_SQLSTATE</code> value, but
          not directly in its <code class="literal">SET</code> clause. That value
          comes from the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> statement
          <code class="literal">SQLSTATE</code> argument.
        </p><p>
          <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> also sets statement
          information items. It sets <code class="literal">NUMBER</code> to 1, and
          <code class="literal">ROW_COUNT</code> to −1 for errors and 0
          otherwise.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="diagnostics-area-populating"></a>13.6.7.7.3 How the Diagnostics Area is Populated</h5>

</div>

</div>

</div>
<p>
          Most nondiagnostic SQL statements populate the diagnostics
          area automatically, and its contents can be set explicitly
          with the <a class="link" href="sql-syntax.html#signal" title="13.6.7.5 SIGNAL Syntax"><code class="literal">SIGNAL</code></a> and
          <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> statements. The
          diagnostics area can be examined with <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
          DIAGNOSTICS</code></a> to extract specific items, or with
          <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> or
          <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> to see conditions
          or errors.
        </p><p>
          SQL statements clear and set the diagnostics area as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              When the server starts executing a statement after parsing
              it, it clears the diagnostics area for nondiagnostic
              statements that use tables. Diagnostic statements do not
              clear the diagnostics area (<a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
              WARNINGS</code></a>, <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW
              ERRORS</code></a>, <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
              DIAGNOSTICS</code></a>).
            </p></li><li class="listitem"><p>
              If a statement raises a condition, the diagnostics area is
              cleared of conditions that belong to earlier statements.
              The exception is that conditions raised by
              <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> and
              <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> are added to the
              diagnostics area without clearing it.
</p></li></ul>
</div>
<p>
          Thus, even a statement that does not normally clear the
          diagnostics area when it begins executing clears it if the
          statement raises a condition.
        </p><p>
          The following example shows the effect of various statements
          on the diagnostics area, using <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
          WARNINGS</code></a> to display information about conditions
          stored there.
        </p><p>
          This <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> statement uses
          a table, so it clears the diagnostics area and populates it
          when the condition occurs:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected, 1 warning (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------+
| Level | Code | Message                            |
+-------+------+------------------------------------+
| Note  | 1051 | Unknown table 'test.no_such_table' |
+-------+------+------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          This
          <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
          statement does not use tables and does not generate warnings,
          so it leaves the diagnostics area unchanged:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @x = 1;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------+
| Level | Code | Message                            |
+-------+------+------------------------------------+
| Note  | 1051 | Unknown table 'test.no_such_table' |
+-------+------+------------------------------------+
1 row in set (0.00 sec)
</pre><p>
          This
          <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
          statement generates an error, so it clears and populates the
          diagnostics area:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET @x = @@x;</code></strong>
ERROR 1193 (HY000): Unknown system variable 'x'

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+-----------------------------+
| Level | Code | Message                     |
+-------+------+-----------------------------+
| Error | 1193 | Unknown system variable 'x' |
+-------+------+-----------------------------+
1 row in set (0.00 sec)
</pre><p>
          The previous
          <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
          statement produced a single condition, so 1 is the only valid
          condition number for <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
          DIAGNOSTICS</code></a> at this point. The following statement
          uses a condition number of 2, which produces a warning that is
          added to the diagnostics area without clearing it:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 2 @p = MESSAGE_TEXT;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------+
| Level | Code | Message                      |
+-------+------+------------------------------+
| Error | 1193 | Unknown system variable 'xx' |
| Error | 1753 | Invalid condition number     |
+-------+------+------------------------------+
2 rows in set (0.00 sec)
</pre><p>
          Now there are two conditions in the diagnostics area, so the
          same <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET DIAGNOSTICS</code></a> statement
          succeeds:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>GET DIAGNOSTICS CONDITION 2 @p = MESSAGE_TEXT;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @p;</code></strong>
+--------------------------+
| @p                       |
+--------------------------+
| Invalid condition number |
+--------------------------+
1 row in set (0.01 sec)
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="diagnostics-area-system-variables"></a>13.6.7.7.4 Diagnostics Area-Related System Variables</h5>

</div>

</div>

</div>
<p>
          Certain system variables control or are related to some
          aspects of the diagnostics area:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> controls
              the number of condition areas in the diagnostics area. If
              more conditions than this occur, MySQL silently discards
              information for the excess conditions. (Conditions added
              by <a class="link" href="sql-syntax.html#resignal" title="13.6.7.4 RESIGNAL Syntax"><code class="literal">RESIGNAL</code></a> are always
              added, with older conditions being discarded as necessary
              to make room.)
            </p></li><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> indicates
              the number of conditions that occurred. This includes
              errors, warnings, and notes. Normally,
              <code class="literal">NUMBER</code> and
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> are the
              same. However, as the number of conditions generated
              exceeds <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>,
              the value of
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> continues
              to rise whereas <code class="literal">NUMBER</code> remains capped
              at <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>
              because no additional conditions are stored in the
              diagnostics area.
            </p></li><li class="listitem"><p>
              <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> indicates the
              number of errors that occurred. This value includes
              <span class="quote">“<span class="quote">not found</span>”</span> and exception conditions, but
              excludes warnings and notes. Like
              <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>, its value
              can exceed
              <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>.
            </p></li><li class="listitem"><p>
              If the <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> system
              variable is set to 0, notes are not stored and do not
              increment <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>.
</p></li></ul>
</div>
<p>
          Example: If <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>
          is 10, the diagnostics area can contain a maximum of 10
          condition areas. Suppose that a statement raises 20
          conditions, 12 of which are errors. In that case, the
          diagnostics area contains the first 10 conditions,
          <code class="literal">NUMBER</code> is 10,
          <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> is 20, and
          <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> is 12.
        </p><p>
          Changes to the value of
          <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> have no
          effect until the next attempt to modify the diagnostics area.
          If the diagnostics area contains 10 condition areas and
          <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> is set to 5,
          that has no immediate effect on the size or content of the
          diagnostics area.
        </p><p>
          Before MySQL 5.6, statement information items are not
          available directly. <code class="literal">ROW_COUNT</code> can be
          obtained by calling the <code class="literal">ROW_COUNT()</code>
          function. <code class="literal">NUMBER</code> is approximated by the
          value of the <code class="literal">warning_count</code> system variable.
          However, whereas <code class="literal">NUMBER</code> is capped to the
          value of <code class="literal">max_error_count</code>,
          <code class="literal">warning_count</code> is not.
</p>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-server-administration"></a>13.7 Database Administration Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#account-management-sql">13.7.1 Account Management Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#table-maintenance-sql">13.7.2 Table Maintenance Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#plugin-sql">13.7.3 Plugin and User-Defined Function Statements</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-statement">13.7.4 SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show">13.7.5 SHOW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#other-administrative-sql">13.7.6 Other Administrative Statements</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="account-management-sql"></a>13.7.1 Account Management Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#alter-user">13.7.1.1 ALTER USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#create-user">13.7.1.2 CREATE USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-user">13.7.1.3 DROP USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#grant">13.7.1.4 GRANT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#rename-user">13.7.1.5 RENAME USER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#revoke">13.7.1.6 REVOKE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#set-password">13.7.1.7 SET PASSWORD Syntax</a></span></dt></dl>
</div>
<p>
      MySQL account information is stored in the tables of the
      <code class="literal">mysql</code> database. This database and the access
      control system are discussed extensively in
      <a class="xref" href="server-administration.html" title="Chapter 5 MySQL Server Administration">Chapter 5, <i>MySQL Server Administration</i></a>, which you should consult
      for additional details.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
        Some releases of MySQL introduce changes to the structure of the
        grant tables to add new privileges or features. To ensure that
        you can take advantage of any new capabilities, update your
        grant tables to have the current structure whenever you update
        to a new version of MySQL. See <a class="xref" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables">Section 4.4.7, “<span class="command"><strong>mysql_upgrade</strong></span> — Check and Upgrade MySQL Tables”</a>.
</p>
</div>
<p>
      When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
      variable is enabled, account-management statements require the
      <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, in addition to any
      other required privileges. This is because they modify tables in
      the <code class="literal">mysql</code> database.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="alter-user"></a>13.7.1.1 ALTER USER Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737144265584"></a><a class="indexterm" name="idm139737144264512"></a><a class="indexterm" name="idm139737144263024"></a><pre class="programlisting">
ALTER USER <em class="replaceable"><code>user_specification</code></em> [, <em class="replaceable"><code>user_specification</code></em>] ...

<em class="replaceable"><code>user_specification</code></em>:
    <em class="replaceable"><code>user</code></em> PASSWORD EXPIRE
</pre><p>
        The <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> statement modifies
        MySQL accounts. An error occurs if you try to modify a
        nonexistent account.
      </p><p>
        To use <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege
        or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for the
        <code class="literal">mysql</code> database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
          <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a> was added in MySQL
          5.6.6. However, in 5.6.6, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER
          USER</code></a> also sets the <code class="literal">Password</code>
          column to the empty string, so do not use this statement until
          5.6.7.
</p>
</div>
<p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. If you specify only the user
        name part of the account name, a host name part of
        <code class="literal">'%'</code> is used. It is also possible to specify
        <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER</code></a> or
        <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> to refer to the
        account associated with the current session.
      </p><p>
        For each account, <a class="link" href="sql-syntax.html#alter-user" title="13.7.1.1 ALTER USER Syntax"><code class="literal">ALTER USER</code></a>
        expires its password. For example:
      </p><pre class="programlisting">
ALTER USER 'jeffrey'@'localhost' PASSWORD EXPIRE;
</pre><p>
        Password expiration for an account affects the corresponding row
        of the <code class="literal">mysql.user</code> table: The server sets the
        <code class="literal">password_expired</code> column to
        <code class="literal">'Y'</code>.
      </p><p>
        A client session operates in restricted mode if the account
        password has been expired. In restricted mode, operations
        performed within the session result in an error until the user
        establishes a new account password:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT 1;</code></strong>
ERROR 1820 (HY000): You must SET PASSWORD before executing this statement

mysql&gt; <strong class="userinput"><code>SET PASSWORD = PASSWORD('<em class="replaceable"><code>new_password</code></em>');</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SELECT 1;</code></strong>
+---+
| 1 |
+---+
| 1 |
+---+
1 row in set (0.00 sec)
</pre><p>
        As of MySQL 5.6.8, this restricted mode of operation permits
        <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
        statements, which is useful if the account password has a
        hashing format that requires
        <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> to be set to a
        value different from its default before using
        <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>.
      </p><p>
        It is possible for an administrative user to reset the account
        password, but any existing sessions for the account remain
        restricted. A client using the account must disconnect and
        reconnect before statements can be executed successfully.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is possible to <span class="quote">“<span class="quote">reset</span>”</span> a password by setting
          it to its current value. As a matter of good policy, it is
          preferable to choose a different password.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-user"></a>13.7.1.2 CREATE USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144220592"></a><a class="indexterm" name="idm139737144219520"></a><a class="indexterm" name="idm139737144218032"></a><pre class="programlisting">
CREATE USER <em class="replaceable"><code>user_specification</code></em> [, <em class="replaceable"><code>user_specification</code></em>] ...

<em class="replaceable"><code>user_specification</code></em>:
    <em class="replaceable"><code>user</code></em> [ <em class="replaceable"><code>identified_option</code></em> ]

<em class="replaceable"><code>auth_option</code></em>: {
    IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>'
  | IDENTIFIED BY PASSWORD '<em class="replaceable"><code>hash_string</code></em>'
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em>
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> AS '<em class="replaceable"><code>hash_string</code></em>'
}
</pre><p>
        The <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> statement creates
        new MySQL accounts. An error occurs if you try to create an
        account that already exists.
      </p><p>
        To use <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege
        or the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql</code> database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        For each account, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>
        creates a new row in the <code class="literal">mysql.user</code> table
        with no privileges and assigns the account an authentication
        plugin. Depending on the syntax used,
        <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> may also assign the
        account a password.
      </p><p>
        Each <em class="replaceable"><code>user_specification</code></em> clause
        consists of an account name and information about how
        authentication occurs for clients that use the account. This
        part of <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> syntax is
        shared with <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>, so the
        description here applies to <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
        as well.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. For example:
      </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY 'mypass';
</pre><p>
        If you specify only the user name part of the account name, a
        host name part of <code class="literal">'%'</code> is used.
      </p><p>
        The server assigns an authentication plugin and password to each
        account as follows, depending on whether the user specification
        clause includes <code class="literal">IDENTIFIED WITH</code> to specify a
        plugin or <code class="literal">IDENTIFIED BY</code> to specify a
        password:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With <code class="literal">IDENTIFIED WITH</code>, the server assigns
            the specified plugin and the account has no password. If the
            optional <code class="literal">AS
            '<em class="replaceable"><code>hash_string</code></em>'</code> clause is
            also given, the string is stored as is in the
            <code class="literal">authentication_string</code> column (it is
            assumed to be already hashed in the format required by the
            plugin).
          </p></li><li class="listitem"><p>
            With <code class="literal">IDENTIFIED BY</code>, the server assigns
            the plugin implicitly and assigns the specified password.
          </p></li><li class="listitem"><p>
            With neither <code class="literal">IDENTIFIED WITH</code> nor
            <code class="literal">IDENTIFIED BY</code>, the server assigns the
            plugin implicitly and the account has no password.
</p></li></ul>
</div>
<p>
        If the account has no password, the <code class="literal">Password</code>
        column in the account's <code class="literal">mysql.user</code> table row
        remains empty, which is insecure. To set the password, use
        <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>. See
        <a class="xref" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax">Section 13.7.1.7, “SET PASSWORD Syntax”</a>.
      </p><p>
        For implicit authentication plugin assignment, the server uses
        these rules:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            As of MySQL 5.6.6, the server assigns the default plugin to
            the account. This plugin becomes the value of the
            <code class="literal">plugin</code> column in the account's
            <code class="literal">mysql.user</code> table row. The default plugin
            is <code class="literal">mysql_native_password</code> unless the
            <a class="link" href="server-administration.html#option_mysqld_default-authentication-plugin"><code class="option">--default-authentication-plugin</code></a>
            option is set otherwise at server startup.
          </p></li><li class="listitem"><p>
            Before MySQL 5.6.6, the server assigns no plugin to the
            account. The <code class="literal">plugin</code> column in the
            account's <code class="literal">mysql.user</code> table row remains
            empty.
</p></li></ul>
</div>
<p>
        For client connections that use a given account, the server
        invokes the authentication plugin assigned to the account and
        the client must provide credentials as required by the
        authentication method that the plugin implements. If the server
        cannot find the plugin, either at account-creation time or
        connect time, an error occurs.
      </p><p>
        If an account's <code class="literal">mysql.user</code> table row has a
        nonempty <code class="literal">plugin</code> column:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The server authenticates client connection attempts using
            the named plugin.
          </p></li><li class="listitem"><p>
            Changes to the account password using
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> with
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> must be made with
            the <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> system
            variable set to the value required by the authentication
            plugin, so that <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a>
            uses the appropriate password hashing method. If the plugin
            is <code class="literal">mysql_old_password</code>, the password can
            also be changed using <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET
            PASSWORD</code></a> with
            <a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a>, which uses
            pre-4.1 password hashing regardless of the value of
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a>.
</p></li></ul>
</div>
<p>
        If an account's <code class="literal">mysql.user</code> table row has an
        empty <code class="literal">plugin</code> column:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The server authenticates client connection attempts using
            the <code class="literal">mysql_native_password</code> or
            <code class="literal">mysql_old_password</code> authentication plugin,
            depending on the hash format of the password stored in the
            <code class="literal">Password</code> column.
          </p></li><li class="listitem"><p>
            Changes to the account password using
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> can be made with
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a>, with
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> set to 0 or 1
            for 4.1 or pre-4.1 password hashing, respectively, or with
            <a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a>, which uses
            pre-4.1 password hashing regardless of the value of
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a>.
</p></li></ul>
</div>
<p>
        <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> examples:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            To specify an authentication plugin for an account, use
            <code class="literal">IDENTIFIED WITH
            <em class="replaceable"><code>auth_plugin</code></em></code>. The plugin
            name can be a quoted string literal or an unquoted name.
            <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
            is an optional quoted string literal to pass to the plugin.
            The plugin interprets the meaning of the string, so its
            format is plugin specific and it is stored in the
            <code class="literal">authentication_string</code> column as given.
            (This value is meaningful only for plugins that use that
            column.) Consult the documentation for a given plugin for
            information about the authentication string values it
            accepts, if any.
          </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED WITH mysql_native_password;
</pre><p>
            The server assigns the given authentication plugin to the
            account but no password. Clients must provide no password
            when they connect. However, an account with no password is
            insecure. To ensure that an account uses a specific
            authentication plugin and has a password with the
            corresponding hash format, specify the plugin explicitly
            with <code class="literal">IDENTIFIED WITH</code>, then use
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> to set the
            password:
          </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED WITH mysql_native_password;
SET old_passwords = 0;
SET PASSWORD FOR 'jeffrey'@'localhost' = PASSWORD('mypass');
</pre><p>
            Changes to the account password using
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> with
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> must be made with
            the <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> system
            variable set to the value required by the account's
            authentication plugin, so that
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> uses the
            appropriate password hashing method. Therefore, to use the
            <code class="literal">sha256_password</code> or
            <code class="literal">mysql_old_password</code> plugin instead, name
            that plugin in the <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE
            USER</code></a> statement and set
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> to 2 or 1,
            respectively, before using <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET
            PASSWORD</code></a>. (Use of
            <code class="literal">mysql_old_password</code> is not recommended. It
            is deprecated and support for it will be removed in a future
            MySQL release.)
          </p></li><li class="listitem"><p>
            To specify a password for an account at account-creation
            time, use <code class="literal">IDENTIFIED BY</code> with the literal
            cleartext password value:
          </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY 'mypass';
</pre><p>
            The server assigns an authentication plugin to the account
            implicitly, as described previously, and assigns the given
            password. Clients must provide the given password when they
            connect.
          </p><p>
            If the implicitly assigned plugin is
            <code class="literal">mysql_native_password</code>, the
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> system
            variable must be set to 0. Otherwise,
            <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> does not hash the
            password in the format required by the plugin and an error
            occurs:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET old_passwords = 1;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY 'mypass';</code></strong>
ERROR 1827 (HY000): The password hash doesn't have the expected
format. Check if the correct password algorithm is being used with
the PASSWORD() function.

mysql&gt; <strong class="userinput"><code>SET old_passwords = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY 'mypass';</code></strong>
Query OK, 0 rows affected (0.00 sec)
</pre></li><li class="listitem"><p>
            To avoid specifying the cleartext password if you know its
            hash value (the value that
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> would return for
            the password), specify the hash value preceded by the
            keyword <code class="literal">PASSWORD</code>:
          </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost'
IDENTIFIED BY PASSWORD '*90E462C37378CED12064BB3388827D2BA3A9B689';
</pre><p>
            The server assigns an authentication plugin to the account
            implicitly, as described previously, and assigns the given
            password. The password hash must be in the format required
            by the assigned plugin. Clients must provide the password
            when they connect.
          </p></li><li class="listitem"><p>
            To enable the user to connect with no password, include no
            <code class="literal">IDENTIFIED BY</code> clause:
          </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost';
</pre><p>
            The server assigns an authentication plugin to the account
            implicitly, as described previously, but no password.
            Clients must provide no password when they connect. However,
            an account with no password is insecure. To avoid this, use
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> to set the
            account password.
</p></li></ul>
</div>
<p>
        As mentioned previously, implicit plugin assignment depends on
        the default authentication plugin. Permitted values of
        <a class="link" href="server-administration.html#option_mysqld_default-authentication-plugin"><code class="option">--default-authentication-plugin</code></a>
        are <code class="literal">mysql_native_plugin</code> and
        <code class="literal">sha256_password</code>, but not
        <code class="literal">mysql_old_password</code>. This means it is not
        possible to set the default plugin so as to be able to create an
        account that uses <code class="literal">mysql_old_password</code> with
        <code class="literal">CREATE USER ... IDENTIFIED BY</code> syntax. To
        create an account that uses
        <code class="literal">mysql_old_password</code>, use <code class="literal">CREATE USER
        ... IDENTIFIED WITH</code> to name the plugin explicitly,
        then set the password:

</p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED WITH mysql_old_password;
SET old_passwords = 1;
SET PASSWORD FOR 'jeffrey'@'localhost' = PASSWORD('mypass');
</pre><p>
      </p><p>
        However, the preceding procedure is not recommended because
        <code class="literal">mysql_old_password</code> is deprecated.
      </p><p>
        For additional information about setting passwords and
        authentication plugins, see
        <a class="xref" href="security.html#assigning-passwords" title="6.3.5 Assigning Account Passwords">Section 6.3.5, “Assigning Account Passwords”</a>, and
        <a class="xref" href="security.html#pluggable-authentication" title="6.3.7 Pluggable Authentication">Section 6.3.7, “Pluggable Authentication”</a>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE
          USER</code></a> may be recorded in server logs or on the client
          side in a history file such as
          <code class="filename">~/.mysql_history</code>, which means that
          cleartext passwords may be read by anyone having read access
          to that information. For information about the conditions
          under which this occurs for the server logs and how to control
          it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For similar
          information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Logging">Section 4.5.1.3, “mysql Logging”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-user"></a>13.7.1.3 DROP USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144079504"></a><a class="indexterm" name="idm139737144078432"></a><a class="indexterm" name="idm139737144076944"></a><a class="indexterm" name="idm139737144075456"></a><a class="indexterm" name="idm139737144073968"></a><a class="indexterm" name="idm139737144072480"></a><a class="indexterm" name="idm139737144070992"></a><a class="indexterm" name="idm139737144069504"></a><a class="indexterm" name="idm139737144068016"></a><pre class="programlisting">
DROP USER <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a> statement removes
        one or more MySQL accounts and their privileges. It removes
        privilege rows for the account from all grant tables. An error
        occurs for accounts that do not exist.
      </p><p>
        To use <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege
        or the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql</code> database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. For example:
      </p><pre class="programlisting">
DROP USER 'jeffrey'@'localhost';
</pre><p>
        If you specify only the user name part of the account name, a
        host name part of <code class="literal">'%'</code> is used.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a> does not
          automatically close any open user sessions. Rather, in the
          event that a user with an open session is dropped, the
          statement does not take effect until that user's session is
          closed. Once the session is closed, the user is dropped, and
          that user's next attempt to log in will fail. <span class="emphasis"><em>This
          is by design</em></span>.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a> does not automatically
        drop or invalidate databases or objects within them that the old
        user created. This includes stored programs or views for which
        the <code class="literal">DEFINER</code> attribute names the dropped user.
        Attempts to access such objects may produce an error if they
        execute in definer security context. (For information about
        security context, see
        <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="grant"></a>13.7.1.4 GRANT Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737144040912"></a><a class="indexterm" name="idm139737144039840"></a><a class="indexterm" name="idm139737144038800"></a><a class="indexterm" name="idm139737144037312"></a><a class="indexterm" name="idm139737144036240"></a><pre class="programlisting">
GRANT
    <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
      [, <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]] ...
    ON [<em class="replaceable"><code>object_type</code></em>] <em class="replaceable"><code>priv_level</code></em>
    TO <em class="replaceable"><code>user_specification</code></em> [, <em class="replaceable"><code>user_specification</code></em>] ...
    [REQUIRE {NONE | <em class="replaceable"><code>ssl_option</code></em> [[AND] <em class="replaceable"><code>ssl_option</code></em>] ...}]
    [WITH {GRANT OPTION | <em class="replaceable"><code>resource_option</code></em>} ...]

GRANT PROXY ON <em class="replaceable"><code>user_specification</code></em>
    TO <em class="replaceable"><code>user_specification</code></em> [, <em class="replaceable"><code>user_specification</code></em>] ...
    [WITH GRANT OPTION]

<em class="replaceable"><code>object_type</code></em>: {
    TABLE
  | FUNCTION
  | PROCEDURE
}

<em class="replaceable"><code>priv_level</code></em>: {
    *
  | *.*
  | <em class="replaceable"><code>db_name</code></em>.*
  | <em class="replaceable"><code>db_name.tbl_name</code></em>
  | <em class="replaceable"><code>tbl_name</code></em>
  | <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>routine_name</code></em>
}

<em class="replaceable"><code>user_specification</code></em>:
    <em class="replaceable"><code>user</code></em> [ <em class="replaceable"><code>auth_option</code></em> ]

<em class="replaceable"><code>auth_option</code></em>: {
    IDENTIFIED BY '<em class="replaceable"><code>auth_string</code></em>'
  | IDENTIFIED BY PASSWORD '<em class="replaceable"><code>hash_string</code></em>'
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em>
  | IDENTIFIED WITH <em class="replaceable"><code>auth_plugin</code></em> AS '<em class="replaceable"><code>hash_string</code></em>'
}

<em class="replaceable"><code>ssl_option</code></em>: {
    SSL
  | X509
  | CIPHER '<em class="replaceable"><code>cipher</code></em>'
  | ISSUER '<em class="replaceable"><code>issuer</code></em>'
  | SUBJECT '<em class="replaceable"><code>subject</code></em>'
}

<em class="replaceable"><code>resource_option</code></em>: {
  | MAX_QUERIES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_UPDATES_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_CONNECTIONS_PER_HOUR <em class="replaceable"><code>count</code></em>
  | MAX_USER_CONNECTIONS <em class="replaceable"><code>count</code></em>
}
</pre><p>
        The <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement grants
        privileges to MySQL user accounts.
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> also serves to specify
        other account characteristics such as use of secure connections
        and limits on access to server resources.
      </p><p>
        To use <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>, you must have the
        <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privilege, and you
        must have the privileges that you are granting. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> additionally
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        The <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> statement is related
        to <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> and enables
        administrators to remove account privileges. See
        <a class="xref" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax">Section 13.7.1.6, “REVOKE Syntax”</a>.
      </p><p>
        Normally, a database administrator first uses
        <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> to create an account,
        then <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> to define its
        privileges and characteristics. For example:
      </p><pre class="programlisting">
CREATE USER 'jeffrey'@'localhost' IDENTIFIED BY 'mypass';
GRANT ALL ON db1.* TO 'jeffrey'@'localhost';
GRANT SELECT ON db2.invoice TO 'jeffrey'@'localhost';
GRANT USAGE ON *.* TO 'jeffrey'@'localhost' WITH MAX_QUERIES_PER_HOUR 90;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Examples shown here include no <code class="literal">IDENTIFIED</code>
          clause. It is assumed that you establish passwords with
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> at account-creation
          time to avoid creating insecure accounts.
</p>
</div>
<p>
        If an account named in a <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
        statement does not already exist,
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> may create it under the
        conditions described later in the discussion of the
        <a class="link" href="server-administration.html#sqlmode_no_auto_create_user"><code class="literal">NO_AUTO_CREATE_USER</code></a> SQL mode.
      </p><p>
        From the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> program,
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> responds with
        <code class="literal">Query OK, 0 rows affected</code> when executed
        successfully. To determine what privileges result from the
        operation, use <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a>. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax">Section 13.7.5.22, “SHOW GRANTS Syntax”</a>.
      </p><p>
        There are several aspects to the
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement, described under
        the following topics in this section:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-privileges" title="Privileges Supported by MySQL">Privileges Supported by MySQL</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-global-privileges" title="Global Privileges">Global Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-database-privileges" title="Database Privileges">Database Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-table-privileges" title="Table Privileges">Table Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-column-privileges" title="Column Privileges">Column Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-routine-privileges" title="Stored Routine Privileges">Stored Routine Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-proxy-privileges" title="Proxy User Privileges">Proxy User Privileges</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-accounts-passwords" title="Account Names and Passwords">Account Names and Passwords</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-other-characteristics" title="Other Account Characteristics">Other Account Characteristics</a>
          </p></li><li class="listitem"><p>
            <a class="xref" href="sql-syntax.html#grant-mysql-vs-standard-sql" title="MySQL and Standard SQL Versions of GRANT">MySQL and Standard SQL Versions of GRANT</a>
</p></li></ul>
</div>
<p>
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> supports host names up to
        60 characters long. Database, table, column, and routine names
        can be up to 64 characters. User names can be up to 16
        characters.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
          <span class="emphasis"><em>The permissible length for user names cannot be
          changed by altering the <code class="literal">mysql.user</code> table.
          Attempting to do so results in unpredictable behavior which
          may even make it impossible for users to log in to the MySQL
          server</em></span>. You should never alter the structure of
          tables in the <code class="literal">mysql</code> database in any manner
          whatsoever except by means of the procedure described in
          <a class="xref" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables">Section 4.4.7, “<span class="command"><strong>mysql_upgrade</strong></span> — Check and Upgrade MySQL Tables”</a>.
</p>
</div>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
          may be recorded in server logs or on the client side in a
          history file such as <code class="filename">~/.mysql_history</code>,
          which means that cleartext passwords may be read by anyone
          having read access to that information. For information about
          the conditions under which this occurs for the server logs and
          how to control it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For
          similar information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Logging">Section 4.5.1.3, “mysql Logging”</a>.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-privileges"></a>Privileges Supported by MySQL</h5>

</div>

</div>

</div>
<p>
          The following table summarizes the permissible
          <em class="replaceable"><code>priv_type</code></em> privilege types that can
          be specified for the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> and
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> statements, and the
          levels at which each privilege can be granted. For additional
          information about these privileges, see
          <a class="xref" href="security.html#privileges-provided" title="6.2.1 Privileges Provided by MySQL">Section 6.2.1, “Privileges Provided by MySQL”</a>.
</p>
<div class="table">
<a name="idm139737143949152"></a><p class="title"><b>Table 13.1 Permissible Privileges for GRANT and REVOKE</b></p>
<div class="table-contents">
<table summary="Permissible Privileges for GRANT and REVOKE" border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Privilege</th><th scope="col">Meaning and Grantable Levels</th></tr></thead><tbody><tr><td scope="row"><a class="link" href="security.html#priv_all"><code class="literal">ALL [PRIVILEGES]</code></a></td><td>Grant all privileges at specified access level except
                  <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a></td></tr><tr><td scope="row"><a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>. Levels:
                  Global, database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a></td><td>Enable stored routines to be altered or dropped. Levels: Global,
                  database, procedure.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a></td><td>Enable database and table creation. Levels: Global, database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a></td><td>Enable stored routine creation. Levels: Global, database.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create-tablespace"><code class="literal">CREATE TABLESPACE</code></a></td><td>Enable tablespaces and log file groups to be created, altered, or
                  dropped. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create-temporary-tables"><code class="literal">CREATE TEMPORARY TABLES</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
                  TEMPORARY TABLE</code></a>. Levels: Global, database.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
                  <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
                  <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>, and
                  <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE ALL
                  PRIVILEGES</code></a>. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a></td><td>Enable views to be created or altered. Levels: Global, database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>. Level: Global,
                  database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a></td><td>Enable databases, tables, and views to be dropped. Levels: Global,
                  database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a></td><td>Enable use of events for the Event Scheduler. Levels: Global, database.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a></td><td>Enable the user to execute stored routines. Levels: Global, database,
                  table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a></td><td>Enable the user to cause the server to read or write files. Level:
                  Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a></td><td>Enable privileges to be granted to or removed from other accounts.
                  Levels: Global, database, table, procedure, proxy.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a></td><td>Enable indexes to be created or dropped. Levels: Global, database,
                  table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>. Levels: Global,
                  database, table, column.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> on tables for
                  which you have the
                  <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> privilege.
                  Levels: Global, database.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a></td><td>Enable the user to see all processes with <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
                  PROCESSLIST</code></a>. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a></td><td>Enable user proxying. Level: From user to user.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a></td><td>Enable foreign key creation. Levels: Global, database, table, column.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> operations. Level:
                  Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a></td><td>Enable the user to ask where master or slave servers are. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a></td><td>Enable replication slaves to read binary log events from the master.
                  Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>. Levels: Global,
                  database, table, column.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a></td><td>Enable <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a> to show all
                  databases. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#show-create-view" title="13.7.5.14 SHOW CREATE VIEW Syntax"><code class="literal">SHOW CREATE VIEW</code></a>. Levels:
                  Global, database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a></td><td>Enable use of <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin shutdown</strong></span></a>. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a></td><td>Enable use of other administrative operations such as
                  <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>,
                  <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a>,
                  <a class="link" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax"><code class="literal">PURGE BINARY LOGS</code></a>,
                  <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET
                  GLOBAL</code></a>, and <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin
                  debug</strong></span></a> command. Level: Global.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a></td><td>Enable trigger operations. Levels: Global, database, table.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a></td><td>Enable use of <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>. Levels: Global,
database, table, column.</td></tr><tr><td scope="row"><a class="link" href="security.html#priv_usage"><code class="literal">USAGE</code></a></td><td>Synonym for <span class="quote">“<span class="quote">no privileges</span>”</span></td></tr></tbody></table>
</div>

</div>
<br class="table-break"><p>
          A trigger is associated with a table, so to create or drop a
          trigger, you must have the
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a> privilege for the
          table, not the trigger.
        </p><p>
          In <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statements, the
          <a class="link" href="security.html#priv_all"><code class="literal">ALL
          [PRIVILEGES]</code></a> or <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a>
          privilege must be named by itself and cannot be specified
          along with other privileges.
          <a class="link" href="security.html#priv_all"><code class="literal">ALL
          [PRIVILEGES]</code></a> stands for all privileges available for
          the level at which privileges are to be granted except for the
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> and
          <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privileges.
        </p><p>
          <a class="link" href="security.html#priv_usage"><code class="literal">USAGE</code></a> can be specified to
          create a user that has no privileges, or to specify the
          <code class="literal">REQUIRE</code> or <code class="literal">WITH</code> clauses
          for an account without changing its existing privileges.
        </p><p>
          MySQL account information is stored in the tables of the
          <code class="literal">mysql</code> database. For additional details,
          consult <a class="xref" href="security.html#privilege-system" title="6.2 The MySQL Access Privilege System">Section 6.2, “The MySQL Access Privilege System”</a>, which discusses
          the <code class="literal">mysql</code> database and the access control
          system extensively.
        </p><p>
          If the grant tables hold privilege rows that contain
          mixed-case database or table names and the
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
          variable is set to a nonzero value,
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> cannot be used to revoke
          these privileges. It will be necessary to manipulate the grant
          tables directly. (<a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> will
          not create such rows when
          <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> is
          set, but such rows might have been created prior to setting
          that variable.)
        </p><p>
          Privileges can be granted at several levels, depending on the
          syntax used for the <code class="literal">ON</code> clause. For
          <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a>, the same
          <code class="literal">ON</code> syntax specifies which privileges to
          remove.
        </p><p>
          For the global, database, table, and routine levels,
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT ALL</code></a>
          assigns only the privileges that exist at the level you are
          granting. For example, <code class="literal">GRANT ALL ON
          <em class="replaceable"><code>db_name</code></em>.*</code> is a
          database-level statement, so it does not grant any global-only
          privileges such as <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>.
          Granting <a class="link" href="security.html#priv_all"><code class="literal">ALL</code></a> does not assign
          the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> or
          <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privilege.
        </p><p>
          The <em class="replaceable"><code>object_type</code></em> clause, if present,
          should be specified as <code class="literal">TABLE</code>,
          <code class="literal">FUNCTION</code>, or <code class="literal">PROCEDURE</code>
          when the following object is a table, a stored function, or a
          stored procedure.
        </p><p>
          The privileges for a database, table, column, or routine are
          formed additively as the logical
          <a class="link" href="functions.html#operator_or"><code class="literal">OR</code></a> of the privileges at each of
          the privilege levels. For example, if a user has a global
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege, the privilege
          cannot be denied by an absence of the privilege at the
          database, table, or column level. Details of the
          privilege-checking procedure are presented in
          <a class="xref" href="security.html#request-access" title="6.2.5 Access Control, Stage 2: Request Verification">Section 6.2.5, “Access Control, Stage 2: Request Verification”</a>.
        </p><p>
          If you are using table, column, or routine privileges for even
          one user, the server examines table, column, and routine
          privileges for all users and this slows down MySQL a bit.
          Similarly, if you limit the number of queries, updates, or
          connections for any users, the server must monitor these
          values.
        </p><p>
          MySQL enables you to grant privileges on databases or tables
          that do not exist. For tables, the privileges to be granted
          must include the <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>
          privilege. <span class="emphasis"><em>This behavior is by design</em></span>,
          and is intended to enable the database administrator to
          prepare user accounts and privileges for databases or tables
          that are to be created at a later time.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
            <span class="emphasis"><em>MySQL does not automatically revoke any privileges
            when you drop a database or table</em></span>. However, if
            you drop a routine, any routine-level privileges granted for
            that routine are revoked.
</p>
</div>

</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-global-privileges"></a>Global Privileges</h5>

</div>

</div>

</div>
<p>
          Global privileges are administrative or apply to all databases
          on a given server. To assign global privileges, use
          <code class="literal">ON *.*</code> syntax:
        </p><pre class="programlisting">
GRANT ALL ON *.* TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON *.* TO 'someuser'@'somehost';
</pre><p>
          The <a class="link" href="security.html#priv_create-tablespace"><code class="literal">CREATE TABLESPACE</code></a>,
          <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>,
          <a class="link" href="security.html#priv_file"><code class="literal">FILE</code></a>,
          <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a>,
          <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a>,
          <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a>,
          <a class="link" href="security.html#priv_replication-slave"><code class="literal">REPLICATION SLAVE</code></a>,
          <a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a>,
          <a class="link" href="security.html#priv_shutdown"><code class="literal">SHUTDOWN</code></a>, and
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privileges are
          administrative and can only be granted globally.
        </p><p>
          Other privileges can be granted globally or at more specific
          levels.
        </p><p>
          MySQL stores global privileges in the
          <code class="literal">mysql.user</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-database-privileges"></a>Database Privileges</h5>

</div>

</div>

</div>
<p>
          Database privileges apply to all objects in a given database.
          To assign database-level privileges, use <code class="literal">ON
          <em class="replaceable"><code>db_name</code></em>.*</code> syntax:
        </p><pre class="programlisting">
GRANT ALL ON mydb.* TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON mydb.* TO 'someuser'@'somehost';
</pre><p>
          If you use <code class="literal">ON *</code> syntax (rather than
          <code class="literal">ON *.*</code>) and you have selected a default
          database, privileges are assigned at the database level for
          the default database. An error occurs if there is no default
          database.
        </p><p>
          The <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>,
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>,
          <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a>,
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>,
          <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a>, and
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a> privileges can be
          specified at the database level. Table or routine privileges
          also can be specified at the database level, in which case
          they apply to all tables or routines in the database.
        </p><p>
          MySQL stores database privileges in the
          <code class="literal">mysql.db</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-table-privileges"></a>Table Privileges</h5>

</div>

</div>

</div>
<p>
          Table privileges apply to all columns in a given table. To
          assign table-level privileges, use <code class="literal">ON
          <em class="replaceable"><code>db_name.tbl_name</code></em></code> syntax:
        </p><pre class="programlisting">
GRANT ALL ON mydb.mytbl TO 'someuser'@'somehost';
GRANT SELECT, INSERT ON mydb.mytbl TO 'someuser'@'somehost';
</pre><p>
          If you specify <em class="replaceable"><code>tbl_name</code></em> rather than
          <em class="replaceable"><code>db_name.tbl_name</code></em>, the statement
          applies to <em class="replaceable"><code>tbl_name</code></em> in the default
          database. An error occurs if there is no default database.
        </p><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values at
          the table level are <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a>,
          <a class="link" href="security.html#priv_create-view"><code class="literal">CREATE VIEW</code></a>,
          <a class="link" href="security.html#priv_create"><code class="literal">CREATE</code></a>,
          <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a>,
          <a class="link" href="security.html#priv_drop"><code class="literal">DROP</code></a>,
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>,
          <a class="link" href="security.html#priv_index"><code class="literal">INDEX</code></a>,
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>,
          <a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a>,
          <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          MySQL stores table privileges in the
          <code class="literal">mysql.tables_priv</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-column-privileges"></a>Column Privileges</h5>

</div>

</div>

</div>
<p>
          Column privileges apply to single columns in a given table.
          Each privilege to be granted at the column level must be
          followed by the column or columns, enclosed within
          parentheses.
        </p><pre class="programlisting">
GRANT SELECT (col1), INSERT (col1,col2) ON mydb.mytbl TO 'someuser'@'somehost';
</pre><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values
          for a column (that is, when you use a
          <em class="replaceable"><code>column_list</code></em> clause) are
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_references"><code class="literal">REFERENCES</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          MySQL stores column privileges in the
          <code class="literal">mysql.columns_priv</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-routine-privileges"></a>Stored Routine Privileges</h5>

</div>

</div>

</div>
<p>
          The <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER ROUTINE</code></a>,
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a>,
          <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>, and
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privileges apply
          to stored routines (procedures and functions). They can be
          granted at the global and database levels. Except for
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a>, these
          privileges can be granted at the routine level for individual
          routines.
        </p><pre class="programlisting">
GRANT CREATE ROUTINE ON mydb.* TO 'someuser'@'somehost';
GRANT EXECUTE ON PROCEDURE mydb.myproc TO 'someuser'@'somehost';
</pre><p>
          The permissible <em class="replaceable"><code>priv_type</code></em> values at
          the routine level are <a class="link" href="security.html#priv_alter-routine"><code class="literal">ALTER
          ROUTINE</code></a>, <a class="link" href="security.html#priv_execute"><code class="literal">EXECUTE</code></a>, and
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>.
          <a class="link" href="security.html#priv_create-routine"><code class="literal">CREATE ROUTINE</code></a> is not a
          routine-level privilege because you must have this privilege
          to create a routine in the first place.
        </p><p>
          MySQL stores routine-level privileges in the
          <code class="literal">mysql.procs_priv</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-proxy-privileges"></a>Proxy User Privileges</h5>

</div>

</div>

</div>
<p>
          The <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> privilege enables one
          user to be a proxy for another. The proxy user impersonates or
          takes the identity of the proxied user.
        </p><pre class="programlisting">
GRANT PROXY ON 'localuser'@'localhost' TO 'externaluser'@'somehost';
</pre><p>
          When <a class="link" href="security.html#priv_proxy"><code class="literal">PROXY</code></a> is granted, it must
          be the only privilege named in the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement, the
          <code class="literal">REQUIRE</code> clause cannot be given, and the
          only permitted <code class="literal">WITH</code> option is <code class="literal">WITH
          GRANT OPTION</code>.
        </p><p>
          Proxying requires that the proxy user authenticate through a
          plugin that returns the name of the proxied user to the server
          when the proxy user connects, and that the proxy user have the
          <code class="literal">PROXY</code> privilege for the proxied user. For
          details and examples, see <a class="xref" href="security.html#proxy-users" title="6.3.9 Proxy Users">Section 6.3.9, “Proxy Users”</a>.
        </p><p>
          MySQL stores proxy privileges in the
          <code class="literal">mysql.proxies_priv</code> table.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-accounts-passwords"></a>Account Names and Passwords</h5>

</div>

</div>

</div>
<p>
          The <em class="replaceable"><code>user_specification</code></em> clause names
          a user and optionally provides authentication information such
          as a password.
        </p><p>
          The <em class="replaceable"><code>user</code></em> value indicates the MySQL
          account to which the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
          statement applies. To accommodate granting rights to users
          from arbitrary hosts, MySQL supports specifying the
          <em class="replaceable"><code>user</code></em> value in the form
          <code class="literal"><em class="replaceable"><code>user_name</code></em>@<em class="replaceable"><code>host_name</code></em></code>.
          If a <em class="replaceable"><code>user_name</code></em> or
          <em class="replaceable"><code>host_name</code></em> value is legal as an
          unquoted identifier, you need not quote it. However, quotation
          marks are necessary to specify a
          <em class="replaceable"><code>user_name</code></em> string containing special
          characters (such as <span class="quote">“<span class="quote"><code class="literal">-</code></span>”</span>), or a
          <em class="replaceable"><code>host_name</code></em> string containing special
          characters or wildcard characters (such as
          <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span>); for example,
          <code class="literal">'test-user'@'%.com'</code>. Quote the user name
          and host name separately.
        </p><p>
          You can specify wildcards in the host name. For example,
          <code class="literal"><em class="replaceable"><code>user_name</code></em>@'%.example.com'</code>
          applies to <em class="replaceable"><code>user_name</code></em> for any host
          in the <code class="literal">example.com</code> domain, and
          <code class="literal"><em class="replaceable"><code>user_name</code></em>@'192.168.1.%'</code>
          applies to <em class="replaceable"><code>user_name</code></em> for any host
          in the <code class="literal">192.168.1</code> class C subnet.
        </p><p>
          The simple form <em class="replaceable"><code>user_name</code></em> is a
          synonym for
          <code class="literal"><em class="replaceable"><code>user_name</code></em>@'%'</code>.
        </p><p>
          <span class="emphasis"><em>MySQL does not support wildcards in user
          names</em></span>. To refer to an anonymous user, specify an
          account with an empty user name with the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement:
        </p><pre class="programlisting">
GRANT ALL ON test.* TO ''@'localhost' ...;
</pre><p>
          In this case, any user who connects from the local host with
          the correct password for the anonymous user will be permitted
          access, with the privileges associated with the anonymous-user
          account.
        </p><p>
          For additional information about user name and host name
          values in account names, see <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>.
        </p><p>
          To specify quoted values, quote database, table, column, and
          routine names as identifiers. Quote user names and host names
          as identifiers or as strings. Quote passwords as strings. For
          string-quoting and identifier-quoting guidelines, see
          <a class="xref" href="language-structure.html#string-literals" title="9.1.1 String Literals">Section 9.1.1, “String Literals”</a>, and
          <a class="xref" href="language-structure.html#identifiers" title="9.2 Schema Object Names">Section 9.2, “Schema Object Names”</a>.
        </p><p>
          The <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span> and
          <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span> wildcards are permitted
          when specifying database names in
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statements that grant
          privileges at the global or database levels. This means, for
          example, that if you want to use a
          <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span> character as part of a
          database name, you should specify it as
          <span class="quote">“<span class="quote"><code class="literal">\_</code></span>”</span> in the
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement, to prevent the
          user from being able to access additional databases matching
          the wildcard pattern; for example, <code class="literal">GRANT ... ON
          `foo\_bar`.* TO ...</code>.
</p>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Warning
</div>
<p>
            If you permit anonymous users to connect to the MySQL
            server, you should also grant privileges to all local users
            as
            <code class="literal"><em class="replaceable"><code>user_name</code></em>@localhost</code>.
            Otherwise, the anonymous user account for
            <code class="literal">localhost</code> in the
            <code class="literal">mysql.user</code> table (created during MySQL
            installation) is used when named users try to log in to the
            MySQL server from the local machine. For details, see
            <a class="xref" href="security.html#connection-access" title="6.2.4 Access Control, Stage 1: Connection Verification">Section 6.2.4, “Access Control, Stage 1: Connection Verification”</a>.
</p>
</div>
<p>
          To determine whether the preceding warning applies to you,
          execute the following query, which lists any anonymous users:
        </p><pre class="programlisting">
SELECT Host, User FROM mysql.user WHERE User='';
</pre><p>
          To avoid the problem just described, delete the local
          anonymous user account using this statement:
        </p><pre class="programlisting">
DROP USER ''@'localhost';
</pre><a class="indexterm" name="idm139737143669200"></a><p>
          To indicate how the user should authenticate when connecting
          to the server, the
          <em class="replaceable"><code>user_specification</code></em> value may
          include an <code class="literal">IDENTIFIED</code> clause to specify an
          authentication plugin, a password, or both. Syntax of the user
          specification is the same as for the
          <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a> statement. For
          details, see <a class="xref" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax">Section 13.7.1.2, “CREATE USER Syntax”</a>.
        </p><p>
          When <code class="literal">IDENTIFIED BY</code> is present and you have
          the global grant privilege (<a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT
          OPTION</code></a>), the password becomes the new password for
          the account, even if the account exists and already has a
          password. Without <code class="literal">IDENTIFIED BY</code>, the
          account password remains unchanged.
        </p><p>
          If an account named in a <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
          statement does not exist, the action taken depends on the
          <a class="link" href="server-administration.html#sqlmode_no_auto_create_user"><code class="literal">NO_AUTO_CREATE_USER</code></a> SQL
          mode:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              If <a class="link" href="server-administration.html#sqlmode_no_auto_create_user"><code class="literal">NO_AUTO_CREATE_USER</code></a>
              is not enabled, <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
              creates the account. <span class="emphasis"><em>This is very
              insecure</em></span> unless you specify a nonempty password
              using <code class="literal">IDENTIFIED BY</code>.
            </p></li><li class="listitem"><p>
              If <a class="link" href="server-administration.html#sqlmode_no_auto_create_user"><code class="literal">NO_AUTO_CREATE_USER</code></a>
              is enabled, <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> fails and
              does not create the account, unless you specify a nonempty
              password using <code class="literal">IDENTIFIED BY</code> or name an
              authentication plugin using <code class="literal">IDENTIFIED
              WITH</code>.
</p></li></ul>
</div>
<p>
          As of MySQL 5.6.12, if the account already exists,
          <code class="literal">IDENTIFIED WITH</code> is prohibited because it is
          intended only for use when creating new accounts.
</p>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-other-characteristics"></a>Other Account Characteristics</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143645296"></a><a class="indexterm" name="idm139737143643808"></a><p>
          MySQL can check X509 certificate attributes in addition to the
          usual authentication that is based on the user name and
          credentials. For background information on the use of SSL with
          MySQL, see <a class="xref" href="security.html#ssl-connections" title="6.3.10 Using SSL for Secure Connections">Section 6.3.10, “Using SSL for Secure Connections”</a>.
        </p><p>
          The optional <code class="literal">REQUIRE</code> clause specifies
          SSL-related options for a MySQL account, using one or more
          <em class="replaceable"><code>ssl_option</code></em> values.
        </p><p>
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> permits these
          <em class="replaceable"><code>ssl_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">NONE</code>
            </p><p>
              Indicates that the account has no SSL or X509
              requirements. Unencrypted connections are permitted if the
              user name and password are valid. However, encrypted
              connections can also be used, at the client's option, if
              the client has the proper certificate and key files. That
              is, the client need not specify any SSL command options,
              in which case the connection will be unencrypted. To use
              an encrypted connection, the client must specify either
              the <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> option, or
              all three of the <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a>,
              <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a>, and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options.
            </p><p>
              <code class="literal">NONE</code> is the default if no SSL-related
              <code class="literal">REQUIRE</code> options are specified.
            </p></li><li class="listitem"><p>
              <code class="literal">SSL</code>
            </p><p>
              Tells the server to permit only SSL-encrypted connections
              for the account.
            </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE SSL;
</pre><p>
              To connect, the client must specify the
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> option to
              authenticate the server certificate, and may additionally
              specify the <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a> and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options. If
              neither <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a> option
              nor <a class="link" href="security.html#option_general_ssl-capath"><code class="option">--ssl-capath</code></a> option is
              specified, the client does not authenticate the server
              certificate.
            </p></li><li class="listitem"><p>
              <code class="literal">X509</code>
            </p><p>
              Requires that the client must have a valid certificate but
              the exact certificate, issuer, and subject do not matter.
              The only requirement is that it should be possible to
              verify its signature with one of the CA certificates.
            </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE X509;
</pre><p>
              To connect, the client must specify the
              <a class="link" href="security.html#option_general_ssl-ca"><code class="option">--ssl-ca</code></a>,
              <a class="link" href="security.html#option_general_ssl-key"><code class="option">--ssl-key</code></a>, and
              <a class="link" href="security.html#option_general_ssl-cert"><code class="option">--ssl-cert</code></a> options. This
              is also true for <code class="literal">ISSUER</code> and
              <code class="literal">SUBJECT</code> because those
              <code class="literal">REQUIRE</code> options imply
              <code class="literal">X509</code>.
            </p></li><li class="listitem"><p>
              <code class="literal">ISSUER
              '<em class="replaceable"><code>issuer</code></em>'</code>
            </p><p>
              Places the restriction on connection attempts that the
              client must present a valid X509 certificate issued by CA
              <code class="literal">'<em class="replaceable"><code>issuer</code></em>'</code>. If
              the client presents a certificate that is valid but has a
              different issuer, the server rejects the connection. Use
              of X509 certificates always implies encryption, so the
              <code class="literal">SSL</code> option is unnecessary in this case.
            </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com';
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                If MySQL is linked against a version of OpenSSL older
                than 0.9.6h, use <code class="literal">Email</code> rather than
                <code class="literal">emailAddress</code> in the
                <code class="literal">'<em class="replaceable"><code>issuer</code></em>'</code>
                value.
</p>
</div>
</li><li class="listitem"><p>
              <code class="literal">SUBJECT
              '<em class="replaceable"><code>subject</code></em>'</code>
            </p><p>
              Places the restriction on connection attempts that the
              client must present a valid X509 certificate containing
              the subject <em class="replaceable"><code>subject</code></em>. If the
              client presents a certificate that is valid but has a
              different subject, the server rejects the connection.
            </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com';
</pre><p>
              MySQL does a simple string comparison of the
              <code class="literal">'<em class="replaceable"><code>subject</code></em>'</code>
              value to the value in the certificate, so lettercase and
              component ordering must be given exactly as present in the
              certificate.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
                Regarding <code class="literal">emailAddress</code>, see the note
                in the description of <code class="literal">REQUIRE ISSUER</code>.
</p>
</div>
</li><li class="listitem"><p>
              <code class="literal">CIPHER
              '<em class="replaceable"><code>cipher</code></em>'</code>
            </p><p>
              Requests a specific cipher method for connections. This
              option is needed to ensure that ciphers and key lengths of
              sufficient strength are used. SSL itself can be weak if
              old algorithms using short encryption keys are used.
            </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre></li></ul>
</div>
<p>
          The <code class="literal">SUBJECT</code>, <code class="literal">ISSUER</code>, and
          <code class="literal">CIPHER</code> options can be combined in the
          <code class="literal">REQUIRE</code> clause like this:
        </p><pre class="programlisting">
GRANT ALL PRIVILEGES ON test.* TO 'root'@'localhost'
  REQUIRE SUBJECT '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL demo client certificate/
    CN=client/emailAddress=client@example.com'
  AND ISSUER '/C=SE/ST=Stockholm/L=Stockholm/
    O=MySQL/CN=CA/emailAddress=ca@example.com'
  AND CIPHER 'EDH-RSA-DES-CBC3-SHA';
</pre><p>
          The order of the options does not matter, but no option can be
          specified twice. The <code class="literal">AND</code> keyword is
          optional between <code class="literal">REQUIRE</code> options.
        </p><p>
          The optional <code class="literal">WITH</code> clause is used for these
          purposes:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              To enable a user to grant privileges to other users
            </p></li><li class="listitem"><p>
              To specify resource limits for a user
</p></li></ul>
</div>
<p>
          The <code class="literal">WITH GRANT OPTION</code> clause gives the user
          the ability to give to other users any privileges the user has
          at the specified privilege level.
        </p><p>
          To grant the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
          privilege to an account without otherwise changing its
          privileges, do this:
        </p><pre class="programlisting">
GRANT USAGE ON *.* TO 'someuser'@'somehost' WITH GRANT OPTION;
</pre><p>
          Be careful to whom you give the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT
          OPTION</code></a> privilege because two users with different
          privileges may be able to combine privileges!
        </p><p>
          You cannot grant another user a privilege which you yourself
          do not have; the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
          privilege enables you to assign only those privileges which
          you yourself possess.
        </p><p>
          Be aware that when you grant a user the
          <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a> privilege at a
          particular privilege level, any privileges the user possesses
          (or may be given in the future) at that level can also be
          granted by that user to other users. Suppose that you grant a
          user the <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege on a
          database. If you then grant the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege on the
          database and specify <code class="literal">WITH GRANT OPTION</code>,
          that user can give to other users not only the
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege, but also
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>. If you then grant the
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege to the user on
          the database, the user can grant
          <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a>,
          <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>, and
          <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a>.
        </p><p>
          For a nonadministrative user, you should not grant the
          <a class="link" href="security.html#priv_alter"><code class="literal">ALTER</code></a> privilege globally or for
          the <code class="literal">mysql</code> database. If you do that, the
          user can try to subvert the privilege system by renaming
          tables!
        </p><p>
          For additional information about security risks associated
          with particular privileges, see
          <a class="xref" href="security.html#privileges-provided" title="6.2.1 Privileges Provided by MySQL">Section 6.2.1, “Privileges Provided by MySQL”</a>.
        </p><a class="indexterm" name="idm139737143557904"></a><a class="indexterm" name="idm139737143556416"></a><p>
          It is possible to place limits on use of server resources by
          an account, as discussed in <a class="xref" href="security.html#user-resources" title="6.3.4 Setting Account Resource Limits">Section 6.3.4, “Setting Account Resource Limits”</a>.
          To do so, use a <code class="literal">WITH</code> clause that specifies
          one or more <em class="replaceable"><code>resource_option</code></em> values.
          Limits not specified retain their current values.
        </p><p>
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> permits these
          <em class="replaceable"><code>resource_option</code></em> values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              <code class="literal">MAX_QUERIES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_UPDATES_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>,
              <code class="literal">MAX_CONNECTIONS_PER_HOUR
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              These options restrict the number of queries, updates, and
              connections to the server permitted to this account during
              any given one-hour period. (Queries for which results are
              served from the query cache do not count against the
              <code class="literal">MAX_QUERIES_PER_HOUR</code> limit.) If
              <em class="replaceable"><code>count</code></em> is <code class="literal">0</code>
              (the default), this means that there is no limitation for
              the account.
            </p></li><li class="listitem"><p>
              <code class="literal">MAX_USER_CONNECTIONS
              <em class="replaceable"><code>count</code></em></code>
            </p><p>
              Restricts the maximum number of simultaneous connections
              to the server by the account. A nonzero
              <em class="replaceable"><code>count</code></em> specifies the limit for
              the account explicitly. If
              <em class="replaceable"><code>count</code></em> is <code class="literal">0</code>
              (the default), the server determines the number of
              simultaneous connections for the account from the global
              value of the
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a>
              system variable. If
              <a class="link" href="server-administration.html#sysvar_max_user_connections"><code class="literal">max_user_connections</code></a> is
              also zero, there is no limit for the account.
</p></li></ul>
</div>
<p>
          If a given resource limit is specified multiple times, the
          last instance takes precedence.
        </p><p>
          To specify resource limits for an existing user without
          affecting existing privileges, use
          <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT USAGE</code></a>
          at the global level (<code class="literal">ON *.*</code>) and name the
          limits to be changed. For example:
        </p><pre class="programlisting">
GRANT USAGE ON *.* TO ...
  WITH MAX_QUERIES_PER_HOUR 500 MAX_UPDATES_PER_HOUR 100;
</pre>
</div>
<div class="simplesect">
<div class="titlepage">
<div>
<div class="simple">
<h5 class="title"><a name="grant-mysql-vs-standard-sql"></a>MySQL and Standard SQL Versions of GRANT</h5>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143531616"></a><p>
          The biggest differences between the MySQL and standard SQL
          versions of <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> are:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              MySQL associates privileges with the combination of a host
              name and user name and not with only a user name.
            </p></li><li class="listitem"><p>
              Standard SQL does not have global or database-level
              privileges, nor does it support all the privilege types
              that MySQL supports.
            </p></li><li class="listitem"><p>
              MySQL does not support the standard SQL
              <code class="literal">UNDER</code> privilege.
            </p></li><li class="listitem"><p>
              Standard SQL privileges are structured in a hierarchical
              manner. If you remove a user, all privileges the user has
              been granted are revoked. This is also true in MySQL if
              you use <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a>. See
              <a class="xref" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax">Section 13.7.1.3, “DROP USER Syntax”</a>.
            </p></li><li class="listitem"><p>
              In standard SQL, when you drop a table, all privileges for
              the table are revoked. In standard SQL, when you revoke a
              privilege, all privileges that were granted based on that
              privilege are also revoked. In MySQL, privileges can be
              dropped only with explicit <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP
              USER</code></a> or <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a>
              statements or by manipulating the MySQL grant tables
              directly.
            </p></li><li class="listitem"><p>
              In MySQL, it is possible to have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for only
              some of the columns in a table. In this case, you can
              still execute <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>
              statements on the table, provided that you insert values
              only for those columns for which you have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege. The
              omitted columns are set to their implicit default values
              if strict SQL mode is not enabled. In strict mode, the
              statement is rejected if any of the omitted columns have
              no default value. (Standard SQL requires you to have the
              <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege on all
              columns.) <a class="xref" href="server-administration.html#sql-mode" title="5.1.7 Server SQL Modes">Section 5.1.7, “Server SQL Modes”</a>, discusses strict
              mode. <a class="xref" href="data-types.html#data-type-defaults" title="11.6 Data Type Default Values">Section 11.6, “Data Type Default Values”</a>, discusses
              implicit default values.
</p></li></ul>
</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="rename-user"></a>13.7.1.5 RENAME USER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143508864"></a><a class="indexterm" name="idm139737143507792"></a><a class="indexterm" name="idm139737143506304"></a><pre class="programlisting">
RENAME USER <em class="replaceable"><code>old_user</code></em> TO <em class="replaceable"><code>new_user</code></em>
    [, <em class="replaceable"><code>old_user</code></em> TO <em class="replaceable"><code>new_user</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> statement renames
        existing MySQL accounts. An error occurs for old accounts that
        do not exist or new accounts that already exist.
      </p><p>
        To use <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a>, you must have
        the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a> privilege
        or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege for the
        <code class="literal">mysql</code> database. When the
        <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system variable is
        enabled, <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> additionally
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. For example:
      </p><pre class="programlisting">
RENAME USER 'jeffrey'@'localhost' TO 'jeff'@'127.0.0.1';
</pre><p>
        If you specify only the user name part of the account name, a
        host name part of <code class="literal">'%'</code> is used.
      </p><p>
        <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> causes the privileges
        held by the old user to be those held by the new user. However,
        <a class="link" href="sql-syntax.html#rename-user" title="13.7.1.5 RENAME USER Syntax"><code class="literal">RENAME USER</code></a> does not
        automatically drop or invalidate databases or objects within
        them that the old user created. This includes stored programs or
        views for which the <code class="literal">DEFINER</code> attribute names
        the old user. Attempts to access such objects may produce an
        error if they execute in definer security context. (For
        information about security context, see
        <a class="xref" href="stored-programs-views.html#stored-programs-security" title="20.6 Access Control for Stored Programs and Views">Section 20.6, “Access Control for Stored Programs and Views”</a>.)
      </p><p>
        The privilege changes take effect as indicated in
        <a class="xref" href="security.html#privilege-changes" title="6.2.6 When Privilege Changes Take Effect">Section 6.2.6, “When Privilege Changes Take Effect”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="revoke"></a>13.7.1.6 REVOKE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143479120"></a><a class="indexterm" name="idm139737143478048"></a><a class="indexterm" name="idm139737143477008"></a><a class="indexterm" name="idm139737143475520"></a><a class="indexterm" name="idm139737143474448"></a><pre class="programlisting">
REVOKE
    <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]
      [, <em class="replaceable"><code>priv_type</code></em> [(<em class="replaceable"><code>column_list</code></em>)]] ...
    ON [<em class="replaceable"><code>object_type</code></em>] <em class="replaceable"><code>priv_level</code></em>
    FROM <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...

REVOKE ALL PRIVILEGES, GRANT OPTION
    FROM <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...

REVOKE PROXY ON <em class="replaceable"><code>user</code></em>
    FROM <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> statement enables
        system administrators to revoke privileges from MySQL accounts.
      </p><p>
        When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
        variable is enabled, <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a>
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege in
        addition to any other required privileges described in the
        following discussion.
      </p><p>
        Each account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. For example:
      </p><pre class="programlisting">
REVOKE INSERT ON *.* FROM 'jeffrey'@'localhost';
</pre><p>
        If you specify only the user name part of the account name, a
        host name part of <code class="literal">'%'</code> is used.
      </p><p>
        For details on the levels at which privileges exist, the
        permissible <em class="replaceable"><code>priv_type</code></em> and
        <em class="replaceable"><code>priv_level</code></em> values, and the syntax for
        specifying users and passwords, see <a class="xref" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax">Section 13.7.1.4, “GRANT Syntax”</a>
      </p><p>
        To use the first <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> syntax,
        you must have the <a class="link" href="security.html#priv_grant-option"><code class="literal">GRANT OPTION</code></a>
        privilege, and you must have the privileges that you are
        revoking.
      </p><p>
        To revoke all privileges, use the second syntax, which drops all
        global, database, table, column, and routine privileges for the
        named user or users:
      </p><pre class="programlisting">
REVOKE ALL PRIVILEGES, GRANT OPTION FROM <em class="replaceable"><code>user</code></em> [, <em class="replaceable"><code>user</code></em>] ...
</pre><p>
        To use this <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> syntax, you
        must have the global <a class="link" href="security.html#priv_create-user"><code class="literal">CREATE USER</code></a>
        privilege or the <a class="link" href="security.html#priv_update"><code class="literal">UPDATE</code></a> privilege
        for the <code class="literal">mysql</code> database.
      </p><p>
        <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> removes privileges, but
        does not drop <code class="literal">mysql.user</code> table entries. To
        remove a user account entirely, use <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP
        USER</code></a> (see <a class="xref" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax">Section 13.7.1.3, “DROP USER Syntax”</a>) or
        <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>.
      </p><p>
        If the grant tables hold privilege rows that contain mixed-case
        database or table names and the
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
        variable is set to a nonzero value,
        <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> cannot be used to revoke
        these privileges. It will be necessary to manipulate the grant
        tables directly. (<a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> will not
        create such rows when
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> is set,
        but such rows might have been created prior to setting the
        variable.)
      </p><p>
        When successfully executed from the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a>
        program, <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a> responds with
        <code class="literal">Query OK, 0 rows affected</code>. To determine what
        privileges result from the operation, use
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a>. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax">Section 13.7.5.22, “SHOW GRANTS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="set-password"></a>13.7.1.7 SET PASSWORD Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143423536"></a><a class="indexterm" name="idm139737143422464"></a><a class="indexterm" name="idm139737143420976"></a><pre class="programlisting">
SET PASSWORD [FOR <em class="replaceable"><code>user</code></em>] = <em class="replaceable"><code>password_option</code></em>

<em class="replaceable"><code>password_option</code></em>: {
    PASSWORD('<em class="replaceable"><code>auth_string</code></em>')
  | OLD_PASSWORD('<em class="replaceable"><code>auth_string</code></em>')
  | '<em class="replaceable"><code>hash_string</code></em>'
}
</pre><p>
        The <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> statement
        assigns a password to a MySQL user account:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With no <code class="literal">FOR
            <em class="replaceable"><code>user</code></em></code> clause, this
            statement sets the password for the current user:
          </p><pre class="programlisting">
SET PASSWORD = <em class="replaceable"><code>password_option</code></em>;
</pre><p>
            Any client who connects to the server using a nonanonymous
            account can change the password for that account. To see
            which account the server authenticated you as, invoke the
            <a class="link" href="functions.html#function_current-user"><code class="literal">CURRENT_USER()</code></a> function:
          </p><pre class="programlisting">
SELECT CURRENT_USER();
</pre><p>
            Permitted <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a>
            values are described later in this section.
          </p></li><li class="listitem"><p>
            With a <code class="literal">FOR
            <em class="replaceable"><code>user</code></em></code> clause, this
            statement sets the password for the named account, which
            must exist:
          </p><pre class="programlisting">
SET PASSWORD FOR 'jeffrey'@'localhost' = <em class="replaceable"><code>password_option</code></em>;
</pre><p>
            In this case, you must have the
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> privilege for the
            <code class="literal">mysql</code> database.
</p></li></ul>
</div>
<p>
        When the <a class="link" href="server-administration.html#sysvar_read_only"><code class="literal">read_only</code></a> system
        variable is enabled, <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a>
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege in
        addition to any other required privileges.
      </p><p>
        If a <code class="literal">FOR <em class="replaceable"><code>user</code></em></code>
        clause is given, the account name uses the format described in
        <a class="xref" href="security.html#account-names" title="6.2.3 Specifying Account Names">Section 6.2.3, “Specifying Account Names”</a>. The
        <em class="replaceable"><code>user</code></em> value should be given as
        <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>,
        where <code class="literal">'<em class="replaceable"><code>user_name</code></em>'</code>
        and <code class="literal">'<em class="replaceable"><code>host_name</code></em>'</code>
        are exactly as listed in the <code class="literal">User</code> and
        <code class="literal">Host</code> columns of the account's
        <code class="literal">mysql.user</code> table row. If you specify only a
        user name, a host name of <code class="literal">'%'</code> is used. For
        example, to set the password for an account with
        <code class="literal">User</code> and <code class="literal">Host</code> column
        values of <code class="literal">'bob'</code> and
        <code class="literal">'%.example.org'</code>, write the statement like
        this:
      </p><pre class="programlisting">
SET PASSWORD FOR 'bob'@'%.example.org' = PASSWORD('<em class="replaceable"><code>cleartext password</code></em>');
</pre><p>
        The password can be specified in these ways:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Using the <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> function
          </p><p>
            The
            <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
            function argument is the cleartext (unencrypted) password.
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> hashes the
            password and returns the encrypted password string for
            storage in the <code class="literal">mysql.user</code> account row.
          </p><p>
            The <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> system
            variable value determines the hashing method used by
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a>. If
            <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> rejects the
            password as not being in the correct format, it may be
            necessary to change
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> to change the
            hashing method. For example, if the account uses the
            <code class="literal">mysql_native_password</code> plugin, the
            <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> value must be
            0:
          </p><pre class="programlisting">
SET old_passwords = 0;
SET PASSWORD FOR 'jeffrey'@'localhost' = PASSWORD('mypass');
</pre><p>
            If the <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a> value
            differs from that required by the authentication plugin, the
            hashed password value returned by
            <a class="link" href="functions.html#function_password"><code class="literal">PASSWORD()</code></a> is not acceptable
            for that plugin, and attempts to set the password produce an
            error. For example:
          </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET old_passwords = 1;</code></strong>
mysql&gt; <strong class="userinput"><code>SET PASSWORD FOR 'jeffrey'@'localhost' = PASSWORD('mypass');</code></strong>
ERROR 1372 (HY000): Password hash should be a 41-digit hexadecimal number
</pre><p>
            Permitted <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a>
            values are described later in this section.
          </p></li><li class="listitem"><p>
            Using the <a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a>
            function:
          </p><p>
            The
            <code class="literal">'<em class="replaceable"><code>auth_string</code></em>'</code>
            function argument is the cleartext (unencrypted) password.
            <a class="link" href="functions.html#function_old-password"><code class="literal">OLD_PASSWORD()</code></a> hashes the
            password using pre-4.1 hashing and returns the encrypted
            password string for storage in the
            <code class="literal">mysql.user</code> account row. This hashing
            method is appropriate only for accounts that use the
            <code class="literal">mysql_old_password</code> authentication plugin.
          </p></li><li class="listitem"><p>
            Using an already encrypted password string
          </p><p>
            The password is specified as a string literal. It must
            represent the already encrypted password value, in the hash
            format required by the authentication method used for the
            account.
</p></li></ul>
</div>
<p>
        The following table shows the permitted values of
        <a class="link" href="server-administration.html#sysvar_old_passwords"><code class="literal">old_passwords</code></a>, the password
        hashing method for each value, and which authentication plugins
        use passwords hashed with each method. These values are
        permitted as of MySQL 5.6.6. Before 5.6.6, the permitted values
        are 0 (or <code class="literal">OFF</code>) and 1 (or
        <code class="literal">ON</code>).
</p>
<div class="informaltable">
<table summary="The following table shows the permitted values of
          old_passwords, the password
          hashing method for each value, and which authentication
plugins use passwords hashed with each method." border="1"><colgroup><col><col><col></colgroup><thead><tr><th scope="col">Value</th><th scope="col">Password Hashing Method</th><th scope="col">Associated Authentication Plugin</th></tr></thead><tbody><tr><td scope="row">0</td><td>MySQL 4.1 native hashing</td><td><code class="literal">mysql_native_password</code></td></tr><tr><td scope="row">1</td><td>Pre-4.1 (<span class="quote">“<span class="quote">old</span>”</span>) hashing</td><td><code class="literal">mysql_old_password</code></td></tr><tr><td scope="row">2</td><td>SHA-256 hashing</td><td><code class="literal">sha256_password</code></td></tr></tbody></table>
</div>
<p>
        For more information about setting passwords, see
        <a class="xref" href="security.html#assigning-passwords" title="6.3.5 Assigning Account Passwords">Section 6.3.5, “Assigning Account Passwords”</a>
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          Under some circumstances, <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET
          PASSWORD</code></a> may be recorded in server logs or on the
          client side in a history file such as
          <code class="filename">~/.mysql_history</code>, which means that
          cleartext passwords may be read by anyone having read access
          to that information. For information about the conditions
          under which this occurs for the server logs and how to control
          it, see <a class="xref" href="security.html#password-logging" title="6.1.2.3 Passwords and Logging">Section 6.1.2.3, “Passwords and Logging”</a>. For similar
          information about client-side logging, see
          <a class="xref" href="programs.html#mysql-logging" title="4.5.1.3 mysql Logging">Section 4.5.1.3, “mysql Logging”</a>.
</p>
</div>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Caution
</div>
<p>
          If you are connecting to a MySQL 4.1 or later server using a
          pre-4.1 client program, do not change your password without
          first reading <a class="xref" href="security.html#password-hashing" title="6.1.2.4 Password Hashing in MySQL">Section 6.1.2.4, “Password Hashing in MySQL”</a>. The default
          password hashing format changed in MySQL 4.1, and if you
          change your password, it might be stored using a hashing
          format that pre-4.1 clients cannot generate, thus preventing
          you from connecting to the server afterward.
</p>
</div>
<p>
        If you are using MySQL Replication, be aware that, currently, a
        password used by a replication slave as part of a
        <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement is
        effectively limited to 32 characters in length; if the password
        is longer, any excess characters are truncated. This is not due
        to any limit imposed by the MySQL Server generally, but rather
        is an issue specific to MySQL Replication. (For more
        information, see Bug #43439.)
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="table-maintenance-sql"></a>13.7.2 Table Maintenance Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#analyze-table">13.7.2.1 ANALYZE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#check-table">13.7.2.2 CHECK TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#checksum-table">13.7.2.3 CHECKSUM TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#optimize-table">13.7.2.4 OPTIMIZE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#repair-table">13.7.2.5 REPAIR TABLE Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="analyze-table"></a>13.7.2.1 ANALYZE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143320592"></a><pre class="programlisting">
ANALYZE [NO_WRITE_TO_BINLOG | LOCAL] TABLE
    <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
</pre><p>
        <code class="literal">ANALYZE TABLE</code> analyzes and stores the key
        distribution for a table. During the analysis, the table is
        locked with a read lock for <code class="literal">InnoDB</code> and
        <code class="literal">MyISAM</code>. This statement works with
        <code class="literal">InnoDB</code>, <code class="literal">NDB</code>, and
        <code class="literal">MyISAM</code> tables. For <code class="literal">MyISAM</code>
        tables, this statement is equivalent to using <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk
        --analyze</strong></span></a>.
      </p><p>
        For more information on how the analysis works within
        <code class="literal">InnoDB</code>, see
        <a class="xref" href="innodb-storage-engine.html#innodb-persistent-stats" title="14.3.11.1 Configuring Persistent Optimizer Statistics Parameters">Section 14.3.11.1, “Configuring Persistent Optimizer Statistics Parameters”</a> and
        <a class="xref" href="innodb-storage-engine.html#innodb-analyze-table-complexity" title="14.3.11.3 Estimating ANALYZE TABLE Complexity for InnoDB Tables">Section 14.3.11.3, “Estimating ANALYZE TABLE Complexity for InnoDB Tables”</a>. Also see
        <a class="xref" href="innodb-storage-engine.html#innodb-restrictions" title="14.5.7 Limits on InnoDB Tables">Section 14.5.7, “Limits on InnoDB Tables”</a>. In particular, when you
        enable the
        <a class="link" href="innodb-storage-engine.html#sysvar_innodb_stats_persistent"><code class="literal">innodb_stats_persistent</code></a> option,
        you must run <code class="literal">ANALYZE TABLE</code> after loading
        substantial data into an <code class="literal">InnoDB</code> table, or
        creating a new index for one.
      </p><p>
        MySQL uses the stored key distribution to decide the order in
        which tables should be joined when you perform a join on
        something other than a constant. In addition, key distributions
        can be used when deciding which indexes to use for a specific
        table within a query.
      </p><p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        <code class="literal">ANALYZE TABLE</code> is supported for partitioned
        tables, and you can use <code class="literal">ALTER TABLE ... ANALYZE
        PARTITION</code> to analyze one or more partitions; for more
        information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>, and
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="19.3.4 Maintenance of Partitions">Section 19.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
      </p><p>
        <code class="literal">ANALYZE TABLE</code> returns a result set with the
        following columns.
</p>
<div class="informaltable">
<table summary="This table describes the columns of the
          ANALYZE TABLE result
          set." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Column</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">Table</code></td><td>The table name</td></tr><tr><td scope="row"><code class="literal">Op</code></td><td>Always <code class="literal">analyze</code></td></tr><tr><td scope="row"><code class="literal">Msg_type</code></td><td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
<code class="literal">warning</code></td></tr><tr><td scope="row"><code class="literal">Msg_text</code></td><td>An informational message</td></tr></tbody></table>
</div>
<p>
        You can check the stored key distribution with the
        <a class="link" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statement. See
        <a class="xref" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax">Section 13.7.5.23, “SHOW INDEX Syntax”</a>.
      </p><p>
        If the table has not changed since the last <code class="literal">ANALYZE
        TABLE</code> statement, the table is not analyzed again.
      </p><p>
        By default, the server writes <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
        TABLE</code></a> statements to the binary log so that they
        replicate to replication slaves. To suppress logging, specify
        the optional <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or
        its alias <code class="literal">LOCAL</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="check-table"></a>13.7.2.2 CHECK TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143266896"></a><pre class="programlisting">
CHECK TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... [<em class="replaceable"><code>option</code></em>] ...

<em class="replaceable"><code>option</code></em> = {
    FOR UPGRADE
  | QUICK
  | FAST
  | MEDIUM
  | EXTENDED
  | CHANGED
}
</pre><p>
        <code class="literal">CHECK TABLE</code> checks a table or tables for
        errors. <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> works for
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>,
        <a class="link" href="storage-engines.html#archive-storage-engine" title="15.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a>, and
        <a class="link" href="storage-engines.html#csv-storage-engine" title="15.4 The CSV Storage Engine"><code class="literal">CSV</code></a> tables. For
        <code class="literal">MyISAM</code> tables, the key statistics are updated
        as well.
      </p><p>
        To check a table, you must have some privilege for it.
      </p><p>
        <code class="literal">CHECK TABLE</code> can also check views for
        problems, such as tables that are referenced in the view
        definition that no longer exist.
      </p><p>
        <code class="literal">CHECK TABLE</code> is supported for partitioned
        tables, and you can use <code class="literal">ALTER TABLE ... CHECK
        PARTITION</code> to check one or more partitions; for more
        information, see <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>, and
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="19.3.4 Maintenance of Partitions">Section 19.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
<h5><a name="idm139737143244656"></a>Output</h5>
<p>
        <code class="literal">CHECK TABLE</code> returns a result set with the
        following columns.
</p>
<div class="informaltable">
<table summary="This table describes the columns of the
          CHECK TABLE result
          set." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Column</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">Table</code></td><td>The table name</td></tr><tr><td scope="row"><code class="literal">Op</code></td><td>Always <code class="literal">check</code></td></tr><tr><td scope="row"><code class="literal">Msg_type</code></td><td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
<code class="literal">warning</code></td></tr><tr><td scope="row"><code class="literal">Msg_text</code></td><td>An informational message</td></tr></tbody></table>
</div>
<p>
        The statement might produce many rows of information for each
        checked table. The last row has a <code class="literal">Msg_type</code>
        value of <code class="literal">status</code> and the
        <code class="literal">Msg_text</code> normally should be
        <code class="literal">OK</code>. If you don't get <code class="literal">OK</code>,
        or <code class="literal">Table is already up to date</code> you should or
        <code class="literal">Table is already up to date</code> for a
        <code class="literal">MyISAM</code> table, you should normally run a
        repair of the table. See
        <a class="xref" href="backup-and-recovery.html#myisam-table-maintenance" title="7.6 MyISAM Table Maintenance and Crash Recovery">Section 7.6, “MyISAM Table Maintenance and Crash Recovery”</a>. <code class="literal">Table is
        already up to date</code> means that the storage engine for
        the table indicated that there was no need to check the table.
</p>
<h5><a name="idm139737143218720"></a>Checking Version Compatibility</h5>
<p>
        The <code class="literal">FOR UPGRADE</code> option checks whether the
        named tables are compatible with the current version of MySQL.
        With <code class="literal">FOR UPGRADE</code>, the server checks each
        table to determine whether there have been any incompatible
        changes in any of the table's data types or indexes since the
        table was created. If not, the check succeeds. Otherwise, if
        there is a possible incompatibility, the server runs a full
        check on the table (which might take some time). If the full
        check succeeds, the server marks the table's
        <code class="filename">.frm</code> file with the current MySQL version
        number. Marking the <code class="filename">.frm</code> file ensures that
        further checks for the table with the same version of the server
        will be fast.
      </p><p>
        Incompatibilities might occur because the storage format for a
        data type has changed or because its sort order has changed. Our
        aim is to avoid these changes, but occasionally they are
        necessary to correct problems that would be worse than an
        incompatibility between releases.
      </p><p>
        Currently, <code class="literal">FOR UPGRADE</code> discovers these
        incompatibilities:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The indexing order for end-space in
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns for
            <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>
            tables changed between MySQL 4.1 and 5.0.
          </p></li><li class="listitem"><p>
            The storage method of the new
            <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> data type changed
            between MySQL 5.0.3 and 5.0.5.
          </p></li><li class="listitem"><p>
            If your table was created by a different version of the
            MySQL server than the one you are currently running,
            <code class="literal">FOR UPGRADE</code> indicates that the table has
            an <code class="filename">.frm</code> file with an incompatible
            version. In this case, the result set returned by
            <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> contains a line
            with a <code class="literal">Msg_type</code> value of
            <code class="literal">error</code> and a <code class="literal">Msg_text</code>
            value of <code class="literal">Table upgrade required. Please do "REPAIR
            TABLE `<em class="replaceable"><code>tbl_name</code></em>`" to fix
            it!</code>
          </p></li><li class="listitem"><p>
            Changes are sometimes made to character sets or collations
            that require table indexes to be rebuilt. For details about
            these changes and when <code class="literal">FOR UPGRADE</code>
            detects them, see
            <a class="xref" href="installing.html#checking-table-incompatibilities" title="2.11.3 Checking Whether Tables or Indexes Must Be Rebuilt">Section 2.11.3, “Checking Whether Tables or Indexes Must Be Rebuilt”</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> data type is
            deprecated as of MySQL 5.6.6. For tables containing
            <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> columns,
            <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> recommends
            <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>, which converts
            <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(2)</code></a> to
            <a class="link" href="data-types.html#year" title="11.3.3 The YEAR Type"><code class="literal">YEAR(4)</code></a>.
</p></li></ul>
</div>
<h5><a name="idm139737143188240"></a>Checking Data Consistency</h5>
<p>
        The following table shows the other check options that can be
        given. These options are passed to the storage engine, which may
        use them or not.
</p>
<div class="informaltable">
<table summary="This table describes other CHECK
          TABLE options." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Type</th><th scope="col">Meaning</th></tr></thead><tbody><tr><td scope="row"><code class="literal">QUICK</code></td><td>Do not scan the rows to check for incorrect links. Applies to
                <code class="literal">InnoDB</code> and <code class="literal">MyISAM</code>
                tables and views.</td></tr><tr><td scope="row"><code class="literal">FAST</code></td><td>Check only tables that have not been closed properly. Applies only to
                <code class="literal">MyISAM</code> tables and views; ignored for
                <code class="literal">InnoDB</code>.</td></tr><tr><td scope="row"><code class="literal">CHANGED</code></td><td>Check only tables that have been changed since the last check or that
                have not been closed properly. Applies only to
                <code class="literal">MyISAM</code> tables and views; ignored for
                <code class="literal">InnoDB</code>.</td></tr><tr><td scope="row"><code class="literal">MEDIUM</code></td><td>Scan rows to verify that deleted links are valid. This also calculates a
                key checksum for the rows and verifies this with a
                calculated checksum for the keys. Applies only to
                <code class="literal">MyISAM</code> tables and views; ignored for
                <code class="literal">InnoDB</code>.</td></tr><tr><td scope="row"><code class="literal">EXTENDED</code></td><td>Do a full key lookup for all keys for each row. This ensures that the
                table is 100% consistent, but takes a long time. Applies
                only to <code class="literal">MyISAM</code> tables and views;
ignored for <code class="literal">InnoDB</code>.</td></tr></tbody></table>
</div>
<p>
        If none of the options <code class="literal">QUICK</code>,
        <code class="literal">MEDIUM</code>, or <code class="literal">EXTENDED</code> are
        specified, the default check type for dynamic-format
        <code class="literal">MyISAM</code> tables is <code class="literal">MEDIUM</code>.
        This has the same result as running <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk
        --medium-check <em class="replaceable"><code>tbl_name</code></em></strong></span></a> on
        the table. The default check type also is
        <code class="literal">MEDIUM</code> for static-format
        <code class="literal">MyISAM</code> tables, unless
        <code class="literal">CHANGED</code> or <code class="literal">FAST</code> is
        specified. In that case, the default is
        <code class="literal">QUICK</code>. The row scan is skipped for
        <code class="literal">CHANGED</code> and <code class="literal">FAST</code> because
        the rows are very seldom corrupted.
      </p><p>
        You can combine check options, as in the following example that
        does a quick check on the table to determine whether it was
        closed properly:
      </p><pre class="programlisting">
CHECK TABLE test_table FAST QUICK;
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> may change the
          table if the table is marked as <span class="quote">“<span class="quote">corrupted</span>”</span> or
          <span class="quote">“<span class="quote">not closed properly</span>”</span> but
          <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> does not find any
          problems in the table. In this case,
          <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> marks the table as
          okay.
</p>
</div>
<p>
        If a table is corrupted, the problem is most likely in the
        indexes and not in the data part. All of the preceding check
        types check the indexes thoroughly and should thus find most
        errors.
      </p><p>
        If you just want to check a table that you assume is okay, you
        should use no check options or the <code class="literal">QUICK</code>
        option. The latter should be used when you are in a hurry and
        can take the very small risk that <code class="literal">QUICK</code> does
        not find an error in the data file. (In most cases, under normal
        usage, MySQL should find any error in the data file. If this
        happens, the table is marked as <span class="quote">“<span class="quote">corrupted</span>”</span> and
        cannot be used until it is repaired.)
      </p><p>
        <code class="literal">FAST</code> and <code class="literal">CHANGED</code> are
        mostly intended to be used from a script (for example, to be
        executed from <span class="command"><strong>cron</strong></span>) if you want to check
        tables from time to time. In most cases, <code class="literal">FAST</code>
        is to be preferred over <code class="literal">CHANGED</code>. (The only
        case when it is not preferred is when you suspect that you have
        found a bug in the <code class="literal">MyISAM</code> code.)
      </p><p>
        <code class="literal">EXTENDED</code> is to be used only after you have
        run a normal check but still get strange errors from a table
        when MySQL tries to update a row or find a row by key. This is
        very unlikely if a normal check has succeeded.
      </p><p>
        Use of <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE
        ... EXTENDED</code></a> might influence the execution plan
        generated by the query optimizer.
      </p><p>
        Some problems reported by <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK
        TABLE</code></a> cannot be corrected automatically:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Found row where the auto_increment column has the
            value 0</code>.
          </p><p>
            This means that you have a row in the table where the
            <code class="literal">AUTO_INCREMENT</code> index column contains the
            value 0. (It is possible to create a row where the
            <code class="literal">AUTO_INCREMENT</code> column is 0 by explicitly
            setting the column to 0 with an
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement.)
          </p><p>
            This is not an error in itself, but could cause trouble if
            you decide to dump the table and restore it or do an
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a> on the table. In
            this case, the <code class="literal">AUTO_INCREMENT</code> column
            changes value according to the rules of
            <code class="literal">AUTO_INCREMENT</code> columns, which could cause
            problems such as a duplicate-key error.
          </p><p>
            To get rid of the warning, execute an
            <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> statement to set the
            column to some value other than 0.
</p></li></ul>
</div>
<h5><a name="idm139737143123904"></a>InnoDB Details</h5>
<p>
        The following notes apply to <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>
        tables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> finds a
            problem for an <code class="literal">InnoDB</code> table, the server
            may shut down to prevent error propagation. Details of the
            error will be written to the error log.
          </p></li><li class="listitem"><p>
            If <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> encounters
            corruptions or errors in <code class="literal">InnoDB</code> tables or
            indexes, it reports an error. It does not shut down the
            server. Starting with MySQL 5.5, <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK
            TABLE</code></a> usually marks the index and sometimes marks
            the table as corrupted, preventing further use of the index
            or table.
          </p></li><li class="listitem"><p>
            If <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> finds the
            wrong number of entries in a secondary index, it will report
            an error but will not shut down the server or prevent access
            to the file.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE</code></a> surveys the index
            page structure, then surveys each key entry. It does not
            validate the key pointer to a clustered record or follow the
            path for <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> pointers.
          </p></li><li class="listitem"><p>
            When an <code class="literal">InnoDB</code> table is stored in its own
            <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd file</a> in
            <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
            mode, the first 3 <a class="link" href="glossary.html#glos_page" title="page">pages</a> of
            the <code class="literal">.ibd</code> contain header information
            rather than table or index data. The <code class="literal">CHECK
            TABLE</code> statement does not detect inconsistencies
            that affect only the header data. To verify the entire
            contents of an <code class="literal">InnoDB</code>
            <code class="literal">.ibd</code> file, use the
            <a class="link" href="programs.html#innochecksum" title="4.6.1 innochecksum — Offline InnoDB File Checksum Utility"><span class="command"><strong>innochecksum</strong></span></a> command.
          </p></li><li class="listitem"><p>
            When running <code class="literal">CHECK TABLE</code> on large
            <code class="literal">InnoDB</code> tables, other threads may be
            blocked during <code class="literal">CHECK TABLE</code> execution. To
            avoid timeouts, the semaphore wait threshold (600 seconds)
            is extended by 2 hours (7200 seconds) for <code class="literal">CHECK
            TABLE</code> operations. If <code class="literal">InnoDB</code>
            detects semaphore waits of 240 seconds or more it starts
            printing <code class="literal">InnoDB</code> monitor output to the
            error log. If a lock request extends beyond the semaphore
            wait threshold, <code class="literal">InnoDB</code> will abort the
            process. To avoid the possibility of a semaphore wait
            timeout entirely, you can run <code class="literal">CHECK TABLE
            QUICK</code> instead of <code class="literal">CHECK TABLE</code>.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="checksum-table"></a>13.7.2.3 CHECKSUM TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143091088"></a><pre class="programlisting">
CHECKSUM TABLE <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ... [ QUICK | EXTENDED ]
</pre><p>
        <a class="link" href="sql-syntax.html#checksum-table" title="13.7.2.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> reports a
        <a class="link" href="glossary.html#glos_checksum" title="checksum">checksum</a> for the contents
        of a table. During the checksum operation, the table is locked
        with a read lock for <code class="literal">InnoDB</code> and
        <code class="literal">MyISAM</code>. You can use this statement to verify
        that the contents are the same before and after a backup,
        rollback, or other operation that is intended to put the data
        back to a known state. This statement requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the table.
</p>
<h5><a name="idm139737143080224"></a>Performance Considerations</h5>
<p>
        By default, the entire table is read row by row and the checksum
        is calculated. For large tables, this could take a long time,
        thus you would only perform this operation occasionally. This
        row-by-row calculation is what you get with the
        <code class="literal">EXTENDED</code> clause, with
        <code class="literal">InnoDB</code> and all other storage engines other
        than <code class="literal">MyISAM</code>, and with
        <code class="literal">MyISAM</code> tables not created with the
        <code class="literal">CHECKSUM=1</code> clause.
      </p><p>
        For <code class="literal">MyISAM</code> tables created with the
        <code class="literal">CHECKSUM=1</code> clause, <code class="literal">CHECKSUM
        TABLE</code> or <code class="literal">CHECKSUM TABLE ... QUICK</code>
        returns the <span class="quote">“<span class="quote">live</span>”</span> table checksum that can be
        returned very fast. If the table does not meet all these
        conditions, the <code class="literal">QUICK</code> method returns
        <code class="literal">NULL</code>. See <a class="xref" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax">Section 13.1.17, “CREATE TABLE Syntax”</a> for
        the syntax of the <code class="literal">CHECKSUM</code> clause.
      </p><p>
        For a nonexistent table, <a class="link" href="sql-syntax.html#checksum-table" title="13.7.2.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM
        TABLE</code></a> returns <code class="literal">NULL</code> and generates a
        warning.
      </p><p>
        Prior to MySQL 5.6.4, <a class="link" href="sql-syntax.html#checksum-table" title="13.7.2.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM
        TABLE</code></a> returned 0 for partitioned tables unless the
        <code class="literal">EXTENDED</code> option was used. (Bug #11933226, Bug
        #60681)
      </p><p>
        The checksum value depends on the table row format. If the row
        format changes, the checksum also changes. For example, the
        storage format for <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>
        changed between MySQL 4.1 and 5.0, so if a 4.1 table is upgraded
        to MySQL 5.0, the checksum value may change.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          If the checksums for two tables are different, then it is
          almost certain that the tables are different in some way.
          However, because the hashing function used by
          <a class="link" href="sql-syntax.html#checksum-table" title="13.7.2.3 CHECKSUM TABLE Syntax"><code class="literal">CHECKSUM TABLE</code></a> is not
          guaranteed to be collision-free, there is a slight chance that
          two tables which are not identical can produce the same
          checksum.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="optimize-table"></a>13.7.2.4 OPTIMIZE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737143057584"></a><a class="indexterm" name="idm139737143056512"></a><a class="indexterm" name="idm139737143055024"></a><pre class="programlisting">
OPTIMIZE [NO_WRITE_TO_BINLOG | LOCAL] TABLE
    <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
</pre><p>
        Reorganizes the physical storage of table data and associated
        index data, to reduce storage space and improve I/O efficiency
        when accessing the table. The exact changes made to each table
        depend on the <a class="link" href="glossary.html#glos_storage_engine" title="storage engine">storage
        engine</a> used by that table.
      </p><p>
        Use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> in these
        cases, depending on the type of table:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            After doing substantial insert, update, or delete operations
            on an <code class="literal">InnoDB</code> table that has its own
            <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd file</a> because it
            was created with the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
            option enabled. The table and indexes are reorganized, and
            disk space can be reclaimed for use by the operating system.
          </p></li><li class="listitem"><p>
            After doing substantial insert, update, or delete operations
            on columns that are part of a <code class="literal">FULLTEXT</code>
            index in an <code class="literal">InnoDB</code> table. Set the
            configuration option
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_optimize_fulltext_only"><code class="literal">innodb_optimize_fulltext_only=1</code></a>
            first. To keep the index maintenance period to a reasonable
            time, set the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_ft_num_word_optimize"><code class="literal">innodb_ft_num_word_optimize</code></a>
            option to specify how many words to update in the search
            index, and run a sequence of <code class="literal">OPTIMIZE
            TABLE</code> statements until the search index is fully
            updated.
          </p></li><li class="listitem"><p>
            After deleting a large part of a <code class="literal">MyISAM</code>
            or <code class="literal">ARCHIVE</code> table, or making many changes
            to a <code class="literal">MyISAM</code> or <code class="literal">ARCHIVE
            </code>table with variable-length rows (tables that have
            <a class="link" href="data-types.html#char" title="11.4.1 The CHAR and VARCHAR Types"><code class="literal">VARCHAR</code></a>,
            <a class="link" href="data-types.html#binary-varbinary" title="11.4.2 The BINARY and VARBINARY Types"><code class="literal">VARBINARY</code></a>,
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>, or
            <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">TEXT</code></a> columns). Deleted rows
            are maintained in a linked list and subsequent
            <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a> operations reuse old
            row positions. You can use <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
            TABLE</code></a> to reclaim the unused space and to
            defragment the data file. After extensive changes to a
            table, this statement may also improve performance of
            statements that use the table, sometimes significantly.
</p></li></ul>
</div>
<p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is also supported
        for partitioned tables. For information about using this
        statement with partitioned tables and table partitions, see
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="19.3.4 Maintenance of Partitions">Section 19.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> works for
        <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a>,
        <a class="link" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine"><code class="literal">MyISAM</code></a>, and
        <a class="link" href="storage-engines.html#archive-storage-engine" title="15.5 The ARCHIVE Storage Engine"><code class="literal">ARCHIVE</code></a> tables.
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is also supported
        for dynamic columns of in-memory
        <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables. It does not work for
        Disk Data tables. The performance of <code class="literal">OPTIMIZE</code>
        on Cluster tables can be tuned by adjusting the value of the
        <code class="literal">ndb_optimization_delay</code> system variable, which
        controls the number of milliseconds to wait between processing
        batches of rows by <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a>. For more information, see
        <a class="xref" href="mysql-cluster.html#mysql-cluster-limitations-resolved" title="18.1.6.11 Previous MySQL Cluster Issues Resolved in MySQL Cluster NDB 7.3">Section 18.1.6.11, “Previous MySQL Cluster Issues Resolved in MySQL Cluster NDB 7.3”</a>.
      </p><p>
        For MySQL Cluster tables, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> can be interrupted by (for example) killing the
        SQL thread performing the <code class="literal">OPTIMIZE</code> operation.
      </p><p>
        By default, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> does
        <span class="emphasis"><em>not</em></span> work for tables created using any other
        storage engine and returns a result indicating this lack of
        support. You can make <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> work for other storage engines by starting
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with the <code class="option">--skip-new</code>
        option. In this case, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> is just mapped to <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a>.
</p>
<h5><a name="idm139737142994112"></a>InnoDB Details</h5>
<p>
        For <code class="literal">InnoDB</code> tables,
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is mapped to
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        FORCE</code></a>, which rebuilds the table to update index
        statistics and free unused space in the clustered index. This is
        displayed in the output of <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> when you run it on an <code class="literal">InnoDB</code>
        table, as shown here:
      </p><pre class="programlisting">
mysql&gt; OPTIMIZE TABLE foo;
+----------+----------+----------+-------------------------------------------------------------------+
| Table    | Op       | Msg_type | Msg_text                                                          |
+----------+----------+----------+-------------------------------------------------------------------+
| test.foo | optimize | note     | Table does not support optimize, doing recreate + analyze instead |
| test.foo | optimize | status   | OK                                                                |
+----------+----------+----------+-------------------------------------------------------------------+
</pre><p>
        Prior to Mysql 5.6.17, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> does not use
        <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">online DDL</a>
        (<code class="literal">ALGORITHM=INPLACE</code>). Consequently, concurrent
        DML (<a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>,
        <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>) is not permitted on a
        table while <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is
        running, i.e. the table is locked. Also, secondary indexes are
        not created as efficiently because keys are inserted in the
        order they appeared in the primary key.
      </p><p>
        As of 5.6.17, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> uses
        <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">online DDL</a>
        (<code class="literal">ALGORITHM=INPLACE</code>) for both regular and
        partitioned <code class="literal">InnoDB</code> tables. The table rebuild,
        triggered by <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> and
        performed under the cover by
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE ...
        FORCE</code></a>, is now performed using
        <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">online DDL</a>
        (<code class="literal">ALGORITHM=INPLACE</code>) and only locks the table
        for a brief interval, which reduces downtime for concurrent DML
        operations.
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> continues to use
        <code class="literal">ALGORITHM=COPY</code> under the following
        conditions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            When the <a class="link" href="server-administration.html#sysvar_old_alter_table"><code class="literal">old_alter_table</code></a>
            system variable is turned ON.
          </p></li><li class="listitem"><p>
            When the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
            <code class="literal">--skip-new</code> option is enabled.
</p></li></ul>
</div>
<p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> using
        <a class="link" href="innodb-storage-engine.html#innodb-online-ddl" title="14.10 InnoDB and Online DDL">online DDL</a>
        (<code class="literal">ALGORITHM=INPLACE</code>) is not supported for
        <code class="literal">InnoDB</code> tables that contain
        <code class="literal">FULLTEXT</code> indexes.
        <code class="literal">ALGORITHM=COPY</code> must be used instead.
      </p><p>
        <code class="literal">InnoDB</code> stores data using a page-allocation
        method and does not suffer from fragmentation in the same way
        that legacy storage engines (such as <code class="literal">MyISAM</code>)
        will. When considering whether or not to run optimize, consider
        the workload of transactions that your server will process:

</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Some level of fragmentation is expected.
              <code class="literal">InnoDB</code> only fills
              <a class="link" href="glossary.html#glos_page" title="page">pages</a> 93% full, to leave
              room for updates without having to split pages.
            </p></li><li class="listitem"><p>
              Delete operations might leave gaps that leave pages less
              filled than desired, which could make it worthwhile to
              optimize the table.
            </p></li><li class="listitem"><p>
              Updates to rows usually rewrite the data within the same
              page, depending on the data type and row format, when
              sufficient space is available. See
              <a class="xref" href="innodb-storage-engine.html#innodb-compression-internals" title="14.6.5 How Compression Works for InnoDB Tables">Section 14.6.5, “How Compression Works for InnoDB Tables”</a> and
              <a class="xref" href="innodb-storage-engine.html#innodb-row-format-overview" title="14.8.1 Overview of InnoDB Row Storage">Section 14.8.1, “Overview of InnoDB Row Storage”</a>.
            </p></li><li class="listitem"><p>
              High-concurrency workloads might leave gaps in indexes
              over time, as <code class="literal">InnoDB</code> retains multiple
              versions of the same data due through its
              <a class="link" href="glossary.html#glos_mvcc" title="MVCC">MVCC</a> mechanism. See
              <a class="xref" href="innodb-storage-engine.html#innodb-multi-versioning" title="14.2.3 InnoDB Multi-Versioning">Section 14.2.3, “InnoDB Multi-Versioning”</a>.
</p></li></ul>
</div>
<p>
</p>
<h5><a name="idm139737142943968"></a>MyISAM Details</h5>
<p>
        For <code class="literal">MyISAM</code> tables,
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> works as follows:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
            If the table has deleted or split rows, repair the table.
          </p></li><li class="listitem"><p>
            If the index pages are not sorted, sort them.
          </p></li><li class="listitem"><p>
            If the table's statistics are not up to date (and the repair
            could not be accomplished by sorting the index), update
            them.
</p></li></ol>
</div>
<h5><a name="idm139737142937296"></a>Other Considerations</h5>
<p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> returns a result
        set with the following columns.
</p>
<div class="informaltable">
<table summary="This table describes columns of the
          OPTIMIZE TABLE result
          set." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Column</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">Table</code></td><td>The table name</td></tr><tr><td scope="row"><code class="literal">Op</code></td><td>Always <code class="literal">optimize</code></td></tr><tr><td scope="row"><code class="literal">Msg_type</code></td><td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
<code class="literal">warning</code></td></tr><tr><td scope="row"><code class="literal">Msg_text</code></td><td>An informational message</td></tr></tbody></table>
</div>
<p>
        For <code class="literal">InnoDB</code> tables prior to 5.6.17 and other
        table types, MySQL <a class="link" href="glossary.html#glos_table_lock" title="table lock">locks the
        table</a> during the time <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> is running. As of MySQL 5.6.17,
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> is performed
        online for regular and partitioned <code class="literal">InnoDB</code>
        tables.
      </p><p>
        By default, the server writes <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE
        TABLE</code></a> statements to the binary log so that they
        replicate to replication slaves. To suppress logging, specify
        the optional <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or
        its alias <code class="literal">LOCAL</code>.
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> does not sort
        R-tree indexes, such as spatial indexes on
        <code class="literal">POINT</code> columns. (Bug #23578)
      </p><p>
        <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> table catches and
        throws any errors that occur while copying table statistics from
        the old file to the newly created file. For example. if the user
        ID of the owner of the <code class="filename">.frm</code>,
        <code class="filename">.MYD</code>, or <code class="filename">.MYI</code> file is
        different from the user ID of the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
        process, <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> generates
        a "cannot change ownership of the file" error unless
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is started by the
        <code class="literal">root</code> user.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="repair-table"></a>13.7.2.5 REPAIR TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142898032"></a><pre class="programlisting">
REPAIR [NO_WRITE_TO_BINLOG | LOCAL] TABLE
    <em class="replaceable"><code>tbl_name</code></em> [, <em class="replaceable"><code>tbl_name</code></em>] ...
    [QUICK] [EXTENDED] [USE_FRM]
</pre><p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> repairs a possibly
        corrupted table, for certain storage engines only. By default,
        it has the same effect as <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --recover
        <em class="replaceable"><code>tbl_name</code></em></strong></span></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> only applies to
          <code class="literal">MyISAM</code>, <code class="literal">ARCHIVE</code>, and
          <code class="literal">CSV</code> tables. See
          <a class="xref" href="storage-engines.html#myisam-storage-engine" title="15.2 The MyISAM Storage Engine">Section 15.2, “The MyISAM Storage Engine”</a>, and
          <a class="xref" href="storage-engines.html#archive-storage-engine" title="15.5 The ARCHIVE Storage Engine">Section 15.5, “The ARCHIVE Storage Engine”</a>, and
          <a class="xref" href="storage-engines.html#csv-storage-engine" title="15.4 The CSV Storage Engine">Section 15.4, “The CSV Storage Engine”</a>
</p>
</div>
<p>
        This statement requires <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a>
        and <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privileges for the
        table.
      </p><p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> is supported for
        partitioned tables. However, the <code class="literal">USE_FRM</code>
        option cannot be used with this statement on a partitioned
        table.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
      </p><p>
        You can use <code class="literal">ALTER TABLE ... REPAIR PARTITION</code>
        to repair one or more partitions; for more information, see
        <a class="xref" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax">Section 13.1.7, “ALTER TABLE Syntax”</a>, and
        <a class="xref" href="partitioning.html#partitioning-maintenance" title="19.3.4 Maintenance of Partitions">Section 19.3.4, “Maintenance of Partitions”</a>.
      </p><p>
        Although normally you should never have to run
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>, if disaster
        strikes, this statement is very likely to get back all your data
        from a <code class="literal">MyISAM</code> table. If your tables become
        corrupted often, try to find the reason for it, to eliminate the
        need to use <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a>. See
        <a class="xref" href="error-handling.html#crashing" title="B.5.4.2 What to Do If MySQL Keeps Crashing">Section B.5.4.2, “What to Do If MySQL Keeps Crashing”</a>, and
        <a class="xref" href="storage-engines.html#myisam-table-problems" title="15.2.4 MyISAM Table Problems">Section 15.2.4, “MyISAM Table Problems”</a>.
</p>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Caution
</div>
<p>
          Make a backup of a table before performing a table repair
          operation; under some circumstances the operation might cause
          data loss. Possible causes include but are not limited to file
          system errors. See <a class="xref" href="backup-and-recovery.html" title="Chapter 7 Backup and Recovery">Chapter 7, <i>Backup and Recovery</i></a>.
</p>
</div>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Warning
</div>
<p>
          If the server crashes during a <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
          TABLE</code></a> operation, it is essential after restarting it
          that you immediately execute another
          <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> statement for the
          table before performing any other operations on it. In the
          worst case, you might have a new clean index file without
          information about the data file, and then the next operation
          you perform could overwrite the data file. This is an unlikely
          but possible scenario that underscores the value of making a
          backup first.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> returns a result set
        with the following columns.
</p>
<div class="informaltable">
<table summary="This table describes columns of the
          REPAIR TABLE result
          set." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Column</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">Table</code></td><td>The table name</td></tr><tr><td scope="row"><code class="literal">Op</code></td><td>Always <code class="literal">repair</code></td></tr><tr><td scope="row"><code class="literal">Msg_type</code></td><td><code class="literal">status</code>, <code class="literal">error</code>,
                <code class="literal">info</code>, <code class="literal">note</code>, or
<code class="literal">warning</code></td></tr><tr><td scope="row"><code class="literal">Msg_text</code></td><td>An informational message</td></tr></tbody></table>
</div>
<p>
        The <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> statement might
        produce many rows of information for each repaired table. The
        last row has a <code class="literal">Msg_type</code> value of
        <code class="literal">status</code> and <code class="literal">Msg_test</code>
        normally should be <code class="literal">OK</code>. If you do not get
        <code class="literal">OK</code> for a <code class="literal">MyISAM</code> table, you
        should try repairing it with <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk
        --safe-recover</strong></span></a>. (<a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
        TABLE</code></a> does not implement all the options of
        <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a>.) With <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk
        --safe-recover</strong></span></a>, you can also use options that
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> does not support,
        such as <a class="link" href="programs.html#option_myisamchk_max-record-length"><code class="option">--max-record-length</code></a>.
      </p><p>
        If you use the <code class="literal">QUICK</code> option,
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> tries to repair only
        the index file, and not the data file. This type of repair is
        like that done by <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --recover
        --quick</strong></span></a>.
      </p><p>
        If you use the <code class="literal">EXTENDED</code> option, MySQL creates
        the index row by row instead of creating one index at a time
        with sorting. This type of repair is like that done by
        <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk --safe-recover</strong></span></a>.
      </p><p>
        The <code class="literal">USE_FRM</code> option is available for use if
        the <code class="filename">.MYI</code> index file is missing or if its
        header is corrupted. This option tells MySQL not to trust the
        information in the <code class="filename">.MYI</code> file header and to
        re-create it using information from the
        <code class="filename">.frm</code> file. This kind of repair cannot be
        done with <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk</strong></span></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Use the <code class="literal">USE_FRM</code> option
          <span class="emphasis"><em>only</em></span> if you cannot use regular
          <code class="literal">REPAIR</code> modes! Telling the server to ignore
          the <code class="filename">.MYI</code> file makes important table
          metadata stored in the <code class="filename">.MYI</code> unavailable
          to the repair process, which can have deleterious
          consequences:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              The current <code class="literal">AUTO_INCREMENT</code> value is
              lost.
            </p></li><li class="listitem"><p>
              The link to deleted records in the table is lost, which
              means that free space for deleted records will remain
              unoccupied thereafter.
            </p></li><li class="listitem"><p>
              The <code class="filename">.MYI</code> header indicates whether the
              table is compressed. If the server ignores this
              information, it cannot tell that a table is compressed and
              repair can cause change or loss of table contents. This
              means that <code class="literal">USE_FRM</code> should not be used
              with compressed tables. That should not be necessary,
              anyway: Compressed tables are read only, so they should
              not become corrupt.
</p></li></ul>
</div>

</div>
<div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Caution
</div>
<p>
          If you use <code class="literal">USE_FRM</code> for a table that was
          created by a different version of the MySQL server than the
          one you are currently running, <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
          TABLE</code></a> will not attempt to repair the table. In this
          case, the result set returned by <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
          TABLE</code></a> contains a line with a
          <code class="literal">Msg_type</code> value of <code class="literal">error</code>
          and a <code class="literal">Msg_text</code> value of <code class="literal">Failed
          repairing incompatible .FRM file</code>.
</p>
</div>
<p>
        If <code class="literal">USE_FRM</code> is <span class="emphasis"><em>not</em></span> used,
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> checks the table to
        see whether an upgrade is required. If so, it performs the
        upgrade, following the same rules as
        <a class="link" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax"><code class="literal">CHECK TABLE ... FOR
        UPGRADE</code></a>. See <a class="xref" href="sql-syntax.html#check-table" title="13.7.2.2 CHECK TABLE Syntax">Section 13.7.2.2, “CHECK TABLE Syntax”</a>, for more
        information. <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> without
        <code class="literal">USE_FRM</code> upgrades the
        <code class="filename">.frm</code> file to the current version.
      </p><a class="indexterm" name="idm139737142794880"></a><a class="indexterm" name="idm139737142793376"></a><p>
        By default, the server writes <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
        TABLE</code></a> statements to the binary log so that they
        replicate to replication slaves. To suppress logging, specify
        the optional <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or
        its alias <code class="literal">LOCAL</code>.
</p>
<div class="important" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Important
</div>
<p>
          In the event that a table on the master becomes corrupted and
          you run <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> on it, any
          resulting changes to the original table are
          <span class="emphasis"><em>not</em></span> propagated to slaves.
</p>
</div>
<p>
        You may be able to increase <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR
        TABLE</code></a> performance by setting certain system variables.
        See <a class="xref" href="optimization.html#repair-table-speed" title="8.6.3 Speed of REPAIR TABLE Statements">Section 8.6.3, “Speed of REPAIR TABLE Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> table catches and
        throws any errors that occur while copying table statistics from
        the old corrupted file to the newly created file. For example.
        if the user ID of the owner of the <code class="filename">.frm</code>,
        <code class="filename">.MYD</code>, or <code class="filename">.MYI</code> file is
        different from the user ID of the <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a>
        process, <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> generates a
        "cannot change ownership of the file" error unless
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> is started by the
        <code class="literal">root</code> user.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="plugin-sql"></a>13.7.3 Plugin and User-Defined Function Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#create-function-udf">13.7.3.1 CREATE FUNCTION Syntax for User-Defined Functions</a></span></dt><dt><span class="section"><a href="sql-syntax.html#drop-function-udf">13.7.3.2 DROP FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#install-plugin">13.7.3.3 INSTALL PLUGIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#uninstall-plugin">13.7.3.4 UNINSTALL PLUGIN Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="create-function-udf"></a>13.7.3.1 CREATE FUNCTION Syntax for User-Defined Functions</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142771664"></a><a class="indexterm" name="idm139737142770592"></a><a class="indexterm" name="idm139737142769104"></a><a class="indexterm" name="idm139737142767616"></a><a class="indexterm" name="idm139737142766544"></a><a class="indexterm" name="idm139737142765472"></a><pre class="programlisting">
CREATE [AGGREGATE] FUNCTION <em class="replaceable"><code>function_name</code></em> RETURNS {STRING|INTEGER|REAL|DECIMAL}
    SONAME <em class="replaceable"><code>shared_library_name</code></em>
</pre><p>
        A user-defined function (UDF) is a way to extend MySQL with a
        new function that works like a native (built-in) MySQL function
        such as <a class="link" href="functions.html#function_abs"><code class="literal">ABS()</code></a> or
        <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a>.
      </p><p>
        <em class="replaceable"><code>function_name</code></em> is the name that should
        be used in SQL statements to invoke the function. The
        <code class="literal">RETURNS</code> clause indicates the type of the
        function's return value. <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a>
        is a legal value after <code class="literal">RETURNS</code>, but currently
        <a class="link" href="data-types.html#fixed-point-types" title="11.2.2 Fixed-Point Types (Exact Value) - DECIMAL, NUMERIC"><code class="literal">DECIMAL</code></a> functions return string
        values and should be written like <code class="literal">STRING</code>
        functions.
      </p><p>
        <em class="replaceable"><code>shared_library_name</code></em> is the basename
        of the shared object file that contains the code that implements
        the function. The file must be located in the plugin directory.
        This directory is given by the value of the
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable. For
        more information, see <a class="xref" href="extending-mysql.html#udf-compiling" title="24.3.2.5 Compiling and Installing User-Defined Functions">Section 24.3.2.5, “Compiling and Installing User-Defined Functions”</a>.
      </p><p>
        To create a function, you must have the
        <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql</code> database. This is necessary because
        <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> adds a row to the
        <code class="literal">mysql.func</code> system table that records the
        function's name, type, and shared library name. If you do not
        have this table, you should run the
        <a class="link" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables"><span class="command"><strong>mysql_upgrade</strong></span></a> command to create it. See
        <a class="xref" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables">Section 4.4.7, “<span class="command"><strong>mysql_upgrade</strong></span> — Check and Upgrade MySQL Tables”</a>.
      </p><p>
        An active function is one that has been loaded with
        <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> and not removed
        with <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>. All active
        functions are reloaded each time the server starts, unless you
        start <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> with the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option. In
        this case, UDF initialization is skipped and UDFs are
        unavailable.
      </p><p>
        For instructions on writing user-defined functions, see
        <a class="xref" href="extending-mysql.html#adding-udf" title="24.3.2 Adding a New User-Defined Function">Section 24.3.2, “Adding a New User-Defined Function”</a>. For the UDF mechanism to work,
        functions must be written in C or C++ (or another language that
        can use C calling conventions), your operating system must
        support dynamic loading and you must have compiled
        <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> dynamically (not statically).
      </p><p>
        An <code class="literal">AGGREGATE</code> function works exactly like a
        native MySQL aggregate (summary) function such as
        <code class="literal">SUM</code> or
        <a class="link" href="functions.html#function_count"><code class="literal">COUNT()</code></a>. For
        <code class="literal">AGGREGATE</code> to work, your
        <code class="literal">mysql.func</code> table must contain a
        <code class="literal">type</code> column. If your
        <code class="literal">mysql.func</code> table does not have this column,
        you should run the <a class="link" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables"><span class="command"><strong>mysql_upgrade</strong></span></a> program to
        create it (see <a class="xref" href="programs.html#mysql-upgrade" title="4.4.7 mysql_upgrade — Check and Upgrade MySQL Tables">Section 4.4.7, “<span class="command"><strong>mysql_upgrade</strong></span> — Check and Upgrade MySQL Tables”</a>).
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          To upgrade the shared library associated with a UDF, issue a
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement,
          upgrade the shared library, and then issue a
          <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement. If
          you upgrade the shared library first and then use
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>, the server may
          crash.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="drop-function-udf"></a>13.7.3.2 DROP FUNCTION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142718320"></a><a class="indexterm" name="idm139737142717248"></a><a class="indexterm" name="idm139737142715760"></a><a class="indexterm" name="idm139737142714272"></a><a class="indexterm" name="idm139737142713200"></a><a class="indexterm" name="idm139737142712128"></a><pre class="programlisting">
DROP FUNCTION <em class="replaceable"><code>function_name</code></em>
</pre><p>
        This statement drops the user-defined function (UDF) named
        <em class="replaceable"><code>function_name</code></em>.
      </p><p>
        To drop a function, you must have the
        <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql</code> database. This is because
        <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> removes a row from
        the <code class="literal">mysql.func</code> system table that records the
        function's name, type, and shared library name.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          To upgrade the shared library associated with a UDF, issue a
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> statement,
          upgrade the shared library, and then issue a
          <a class="link" href="sql-syntax.html#create-function" title="13.1.12 CREATE FUNCTION Syntax"><code class="literal">CREATE FUNCTION</code></a> statement. If
          you upgrade the shared library first and then use
          <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a>, the server may
          crash.
</p>
</div>
<p>
        <a class="link" href="sql-syntax.html#drop-function" title="13.1.23 DROP FUNCTION Syntax"><code class="literal">DROP FUNCTION</code></a> is also used to
        drop stored functions (see <a class="xref" href="sql-syntax.html#drop-procedure" title="13.1.26 DROP PROCEDURE and DROP FUNCTION Syntax">Section 13.1.26, “DROP PROCEDURE and DROP FUNCTION Syntax”</a>).
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="install-plugin"></a>13.7.3.3 INSTALL PLUGIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142691440"></a><a class="indexterm" name="idm139737142690368"></a><a class="indexterm" name="idm139737142689296"></a><pre class="programlisting">
INSTALL PLUGIN <em class="replaceable"><code>plugin_name</code></em> SONAME '<em class="replaceable"><code>shared_library_name</code></em>'
</pre><p>
        This statement installs a server plugin. It requires the
        <a class="link" href="security.html#priv_insert"><code class="literal">INSERT</code></a> privilege for the
        <code class="literal">mysql.plugin</code> table.
      </p><p>
        <em class="replaceable"><code>plugin_name</code></em> is the name of the plugin
        as defined in the plugin descriptor structure contained in the
        library file (see <a class="xref" href="extending-mysql.html#plugin-data-structures" title="24.2.4.2 Plugin Data Structures">Section 24.2.4.2, “Plugin Data Structures”</a>).
        Plugin names are not case sensitive. For maximal compatibility,
        plugin names should be limited to ASCII letters, digits, and
        underscore because they are used in C source files, shell
        command lines, M4 and Bourne shell scripts, and SQL
        environments.
      </p><p>
        <em class="replaceable"><code>shared_library_name</code></em> is the name of
        the shared library that contains the plugin code. The name
        includes the file name extension (for example,
        <code class="filename">libmyplugin.so</code>,
        <code class="filename">libmyplugin.dll</code>, or
        <code class="filename">libmyplugin.dylib</code>).
      </p><p>
        The shared library must be located in the plugin directory (the
        directory named by the
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> system variable).
        The library must be in the plugin directory itself, not in a
        subdirectory. By default,
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> is the
        <code class="filename">plugin</code> directory under the directory named
        by the <code class="literal">pkglibdir</code> configuration variable, but
        it can be changed by setting the value of
        <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> at server startup.
        For example, set its value in a <code class="filename">my.cnf</code>
        file:
      </p><pre class="programlisting">
[mysqld]
plugin_dir=<em class="replaceable"><code>/path/to/plugin/directory</code></em>
</pre><p>
        If the value of <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a> is a
        relative path name, it is taken to be relative to the MySQL base
        directory (the value of the
        <a class="link" href="server-administration.html#sysvar_basedir"><code class="literal">basedir</code></a> system variable).
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> loads and
        initializes the plugin code to make the plugin available for
        use. A plugin is initialized by executing its initialization
        function, which handles any setup that the plugin must perform
        before it can be used. When the server shuts down, it executes
        the deinitialization function for each plugin that is loaded so
        that the plugin has a chance to perform any final cleanup.
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> also registers the
        plugin by adding a line that indicates the plugin name and
        library file name to the <code class="literal">mysql.plugin</code> table.
        At server startup, the server loads and initializes any plugin
        that is listed in the <code class="literal">mysql.plugin</code> table.
        This means that a plugin is installed with
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> only once, not
        every time the server starts. Plugin loading at startup does not
        occur if the server is started with the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option.
      </p><p>
        A plugin library can contain multiple plugins. For each of them
        to be installed, use a separate <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
        PLUGIN</code></a> statement. Each statement names a different
        plugin, but all of them specify the same library name.
      </p><p>
        <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> causes the server
        to read option (<code class="filename">my.cnf</code>) files just as
        during server startup. This enables the plugin to pick up any
        relevant options from those files. It is possible to add plugin
        options to an option file even before loading a plugin (if the
        <code class="literal">loose</code> prefix is used). It is also possible to
        uninstall a plugin, edit <code class="filename">my.cnf</code>, and
        install the plugin again. Restarting the plugin this way enables
        it to the new option values without a server restart.
      </p><p>
        For options that control individual plugin loading at server
        startup, see <a class="xref" href="server-administration.html#server-plugin-loading" title="5.1.8.1 Installing and Uninstalling Plugins">Section 5.1.8.1, “Installing and Uninstalling Plugins”</a>. If you
        need to load plugins for a single server startup when the
        <a class="link" href="server-administration.html#option_mysqld_skip-grant-tables"><code class="option">--skip-grant-tables</code></a> option is
        given (which tells the server not to read system tables), use
        the <a class="link" href="server-administration.html#option_mysqld_plugin-load"><code class="option">--plugin-load</code></a> option. See
        <a class="xref" href="server-administration.html#server-options" title="5.1.3 Server Command Options">Section 5.1.3, “Server Command Options”</a>.
      </p><p>
        To remove a plugin, use the <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
        PLUGIN</code></a> statement.
      </p><p>
        For additional information about plugin loading, see
        <a class="xref" href="server-administration.html#server-plugin-loading" title="5.1.8.1 Installing and Uninstalling Plugins">Section 5.1.8.1, “Installing and Uninstalling Plugins”</a>.
      </p><p>
        To see what plugins are installed, use the
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.5.26 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> statement or query
        the <a class="link" href="information-schema.html#plugins-table" title="21.14 The INFORMATION_SCHEMA PLUGINS Table"><code class="literal">INFORMATION_SCHEMA.PLUGINS</code></a>
        table.
      </p><p>
        If you recompile a plugin library and need to reinstall it, you
        can use either of the following methods:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Use <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> to
            uninstall all plugins in the library, install the new plugin
            library file in the plugin directory, and then use
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> to install all
            plugins in the library. This procedure has the advantage
            that it can be used without stopping the server. However, if
            the plugin library contains many plugins, you must issue
            many <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> statements.
          </p></li><li class="listitem"><p>
            Stop the server, install the new plugin library file in the
            plugin directory, and restart the server.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="uninstall-plugin"></a>13.7.3.4 UNINSTALL PLUGIN Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142631616"></a><a class="indexterm" name="idm139737142630544"></a><a class="indexterm" name="idm139737142629472"></a><pre class="programlisting">
UNINSTALL PLUGIN <em class="replaceable"><code>plugin_name</code></em>
</pre><p>
        This statement removes an installed server plugin. It requires
        the <a class="link" href="security.html#priv_delete"><code class="literal">DELETE</code></a> privilege for the
        <code class="literal">mysql.plugin</code> table.
      </p><p>
        <em class="replaceable"><code>plugin_name</code></em> must be the name of some
        plugin that is listed in the <code class="literal">mysql.plugin</code>
        table. The server executes the plugin's deinitialization
        function and removes the row for the plugin from the
        <code class="literal">mysql.plugin</code> table, so that subsequent server
        restarts will not load and initialize the plugin.
        <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> does not remove
        the plugin's shared library file.
      </p><p>
        You cannot uninstall a plugin if any table that uses it is open.
      </p><p>
        Plugin removal has implications for the use of associated
        tables. For example, if a full-text parser plugin is associated
        with a <code class="literal">FULLTEXT</code> index on the table,
        uninstalling the plugin makes the table unusable. Any attempt to
        access the table results in an error. The table cannot even be
        opened, so you cannot drop an index for which the plugin is
        used. This means that uninstalling a plugin is something to do
        with care unless you do not care about the table contents. If
        you are uninstalling a plugin with no intention of reinstalling
        it later and you care about the table contents, you should dump
        the table with <a class="link" href="programs.html#mysqldump" title="4.5.4 mysqldump — A Database Backup Program"><span class="command"><strong>mysqldump</strong></span></a> and remove the
        <code class="literal">WITH PARSER</code> clause from the dumped
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement so that
        you can reload the table later. If you do not care about the
        table, <a class="link" href="sql-syntax.html#drop-table" title="13.1.28 DROP TABLE Syntax"><code class="literal">DROP TABLE</code></a> can be used
        even if any plugins associated with the table are missing.
      </p><p>
        For additional information about plugin loading, see
        <a class="xref" href="server-administration.html#server-plugin-loading" title="5.1.8.1 Installing and Uninstalling Plugins">Section 5.1.8.1, “Installing and Uninstalling Plugins”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="set-statement"></a>13.7.4 SET Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142607648"></a><pre class="programlisting">
SET <em class="replaceable"><code>variable_assignment</code></em> [, <em class="replaceable"><code>variable_assignment</code></em>] ...

<em class="replaceable"><code>variable_assignment</code></em>:
      <em class="replaceable"><code>user_var_name</code></em> = <em class="replaceable"><code>expr</code></em>
    | [GLOBAL | SESSION] <em class="replaceable"><code>system_var_name</code></em> = <em class="replaceable"><code>expr</code></em>
    | [@@global. | @@session. | @@]<em class="replaceable"><code>system_var_name</code></em> = <em class="replaceable"><code>expr</code></em>
</pre><p>
      The <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      statement assigns values to different types of variables that
      affect the operation of the server or your client.
    </p><p>
      This section describes use of
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a> for
      assigning values to variables. The
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      statement can be used to assign values to these types of
      variables:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          System variables. See
          <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>. System variables
          also can be set at server startup, as described in
          <a class="xref" href="server-administration.html#using-system-variables" title="5.1.5 Using System Variables">Section 5.1.5, “Using System Variables”</a>.
        </p><p>
          User-defined variables. See <a class="xref" href="language-structure.html#user-variables" title="9.4 User-Defined Variables">Section 9.4, “User-Defined Variables”</a>.
        </p></li><li class="listitem"><p>
          Stored procedure and function parameters, and stored program
          local variables. See
          <a class="xref" href="sql-syntax.html#stored-program-variables" title="13.6.4 Variables in Stored Programs">Section 13.6.4, “Variables in Stored Programs”</a>.
</p></li></ul>
</div>
<p>
      Some variants of
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      syntax are used in other contexts:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <code class="literal">SET CHARACTER SET</code> and <code class="literal">SET
          NAMES</code> assign values to character set and collation
          variables associated with the connection to the server.
          <code class="literal">SET ONE_SHOT</code> is used for replication. These
          variants are described later in this section.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax"><code class="literal">SET PASSWORD</code></a> assigns account
          passwords. See <a class="xref" href="sql-syntax.html#set-password" title="13.7.1.7 SET PASSWORD Syntax">Section 13.7.1.7, “SET PASSWORD Syntax”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax"><code class="literal">SET
          TRANSACTION ISOLATION LEVEL</code></a> sets the isolation level
          for transaction processing. See
          <a class="xref" href="sql-syntax.html#set-transaction" title="13.3.6 SET TRANSACTION Syntax">Section 13.3.6, “SET TRANSACTION Syntax”</a>.
</p></li></ul>
</div>
<p>
      The following discussion shows the different
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      syntaxes that you can use to set variables. The examples use the
      <a class="link" href="functions.html#operator_assign-equal"><code class="literal">=</code></a> assignment
      operator, but you can also use the
      <a class="link" href="functions.html#operator_assign-value"><code class="literal">:=</code></a>
      assignment operator for this purpose.
    </p><p>
      A user variable is written as
      <code class="literal">@<em class="replaceable"><code>var_name</code></em></code> and can be
      set as follows:
    </p><pre class="programlisting">
SET @<em class="replaceable"><code>var_name</code></em> = <em class="replaceable"><code>expr</code></em>;
</pre><p>
      Many system variables are dynamic and can be changed while the
      server runs by using the
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      statement. For a list, see
      <a class="xref" href="server-administration.html#dynamic-system-variables" title="5.1.5.2 Dynamic System Variables">Section 5.1.5.2, “Dynamic System Variables”</a>. To change a system
      variable with
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>,
      refer to it as <em class="replaceable"><code>var_name</code></em>, optionally
      preceded by a modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          To indicate explicitly that a variable is a global variable,
          precede its name by <code class="literal">GLOBAL</code> or
          <code class="literal">@@global.</code>. The
          <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege is required to
          set global variables.
        </p></li><li class="listitem"><p>
          To indicate explicitly that a variable is a session variable,
          precede its name by <code class="literal">SESSION</code>,
          <code class="literal">@@session.</code>, or <code class="literal">@@</code>.
          Setting a session variable normally requires no special
          privilege, although there are exceptions (such as
          <a class="link" href="server-administration.html#sysvar_sql_log_bin"><code class="literal">sql_log_bin</code></a>.) A client can
          change its own session variables, but not those of any other
          client.
        </p></li><li class="listitem"><p>
          <code class="literal">LOCAL</code> and <code class="literal">@@local.</code> are
          synonyms for <code class="literal">SESSION</code> and
          <code class="literal">@@session.</code>.
        </p></li><li class="listitem"><p>
          If no modifier is present,
          <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
          changes the session variable.
</p></li></ul>
</div>
<p>
      A <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      statement can contain multiple variable assignments, separated by
      commas. For example, the statement can assign values to a
      user-defined variable and a system variable. If you set several
      system variables, the most recent <code class="literal">GLOBAL</code> or
      <code class="literal">SESSION</code> modifier in the statement is used for
      following variables that have no modifier specified.
    </p><p>
      Examples:
    </p><pre class="programlisting">
SET sort_buffer_size=10000;
SET @@local.sort_buffer_size=10000;
SET GLOBAL sort_buffer_size=1000000, SESSION sort_buffer_size=1000000;
SET @@sort_buffer_size=1000000;
SET @@global.sort_buffer_size=1000000, @@local.sort_buffer_size=1000000;
</pre><p>
      The <code class="literal">@@<em class="replaceable"><code>var_name</code></em></code>
      syntax for system variables is supported for compatibility with
      some other database systems.
    </p><p>
      If you change a session system variable, the value remains in
      effect until your session ends or until you change the variable to
      a different value. The change is not visible to other clients.
    </p><p>
      If you change a global system variable, the value is remembered
      and used for new connections until the server restarts. (To make a
      global system variable setting permanent, you should set it in an
      option file.) The change is visible to any client that accesses
      that global variable. However, the change affects the
      corresponding session variable only for clients that connect after
      the change. The global variable change does not affect the session
      variable for any client that is currently connected (not even that
      of the client that issues the
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET
      GLOBAL</code></a> statement).
    </p><p>
      To prevent incorrect usage, MySQL produces an error if you use
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET
      GLOBAL</code></a> with a variable that can only be used with
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET
      SESSION</code></a> or if you do not specify
      <code class="literal">GLOBAL</code> (or <code class="literal">@@global.</code>) when
      setting a global variable.
    </p><p>
      To set a <code class="literal">SESSION</code> variable to the
      <code class="literal">GLOBAL</code> value or a <code class="literal">GLOBAL</code>
      value to the compiled-in MySQL default value, use the
      <code class="literal">DEFAULT</code> keyword. For example, the following two
      statements are identical in setting the session value of
      <a class="link" href="server-administration.html#sysvar_max_join_size"><code class="literal">max_join_size</code></a> to the global
      value:
    </p><pre class="programlisting">
SET max_join_size=DEFAULT;
SET @@session.max_join_size=@@global.max_join_size;
</pre><p>
      Not all system variables can be set to <code class="literal">DEFAULT</code>.
      In such cases, use of <code class="literal">DEFAULT</code> results in an
      error.
    </p><p>
      It is not permitted to assign the value <code class="literal">DEFAULT</code>
      to user-defined variables, stored procedure or function
      parameters, or stored program local variables. This results in a
      syntax error for user-defined variables, and also for parameters
      or local variables as of MySQL 5.6.6.
    </p><p>
      You can refer to the values of specific global or session system
      variables in expressions by using one of the
      <code class="literal">@@</code>-modifiers. For example, you can retrieve
      values in a <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement like
      this:
    </p><pre class="programlisting">
SELECT @@global.sql_mode, @@session.sql_mode, @@sql_mode;
</pre><p>
      When you refer to a system variable in an expression as
      <code class="literal">@@<em class="replaceable"><code>var_name</code></em></code> (that is,
      when you do not specify <code class="literal">@@global.</code> or
      <code class="literal">@@session.</code>), MySQL returns the session value if
      it exists and the global value otherwise. (This differs from
      <code class="literal">SET @@<em class="replaceable"><code>var_name</code></em> =
      <em class="replaceable"><code>value</code></em></code>, which always refers to
      the session value.)
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        Some variables displayed by <code class="literal">SHOW VARIABLES</code>
        may not be available using <code class="literal">SELECT
        @@<em class="replaceable"><code>var_name</code></em></code> syntax; an
        <code class="literal">Unknown system variable</code> occurs. As a
        workaround in such cases, you can use <code class="literal">SHOW VARIABLES
        LIKE '<em class="replaceable"><code>var_name</code></em>'</code>.
</p>
</div>
<p>
      Suffixes for specifying a value multiplier can be used when
      setting a variable at server startup, but not to set the value
      with <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      at runtime. On the other hand, with
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a> you
      can assign a variable's value using an expression, which is not
      true when you set a variable at server startup. For example, the
      first of the following lines is legal at server startup, but the
      second is not:
    </p><pre class="programlisting">
shell&gt; <strong class="userinput"><code>mysql --max_allowed_packet=16M</code></strong>
shell&gt; <strong class="userinput"><code>mysql --max_allowed_packet=16*1024*1024</code></strong>
</pre><p>
      Conversely, the second of the following lines is legal at runtime,
      but the first is not:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET GLOBAL max_allowed_packet=16M;</code></strong>
mysql&gt; <strong class="userinput"><code>SET GLOBAL max_allowed_packet=16*1024*1024;</code></strong>
</pre><p>
      To display system variables names and values, use the
      <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> statement. (See
      <a class="xref" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax">Section 13.7.5.40, “SHOW VARIABLES Syntax”</a>.)
    </p><p>
      The following list describes
      <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
      options that have nonstandard syntax (that is, options that are
      not set with <code class="literal"><em class="replaceable"><code>name</code></em> =
      <em class="replaceable"><code>value</code></em></code> syntax).
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          <a class="indexterm" name="idm139737142501920"></a>

          <code class="literal">CHARACTER SET
          {<em class="replaceable"><code>charset_name</code></em> | DEFAULT}</code>
        </p><p>
          This maps all strings from and to the client with the given
          mapping. You can add new mappings by editing
          <code class="filename">sql/convert.cc</code> in the MySQL source
          distribution. <code class="literal">SET CHARACTER SET</code> sets three
          session system variables:
          <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> and
          <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> are set
          to the given character set, and
          <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to
          the value of
          <a class="link" href="server-administration.html#sysvar_character_set_database"><code class="literal">character_set_database</code></a>. See
          <a class="xref" href="globalization.html#charset-connection" title="10.1.4 Connection Character Sets and Collations">Section 10.1.4, “Connection Character Sets and Collations”</a>.
        </p><p>
          The default mapping can be restored by using the value
          <code class="literal">DEFAULT</code>. The default depends on the server
          configuration.
        </p><p>
          <code class="literal">ucs2</code>, <code class="literal">utf16</code>, and
          <code class="literal">utf32</code> cannot be used as a client character
          set, which means that they do not work for <code class="literal">SET
          CHARACTER SET</code>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737142486096"></a>

          <code class="literal">NAMES {'<em class="replaceable"><code>charset_name</code></em>'
          [COLLATE '<em class="replaceable"><code>collation_name</code></em>'] |
          DEFAULT}</code>
        </p><p>
          <code class="literal">SET NAMES</code> sets the three session system
          variables
          <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>,
          <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a>, and
          <a class="link" href="server-administration.html#sysvar_character_set_results"><code class="literal">character_set_results</code></a> to the
          given character set. Setting
          <a class="link" href="server-administration.html#sysvar_character_set_connection"><code class="literal">character_set_connection</code></a> to
          <code class="literal">charset_name</code> also sets
          <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> to the
          default collation for <code class="literal">charset_name</code>. The
          optional <code class="literal">COLLATE</code> clause may be used to
          specify a collation explicitly. See
          <a class="xref" href="globalization.html#charset-connection" title="10.1.4 Connection Character Sets and Collations">Section 10.1.4, “Connection Character Sets and Collations”</a>.
        </p><p>
          The default mapping can be restored by using a value of
          <code class="literal">DEFAULT</code>. The default depends on the server
          configuration.
        </p><p>
          <code class="literal">ucs2</code>, <code class="literal">utf16</code>, and
          <code class="literal">utf32</code> cannot be used as a client character
          set, which means that they do not work for <code class="literal">SET
          NAMES</code>.
        </p></li><li class="listitem"><p>
          <a class="indexterm" name="idm139737142467232"></a>

          <code class="literal">ONE_SHOT</code>
        </p><p>
          <code class="literal">ONE_SHOT</code> is for internal use only, has been
          deprecated since MySQL 5.0, and was removed in MySQL 5.6.1.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="show"></a>13.7.5 SHOW Syntax</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#show-authors">13.7.5.1 SHOW AUTHORS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-binary-logs">13.7.5.2 SHOW BINARY LOGS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-binlog-events">13.7.5.3 SHOW BINLOG EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-character-set">13.7.5.4 SHOW CHARACTER SET Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-collation">13.7.5.5 SHOW COLLATION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-columns">13.7.5.6 SHOW COLUMNS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-contributors">13.7.5.7 SHOW CONTRIBUTORS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-database">13.7.5.8 SHOW CREATE DATABASE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-event">13.7.5.9 SHOW CREATE EVENT Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-function">13.7.5.10 SHOW CREATE FUNCTION Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-procedure">13.7.5.11 SHOW CREATE PROCEDURE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-table">13.7.5.12 SHOW CREATE TABLE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-trigger">13.7.5.13 SHOW CREATE TRIGGER Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-create-view">13.7.5.14 SHOW CREATE VIEW Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-databases">13.7.5.15 SHOW DATABASES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-engine">13.7.5.16 SHOW ENGINE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-engines">13.7.5.17 SHOW ENGINES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-errors">13.7.5.18 SHOW ERRORS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-events">13.7.5.19 SHOW EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-function-code">13.7.5.20 SHOW FUNCTION CODE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-function-status">13.7.5.21 SHOW FUNCTION STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-grants">13.7.5.22 SHOW GRANTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-index">13.7.5.23 SHOW INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-master-status">13.7.5.24 SHOW MASTER STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-open-tables">13.7.5.25 SHOW OPEN TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-plugins">13.7.5.26 SHOW PLUGINS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-privileges">13.7.5.27 SHOW PRIVILEGES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-procedure-code">13.7.5.28 SHOW PROCEDURE CODE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-procedure-status">13.7.5.29 SHOW PROCEDURE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-processlist">13.7.5.30 SHOW PROCESSLIST Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-profile">13.7.5.31 SHOW PROFILE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-profiles">13.7.5.32 SHOW PROFILES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-relaylog-events">13.7.5.33 SHOW RELAYLOG EVENTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-slave-hosts">13.7.5.34 SHOW SLAVE HOSTS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-slave-status">13.7.5.35 SHOW SLAVE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-status">13.7.5.36 SHOW STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-table-status">13.7.5.37 SHOW TABLE STATUS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-tables">13.7.5.38 SHOW TABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-triggers">13.7.5.39 SHOW TRIGGERS Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-variables">13.7.5.40 SHOW VARIABLES Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#show-warnings">13.7.5.41 SHOW WARNINGS Syntax</a></span></dt></dl>
</div>
<a class="indexterm" name="idm139737142461840"></a><a class="indexterm" name="idm139737142459024"></a><a class="indexterm" name="idm139737142457536"></a><a class="indexterm" name="idm139737142456464"></a><a class="indexterm" name="idm139737142455392"></a><a class="indexterm" name="idm139737142454320"></a><a class="indexterm" name="idm139737142453248"></a><a class="indexterm" name="idm139737142452176"></a><a class="indexterm" name="idm139737142451104"></a><a class="indexterm" name="idm139737142450032"></a><a class="indexterm" name="idm139737142448960"></a><a class="indexterm" name="idm139737142447888"></a><a class="indexterm" name="idm139737142446816"></a><a class="indexterm" name="idm139737142445744"></a><a class="indexterm" name="idm139737142444672"></a><a class="indexterm" name="idm139737142443600"></a><a class="indexterm" name="idm139737142442528"></a><a class="indexterm" name="idm139737142441456"></a><a class="indexterm" name="idm139737142440384"></a><a class="indexterm" name="idm139737142439312"></a><a class="indexterm" name="idm139737142438240"></a><a class="indexterm" name="idm139737142437168"></a><a class="indexterm" name="idm139737142436096"></a><a class="indexterm" name="idm139737142435024"></a><a class="indexterm" name="idm139737142433952"></a><a class="indexterm" name="idm139737142432880"></a><a class="indexterm" name="idm139737142431808"></a><a class="indexterm" name="idm139737142430736"></a><a class="indexterm" name="idm139737142429664"></a><a class="indexterm" name="idm139737142428592"></a><a class="indexterm" name="idm139737142427520"></a><a class="indexterm" name="idm139737142426448"></a><a class="indexterm" name="idm139737142425376"></a><a class="indexterm" name="idm139737142424304"></a><a class="indexterm" name="idm139737142423232"></a><a class="indexterm" name="idm139737142422160"></a><a class="indexterm" name="idm139737142421088"></a><a class="indexterm" name="idm139737142420016"></a><a class="indexterm" name="idm139737142418944"></a><a class="indexterm" name="idm139737142417872"></a><a class="indexterm" name="idm139737142416800"></a><a class="indexterm" name="idm139737142415728"></a><a class="indexterm" name="idm139737142414656"></a><a class="indexterm" name="idm139737142413584"></a><a class="indexterm" name="idm139737142412512"></a><a class="indexterm" name="idm139737142411440"></a><p>
      <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> has many forms that provide
      information about databases, tables, columns, or status
      information about the server. This section describes those
      following:
    </p><pre class="programlisting">
SHOW AUTHORS
SHOW {BINARY | MASTER} LOGS
SHOW BINLOG EVENTS [IN '<em class="replaceable"><code>log_name</code></em>'] [FROM <em class="replaceable"><code>pos</code></em>] [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW CHARACTER SET [<em class="replaceable"><code>like_or_where</code></em>]
SHOW COLLATION [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [FULL] COLUMNS FROM <em class="replaceable"><code>tbl_name</code></em> [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW CONTRIBUTORS
SHOW CREATE DATABASE <em class="replaceable"><code>db_name</code></em>
SHOW CREATE EVENT <em class="replaceable"><code>event_name</code></em>
SHOW CREATE FUNCTION <em class="replaceable"><code>func_name</code></em>
SHOW CREATE PROCEDURE <em class="replaceable"><code>proc_name</code></em>
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>
SHOW CREATE TRIGGER <em class="replaceable"><code>trigger_name</code></em>
SHOW CREATE VIEW <em class="replaceable"><code>view_name</code></em>
SHOW DATABASES [<em class="replaceable"><code>like_or_where</code></em>]
SHOW ENGINE <em class="replaceable"><code>engine_name</code></em> {STATUS | MUTEX}
SHOW [STORAGE] ENGINES
SHOW ERRORS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW EVENTS
SHOW FUNCTION CODE <em class="replaceable"><code>func_name</code></em>
SHOW FUNCTION STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW GRANTS FOR <em class="replaceable"><code>user</code></em>
SHOW INDEX FROM <em class="replaceable"><code>tbl_name</code></em> [FROM <em class="replaceable"><code>db_name</code></em>]
SHOW MASTER STATUS
SHOW OPEN TABLES [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW PLUGINS
SHOW PROCEDURE CODE <em class="replaceable"><code>proc_name</code></em>
SHOW PROCEDURE STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW PRIVILEGES
SHOW [FULL] PROCESSLIST
SHOW PROFILE [<em class="replaceable"><code>types</code></em>] [FOR QUERY <em class="replaceable"><code>n</code></em>] [OFFSET <em class="replaceable"><code>n</code></em>] [LIMIT <em class="replaceable"><code>n</code></em>]
SHOW PROFILES
SHOW SLAVE HOSTS
SHOW SLAVE STATUS
SHOW [GLOBAL | SESSION] STATUS [<em class="replaceable"><code>like_or_where</code></em>]
SHOW TABLE STATUS [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [FULL] TABLES [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW TRIGGERS [FROM <em class="replaceable"><code>db_name</code></em>] [<em class="replaceable"><code>like_or_where</code></em>]
SHOW [GLOBAL | SESSION] VARIABLES [<em class="replaceable"><code>like_or_where</code></em>]
SHOW WARNINGS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]

<em class="replaceable"><code>like_or_where</code></em>:
    LIKE '<em class="replaceable"><code>pattern</code></em>'
  | WHERE <em class="replaceable"><code>expr</code></em>
</pre><p>
      If the syntax for a given <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a>
      statement includes a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE
      '<em class="replaceable"><code>pattern</code></em>'</code></a> part,
      <code class="literal">'<em class="replaceable"><code>pattern</code></em>'</code> is a
      string that can contain the SQL
      <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span> and
      <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span> wildcard characters. The
      pattern is useful for restricting statement output to matching
      values.
    </p><p>
      Several <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> statements also accept
      a <code class="literal">WHERE</code> clause that provides more flexibility
      in specifying which rows to display. See
      <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
    </p><p>
      Many MySQL APIs (such as PHP) enable you to treat the result
      returned from a <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a> statement as
      you would a result set from a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>; see
      <a class="xref" href="connectors-apis.html" title="Chapter 23 Connectors and APIs">Chapter 23, <i>Connectors and APIs</i></a>, or your API documentation for
      more information. In addition, you can work in SQL with results
      from queries on tables in the
      <code class="literal">INFORMATION_SCHEMA</code> database, which you cannot
      easily do with results from <a class="link" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax"><code class="literal">SHOW</code></a>
      statements. See <a class="xref" href="information-schema.html" title="Chapter 21 INFORMATION_SCHEMA Tables">Chapter 21, <i>INFORMATION_SCHEMA Tables</i></a>.
</p>
<div class="section">

<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-authors"></a>13.7.5.1 SHOW AUTHORS Syntax</h4>
</div>
</div>
</div>
<a class="indexterm" name="idm139737142367344"></a><pre class="programlisting">
SHOW AUTHORS
</pre><p>
        The <a class="link" href="sql-syntax.html#show-authors" title="13.7.5.1 SHOW AUTHORS Syntax"><code class="literal">SHOW AUTHORS</code></a> statement
        displays information about the people who work on MySQL. For
        each author, it displays <code class="literal">Name</code>,
        <code class="literal">Location</code>, and <code class="literal">Comment</code>
        values.
      </p><p>
        This statement is removed as of MySQL 5.6.8.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-binary-logs"></a>13.7.5.2 SHOW BINARY LOGS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142356768"></a><a class="indexterm" name="idm139737142355696"></a><pre class="programlisting">
SHOW BINARY LOGS
SHOW MASTER LOGS
</pre><p>
        Lists the binary log files on the server. This statement is used
        as part of the procedure described in
        <a class="xref" href="sql-syntax.html#purge-binary-logs" title="13.4.1.1 PURGE BINARY LOGS Syntax">Section 13.4.1.1, “PURGE BINARY LOGS Syntax”</a>, that shows how to determine
        which logs can be purged.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW BINARY LOGS;</code></strong>
+---------------+-----------+
| Log_name      | File_size |
+---------------+-----------+
| binlog.000015 |    724935 |
| binlog.000016 |    733481 |
+---------------+-----------+
</pre><p>
        <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.5.2 SHOW BINARY LOGS Syntax"><code class="literal">SHOW MASTER
        LOGS</code></a> is equivalent to <a class="link" href="sql-syntax.html#show-binary-logs" title="13.7.5.2 SHOW BINARY LOGS Syntax"><code class="literal">SHOW BINARY
        LOGS</code></a>.
      </p><p>
        In MySQL 5.6.5 and earlier, the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege was required to
        use this statement. Starting with MySQL 5.6.6, a user with the
        <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a> privilege may
        also execute this statement.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-binlog-events"></a>13.7.5.3 SHOW BINLOG EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142340800"></a><pre class="programlisting">
SHOW BINLOG EVENTS
   [IN '<em class="replaceable"><code>log_name</code></em>'] [FROM <em class="replaceable"><code>pos</code></em>] [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
</pre><p>
        Shows the events in the binary log. If you do not specify
        <code class="literal">'<em class="replaceable"><code>log_name</code></em>'</code>, the
        first binary log is displayed.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Issuing a <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>
          with no <code class="literal">LIMIT</code> clause could start a very
          time- and resource-consuming process because the server
          returns to the client the complete contents of the binary log
          (which includes all statements executed by the server that
          modify data). As an alternative to <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW
          BINLOG EVENTS</code></a>, use the
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a> utility to save the binary log
          to a text file for later examination and analysis. See
          <a class="xref" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files">Section 4.6.8, “<span class="command"><strong>mysqlbinlog</strong></span> — Utility for Processing Binary Log Files”</a>.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          Some events relating to the setting of user and system
          variables are not included in the output from
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a>. To get
          complete coverage of events within a binary log, use
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>.
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#show-binlog-events" title="13.7.5.3 SHOW BINLOG EVENTS Syntax"><code class="literal">SHOW BINLOG EVENTS</code></a> does
          <span class="emphasis"><em>not</em></span> work with relay log files. You can
          use <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.5.33 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a> for
          this purpose.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-character-set"></a>13.7.5.4 SHOW CHARACTER SET Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142314880"></a><pre class="programlisting">
SHOW CHARACTER SET
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        The <a class="link" href="sql-syntax.html#show-character-set" title="13.7.5.4 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER SET</code></a> statement
        shows all available character sets. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which character set names to match. The <code class="literal">WHERE</code>
        clause can be given to select rows using more general
        conditions, as discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>. For
        example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CHARACTER SET LIKE 'latin%';</code></strong>
+---------+-----------------------------+-------------------+--------+
| Charset | Description                 | Default collation | Maxlen |
+---------+-----------------------------+-------------------+--------+
| latin1  | cp1252 West European        | latin1_swedish_ci |      1 |
| latin2  | ISO 8859-2 Central European | latin2_general_ci |      1 |
| latin5  | ISO 8859-9 Turkish          | latin5_turkish_ci |      1 |
| latin7  | ISO 8859-13 Baltic          | latin7_general_ci |      1 |
+---------+-----------------------------+-------------------+--------+
</pre><p>
        The <code class="literal">Maxlen</code> column shows the maximum number of
        bytes required to store one character.
      </p><p>
        The <code class="literal">filename</code> character set is for internal
        use only; consequently, <a class="link" href="sql-syntax.html#show-character-set" title="13.7.5.4 SHOW CHARACTER SET Syntax"><code class="literal">SHOW CHARACTER
        SET</code></a> does not display it.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-collation"></a>13.7.5.5 SHOW COLLATION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142297824"></a><pre class="programlisting">
SHOW COLLATION
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement lists collations supported by the server. By
        default, the output from <a class="link" href="sql-syntax.html#show-collation" title="13.7.5.5 SHOW COLLATION Syntax"><code class="literal">SHOW
        COLLATION</code></a> includes all available collations. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which collation names to match. The <code class="literal">WHERE</code>
        clause can be given to select rows using more general
        conditions, as discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>. For
        example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLLATION LIKE 'latin1%';</code></strong>
+-------------------+---------+----+---------+----------+---------+
| Collation         | Charset | Id | Default | Compiled | Sortlen |
+-------------------+---------+----+---------+----------+---------+
| latin1_german1_ci | latin1  |  5 |         |          |       0 |
| latin1_swedish_ci | latin1  |  8 | Yes     | Yes      |       0 |
| latin1_danish_ci  | latin1  | 15 |         |          |       0 |
| latin1_german2_ci | latin1  | 31 |         | Yes      |       2 |
| latin1_bin        | latin1  | 47 |         | Yes      |       0 |
| latin1_general_ci | latin1  | 48 |         |          |       0 |
| latin1_general_cs | latin1  | 49 |         |          |       0 |
| latin1_spanish_ci | latin1  | 94 |         |          |       0 |
+-------------------+---------+----+---------+----------+---------+
</pre><p>
        The <code class="literal">Collation</code> and <code class="literal">Charset</code>
        columns indicate the names of the collation and the character
        set with which it is associated. <code class="literal">Id</code> is the
        collation ID. <code class="literal">Default</code> indicates whether the
        collation is the default for its character set.
        <code class="literal">Compiled</code> indicates whether the character set
        is compiled into the server. <code class="literal">Sortlen</code> is
        related to the amount of memory required to sort strings
        expressed in the character set.
      </p><p>
        To see the default collation for each character set, use the
        following statement. <code class="literal">Default</code> is a reserved
        word, so to use it as an identifier, it must be quoted as such:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLLATION WHERE `Default` = 'Yes';</code></strong>
+---------------------+----------+----+---------+----------+---------+
| Collation           | Charset  | Id | Default | Compiled | Sortlen |
+---------------------+----------+----+---------+----------+---------+
| big5_chinese_ci     | big5     |  1 | Yes     | Yes      |       1 |
| dec8_swedish_ci     | dec8     |  3 | Yes     | Yes      |       1 |
| cp850_general_ci    | cp850    |  4 | Yes     | Yes      |       1 |
| hp8_english_ci      | hp8      |  6 | Yes     | Yes      |       1 |
| koi8r_general_ci    | koi8r    |  7 | Yes     | Yes      |       1 |
| latin1_swedish_ci   | latin1   |  8 | Yes     | Yes      |       1 |
...
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-columns"></a>13.7.5.6 SHOW COLUMNS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142275712"></a><a class="indexterm" name="idm139737142272896"></a><pre class="programlisting">
SHOW [FULL] COLUMNS {FROM | IN} <em class="replaceable"><code>tbl_name</code></em> [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays information
        about the columns in a given table. It also works for views. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which column names to match. The <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays information
        only for those columns for which you have some privilege.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLUMNS FROM City;</code></strong>
+------------+----------+------+-----+---------+----------------+
| Field      | Type     | Null | Key | Default | Extra          |
+------------+----------+------+-----+---------+----------------+
| Id         | int(11)  | NO   | PRI | NULL    | auto_increment |
| Name       | char(35) | NO   |     |         |                |
| Country    | char(3)  | NO   | UNI |         |                |
| District   | char(20) | YES  | MUL |         |                |
| Population | int(11)  | NO   |     | 0       |                |
+------------+----------+------+-----+---------+----------------+
5 rows in set (0.00 sec)
</pre><p>
        If the data types differ from what you expect them to be based
        on a <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement, note
        that MySQL sometimes changes data types when you create or alter
        a table. The conditions under which this occurs are described in
        <a class="xref" href="sql-syntax.html#silent-column-changes" title="13.1.17.4 Silent Column Specification Changes">Section 13.1.17.4, “Silent Column Specification Changes”</a>.
      </p><p>
        The <code class="literal">FULL</code> keyword causes the output to include
        the column collation and comments, as well as the privileges you
        have for each column.
      </p><p>
        You can use <em class="replaceable"><code>db_name.tbl_name</code></em> as an
        alternative to the <code class="literal"><em class="replaceable"><code>tbl_name</code></em>
        FROM <em class="replaceable"><code>db_name</code></em></code> syntax. In
        other words, these two statements are equivalent:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW COLUMNS FROM mytable FROM mydb;</code></strong>
mysql&gt; <strong class="userinput"><code>SHOW COLUMNS FROM mydb.mytable;</code></strong>
</pre><p>
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> displays the
        following values for each table column:
      </p><p>
        <code class="literal">Field</code> indicates the column name.
      </p><p>
        <code class="literal">Type</code> indicates the column data type.
      </p><p>
        <code class="literal">Collation</code> indicates the collation for
        nonbinary string columns, or <code class="literal">NULL</code> for other
        columns. This value is displayed only if you use the
        <code class="literal">FULL</code> keyword.
      </p><p>
        The <code class="literal">Null</code> field contains
        <code class="literal">YES</code> if <code class="literal">NULL</code> values can be
        stored in the column, <code class="literal">NO</code> if not.
      </p><p>
        The <code class="literal">Key</code> field indicates whether the column is
        indexed:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            If <code class="literal">Key</code> is empty, the column either is not
            indexed or is indexed only as a secondary column in a
            multiple-column, nonunique index.
          </p></li><li class="listitem"><p>
            If <code class="literal">Key</code> is <code class="literal">PRI</code>, the
            column is a <code class="literal">PRIMARY KEY</code> or is one of the
            columns in a multiple-column <code class="literal">PRIMARY KEY</code>.
          </p></li><li class="listitem"><p>
            If <code class="literal">Key</code> is <code class="literal">UNI</code>, the
            column is the first column of a <code class="literal">UNIQUE</code>
            index. (A <code class="literal">UNIQUE</code> index permits multiple
            <code class="literal">NULL</code> values, but you can tell whether the
            column permits <code class="literal">NULL</code> by checking the
            <code class="literal">Null</code> field.)
          </p></li><li class="listitem"><p>
            If <code class="literal">Key</code> is <code class="literal">MUL</code>, the
            column is the first column of a nonunique index in which
            multiple occurrences of a given value are permitted within
            the column.
</p></li></ul>
</div>
<p>
        If more than one of the <code class="literal">Key</code> values applies to
        a given column of a table, <code class="literal">Key</code> displays the
        one with the highest priority, in the order
        <code class="literal">PRI</code>, <code class="literal">UNI</code>,
        <code class="literal">MUL</code>.
      </p><p>
        A <code class="literal">UNIQUE</code> index may be displayed as
        <code class="literal">PRI</code> if it cannot contain
        <code class="literal">NULL</code> values and there is no <code class="literal">PRIMARY
        KEY</code> in the table. A <code class="literal">UNIQUE</code> index
        may display as <code class="literal">MUL</code> if several columns form a
        composite <code class="literal">UNIQUE</code> index; although the
        combination of the columns is unique, each column can still hold
        multiple occurrences of a given value.
      </p><p>
        The <code class="literal">Default</code> field indicates the default value
        that is assigned to the column. This is <code class="literal">NULL</code>
        if the column has an explicit default of
        <code class="literal">NULL</code>, or if the column definition has no
        <code class="literal">DEFAULT</code> clause.
      </p><p>
        The <code class="literal">Extra</code> field contains any additional
        information that is available about a given column. The value is
        nonempty in these cases: <code class="literal">auto_increment</code> for
        columns that have the <code class="literal">AUTO_INCREMENT</code>
        attribute; <code class="literal">on update CURRENT_TIMESTAMP</code> for
        <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> or
        <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> columns that have the
        <code class="literal">ON UPDATE CURRENT_TIMESTAMP</code> attribute.
      </p><p>
        <code class="literal">Privileges</code> indicates the privileges you have
        for the column. This value is displayed only if you use the
        <code class="literal">FULL</code> keyword.
      </p><p>
        <code class="literal">Comment</code> indicates any comment the column has.
        This value is displayed only if you use the
        <code class="literal">FULL</code> keyword.
      </p><a class="indexterm" name="idm139737142201952"></a><p>
        <code class="literal">SHOW FIELDS</code> is a synonym for
        <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a>. You can also list a
        table's columns with the <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        <em class="replaceable"><code>db_name</code></em>
        <em class="replaceable"><code>tbl_name</code></em></strong></span></a> command.
      </p><p>
        The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> statement provides
        information similar to <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW
        COLUMNS</code></a>. See <a class="xref" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax">Section 13.8.1, “DESCRIBE Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>,
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>, and
        <a class="link" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statements also
        provide information about tables. See <a class="xref" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax">Section 13.7.5, “SHOW Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-contributors"></a>13.7.5.7 SHOW CONTRIBUTORS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142186288"></a><pre class="programlisting">
SHOW CONTRIBUTORS
</pre><p>
        The <a class="link" href="sql-syntax.html#show-contributors" title="13.7.5.7 SHOW CONTRIBUTORS Syntax"><code class="literal">SHOW CONTRIBUTORS</code></a> statement
        displays information about the people who contribute to MySQL
        source or to causes that we support. For each contributor, it
        displays <code class="literal">Name</code>, <code class="literal">Location</code>,
        and <code class="literal">Comment</code> values.
      </p><p>
        This statement is removed as of MySQL 5.6.8.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-database"></a>13.7.5.8 SHOW CREATE DATABASE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142175664"></a><a class="indexterm" name="idm139737142174624"></a><pre class="programlisting">
SHOW CREATE {DATABASE | SCHEMA} [IF NOT EXISTS] <em class="replaceable"><code>db_name</code></em>
</pre><p>
        Shows the <a class="link" href="sql-syntax.html#create-database" title="13.1.10 CREATE DATABASE Syntax"><code class="literal">CREATE DATABASE</code></a>
        statement that creates the named database. If the
        <code class="literal">SHOW</code> statement includes an <code class="literal">IF NOT
        EXISTS</code> clause, the output too includes such a clause.
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.5.8 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW
        CREATE SCHEMA</code></a> is a synonym for
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.5.8 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW CREATE DATABASE</code></a>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE DATABASE test\G</code></strong>
*************************** 1. row ***************************
       Database: test
Create Database: CREATE DATABASE `test`
                 /*!40100 DEFAULT CHARACTER SET latin1 */

mysql&gt; <strong class="userinput"><code>SHOW CREATE SCHEMA test\G</code></strong>
*************************** 1. row ***************************
       Database: test
Create Database: CREATE DATABASE `test`
                 /*!40100 DEFAULT CHARACTER SET latin1 */
</pre><p>
        <a class="link" href="sql-syntax.html#show-create-database" title="13.7.5.8 SHOW CREATE DATABASE Syntax"><code class="literal">SHOW CREATE DATABASE</code></a> quotes table
        and column names according to the value of the
        <a class="link" href="server-administration.html#sysvar_sql_quote_show_create"><code class="literal">sql_quote_show_create</code></a> option.
        See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-event"></a>13.7.5.9 SHOW CREATE EVENT Syntax</h4>

</div>

</div>

</div>
<pre class="programlisting">
SHOW CREATE EVENT <em class="replaceable"><code>event_name</code></em>
</pre><p>
        This statement displays the <a class="link" href="sql-syntax.html#create-event" title="13.1.11 CREATE EVENT Syntax"><code class="literal">CREATE
        EVENT</code></a> statement needed to re-create a given event. It
        requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege for
        the database from which the event is to be shown. For example
        (using the same event <code class="literal">e_daily</code> defined and
        then altered in <a class="xref" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax">Section 13.7.5.19, “SHOW EVENTS Syntax”</a>):
      </p><pre class="programlisting">
mysql&gt; SHOW CREATE EVENT test.e_daily\G
*************************** 1. row ***************************
               Event: e_daily
            sql_mode:
           time_zone: SYSTEM
        Create Event: CREATE EVENT `e_daily`
                        ON SCHEDULE EVERY 1 DAY
                        STARTS CURRENT_TIMESTAMP + INTERVAL 6 HOUR
                        ON COMPLETION NOT PRESERVE
                        ENABLE
                        COMMENT 'Saves total number of sessions then
                                clears the table each day'
                        DO BEGIN
                          INSERT INTO site_activity.totals (time, total)
                            SELECT CURRENT_TIMESTAMP, COUNT(*)
                            FROM site_activity.sessions;
                          DELETE FROM site_activity.sessions;
                        END
character_set_client: latin1
collation_connection: latin1_swedish_ci
  Database Collation: latin1_swedish_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the event was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the event was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the event is associated.
      </p><p>
        The output reflects the current status of the event
        (<code class="literal">ENABLE</code>) rather than the status with which it
        was created.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-function"></a>13.7.5.10 SHOW CREATE FUNCTION Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142134832"></a><pre class="programlisting">
SHOW CREATE FUNCTION <em class="replaceable"><code>func_name</code></em>
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-create-procedure" title="13.7.5.11 SHOW CREATE PROCEDURE Syntax"><code class="literal">SHOW CREATE
        PROCEDURE</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-create-procedure" title="13.7.5.11 SHOW CREATE PROCEDURE Syntax">Section 13.7.5.11, “SHOW CREATE PROCEDURE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-procedure"></a>13.7.5.11 SHOW CREATE PROCEDURE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142126016"></a><pre class="programlisting">
SHOW CREATE PROCEDURE <em class="replaceable"><code>proc_name</code></em>
</pre><p>
        This statement is a MySQL extension. It returns the exact string
        that can be used to re-create the named stored procedure. A
        similar statement, <a class="link" href="sql-syntax.html#show-create-function" title="13.7.5.10 SHOW CREATE FUNCTION Syntax"><code class="literal">SHOW CREATE
        FUNCTION</code></a>, displays information about stored functions
        (see <a class="xref" href="sql-syntax.html#show-create-function" title="13.7.5.10 SHOW CREATE FUNCTION Syntax">Section 13.7.5.10, “SHOW CREATE FUNCTION Syntax”</a>).
      </p><p>
        To use either statement, you must be the user named in the
        routine <code class="literal">DEFINER</code> clause or have
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> access to the
        <code class="literal">mysql.proc</code> table. If you do not have
        privileges for the routine itself, the value displayed for the
        <code class="literal">Create Procedure</code> or <code class="literal">Create
        Function</code> field will be <code class="literal">NULL</code>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE PROCEDURE test.simpleproc\G</code></strong>
*************************** 1. row ***************************
           Procedure: simpleproc
            sql_mode:
    Create Procedure: CREATE PROCEDURE `simpleproc`(OUT param1 INT)
                      BEGIN
                      SELECT COUNT(*) INTO param1 FROM t;
                      END
character_set_client: latin1
collation_connection: latin1_swedish_ci
  Database Collation: latin1_swedish_ci

mysql&gt; <strong class="userinput"><code>SHOW CREATE FUNCTION test.hello\G</code></strong>
*************************** 1. row ***************************
            Function: hello
            sql_mode:
     Create Function: CREATE FUNCTION `hello`(s CHAR(20))
                      RETURNS CHAR(50)
                      RETURN CONCAT('Hello, ',s,'!')
character_set_client: latin1
collation_connection: latin1_swedish_ci
  Database Collation: latin1_swedish_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the routine was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the routine was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the routine is associated.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-table"></a>13.7.5.12 SHOW CREATE TABLE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142102480"></a><pre class="programlisting">
SHOW CREATE TABLE <em class="replaceable"><code>tbl_name</code></em>
</pre><p>
        Shows the <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement
        that creates the named table. To use this statement, you must
        have some privilege for the table. This statement also works
        with views.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TABLE t\G</code></strong>
*************************** 1. row ***************************
       Table: t
Create Table: CREATE TABLE t (
  id INT(11) default NULL auto_increment,
  s char(60) default NULL,
  PRIMARY KEY (id)
) ENGINE=MyISAM

</pre><p>
        <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a> quotes table
        and column names according to the value of the
        <a class="link" href="server-administration.html#sysvar_sql_quote_show_create"><code class="literal">sql_quote_show_create</code></a> option.
        See <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-trigger"></a>13.7.5.13 SHOW CREATE TRIGGER Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142086832"></a><pre class="programlisting">
SHOW CREATE TRIGGER <em class="replaceable"><code>trigger_name</code></em>
</pre><p>
        This statement shows the <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE
        TRIGGER</code></a> statement that creates the named trigger.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE TRIGGER ins_sum\G</code></strong>
*************************** 1. row ***************************
               Trigger: ins_sum
              sql_mode: NO_ENGINE_SUBSTITUTION
SQL Original Statement: CREATE DEFINER=`me`@`localhost` TRIGGER ins_sum
                        BEFORE INSERT ON account
                        FOR EACH ROW SET @sum = @sum + NEW.amount
  character_set_client: utf8
  collation_connection: utf8_general_ci
    Database Collation: latin1_swedish_ci
</pre><p>
        <a class="link" href="sql-syntax.html#show-create-trigger" title="13.7.5.13 SHOW CREATE TRIGGER Syntax"><code class="literal">SHOW CREATE TRIGGER</code></a> output has
        the following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Trigger</code>: The trigger name.
          </p></li><li class="listitem"><p>
            <code class="literal">sql_mode</code>: The SQL mode in effect when the
            trigger executes.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL Original Statement</code>: The
            <a class="link" href="sql-syntax.html#create-trigger" title="13.1.19 CREATE TRIGGER Syntax"><code class="literal">CREATE TRIGGER</code></a> statement that
            defines the trigger.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">collation_connection</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Database Collation</code>: The collation of the
            database with which the trigger is associated.
</p></li></ul>
</div>
<p>
        You can also obtain information about trigger objects from
        <code class="literal">INFORMATION_SCHEMA</code>, which contains a
        <a class="link" href="information-schema.html#triggers-table" title="21.26 The INFORMATION_SCHEMA TRIGGERS Table"><code class="literal">TRIGGERS</code></a> table. See
        <a class="xref" href="information-schema.html#triggers-table" title="21.26 The INFORMATION_SCHEMA TRIGGERS Table">Section 21.26, “The INFORMATION_SCHEMA TRIGGERS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-create-view"></a>13.7.5.14 SHOW CREATE VIEW Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142059216"></a><pre class="programlisting">
SHOW CREATE VIEW <em class="replaceable"><code>view_name</code></em>
</pre><p>
        This statement shows the <a class="link" href="sql-syntax.html#create-view" title="13.1.20 CREATE VIEW Syntax"><code class="literal">CREATE
        VIEW</code></a> statement that creates the named view.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW CREATE VIEW v\G</code></strong>
*************************** 1. row ***************************
                View: v
         Create View: CREATE ALGORITHM=UNDEFINED
                      DEFINER=`bob`@`localhost`
                      SQL SECURITY DEFINER VIEW
                      `v` AS select 1 AS `a`,2 AS `b`
character_set_client: latin1
collation_connection: latin1_swedish_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the view was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the view was created.
      </p><p>
        Use of <a class="link" href="sql-syntax.html#show-create-view" title="13.7.5.14 SHOW CREATE VIEW Syntax"><code class="literal">SHOW CREATE VIEW</code></a> requires
        the <a class="link" href="security.html#priv_show-view"><code class="literal">SHOW VIEW</code></a> privilege and the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the view in
        question.
      </p><p>
        You can also obtain information about view objects from
        <code class="literal">INFORMATION_SCHEMA</code>, which contains a
        <a class="link" href="information-schema.html#views-table" title="21.28 The INFORMATION_SCHEMA VIEWS Table"><code class="literal">VIEWS</code></a> table. See
        <a class="xref" href="information-schema.html#views-table" title="21.28 The INFORMATION_SCHEMA VIEWS Table">Section 21.28, “The INFORMATION_SCHEMA VIEWS Table”</a>.
      </p><p>
        MySQL lets you use different
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> settings to tell the
        server the type of SQL syntax to support. For example, you might
        use the <a class="link" href="server-administration.html#sqlmode_ansi"><code class="literal">ANSI</code></a> SQL mode to
        ensure MySQL correctly interprets the standard SQL concatenation
        operator, the double bar (<code class="literal">||</code>), in your
        queries. If you then create a view that concatenates items, you
        might worry that changing the
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> setting to a value
        different from <a class="link" href="server-administration.html#sqlmode_ansi"><code class="literal">ANSI</code></a> could
        cause the view to become invalid. But this is not the case. No
        matter how you write out a view definition, MySQL always stores
        it the same way, in a canonical form. Here is an example that
        shows how the server changes a double bar concatenation operator
        to a <a class="link" href="functions.html#function_concat"><code class="literal">CONCAT()</code></a> function:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_mode = 'ANSI';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE VIEW test.v AS SELECT 'a' || 'b' as col1;</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW CREATE VIEW test.v\G</code></strong>
*************************** 1. row ***************************
                View: v
         Create View: CREATE VIEW "v" AS select concat('a','b') AS "col1"
...
1 row in set (0.00 sec)
</pre><p>
        The advantage of storing a view definition in canonical form is
        that changes made later to the value of
        <a class="link" href="server-administration.html#sysvar_sql_mode"><code class="literal">sql_mode</code></a> will not affect the
        results from the view. However an additional consequence is that
        comments prior to <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> are
        stripped from the definition by the server.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-databases"></a>13.7.5.15 SHOW DATABASES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142023904"></a><a class="indexterm" name="idm139737142022832"></a><pre class="programlisting">
SHOW {DATABASES | SCHEMAS}
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW DATABASES</code></a> lists the
        databases on the MySQL server host.
        <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW
        SCHEMAS</code></a> is a synonym for <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW
        DATABASES</code></a>. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a>
        clause, if present, indicates which database names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        You see only those databases for which you have some kind of
        privilege, unless you have the global <a class="link" href="sql-syntax.html#show-databases" title="13.7.5.15 SHOW DATABASES Syntax"><code class="literal">SHOW
        DATABASES</code></a> privilege. You can also get this list using
        the <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow</strong></span></a> command.
      </p><p>
        If the server was started with the
        <a class="link" href="server-administration.html#option_mysqld_skip-show-database"><code class="option">--skip-show-database</code></a> option, you
        cannot use this statement at all unless you have the
        <a class="link" href="security.html#priv_show-databases"><code class="literal">SHOW DATABASES</code></a> privilege.
      </p><p>
        MySQL implements databases as directories in the data directory,
        so this statement simply lists directories in that location.
        However, the output may include names of directories that do not
        correspond to actual databases.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-engine"></a>13.7.5.16 SHOW ENGINE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737142002624"></a><a class="indexterm" name="idm139737142001552"></a><a class="indexterm" name="idm139737142000464"></a><a class="indexterm" name="idm139737141999392"></a><pre class="programlisting">
SHOW ENGINE <em class="replaceable"><code>engine_name</code></em> {STATUS | MUTEX}
</pre><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE</code></a> displays operational
        information about a storage engine. It requires the
        <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege. The statement
        has these variants:
      </p><pre class="programlisting">
SHOW ENGINE INNODB STATUS
SHOW ENGINE INNODB MUTEX
SHOW ENGINE {NDB | NDBCLUSTER} STATUS
SHOW ENGINE PERFORMANCE_SCHEMA STATUS
</pre><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        STATUS</code></a> displays extensive information from the
        standard <code class="literal">InnoDB</code> Monitor about the state of
        the <code class="literal">InnoDB</code> storage engine. For information
        about the standard monitor and other <code class="literal">InnoDB</code>
        Monitors that provide information about
        <code class="literal">InnoDB</code> processing, see
        <a class="xref" href="innodb-storage-engine.html#innodb-monitors" title="14.14 InnoDB Monitors">Section 14.14, “InnoDB Monitors”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE INNODB
        MUTEX</code></a> displays <code class="literal">InnoDB</code>
        <a class="link" href="glossary.html#glos_mutex" title="mutex">mutex</a> and
        <a class="link" href="glossary.html#glos_rw_lock" title="rw-lock">rw-lock</a> statistics.
        Statement output has the following columns:
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Most <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
          INNODB MUTEX</code></a> output is removed in 5.6.14.
          <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
          INNODB MUTEX</code></a> output is removed entirely in MySQL
          5.7.2. <code class="literal">InnoDB</code> mutexes can be monitored
          using <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema">Performance
          Schema</a> tables. For an example, see
          <a class="xref" href="innodb-storage-engine.html#monitor-innodb-mutex-waits-performance-schema" title="14.13.1 Monitoring InnoDB Mutex Waits Using Performance Schema">Section 14.13.1, “Monitoring InnoDB Mutex Waits Using Performance Schema”</a>.
</p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Type</code>
          </p><p>
            Always <code class="literal">InnoDB</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            The source file where the mutex is implemented, and the line
            number in the file where the mutex is created. The line
            number is specific to your version of MySQL.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>
          </p><p>
            The mutex status. This field displays several values if
            <a class="link" href="installing.html#option_cmake_with_debug"><code class="option">WITH_DEBUG</code></a> was defined at
            MySQL compilation time. If
            <a class="link" href="installing.html#option_cmake_with_debug"><code class="option">WITH_DEBUG</code></a> was not defined,
            the statement displays only the <code class="literal">os_waits</code>
            value. In the latter case (without
            <a class="link" href="installing.html#option_cmake_with_debug"><code class="option">WITH_DEBUG</code></a>), the information
            on which the output is based is insufficient to distinguish
            regular mutexes and mutexes that protect rw-locks (which
            permit multiple readers or a single writer). Consequently,
            the output may appear to contain multiple rows for the same
            mutex.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">count</code> indicates how many times the
                mutex was requested.
              </p></li><li class="listitem"><p>
                <code class="literal">spin_waits</code> indicates how many times
                the spinlock had to run.
              </p></li><li class="listitem"><p>
                <code class="literal">spin_rounds</code> indicates the number of
                spinlock rounds. (<code class="literal">spin_rounds</code> divided
                by <code class="literal">spin_waits</code> provides the average
                round count.)
              </p></li><li class="listitem"><p>
                <code class="literal">os_waits</code> indicates the number of
                operating system waits. This occurs when the spinlock
                did not work (the mutex was not locked during the
                spinlock and it was necessary to yield to the operating
                system and wait).
              </p></li><li class="listitem"><p>
                <code class="literal">os_yields</code> indicates the number of
                times a thread trying to lock a mutex gave up its
                timeslice and yielded to the operating system (on the
                presumption that permitting other threads to run will
                free the mutex so that it can be locked).
              </p></li><li class="listitem"><p>
                <code class="literal">os_wait_times</code> indicates the amount of
                time (in ms) spent in operating system waits. In MySQL
                5.6 timing is disabled and this value is
                always 0.
</p></li></ul>
</div>
</li></ul>
</div>
<p>
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> skips the
        <a class="link" href="glossary.html#glos_mutex" title="mutex">mutexes</a> and
        <a class="link" href="glossary.html#glos_rw_lock" title="rw-lock">rw-locks</a> of
        <a class="link" href="glossary.html#glos_buffer_pool" title="buffer pool">buffer pool</a> blocks, as
        the amount of output can be overwhelming on systems with a large
        buffer pool. (There is one mutex and one rw-lock in each 16K
        buffer pool block, and there are 65,536 blocks per gigabyte.)
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> also does not list
        any mutexes or rw-locks that have never been waited on
        (<code class="literal">os_waits=0</code>). Thus, <code class="literal">SHOW ENGINE
        INNODB MUTEX</code> only displays information about mutexes
        and rw-locks outside of the buffer pool that have caused at
        least one OS-level <a class="link" href="glossary.html#glos_wait" title="wait">wait</a>.
      </p><p>
        <code class="literal">SHOW ENGINE INNODB MUTEX</code> information can be
        used to diagnose system problems. For example, large values of
        <code class="literal">spin_waits</code> and <code class="literal">spin_rounds</code>
        may indicate scalability problems.
      </p><p>
        Use <a class="link" href="sql-syntax.html#show-engine" title="13.7.5.16 SHOW ENGINE Syntax"><code class="literal">SHOW ENGINE
        PERFORMANCE_SCHEMA STATUS</code></a> to inspect the internal
        operation of the Performance Schema code:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE PERFORMANCE_SCHEMA STATUS\G</code></strong>
...
*************************** 3. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_size
Status: 76
*************************** 4. row ***************************
  Type: performance_schema
  Name: events_waits_history.row_count
Status: 10000
*************************** 5. row ***************************
  Type: performance_schema
  Name: events_waits_history.memory
Status: 760000
...
*************************** 57. row ***************************
  Type: performance_schema
  Name: performance_schema.memory
Status: 26459600
...
</pre><p>
        This statement is intended to help the DBA understand the
        effects that different Performance Schema options have on memory
        requirements.
      </p><p>
        <code class="literal">Name</code> values consist of two parts, which name
        an internal buffer and a buffer attribute, respectively.
        Interpret buffer names as follows:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            An internal buffer that is not exposed as a table is named
            within parentheses. Examples:
            <code class="literal">(pfs_cond_class).row_size</code>,
            <code class="literal">(pfs_mutex_class).memory</code>.
          </p></li><li class="listitem"><p>
            An internal buffer that is exposed as a table in the
            <code class="literal">performance_schema</code> database is named
            after the table, without parentheses. Examples:
            <code class="literal">events_waits_history.row_size</code>,
            <code class="literal">mutex_instances.row_count</code>.
          </p></li><li class="listitem"><p>
            A value that applies to the Performance Schema as a whole
            begins with <code class="literal">performance_schema</code>. Example:
            <code class="literal">performance_schema.memory</code>.
</p></li></ul>
</div>
<p>
        Buffer attributes have these meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">row_size</code> is the size of the internal
            record used by the implementation, such as the size of a row
            in a table. <code class="literal">row_size</code> values cannot be
            changed.
          </p></li><li class="listitem"><p>
            <code class="literal">row_count</code> is the number of internal
            records, such as the number of rows in a table.
            <code class="literal">row_count</code> values can be changed using
            Performance Schema configuration options.
          </p></li><li class="listitem"><p>
            For a table,
            <code class="literal"><em class="replaceable"><code>tbl_name</code></em>.memory</code>
            is the product of <code class="literal">row_size</code> and
            <code class="literal">row_count</code>. For the Performance Schema as
            a whole, <code class="literal">performance_schema.memory</code> is the
            sum of all the memory used (the sum of all other
            <code class="literal">memory</code> values).
</p></li></ul>
</div>
<p>
        In some cases, there is a direct relationship between a
        Performance Schema configuration parameter and a <code class="literal">SHOW
        ENGINE</code> value. For example,
        <code class="literal">events_waits_history_long.row_count</code>
        corresponds to
        <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_long_size"><code class="literal">performance_schema_events_waits_history_long_size</code></a>.
        In other cases, the relationship is more complex. For example,
        <code class="literal">events_waits_history.row_count</code> corresponds to
        <a class="link" href="performance-schema.html#sysvar_performance_schema_events_waits_history_size"><code class="literal">performance_schema_events_waits_history_size</code></a>
        (the number of rows per thread) multiplied by
        <a class="link" href="performance-schema.html#sysvar_performance_schema_max_thread_instances"><code class="literal">performance_schema_max_thread_instances</code></a>
        ( the number of threads).
      </p><p><a name="show-engine-ndb-status"></a><b>SHOW ENGINE NDB STATUS. </b>
          If the server has the <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage
          engine enabled, <code class="literal">SHOW ENGINE NDB STATUS</code>
          displays cluster status information such as the number of
          connected data nodes, the cluster connectstring, and cluster
          binary log epochs, as well as counts of various Cluster API
          objects created by the MySQL Server when connected to the
          cluster. Sample output from this statement is shown here:
        </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINE NDB STATUS;</code></strong>
+------------+-----------------------+--------------------------------------------------+
| Type       | Name                  | Status                                           |
+------------+-----------------------+--------------------------------------------------+
| ndbcluster | connection            | cluster_node_id=7,
  connected_host=192.168.0.103, connected_port=1186, number_of_data_nodes=4,
  number_of_ready_data_nodes=3, connect_count=0                                         |
| ndbcluster | NdbTransaction        | created=6, free=0, sizeof=212                    |
| ndbcluster | NdbOperation          | created=8, free=8, sizeof=660                    |
| ndbcluster | NdbIndexScanOperation | created=1, free=1, sizeof=744                    |
| ndbcluster | NdbIndexOperation     | created=0, free=0, sizeof=664                    |
| ndbcluster | NdbRecAttr            | created=1285, free=1285, sizeof=60               |
| ndbcluster | NdbApiSignal          | created=16, free=16, sizeof=136                  |
| ndbcluster | NdbLabel              | created=0, free=0, sizeof=196                    |
| ndbcluster | NdbBranch             | created=0, free=0, sizeof=24                     |
| ndbcluster | NdbSubroutine         | created=0, free=0, sizeof=68                     |
| ndbcluster | NdbCall               | created=0, free=0, sizeof=16                     |
| ndbcluster | NdbBlob               | created=1, free=1, sizeof=264                    |
| ndbcluster | NdbReceiver           | created=4, free=0, sizeof=68                     |
| ndbcluster | binlog                | latest_epoch=155467, latest_trans_epoch=148126,
  latest_received_binlog_epoch=0, latest_handled_binlog_epoch=0,
  latest_applied_binlog_epoch=0                                                         |
+------------+-----------------------+--------------------------------------------------+
</pre><p>
        The rows with <code class="literal">connection</code> and
        <code class="literal">binlog</code> in the <code class="literal">Name</code> column
        were added to the output of this statement in MySQL 5.1. The
        <code class="literal">Status</code> column in each of these rows provides
        information about the MySQL server's connection to the cluster
        and about the cluster binary log's status, respectively. The
        <code class="literal">Status</code> information is in the form of
        comma-delimited set of name/value pairs.
      </p><p>
        The <code class="literal">connection</code> row's
        <code class="literal">Status</code> column contains the name/value pairs
        described in the following table.
</p>
<div class="informaltable">
<table border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Name</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">cluster_node_id</code></td><td>The node ID of the MySQL server in the cluster</td></tr><tr><td scope="row"><code class="literal">connected_host</code></td><td>The host name or IP address of the cluster management server to which
                the MySQL server is connected</td></tr><tr><td scope="row"><code class="literal">connected_port</code></td><td>The port used by the MySQL server to connect to the management server
                (<code class="literal">connected_host</code>)</td></tr><tr><td scope="row"><code class="literal">number_of_data_nodes</code></td><td>The number of data nodes configured for the cluster (that is, the number
                of <code class="literal">[ndbd]</code> sections in the cluster
                <code class="filename">config.ini</code> file)</td></tr><tr><td scope="row"><code class="literal">number_of_ready_data_nodes</code></td><td>The number of data nodes in the cluster that are actually running</td></tr><tr><td scope="row"><code class="literal">connect_count</code></td><td>The number of times this <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> has connected or
reconnected to cluster data nodes</td></tr></tbody></table>
</div>
<p>
        The <code class="literal">binlog</code> row's <code class="literal">Status</code>
        column contains information relating to MySQL Cluster
        Replication. The name/value pairs it contains are described in
        the following table.
</p>
<div class="informaltable">
<table border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Name</th><th scope="col">Value</th></tr></thead><tbody><tr><td scope="row"><code class="literal">latest_epoch</code></td><td>The most recent epoch most recently run on this MySQL server (that is,
                the sequence number of the most recent transaction run
                on the server)</td></tr><tr><td scope="row"><code class="literal">latest_trans_epoch</code></td><td>The most recent epoch processed by the cluster's data nodes</td></tr><tr><td scope="row"><code class="literal">latest_received_binlog_epoch</code></td><td>The most recent epoch received by the binary log thread</td></tr><tr><td scope="row"><code class="literal">latest_handled_binlog_epoch</code></td><td>The most recent epoch processed by the binary log thread (for writing to
the binary log)</td></tr><tr><td scope="row"><code class="literal">latest_applied_binlog_epoch</code></td><td>The most recent epoch actually written to the binary log</td></tr></tbody></table>
</div>
<p>
        See <a class="xref" href="mysql-cluster.html#mysql-cluster-replication" title="18.6 MySQL Cluster Replication">Section 18.6, “MySQL Cluster Replication”</a>, for more
        information.
      </p><p>
        The remaining rows from the output of <code class="literal">SHOW ENGINE NDB
        STATUS</code> which are most likely to prove useful in
        monitoring the cluster are listed here by
        <code class="literal">Name</code>:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">NdbTransaction</code>: The number and size of
            <code class="literal">NdbTransaction</code> objects that have been
            created. An <code class="literal">NdbTransaction</code> is created
            each time a table schema operation (such as
            <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> or
            <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>) is performed on
            an <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbOperation</code>: The number and size of
            <code class="literal">NdbOperation</code> objects that have been
            created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbIndexScanOperation</code>: The number and
            size of <code class="literal">NdbIndexScanOperation</code> objects
            that have been created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbIndexOperation</code>: The number and size of
            <code class="literal">NdbIndexOperation</code> objects that have been
            created.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbRecAttr</code>: The number and size of
            <code class="literal">NdbRecAttr</code> objects that have been
            created. In general, one of these is created each time a
            data manipulation statement is performed by an SQL node.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbBlob</code>: The number and size of
            <code class="literal">NdbBlob</code> objects that have been created.
            An <code class="literal">NdbBlob</code> is created for each new
            operation involving a <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a>
            column in an <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> table.
          </p></li><li class="listitem"><p>
            <code class="literal">NdbReceiver</code>: The number and size of any
            <code class="literal">NdbReceiver</code> object that have been
            created. The number in the <code class="literal">created</code> column
            is the same as the number of data nodes in the cluster to
            which the MySQL server has connected.
</p></li></ul>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          <code class="literal">SHOW ENGINE NDB STATUS</code> returns an empty
          result if no operations involving
          <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables have been performed
          during the current session by the MySQL client accessing the
          SQL node on which this statement is run.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-engines"></a>13.7.5.17 SHOW ENGINES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141832656"></a><a class="indexterm" name="idm139737141831584"></a><pre class="programlisting">
SHOW [STORAGE] ENGINES
</pre><p>
        <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> displays status
        information about the server's storage engines. This is
        particularly useful for checking whether a storage engine is
        supported, or to see what the default engine is. This
        information can also be obtained from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#engines-table" title="21.6 The INFORMATION_SCHEMA ENGINES Table"><code class="literal">ENGINES</code></a> table. See
        <a class="xref" href="information-schema.html#engines-table" title="21.6 The INFORMATION_SCHEMA ENGINES Table">Section 21.6, “The INFORMATION_SCHEMA ENGINES Table”</a>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW ENGINES\G</code></strong>
*************************** 1. row ***************************
      Engine: MEMORY
     Support: YES
     Comment: Hash based, stored in memory, useful for temporary tables
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 2. row ***************************
      Engine: MyISAM
     Support: YES
     Comment: MyISAM storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 3. row ***************************
      Engine: InnoDB
     Support: DEFAULT
     Comment: Supports transactions, row-level locking, and foreign keys
Transactions: YES
          XA: YES
  Savepoints: YES
*************************** 4. row ***************************
      Engine: EXAMPLE
     Support: YES
     Comment: Example storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 5. row ***************************
      Engine: ARCHIVE
     Support: YES
     Comment: Archive storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 6. row ***************************
      Engine: CSV
     Support: YES
     Comment: CSV storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 7. row ***************************
      Engine: BLACKHOLE
     Support: YES
     Comment: /dev/null storage engine (anything you write »
              to it disappears)
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 8. row ***************************
      Engine: FEDERATED
     Support: YES
     Comment: Federated MySQL storage engine
Transactions: NO
          XA: NO
  Savepoints: NO
*************************** 9. row ***************************
      Engine: MRG_MYISAM
     Support: YES
     Comment: Collection of identical MyISAM tables
Transactions: NO
          XA: NO
  Savepoints: NO
</pre><p>
        The output from <a class="link" href="sql-syntax.html#show-engines" title="13.7.5.17 SHOW ENGINES Syntax"><code class="literal">SHOW ENGINES</code></a> may
        vary according to the MySQL version used and other factors. The
        values shown in the <code class="literal">Support</code> column indicate
        the server's level of support for the storage engine, as shown
        in the following table.
</p>
<div class="informaltable">
<table summary="This table describes values for the
          Support column in the output of the
SHOW ENGINES command." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">Value</th><th scope="col">Meaning</th></tr></thead><tbody><tr><td scope="row"><code class="literal">YES</code></td><td>The engine is supported and is active</td></tr><tr><td scope="row"><code class="literal">DEFAULT</code></td><td>Like <code class="literal">YES</code>, plus this is the default engine</td></tr><tr><td scope="row"><code class="literal">NO</code></td><td>The engine is not supported</td></tr><tr><td scope="row"><code class="literal">DISABLED</code></td><td>The engine is supported but has been disabled</td></tr></tbody></table>
</div>
<p>
        A value of <code class="literal">NO</code> means that the server was
        compiled without support for the engine, so it cannot be enabled
        at runtime.
      </p><p>
        A value of <code class="literal">DISABLED</code> occurs either because the
        server was started with an option that disables the engine, or
        because not all options required to enable it were given. In the
        latter case, the error log file should contain a reason
        indicating why the option is disabled. See
        <a class="xref" href="server-administration.html#error-log" title="5.2.2 The Error Log">Section 5.2.2, “The Error Log”</a>.
      </p><p>
        You might also see <code class="literal">DISABLED</code> for a storage
        engine if the server was compiled to support it, but was started
        with a
        <code class="option">--skip-<em class="replaceable"><code>engine_name</code></em></code>
        option. For the <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> storage engine,
        <code class="literal">DISABLED</code> means the server was compiled with
        support for MySQL Cluster, but was not started with the
        <a class="link" href="mysql-cluster.html#option_mysqld_ndbcluster"><code class="option">--ndbcluster</code></a> option.
      </p><p>
        All MySQL servers support <code class="literal">MyISAM</code> tables. It
        is not possible to disable <code class="literal">MyISAM</code>.
      </p><p>
        The <code class="literal">Transactions</code>, <code class="literal">XA</code>, and
        <code class="literal">Savepoints</code> columns indicate whether the
        storage engine supports transactions, XA transactions, and
        savepoints, respectively.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-errors"></a>13.7.5.18 SHOW ERRORS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141786400"></a><a class="indexterm" name="idm139737141785328"></a><pre class="programlisting">
SHOW ERRORS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW COUNT(*) ERRORS
</pre><p>
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> is a diagnostic
        statement that is similar to <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
        WARNINGS</code></a>, except that it displays information only for
        errors, rather than for errors, warnings, and notes.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW COUNT(*)
        ERRORS</code></a> statement displays the number of errors. You
        can also retrieve this number from the
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> variable:
      </p><pre class="programlisting">
SHOW COUNT(*) ERRORS;
SELECT @@error_count;
</pre><p>
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> and
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> apply only to
        errors, not warnings or notes. In other respects, they are
        similar to <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> and
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>. In particular,
        <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW ERRORS</code></a> cannot display
        information for more than
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> messages, and
        <a class="link" href="server-administration.html#sysvar_error_count"><code class="literal">error_count</code></a> can exceed the
        value of <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> if the
        number of errors exceeds
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>.
      </p><p>
        For more information, see <a class="xref" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax">Section 13.7.5.41, “SHOW WARNINGS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-events"></a>13.7.5.19 SHOW EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141755856"></a><pre class="programlisting">
SHOW EVENTS [{FROM | IN} <em class="replaceable"><code>schema_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement displays information about Event Manager events.
        It requires the <a class="link" href="security.html#priv_event"><code class="literal">EVENT</code></a> privilege
        for the database from which the events are to be shown.
      </p><p>
        In its simplest form, <a class="link" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>
        lists all of the events in the current schema:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT CURRENT_USER(), SCHEMA();</code></strong>
+----------------+----------+
| CURRENT_USER() | SCHEMA() |
+----------------+----------+
| jon@ghidora    | myschema |
+----------------+----------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW EVENTS\G</code></strong>
*************************** 1. row ***************************
                  Db: myschema
                Name: e_daily
             Definer: jon@ghidora
           Time zone: SYSTEM
                Type: RECURRING
          Execute at: NULL
      Interval value: 10
      Interval field: SECOND
              Starts: 2006-02-09 10:41:23
                Ends: NULL
              Status: ENABLED
          Originator: 0
character_set_client: latin1
collation_connection: latin1_swedish_ci
  Database Collation: latin1_swedish_ci
</pre><p>
        To see events for a specific schema, use the
        <code class="literal">FROM</code> clause. For example, to see events for
        the <code class="literal">test</code> schema, use the following statement:
      </p><pre class="programlisting">
SHOW EVENTS FROM test;
</pre><p>
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which event names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a> output has the
        following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Db</code>: The schema (database) on which the
            event is defined.
          </p></li><li class="listitem"><p>
            <code class="literal">Name</code>: The name of the event.
          </p></li><li class="listitem"><p>
            <code class="literal">Time zone</code>: The event time zone, which is
            the time zone used for scheduling the event and that is in
            effect within the event as it executes. The default value is
            <code class="literal">SYSTEM</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Definer</code>: The account of the user who
            created the event, in
            <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
            format.
          </p></li><li class="listitem"><p>
            <code class="literal">Type</code>: The event repetition type, either
            <code class="literal">ONE TIME</code> (transient) or
            <code class="literal">RECURRING</code> (repeating).
          </p></li><li class="listitem"><p>
            <code class="literal">Execute At</code>: The date and time when a
            transient event is set to execute. Shown as a
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value.
          </p><p>
            For a recurring event, the value of this column is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Interval Value</code>: For a recurring event,
            the number of intervals to wait between event executions.
          </p><p>
            For a transient event, the value of this column is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Interval Field</code>: The time units used for
            the interval which a recurring event waits before repeating.
          </p><p>
            For a transient event, the value of this column is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Starts</code>: The start date and time for a
            recurring event. This is displayed as a
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value, and is
            <code class="literal">NULL</code> if no start date and time are
            defined for the event.
          </p><p>
            For a transient event, this column is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Ends</code>: The end date and time for a
            recurring event. This is displayed as a
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">DATETIME</code></a> value, and defaults
            to <code class="literal">NULL</code> if no end date and time is
            defined for the event.
          </p><p>
            For a transient event, this column is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>: The event status. One of
            <code class="literal">ENABLED</code>, <code class="literal">DISABLED</code>, or
            <code class="literal">SLAVESIDE_DISABLED</code>.
          </p><p>
            <code class="literal">SLAVESIDE_DISABLED</code> indicates that the
            creation of the event occurred on another MySQL server
            acting as a replication master and replicated to the current
            MySQL server which is acting as a slave, but the event is
            not presently being executed on the slave.
          </p></li><li class="listitem"><p>
            <code class="literal">Originator</code>: The server ID of the MySQL
            server on which the event was created. Defaults to 0.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code> is the session value
            of the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>
            system variable when the routine was created.
            <code class="literal">collation_connection</code> is the session value
            of the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
            system variable when the routine was created.
            <code class="literal">Database Collation</code> is the collation of
            the database with which the routine is associated.
</p></li></ul>
</div>
<p>
        For more information about <code class="literal">SLAVE_DISABLED</code> and
        the <code class="literal">Originator</code> column, see
        <a class="xref" href="replication.html#replication-features-invoked" title="17.4.1.11 Replication of Invoked Features">Section 17.4.1.11, “Replication of Invoked Features”</a>.
      </p><p>
        The event action statement is not shown in the output of
        <a class="link" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>. Use
        <a class="link" href="sql-syntax.html#show-create-event" title="13.7.5.9 SHOW CREATE EVENT Syntax"><code class="literal">SHOW CREATE EVENT</code></a> or the
        <a class="link" href="information-schema.html#events-table" title="21.7 The INFORMATION_SCHEMA EVENTS Table"><code class="literal">INFORMATION_SCHEMA.EVENTS</code></a> table.
      </p><p>
        Times displayed by <a class="link" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax"><code class="literal">SHOW EVENTS</code></a>
        are given in the event time zone, as discussed in
        <a class="xref" href="stored-programs-views.html#events-metadata" title="20.4.4 Event Metadata">Section 20.4.4, “Event Metadata”</a>.
      </p><p>
        The columns in the output of <a class="link" href="sql-syntax.html#show-events" title="13.7.5.19 SHOW EVENTS Syntax"><code class="literal">SHOW
        EVENTS</code></a> are similar to, but not identical to the
        columns in the
        <a class="link" href="information-schema.html#events-table" title="21.7 The INFORMATION_SCHEMA EVENTS Table"><code class="literal">INFORMATION_SCHEMA.EVENTS</code></a> table.
        See <a class="xref" href="information-schema.html#events-table" title="21.7 The INFORMATION_SCHEMA EVENTS Table">Section 21.7, “The INFORMATION_SCHEMA EVENTS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-function-code"></a>13.7.5.20 SHOW FUNCTION CODE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141678176"></a><pre class="programlisting">
SHOW FUNCTION CODE <em class="replaceable"><code>func_name</code></em>
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-procedure-code" title="13.7.5.28 SHOW PROCEDURE CODE Syntax"><code class="literal">SHOW PROCEDURE
        CODE</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-procedure-code" title="13.7.5.28 SHOW PROCEDURE CODE Syntax">Section 13.7.5.28, “SHOW PROCEDURE CODE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-function-status"></a>13.7.5.21 SHOW FUNCTION STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141669072"></a><pre class="programlisting">
SHOW FUNCTION STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement is similar to <a class="link" href="sql-syntax.html#show-procedure-status" title="13.7.5.29 SHOW PROCEDURE STATUS Syntax"><code class="literal">SHOW PROCEDURE
        STATUS</code></a> but for stored functions. See
        <a class="xref" href="sql-syntax.html#show-procedure-status" title="13.7.5.29 SHOW PROCEDURE STATUS Syntax">Section 13.7.5.29, “SHOW PROCEDURE STATUS Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-grants"></a>13.7.5.22 SHOW GRANTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141659600"></a><a class="indexterm" name="idm139737141658112"></a><a class="indexterm" name="idm139737141657040"></a><pre class="programlisting">
SHOW GRANTS [FOR <em class="replaceable"><code>user</code></em>]
</pre><p>
        This statement lists the <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>
        statement or statements that must be issued to duplicate the
        privileges that are granted to a MySQL user account.
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> requires the
        <a class="link" href="security.html#priv_select"><code class="literal">SELECT</code></a> privilege for the
        <code class="literal">mysql</code> database, except to see the privileges
        for the current user.
      </p><p>
        The account is named using the same format as for the
        <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a> statement; for example,
        <code class="literal">'jeffrey'@'localhost'</code>. If you specify only
        the user name part of the account name, a host name part of
        <code class="literal">'%'</code> is used. For additional information about
        specifying account names, see <a class="xref" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax">Section 13.7.1.4, “GRANT Syntax”</a>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW GRANTS FOR 'root'@'localhost';</code></strong>
+---------------------------------------------------------------------+
| Grants for root@localhost                                           |
+---------------------------------------------------------------------+
| GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' WITH GRANT OPTION |
+---------------------------------------------------------------------+
</pre><p>
        To list the privileges granted to the account that you are using
        to connect to the server, you can use any of the following
        statements:
      </p><pre class="programlisting">
SHOW GRANTS;
SHOW GRANTS FOR CURRENT_USER;
SHOW GRANTS FOR CURRENT_USER();
</pre><p>
        If <code class="literal">SHOW GRANTS FOR CURRENT_USER</code> (or any of
        the equivalent syntaxes) is used in <code class="literal">DEFINER</code>
        context, such as within a stored procedure that is defined with
        <code class="literal">SQL SECURITY DEFINER</code>), the grants displayed
        are those of the definer and not the invoker.
      </p><p>
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> displays only the
        privileges granted explicitly to the named account. Other
        privileges might be available to the account, but they are not
        displayed. For example, if an anonymous account exists, the
        named account might be able to use its privileges, but
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> will not display
        them.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-index"></a>13.7.5.23 SHOW INDEX Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141632560"></a><a class="indexterm" name="idm139737141629744"></a><a class="indexterm" name="idm139737141628672"></a><pre class="programlisting">
SHOW {INDEX | INDEXES | KEYS}
    {FROM | IN} <em class="replaceable"><code>tbl_name</code></em>
    [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> returns table index
        information. The format resembles that of the
        <code class="literal">SQLStatistics</code> call in ODBC. This statement
        requires some privilege for any column in the table.
      </p><p>
        <a class="link" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> returns the following
        fields:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Table</code>
          </p><p>
            The name of the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Non_unique</code>
          </p><p>
            0 if the index cannot contain duplicates, 1 if it can.
          </p></li><li class="listitem"><p>
            <code class="literal">Key_name</code>
          </p><p>
            The name of the index. If the index is the primary key, the
            name is always <code class="literal">PRIMARY</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Seq_in_index</code>
          </p><p>
            The column sequence number in the index, starting with 1.
          </p></li><li class="listitem"><p>
            <code class="literal">Column_name</code>
          </p><p>
            The column name.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737141607232"></a>

            <code class="literal">Collation</code>
          </p><p>
            How the column is sorted in the index. In MySQL, this can
            have values <span class="quote">“<span class="quote"><code class="literal">A</code></span>”</span> (Ascending)
            or <code class="literal">NULL</code> (Not sorted).
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737141601808"></a>

            <a class="indexterm" name="idm139737141599904"></a>

            <code class="literal">Cardinality</code>
          </p><p>
            An estimate of the number of unique values in the index.
            This is updated by running <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
            TABLE</code></a> or <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -a</strong></span></a>.
            <code class="literal">Cardinality</code> is counted based on
            statistics stored as integers, so the value is not
            necessarily exact even for small tables. The higher the
            cardinality, the greater the chance that MySQL uses the
            index when doing joins.
          </p></li><li class="listitem"><p>
            <code class="literal">Sub_part</code>
          </p><p>
            The number of indexed characters if the column is only
            partly indexed, <code class="literal">NULL</code> if the entire column
            is indexed.
          </p></li><li class="listitem"><p>
            <code class="literal">Packed</code>
          </p><p>
            Indicates how the key is packed. <code class="literal">NULL</code> if
            it is not.
          </p></li><li class="listitem"><p>
            <code class="literal">Null</code>
          </p><p>
            Contains <code class="literal">YES</code> if the column may contain
            <code class="literal">NULL</code> values and <code class="literal">''</code> if
            not.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_type</code>
          </p><p>
            The index method used (<code class="literal">BTREE</code>,
            <code class="literal">FULLTEXT</code>, <code class="literal">HASH</code>,
            <code class="literal">RTREE</code>).
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            Information about the index not described in its own column,
            such as <code class="literal">disabled</code> if the index is
            disabled.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_comment</code>
          </p><p>
            Any comment provided for the index with a
            <code class="literal">COMMENT</code> attribute when the index was
            created.
</p></li></ul>
</div>
<p>
        You can use
        <em class="replaceable"><code>db_name</code></em>.<em class="replaceable"><code>tbl_name</code></em>
        as an alternative to the
        <code class="literal"><em class="replaceable"><code>tbl_name</code></em> FROM
        <em class="replaceable"><code>db_name</code></em></code> syntax. These two
        statements are equivalent:
      </p><pre class="programlisting">
SHOW INDEX FROM mytable FROM mydb;
SHOW INDEX FROM mydb.mytable;
</pre><p>
        The <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        You can also list a table's indexes with the <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        -k <em class="replaceable"><code>db_name</code></em>
        <em class="replaceable"><code>tbl_name</code></em></strong></span></a> command.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-master-status"></a>13.7.5.24 SHOW MASTER STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141563872"></a><pre class="programlisting">
SHOW MASTER STATUS
</pre><p>
        This statement provides status information about the binary log
        files of the master. It requires either the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> or
        <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a> privilege.
      </p><p>
        Example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW MASTER STATUS\G</code></strong>
*************************** 1. row ***************************
             File: master-bin.000002
         Position: 1307
     Binlog_Do_DB: test
 Binlog_Ignore_DB: manual, mysql
Executed_Gtid_Set: 3E11FA47-71CA-11E1-9E33-C80AA9429562:1-5
1 row in set (0.00 sec)
</pre><p>
        The <code class="literal">Executed_Gtid_Set</code> column was added in
        MySQL 5.6.5. When global transaction IDs are in use, this column
        shows the set of GTIDs for transactions that have been executed
        on the master. This is the same as the value for the
        <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> system variable
        (named <a class="link" href="replication.html#sysvar_gtid_done"><code class="literal">gtid_done</code></a> prior to MySQL
        5.6.9) on this server, as well as the value for
        <code class="literal">Executed_Gtid_Set</code> in the output of
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> on this server.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-open-tables"></a>13.7.5.25 SHOW OPEN TABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141546880"></a><a class="indexterm" name="idm139737141544064"></a><pre class="programlisting">
SHOW OPEN TABLES [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.5.25 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a> lists the
        non-<code class="literal">TEMPORARY</code> tables that are currently open
        in the table cache. See <a class="xref" href="optimization.html#table-cache" title="8.4.3.1 How MySQL Opens and Closes Tables">Section 8.4.3.1, “How MySQL Opens and Closes Tables”</a>. The
        <code class="literal">FROM</code> clause, if present, restricts the tables
        shown to those present in the <em class="replaceable"><code>db_name</code></em>
        database. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if
        present, indicates which table names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.5.25 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a> output has the
        following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Database</code>
          </p><p>
            The database containing the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Table</code>
          </p><p>
            The table name.
          </p></li><li class="listitem"><p>
            <code class="literal">In_use</code>
          </p><p>
            The number of table locks or lock requests there are for the
            table. For example, if one client acquires a lock for a
            table using <code class="literal">LOCK TABLE t1 WRITE</code>,
            <code class="literal">In_use</code> will be 1. If another client
            issues <code class="literal">LOCK TABLE t1 WRITE</code> while the
            table remains locked, the client will block waiting for the
            lock, but the lock request causes <code class="literal">In_use</code>
            to be 2. If the count is zero, the table is open but not
            currently being used. <code class="literal">In_use</code> is also
            increased by the
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER ...
            OPEN</code></a> statement and decreased by
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER ...
            CLOSE</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Name_locked</code>
          </p><p>
            Whether the table name is locked. Name locking is used for
            operations such as dropping or renaming tables.
</p></li></ul>
</div>
<p>
        If you have no privileges for a table, it does not show up in
        the output from <a class="link" href="sql-syntax.html#show-open-tables" title="13.7.5.25 SHOW OPEN TABLES Syntax"><code class="literal">SHOW OPEN TABLES</code></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-plugins"></a>13.7.5.26 SHOW PLUGINS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141511488"></a><pre class="programlisting">
SHOW PLUGINS
</pre><p>
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.5.26 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> displays information
        about server plugins. Plugin information is also available in
        the <code class="literal">INFORMATION_SCHEMA.PLUGINS</code> table. See
        <a class="xref" href="information-schema.html#plugins-table" title="21.14 The INFORMATION_SCHEMA PLUGINS Table">Section 21.14, “The INFORMATION_SCHEMA PLUGINS Table”</a>.
      </p><p>
        Example of <a class="link" href="sql-syntax.html#show-plugins" title="13.7.5.26 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> output:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PLUGINS\G</code></strong>
*************************** 1. row ***************************
   Name: binlog
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 2. row ***************************
   Name: CSV
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 3. row ***************************
   Name: MEMORY
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
*************************** 4. row ***************************
   Name: MyISAM
 Status: ACTIVE
   Type: STORAGE ENGINE
Library: NULL
License: GPL
...
</pre><p>
        <a class="link" href="sql-syntax.html#show-plugins" title="13.7.5.26 SHOW PLUGINS Syntax"><code class="literal">SHOW PLUGINS</code></a> output has the
        following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Name</code>: The name used to refer to the
            plugin in statements such as <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
            PLUGIN</code></a> and <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
            PLUGIN</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Status</code>: The plugin status, one of
            <code class="literal">ACTIVE</code>, <code class="literal">INACTIVE</code>,
            <code class="literal">DISABLED</code>, or <code class="literal">DELETED</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Type</code>: The type of plugin, such as
            <code class="literal">STORAGE ENGINE</code>,
            <code class="literal">INFORMATION_SCHEMA</code>, or
            <code class="literal">AUTHENTICATION</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Library</code>: The name of the plugin shared
            object file. This is the name used to refer to the plugin
            file in statements such as <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
            PLUGIN</code></a> and <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
            PLUGIN</code></a>. This file is located in the directory
            named by the <a class="link" href="server-administration.html#sysvar_plugin_dir"><code class="literal">plugin_dir</code></a>
            system variable. If the library name is
            <code class="literal">NULL</code>, the plugin is compiled in and
            cannot be uninstalled with <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL
            PLUGIN</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">License</code>: How the plugin is licensed; for
            example, <code class="literal">GPL</code>.
</p></li></ul>
</div>
<p>
        For plugins installed with <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL
        PLUGIN</code></a>, the <code class="literal">Name</code> and
        <code class="literal">Library</code> values are also registered in the
        <code class="literal">mysql.plugin</code> table.
      </p><p>
        For information about plugin data structures that form the basis
        of the information displayed by <a class="link" href="sql-syntax.html#show-plugins" title="13.7.5.26 SHOW PLUGINS Syntax"><code class="literal">SHOW
        PLUGINS</code></a>, see <a class="xref" href="extending-mysql.html#plugin-api" title="24.2 The MySQL Plugin API">Section 24.2, “The MySQL Plugin API”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-privileges"></a>13.7.5.27 SHOW PRIVILEGES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141468592"></a><pre class="programlisting">
SHOW PRIVILEGES
</pre><p>
        <a class="link" href="sql-syntax.html#show-privileges" title="13.7.5.27 SHOW PRIVILEGES Syntax"><code class="literal">SHOW PRIVILEGES</code></a> shows the list of
        system privileges that the MySQL server supports. The exact list
        of privileges depends on the version of your server.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PRIVILEGES\G</code></strong>
*************************** 1. row ***************************
Privilege: Alter
  Context: Tables
  Comment: To alter the table
*************************** 2. row ***************************
Privilege: Alter routine
  Context: Functions,Procedures
  Comment: To alter or drop stored functions/procedures
*************************** 3. row ***************************
Privilege: Create
  Context: Databases,Tables,Indexes
  Comment: To create new databases and tables
*************************** 4. row ***************************
Privilege: Create routine
  Context: Databases
  Comment: To use CREATE FUNCTION/PROCEDURE
*************************** 5. row ***************************
Privilege: Create temporary tables
  Context: Databases
  Comment: To use CREATE TEMPORARY TABLE
...
</pre><p>
        Privileges belonging to a specific user are displayed by the
        <a class="link" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax"><code class="literal">SHOW GRANTS</code></a> statement. See
        <a class="xref" href="sql-syntax.html#show-grants" title="13.7.5.22 SHOW GRANTS Syntax">Section 13.7.5.22, “SHOW GRANTS Syntax”</a>, for more information.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-procedure-code"></a>13.7.5.28 SHOW PROCEDURE CODE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141455584"></a><pre class="programlisting">
SHOW PROCEDURE CODE <em class="replaceable"><code>proc_name</code></em>
</pre><p>
        This statement is a MySQL extension that is available only for
        servers that have been built with debugging support. It displays
        a representation of the internal implementation of the named
        stored procedure. A similar statement, <a class="link" href="sql-syntax.html#show-function-code" title="13.7.5.20 SHOW FUNCTION CODE Syntax"><code class="literal">SHOW
        FUNCTION CODE</code></a>, displays information about stored
        functions (see <a class="xref" href="sql-syntax.html#show-function-code" title="13.7.5.20 SHOW FUNCTION CODE Syntax">Section 13.7.5.20, “SHOW FUNCTION CODE Syntax”</a>).
      </p><p>
        To use either statement, you must be the owner of the routine or
        have <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> access to the
        <code class="literal">mysql.proc</code> table.
      </p><p>
        If the named routine is available, each statement produces a
        result set. Each row in the result set corresponds to one
        <span class="quote">“<span class="quote">instruction</span>”</span> in the routine. The first column is
        <code class="literal">Pos</code>, which is an ordinal number beginning
        with 0. The second column is <code class="literal">Instruction</code>,
        which contains an SQL statement (usually changed from the
        original source), or a directive which has meaning only to the
        stored-routine handler.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DELIMITER //</code></strong>
mysql&gt; <strong class="userinput"><code>CREATE PROCEDURE p1 ()</code></strong>
    -&gt; <strong class="userinput"><code>BEGIN</code></strong>
    -&gt;   <strong class="userinput"><code>DECLARE fanta INT DEFAULT 55;</code></strong>
    -&gt;   <strong class="userinput"><code>DROP TABLE t2;</code></strong>
    -&gt;   <strong class="userinput"><code>LOOP</code></strong>
    -&gt;     <strong class="userinput"><code>INSERT INTO t3 VALUES (fanta);</code></strong>
    -&gt;     <strong class="userinput"><code>END LOOP;</code></strong>
    -&gt;   <strong class="userinput"><code>END//</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROCEDURE CODE p1//</code></strong>
+-----+----------------------------------------+
| Pos | Instruction                            |
+-----+----------------------------------------+
|   0 | set fanta@0 55                         |
|   1 | stmt 9 "DROP TABLE t2"                 |
|   2 | stmt 5 "INSERT INTO t3 VALUES (fanta)" |
|   3 | jump 2                                 |
+-----+----------------------------------------+
4 rows in set (0.00 sec)
</pre><p>
        In this example, the nonexecutable <code class="literal">BEGIN</code> and
        <code class="literal">END</code> statements have disappeared, and for the
        <code class="literal">DECLARE
        <em class="replaceable"><code>variable_name</code></em></code> statement,
        only the executable part appears (the part where the default is
        assigned). For each statement that is taken from source, there
        is a code word <code class="literal">stmt</code> followed by a type (9
        means <code class="literal">DROP</code>, 5 means
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>, and so on). The final row
        contains an instruction <code class="literal">jump 2</code>, meaning
        <code class="literal">GOTO instruction #2</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-procedure-status"></a>13.7.5.29 SHOW PROCEDURE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141425008"></a><pre class="programlisting">
SHOW PROCEDURE STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        This statement is a MySQL extension. It returns characteristics
        of a stored procedure, such as the database, name, type,
        creator, creation and modification dates, and character set
        information. A similar statement, <a class="link" href="sql-syntax.html#show-function-status" title="13.7.5.21 SHOW FUNCTION STATUS Syntax"><code class="literal">SHOW
        FUNCTION STATUS</code></a>, displays information about stored
        functions (see <a class="xref" href="sql-syntax.html#show-function-status" title="13.7.5.21 SHOW FUNCTION STATUS Syntax">Section 13.7.5.21, “SHOW FUNCTION STATUS Syntax”</a>).
      </p><p>
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which procedure or function names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW PROCEDURE STATUS LIKE 'sp1'\G</code></strong>
*************************** 1. row ***************************
                  Db: test
                Name: sp1
                Type: PROCEDURE
             Definer: testuser@localhost
            Modified: 2004-08-03 15:29:37
             Created: 2004-08-03 15:29:37
       Security_type: DEFINER
             Comment:
character_set_client: latin1
collation_connection: latin1_swedish_ci
  Database Collation: latin1_swedish_ci
</pre><p>
        <code class="literal">character_set_client</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a> system
        variable when the routine was created.
        <code class="literal">collation_connection</code> is the session value of
        the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a> system
        variable when the routine was created. <code class="literal">Database
        Collation</code> is the collation of the database with which
        the routine is associated.
      </p><p>
        You can also get information about stored routines from the
        <a class="link" href="information-schema.html#routines-table" title="21.18 The INFORMATION_SCHEMA ROUTINES Table"><code class="literal">ROUTINES</code></a> table in
        <code class="literal">INFORMATION_SCHEMA</code>. See
        <a class="xref" href="information-schema.html#routines-table" title="21.18 The INFORMATION_SCHEMA ROUTINES Table">Section 21.18, “The INFORMATION_SCHEMA ROUTINES Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-processlist"></a>13.7.5.30 SHOW PROCESSLIST Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141401216"></a><a class="indexterm" name="idm139737141400144"></a><a class="indexterm" name="idm139737141399072"></a><a class="indexterm" name="idm139737141398000"></a><a class="indexterm" name="idm139737141396512"></a><a class="indexterm" name="idm139737141395024"></a><pre class="programlisting">
SHOW [FULL] PROCESSLIST
</pre><p>
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> shows you which
        threads are running. You can also get this information from the
        <code class="literal">INFORMATION_SCHEMA</code>
        <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">PROCESSLIST</code></a> table or the
        <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin processlist</strong></span></a> command. If you have
        the <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a> privilege, you can
        see all threads. Otherwise, you can see only your own threads
        (that is, threads associated with the MySQL account that you are
        using). If you do not use the <code class="literal">FULL</code> keyword,
        only the first 100 characters of each statement are shown in the
        <code class="literal">Info</code> field.
      </p><p>
        Process information is also available from the
        <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">performance_schema.threads</code></a> table.
        However, access to <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> does not
        require a mutex and has minimal impact on server performance.
        <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a> and
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> have negative
        performance consequences because they require a mutex.
        <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> also shows information
        about background threads, which
        <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a> and
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> do not. This
        means that <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> can be used to
        monitor activity the other thread information sources cannot.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> statement is
        very useful if you get the <span class="quote">“<span class="quote">too many connections</span>”</span>
        error message and want to find out what is going on. MySQL
        reserves one extra connection to be used by accounts that have
        the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, to ensure
        that administrators should always be able to connect and check
        the system (assuming that you are not giving this privilege to
        all your users).
      </p><p>
        Threads can be killed with the
        <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a> statement. See
        <a class="xref" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax">Section 13.7.6.4, “KILL Syntax”</a>.
      </p><p>
        Here is an example of <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
        PROCESSLIST</code></a> output:
      </p><pre class="programlisting">
mysql&gt; SHOW FULL PROCESSLIST\G
*************************** 1. row ***************************
Id: 1
User: system user
Host:
db: NULL
Command: Connect
Time: 1030455
State: Waiting for master to send event
Info: NULL
*************************** 2. row ***************************
Id: 2
User: system user
Host:
db: NULL
Command: Connect
Time: 1004
State: Has read all relay log; waiting for the slave
       I/O thread to update it
Info: NULL
*************************** 3. row ***************************
Id: 3112
User: replikator
Host: artemis:2204
db: NULL
Command: Binlog Dump
Time: 2144
State: Has sent all binlog to slave; waiting for binlog to be updated
Info: NULL
*************************** 4. row ***************************
Id: 3113
User: replikator
Host: iconnect2:45781
db: NULL
Command: Binlog Dump
Time: 2086
State: Has sent all binlog to slave; waiting for binlog to be updated
Info: NULL
*************************** 5. row ***************************
Id: 3123
User: stefan
Host: localhost
db: apollon
Command: Query
Time: 0
State: NULL
Info: SHOW FULL PROCESSLIST
5 rows in set (0.00 sec)
</pre><p>
        The columns produced by <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
        PROCESSLIST</code></a> have the following meanings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><a name="processlist_id"></a>
            <code class="literal">Id</code>
          </p><p>
            The connection identifier. This is the same type of value
            displayed in the <code class="literal">ID</code> column of the
            <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
            table, the <code class="literal">PROCESSLIST_ID</code> column of the
            Performance Schema <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a>
            table, and returned by the
            <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function.
          </p></li><li class="listitem"><p><a name="processlist_user"></a>
            <code class="literal">User</code>
          </p><p>
            The MySQL user who issued the statement. If this is
            <code class="literal">system user</code>, it refers to a nonclient
            thread spawned by the server to handle tasks internally.
            This could be the I/O or SQL thread used on replication
            slaves or a delayed-row handler. <code class="literal">unauthenticated
            user</code> refers to a thread that has become associated
            with a client connection but for which authentication of the
            client user has not yet been done.
            <code class="literal">event_scheduler</code> refers to the thread that
            monitors scheduled events. For <code class="literal">system
            user</code>, there is no host specified in the
            <code class="literal">Host</code> column.
          </p></li><li class="listitem"><p><a name="processlist_host"></a>
            <code class="literal">Host</code>
          </p><p>
            The host name of the client issuing the statement (except
            for <code class="literal">system user</code> where there is no host).
            <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> reports the
            host name for TCP/IP connections in
            <code class="literal"><em class="replaceable"><code>host_name</code></em>:<em class="replaceable"><code>client_port</code></em></code>
            format to make it easier to determine which client is doing
            what.
          </p></li><li class="listitem"><p><a name="processlist_db"></a>
            <code class="literal">db</code>
          </p><p>
            The default database, if one is selected, otherwise
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p><a name="processlist_command"></a>
            <code class="literal">Command</code>
          </p><p>
            The type of command the thread is executing. For
            descriptions for thread commands, see
            <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>. The value of this
            column corresponds to the
            <code class="literal">COM_<em class="replaceable"><code>xxx</code></em></code>
            commands of the client/server protocol and
            <code class="literal">Com_<em class="replaceable"><code>xxx</code></em></code> status
            variables. See <a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 Server Status Variables">Section 5.1.6, “Server Status Variables”</a>
          </p></li><li class="listitem"><p><a name="processlist_time"></a>
            <code class="literal">Time</code>
          </p><p>
            The time in seconds that the thread has been in its current
            state. For a slave SQL thread, the value is the number of
            seconds between the timestamp of the last replicated event
            and the real time of the slave machine. See
            <a class="xref" href="replication.html#replication-implementation-details" title="17.2.1 Replication Implementation Details">Section 17.2.1, “Replication Implementation Details”</a>.
          </p></li><li class="listitem"><p><a name="processlist_state"></a>
            <code class="literal">State</code>
          </p><p>
            An action, event, or state that indicates what the thread is
            doing. Descriptions for <code class="literal">State</code> values can
            be found at <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>.
          </p><p>
            Most states correspond to very quick operations. If a thread
            stays in a given state for many seconds, there might be a
            problem that needs to be investigated.
          </p><p>
            For the <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>
            statement, the value of <code class="literal">State</code> is
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p><a name="processlist_info"></a>
            <code class="literal">Info</code>
          </p><p>
            The statement the thread is executing, or
            <code class="literal">NULL</code> if it is not executing any
            statement. The statement might be the one sent to the
            server, or an innermost statement if the statement executes
            other statements. For example, if a <code class="literal">CALL</code>
            statement executes a stored procedure that is executing a
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement, the
            <code class="literal">Info</code> value shows the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-profile"></a>13.7.5.31 SHOW PROFILE Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141310416"></a><a class="indexterm" name="idm139737141309344"></a><pre class="programlisting">
SHOW PROFILE [<em class="replaceable"><code>type</code></em> [, <em class="replaceable"><code>type</code></em>] ... ]
    [FOR QUERY <em class="replaceable"><code>n</code></em>]
    [LIMIT <em class="replaceable"><code>row_count</code></em> [OFFSET <em class="replaceable"><code>offset</code></em>]]

<em class="replaceable"><code>type</code></em>:
    ALL
  | BLOCK IO
  | CONTEXT SWITCHES
  | CPU
  | IPC
  | MEMORY
  | PAGE FAULTS
  | SOURCE
  | SWAPS
</pre><p>
        The <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> and
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statements display
        profiling information that indicates resource usage for
        statements executed during the course of the current session.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          These statements are deprecated as of MySQL 5.6.7 and will be
          removed in a future MySQL release. Use the
          <a class="link" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema">Performance Schema</a>
          instead; see
          <a class="xref" href="performance-schema.html#performance-schema-query-profiling" title="22.15.1 Query Profiling Using Performance Schema">Section 22.15.1, “Query Profiling Using Performance Schema”</a>.
</p>
</div>
<p>
        Profiling is controlled by the
        <a class="link" href="server-administration.html#sysvar_profiling"><code class="literal">profiling</code></a> session variable,
        which has a default value of 0 (<code class="literal">OFF</code>).
        Profiling is enabled by setting
        <a class="link" href="server-administration.html#sysvar_profiling"><code class="literal">profiling</code></a> to 1 or
        <code class="literal">ON</code>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET profiling = 1;</code></strong>
</pre><p>
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> displays a list of
        the most recent statements sent to the server. The size of the
        list is controlled by the
        <a class="link" href="server-administration.html#sysvar_profiling_history_size"><code class="literal">profiling_history_size</code></a> session
        variable, which has a default value of 15. The maximum value is
        100. Setting the value to 0 has the practical effect of
        disabling profiling.
      </p><p>
        All statements are profiled except <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW
        PROFILE</code></a> and <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW
        PROFILES</code></a>, so you will find neither of those statements
        in the profile list. Malformed statements are profiled. For
        example, <code class="literal">SHOW PROFILING</code> is an illegal
        statement, and a syntax error occurs if you try to execute it,
        but it will show up in the profiling list.
      </p><p>
        <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays detailed
        information about a single statement. Without the <code class="literal">FOR
        QUERY <em class="replaceable"><code>n</code></em></code> clause, the output
        pertains to the most recently executed statement. If
        <code class="literal">FOR QUERY <em class="replaceable"><code>n</code></em></code> is
        included, <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays
        information for statement <em class="replaceable"><code>n</code></em>. The
        values of <em class="replaceable"><code>n</code></em> correspond to the
        <code class="literal">Query_ID</code> values displayed by
        <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a>.
      </p><p>
        The <code class="literal">LIMIT
        <em class="replaceable"><code>row_count</code></em></code> clause may be
        given to limit the output to
        <em class="replaceable"><code>row_count</code></em> rows. If
        <code class="literal">LIMIT</code> is given, <code class="literal">OFFSET
        <em class="replaceable"><code>offset</code></em></code> may be added to
        begin the output <em class="replaceable"><code>offset</code></em> rows into the
        full set of rows.
      </p><p>
        By default, <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a> displays
        <code class="literal">Status</code> and <code class="literal">Duration</code>
        columns. The <code class="literal">Status</code> values are like the
        <code class="literal">State</code> values displayed by
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a>, although there
        might be some minor differences in interpretion for the two
        statements for some status values (see
        <a class="xref" href="optimization.html#thread-information" title="8.14 Examining Thread Information">Section 8.14, “Examining Thread Information”</a>).
      </p><p>
        Optional <em class="replaceable"><code>type</code></em> values may be specified
        to display specific additional types of information:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">ALL</code> displays all information
          </p></li><li class="listitem"><p>
            <code class="literal">BLOCK IO</code> displays counts for block input
            and output operations
          </p></li><li class="listitem"><p>
            <code class="literal">CONTEXT SWITCHES</code> displays counts for
            voluntary and involuntary context switches
          </p></li><li class="listitem"><p>
            <code class="literal">CPU</code> displays user and system CPU usage
            times
          </p></li><li class="listitem"><p>
            <code class="literal">IPC</code> displays counts for messages sent and
            received
          </p></li><li class="listitem"><p>
            <code class="literal">MEMORY</code> is not currently implemented
          </p></li><li class="listitem"><p>
            <code class="literal">PAGE FAULTS</code> displays counts for major and
            minor page faults
          </p></li><li class="listitem"><p>
            <code class="literal">SOURCE</code> displays the names of functions
            from the source code, together with the name and line number
            of the file in which the function occurs
          </p></li><li class="listitem"><p>
            <code class="literal">SWAPS</code> displays swap counts
</p></li></ul>
</div>
<p>
        Profiling is enabled per session. When a session ends, its
        profiling information is lost.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SELECT @@profiling;</code></strong>
+-------------+
| @@profiling |
+-------------+
|           0 |
+-------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET profiling = 1;</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS t1;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)

mysql&gt; <strong class="userinput"><code>CREATE TABLE T1 (id INT);</code></strong>
Query OK, 0 rows affected (0.01 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILES;</code></strong>
+----------+----------+--------------------------+
| Query_ID | Duration | Query                    |
+----------+----------+--------------------------+
|        0 | 0.000088 | SET PROFILING = 1        |
|        1 | 0.000136 | DROP TABLE IF EXISTS t1  |
|        2 | 0.011947 | CREATE TABLE t1 (id INT) |
+----------+----------+--------------------------+
3 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE;</code></strong>
+----------------------+----------+
| Status               | Duration |
+----------------------+----------+
| checking permissions | 0.000040 |
| creating table       | 0.000056 |
| After create         | 0.011363 |
| query end            | 0.000375 |
| freeing items        | 0.000089 |
| logging slow query   | 0.000019 |
| cleaning up          | 0.000005 |
+----------------------+----------+
7 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE FOR QUERY 1;</code></strong>
+--------------------+----------+
| Status             | Duration |
+--------------------+----------+
| query end          | 0.000107 |
| freeing items      | 0.000008 |
| logging slow query | 0.000015 |
| cleaning up        | 0.000006 |
+--------------------+----------+
4 rows in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SHOW PROFILE CPU FOR QUERY 2;</code></strong>
+----------------------+----------+----------+------------+
| Status               | Duration | CPU_user | CPU_system |
+----------------------+----------+----------+------------+
| checking permissions | 0.000040 | 0.000038 |   0.000002 |
| creating table       | 0.000056 | 0.000028 |   0.000028 |
| After create         | 0.011363 | 0.000217 |   0.001571 |
| query end            | 0.000375 | 0.000013 |   0.000028 |
| freeing items        | 0.000089 | 0.000010 |   0.000014 |
| logging slow query   | 0.000019 | 0.000009 |   0.000010 |
| cleaning up          | 0.000005 | 0.000003 |   0.000002 |
+----------------------+----------+----------+------------+
7 rows in set (0.00 sec)
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Profiling is only partially functional on some architectures.
          For values that depend on the <code class="literal">getrusage()</code>
          system call, <code class="literal">NULL</code> is returned on systems
          such as Windows that do not support the call. In addition,
          profiling is per process and not per thread. This means that
          activity on threads within the server other than your own may
          affect the timing information that you see.
</p>
</div>
<p>
        You can also get profiling information from the
        <a class="link" href="information-schema.html#profiling-table" title="21.16 The INFORMATION_SCHEMA PROFILING Table"><code class="literal">PROFILING</code></a> table in
        <code class="literal">INFORMATION_SCHEMA</code>. See
        <a class="xref" href="information-schema.html#profiling-table" title="21.16 The INFORMATION_SCHEMA PROFILING Table">Section 21.16, “The INFORMATION_SCHEMA PROFILING Table”</a>. For example, the following
        queries produce the same result:
      </p><pre class="programlisting">
SHOW PROFILE FOR QUERY 2;

SELECT STATE, FORMAT(DURATION, 6) AS DURATION
FROM INFORMATION_SCHEMA.PROFILING
WHERE QUERY_ID = 2 ORDER BY SEQ;
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-profiles"></a>13.7.5.32 SHOW PROFILES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141230176"></a><pre class="programlisting">
SHOW PROFILES
</pre><p>
        The <a class="link" href="sql-syntax.html#show-profiles" title="13.7.5.32 SHOW PROFILES Syntax"><code class="literal">SHOW PROFILES</code></a> statement,
        together with <a class="link" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax"><code class="literal">SHOW PROFILE</code></a>,
        displays profiling information that indicates resource usage for
        statements executed during the course of the current session.
        For more information, see <a class="xref" href="sql-syntax.html#show-profile" title="13.7.5.31 SHOW PROFILE Syntax">Section 13.7.5.31, “SHOW PROFILE Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          These statements are deprecated as of MySQL 5.6.7 and will be
          removed in a future MySQL release. Use the Performance Schema
          instead; see <a class="xref" href="performance-schema.html" title="Chapter 22 MySQL Performance Schema">Chapter 22, <i>MySQL Performance Schema</i></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-relaylog-events"></a>13.7.5.33 SHOW RELAYLOG EVENTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141218688"></a><pre class="programlisting">
SHOW RELAYLOG EVENTS
   [IN '<em class="replaceable"><code>log_name</code></em>'] [FROM <em class="replaceable"><code>pos</code></em>] [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
</pre><p>
        Shows the events in the relay log of a replication slave. If you
        do not specify
        <code class="literal">'<em class="replaceable"><code>log_name</code></em>'</code>, the
        first relay log is displayed. This statement has no effect on
        the master.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          Issuing a <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.5.33 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a>
          with no <code class="literal">LIMIT</code> clause could start a very
          time- and resource-consuming process because the server
          returns to the client the complete contents of the relay log
          (including all statements modifying data that have been
          received by the slave).
</p>
</div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Note
</div>
<p>
          Some events relating to the setting of user and system
          variables are not included in the output from
          <a class="link" href="sql-syntax.html#show-relaylog-events" title="13.7.5.33 SHOW RELAYLOG EVENTS Syntax"><code class="literal">SHOW RELAYLOG EVENTS</code></a>. To get
          complete coverage of events within a relay log, use
          <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-slave-hosts"></a>13.7.5.34 SHOW SLAVE HOSTS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141199680"></a><pre class="programlisting">
SHOW SLAVE HOSTS
</pre><p>
        Displays a list of replication slaves currently registered with
        the master.
      </p><p>
        <code class="literal">SHOW SLAVE HOSTS</code> should be executed on a
        server that acts as a replication master. The statement displays
        information about servers that are or have been connected as
        replication slaves, with each row of the result corresponding to
        one slave server, as shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW SLAVE HOSTS</code></strong>;
+-----------+-----------+-------+-----------+--------------------------------------+
| Server_id | Host      | Port  | Master_id | Slave_UUID                           |
+-----------+-----------+-------+-----------+--------------------------------------+
|  192168010 | iconnect2 | 3306 | 192168011 | 14cb6624-7f93-11e0-b2c0-c80aa9429562 |
| 1921680101 | athena    | 3306 | 192168011 | 07af4990-f41f-11df-a566-7ac56fdaf645 |
+------------+-----------+------+-----------+--------------------------------------+
</pre>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Server_id</code>: The unique server ID of the
            slave server, as configured in the slave server's
            option file, or on the command line with
            <a class="link" href="replication.html#option_mysqld_server-id"><code class="option">--server-id=<em class="replaceable"><code>value</code></em></code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Host</code>: The host name of the slave server
            as specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-host"><code class="option">--report-host</code></a> option. This
            can differ from the machine name as configured in the
            operating system.
          </p></li><li class="listitem"><p>
            <code class="literal">User</code>: The slave server user name as,
            specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-user"><code class="option">--report-user</code></a> option.
            Statement output includes this column only if the master
            server is started with the
            <a class="link" href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a>
            option.
          </p></li><li class="listitem"><p>
            <code class="literal">Password</code>: The slave server password as,
            specified on the slave with the
            <a class="link" href="replication.html#option_mysqld_report-password"><code class="option">--report-password</code></a> option.
            Statement output includes this column only if the master
            server is started with the
            <a class="link" href="replication.html#option_mysqld_show-slave-auth-info"><code class="option">--show-slave-auth-info</code></a>
            option.
          </p></li><li class="listitem"><p>
            <code class="literal">Port</code>: The port on the master to which the
            slave server is listening, as specified on the slave with
            the <a class="link" href="replication.html#option_mysqld_report-port"><code class="option">--report-port</code></a> option.
          </p><p>
            In MySQL 5.6.5 and later, a zero in this column means that
            the slave port
            (<a class="link" href="replication.html#option_mysqld_report-port"><code class="option">--report-port</code></a>) was not set.
            Prior to MySQL 5.6.5, 3306 was used as the default in such
            cases (Bug #13333431).
          </p></li><li class="listitem"><p>
            <code class="literal">Master_id</code>: The unique server ID of the
            master server that the slave server is replicating from.
            This is the server ID of the server on which <code class="literal">SHOW
            SLAVE HOSTS</code> is executed, so this same value is
            listed for each row in the result.
          </p></li><li class="listitem"><p>
            <a class="indexterm" name="idm139737141171248"></a>

            <code class="literal">Slave_UUID</code>: The globally unique ID of
            this slave, as generated on the slave and found in the
            slave's <code class="filename">auto.cnf</code> file.
          </p><p>
            This column was added in MySQL 5.6.0.
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-slave-status"></a>13.7.5.35 SHOW SLAVE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737141165632"></a><pre class="programlisting">
SHOW SLAVE STATUS
</pre><p>
        This statement provides status information on essential
        parameters of the slave threads. It requires either the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> or
        <a class="link" href="security.html#priv_replication-client"><code class="literal">REPLICATION CLIENT</code></a> privilege.
      </p><p>
        If you issue this statement using the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a>
        client, you can use a <code class="literal">\G</code> statement terminator
        rather than a semicolon to obtain a more readable vertical
        layout:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW SLAVE STATUS\G</code></strong>
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: localhost
                  Master_User: root
                  Master_Port: 13000
                Connect_Retry: 60
              Master_Log_File: master-bin.000002
          Read_Master_Log_Pos: 1307
               Relay_Log_File: slave-relay-bin.000003
                Relay_Log_Pos: 1508
        Relay_Master_Log_File: master-bin.000002
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB:
          Replicate_Ignore_DB:
           Replicate_Do_Table:
       Replicate_Ignore_Table:
      Replicate_Wild_Do_Table:
  Replicate_Wild_Ignore_Table:
                   Last_Errno: 0
                   Last_Error:
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 1307
              Relay_Log_Space: 1858
              Until_Condition: None
               Until_Log_File:
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File:
           Master_SSL_CA_Path:
              Master_SSL_Cert:
            Master_SSL_Cipher:
               Master_SSL_Key:
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error:
               Last_SQL_Errno: 0
               Last_SQL_Error:
  Replicate_Ignore_Server_Ids:
             Master_Server_Id: 1
                  Master_UUID: 3e11fa47-71ca-11e1-9e33-c80aa9429562
             Master_Info_File: /var/mysqld.2/data/master.info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has read all relay log; waiting for the slave I/O thread to update it
           Master_Retry_Count: 10
                  Master_Bind:
      Last_IO_Error_Timestamp:
     Last_SQL_Error_Timestamp:
               Master_SSL_Crl:
           Master_SSL_Crlpath:
           Retrieved_Gtid_Set: 3e11fa47-71ca-11e1-9e33-c80aa9429562:1-5
            Executed_Gtid_Set: 3e11fa47-71ca-11e1-9e33-c80aa9429562:1-5
                Auto_Position: 1
1 row in set (0.00 sec)
</pre><p>
        The following list describes the fields returned by
        <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a>. For additional
        information about interpreting their meanings, see
        <a class="xref" href="optimization.html#slave-io-thread-states" title="8.14.6 Replication Slave I/O Thread States">Section 8.14.6, “Replication Slave I/O Thread States”</a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Slave_IO_State</code>
          </p><p>
            A copy of the <code class="literal">State</code> field of the
            <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> output for
            the slave I/O thread. This tells you what the thread is
            doing: trying to connect to the master, waiting for events
            from the master, reconnecting to the master, and so on. For
            a listing of possible states, see
            <a class="xref" href="optimization.html#slave-io-thread-states" title="8.14.6 Replication Slave I/O Thread States">Section 8.14.6, “Replication Slave I/O Thread States”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Host</code>
          </p><p>
            The master host that the slave is connected to.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_User</code>
          </p><p>
            The user name of the account used to connect to the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Port</code>
          </p><p>
            The port used to connect to the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Connect_Retry</code>
          </p><p>
            The number of seconds between connect retries (default 60).
            This can be set with the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Log_File</code>
          </p><p>
            The name of the master binary log file from which the I/O
            thread is currently reading.
          </p></li><li class="listitem"><p>
            <code class="literal">Read_Master_Log_Pos</code>
          </p><p>
            The position in the current master binary log file up to
            which the I/O thread has read.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_File</code>
          </p><p>
            The name of the relay log file from which the SQL thread is
            currently reading and executing.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_Pos</code>
          </p><p>
            The position in the current relay log file up to which the
            SQL thread has read and executed.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Master_Log_File</code>
          </p><p>
            The name of the master binary log file containing the most
            recent event executed by the SQL thread.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_IO_Running</code>
          </p><p>
            Whether the I/O thread is started and has connected
            successfully to the master. Internally, the state of this
            thread is represented by one of the following three values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p><b>MYSQL_SLAVE_NOT_RUN. </b>
                  The slave I/O thread is not running. For this state,
                  <code class="literal">Slave_IO_Running</code> is
                  <code class="literal">No</code>.
                </p></li><li class="listitem"><p><b>MYSQL_SLAVE_RUN_NOT_CONNECT. </b>
                  The slave I/O thread is running, but is not connected
                  to a replication master. For this state,
                  <code class="literal">Slave_IO_Running</code> depends on the
                  server version as shown in the following table.
</p>
<div class="informaltable">
<table summary="For the
                  MYSQL_SLAVE_RUN_NOT_CONNECT state,
                  Slave_IO_Running depends on the
                  MySQL server version. This table shows MySQL version
                  dependency for
Slave_IO_Running." border="1"><colgroup><col><col></colgroup><thead><tr><th scope="col">MySQL Version</th><th scope="col"><code class="literal">Slave_IO_Running</code></th></tr></thead><tbody><tr><td scope="row">4.1 (4.1.13 and earlier); 5.0 (5.0.11 and earlier)</td><td><code class="literal">Yes</code></td></tr><tr><td scope="row">4.1 (4.1.14 and later); 5.0 (5.0.12 and later)</td><td><code class="literal">No</code></td></tr><tr><td scope="row">5.1 (5.1.45 and earlier)</td><td><code class="literal">No</code></td></tr><tr><td scope="row">5.1 (5.1.46 and later); 5.5; 5.6</td><td><code class="literal">Connecting</code></td></tr></tbody></table>
</div>
</li><li class="listitem"><p><b>MYSQL_SLAVE_RUN_CONNECT. </b>
                  The slave I/O thread is running, and is connected to a
                  replication master. For this state,
                  <code class="literal">Slave_IO_Running</code> is
                  <code class="literal">Yes</code>.
</p></li></ul>
</div>
<p>
            The value of the
            <a class="link" href="server-administration.html#statvar_Slave_running"><code class="literal">Slave_running</code></a> system
            status variable corresponds with this value.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_SQL_Running</code>
          </p><p>
            Whether the SQL thread is started.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Do_DB</code>,
            <code class="literal">Replicate_Ignore_DB</code>
          </p><p>
            The lists of databases that were specified with the
            <a class="link" href="replication.html#option_mysqld_replicate-do-db"><code class="option">--replicate-do-db</code></a> and
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-db"><code class="option">--replicate-ignore-db</code></a>
            options, if any.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Do_Table</code>,
            <code class="literal">Replicate_Ignore_Table</code>,
            <code class="literal">Replicate_Wild_Do_Table</code>,
            <code class="literal">Replicate_Wild_Ignore_Table</code>
          </p><p>
            The lists of tables that were specified with the
            <a class="link" href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>,
            <a class="link" href="replication.html#option_mysqld_replicate-ignore-table"><code class="option">--replicate-ignore-table</code></a>,
            <a class="link" href="replication.html#option_mysqld_replicate-wild-do-table"><code class="option">--replicate-wild-do-table</code></a>,
            and
            <a class="link" href="replication.html#option_mysqld_replicate-wild-ignore-table"><code class="option">--replicate-wild-ignore-table</code></a>
            options, if any.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_Errno</code>, <code class="literal">Last_Error</code>
          </p><p>
            These columns are aliases for
            <code class="literal">Last_SQL_Errno</code> and
            <code class="literal">Last_SQL_Error</code>.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              When the slave SQL thread receives an error, it reports
              the error first, then stops the SQL thread. This means
              that there is a small window of time during which
              <a class="link" href="sql-syntax.html#show-slave-status" title="13.7.5.35 SHOW SLAVE STATUS Syntax"><code class="literal">SHOW SLAVE STATUS</code></a> shows a
              nonzero value for <code class="literal">Last_SQL_Errno</code> even
              though <code class="literal">Slave_SQL_Running</code> still displays
              <code class="literal">Yes</code>.
</p>
</div>
</li><li class="listitem"><p>
            <code class="literal">Skip_Counter</code>
          </p><p>
            The current value of the
            <a class="link" href="replication.html#sysvar_sql_slave_skip_counter"><code class="literal">sql_slave_skip_counter</code></a>
            system variable. See
            <a class="xref" href="sql-syntax.html#set-global-sql-slave-skip-counter" title="13.4.2.4 SET GLOBAL sql_slave_skip_counter Syntax">Section 13.4.2.4, “SET GLOBAL sql_slave_skip_counter Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Exec_Master_Log_Pos</code>
          </p><p>
            The position in the current master binary log file to which
            the SQL thread has read and executed, marking the start of
            the next transaction or event to be processed. You can use
            this value with the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement's
            <code class="literal">MASTER_LOG_POS</code> option when starting a new
            slave from an existing slave, so that the new slave reads
            from this point. The coordinates given by
            (<code class="literal">Relay_Master_Log_File</code>,
            <code class="literal">Exec_Master_Log_Pos</code>) in the master's
            binary log correspond to the coordinates given by
            (<code class="literal">Relay_Log_File</code>,
            <code class="literal">Relay_Log_Pos</code>) in the relay log.
          </p><p>
            When using a multi-threaded slave (by setting
            <a class="link" href="replication.html#sysvar_slave_parallel_workers"><code class="literal">slave_parallel_workers</code></a> to a
            nonzero value in MySQL 5.6.3 and later), the value in this
            column actually represents a <span class="quote">“<span class="quote">low-water</span>”</span> mark,
            before which no uncommitted transactions remain. Because the
            current implementation allows execution of transactions on
            different databases in a different order on the slave than
            on the master, this is not necessarily the position of the
            most recently executed transaction.
          </p></li><li class="listitem"><p>
            <code class="literal">Relay_Log_Space</code>
          </p><p>
            The total combined size of all existing relay log files.
          </p></li><li class="listitem"><p>
            <code class="literal">Until_Condition</code>,
            <code class="literal">Until_Log_File</code>,
            <code class="literal">Until_Log_Pos</code>
          </p><p>
            The values specified in the <code class="literal">UNTIL</code> clause
            of the <a class="link" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax"><code class="literal">START SLAVE</code></a> statement.
          </p><p>
            <code class="literal">Until_Condition</code> has these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">None</code> if no <code class="literal">UNTIL</code>
                clause was specified
              </p></li><li class="listitem"><p>
                <code class="literal">Master</code> if the slave is reading until
                a given position in the master's binary log
              </p></li><li class="listitem"><p>
                <code class="literal">Relay</code> if the slave is reading until a
                given position in its relay log
</p></li></ul>
</div>
<p>
            Starting with MySQL 5.6.6 <code class="literal">UNTIL</code> clauses
            related to GTIDs were added that have these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">SQL_BEFORE_GTIDS</code> if the slave SQL
                thread is processing transactions until it has reached
                the first transaction whose GTID is listed in the
                <code class="literal">gtid_set</code>.
              </p></li><li class="listitem"><p>
                <code class="literal">SQL_AFTER_GTIDS</code> if the slave threads
                are processing all transactions until the last
                transaction in the <code class="literal">gtid_set</code> has been
                processed by both threads.
              </p></li><li class="listitem"><p>
                <code class="literal">SQL_AFTER_MTS_GAPS</code> if a
                multi-threaded slave's SQL threads are running until no
                more gaps are found in the relay log.
</p></li></ul>
</div>
<p>
            <code class="literal">Until_Log_File</code> and
            <code class="literal">Until_Log_Pos</code> indicate the log file name
            and position that define the coordinates at which the SQL
            thread stops executing.
          </p><p>
            For more information on <code class="literal">UNTIL</code> clauses,
            see <a class="xref" href="sql-syntax.html#start-slave" title="13.4.2.5 START SLAVE Syntax">Section 13.4.2.5, “START SLAVE Syntax”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_SSL_Allowed</code>,
            <code class="literal">Master_SSL_CA_File</code>,
            <code class="literal">Master_SSL_CA_Path</code>,
            <code class="literal">Master_SSL_Cert</code>,
            <code class="literal">Master_SSL_Cipher</code>,
            <code class="literal">Master_SSL_CRL_File</code>,
            <code class="literal">Master_SSL_CRL_Path</code>,
            <code class="literal">Master_SSL_Key</code>,
            <code class="literal">Master_SSL_Verify_Server_Cert</code>
          </p><p>
            These fields show the SSL parameters used by the slave to
            connect to the master, if any.
          </p><p>
            <code class="literal">Master_SSL_Allowed</code> has these values:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">Yes</code> if an SSL connection to the
                master is permitted
              </p></li><li class="listitem"><p>
                <code class="literal">No</code> if an SSL connection to the master
                is not permitted
              </p></li><li class="listitem"><p>
                <code class="literal">Ignored</code> if an SSL connection is
                permitted but the slave server does not have SSL support
                enabled
</p></li></ul>
</div>
<p>
            The values of the other SSL-related fields correspond to the
            values of the <code class="literal">MASTER_SSL_CA</code>,
            <code class="literal">MASTER_SSL_CAPATH</code>,
            <code class="literal">MASTER_SSL_CERT</code>,
            <code class="literal">MASTER_SSL_CIPHER</code>,
            <code class="literal">MASTER_SSL_CRL</code>,
            <code class="literal">MASTER_SSL_CRLPATH</code>,
            <code class="literal">MASTER_SSL_KEY</code>, and
            <code class="literal">MASTER_SSL_VERIFY_SERVER_CERT</code> options to
            the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement. See <a class="xref" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax">Section 13.4.2.1, “CHANGE MASTER TO Syntax”</a>.
          </p><p>
            <code class="literal">Master_SSL_CRL_File</code> and
            <code class="literal">Master_SSL_CRL_Path</code> were added in MySQL
            5.6.3.
          </p></li><li class="listitem"><p>
            <code class="literal">Seconds_Behind_Master</code>
          </p><p>
            This field is an indication of how <span class="quote">“<span class="quote">late</span>”</span> the
            slave is:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                When the slave is actively processing updates, this
                field shows the difference between the current timestamp
                on the slave and the original timestamp logged on the
                master for the event currently being processed on the
                slave.
              </p></li><li class="listitem"><p>
                When no event is currently being processed on the slave,
                this value is 0.
</p></li></ul>
</div>
<p>
            In essence, this field measures the time difference in
            seconds between the slave SQL thread and the slave I/O
            thread. If the network connection between master and slave
            is fast, the slave I/O thread is very close to the master,
            so this field is a good approximation of how late the slave
            SQL thread is compared to the master. If the network is
            slow, this is <span class="emphasis"><em>not</em></span> a good approximation;
            the slave SQL thread may quite often be caught up with the
            slow-reading slave I/O thread, so
            <code class="literal">Seconds_Behind_Master</code> often shows a value
            of 0, even if the I/O thread is late compared to the master.
            In other words, <span class="emphasis"><em>this column is useful only for
            fast networks</em></span>.
          </p><p>
            This time difference computation works even if the master
            and slave do not have identical clock times, provided that
            the difference, computed when the slave I/O thread starts,
            remains constant from then on. Any changes—including
            NTP updates—can lead to clock skews that can make
            calculation of <code class="literal">Seconds_Behind_Master</code> less
            reliable.
          </p><p>
            In MySQL 5.6.9 and later, this field is
            <code class="literal">NULL</code> (undefined or unknown) if the slave
            SQL thread is not running, or if the SQL thread has consumed
            all of the relay log and the slave I/O thread is not
            running. Previously, this field was <code class="literal">NULL</code>
            if the slave SQL thread or the slave I/O thread was not
            running or was not connected to the master. (Bug #12946333)
            For example, if (prior to MySQL 5.6.9) the slave I/O thread
            was running but was not connected to the master and was
            sleeping for the number of seconds given by the
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement or
            <a class="link" href="replication.html#option_mysqld_master-connect-retry"><code class="option">--master-connect-retry</code></a> option
            (default 60) before reconnecting, the value was
            <code class="literal">NULL</code>. Now in such cases, the connection
            to the master is not tested; instead, if the I/O thread is
            running but the relay log is exhausted,
            <code class="literal">Seconds_Behind_Master</code> is set to 0.
          </p><p>
            The value of <code class="literal">Seconds_Behind_Master</code> is
            based on the timestamps stored in events, which are
            preserved through replication. This means that if a master
            M1 is itself a slave of M0, any event from M1's binary log
            that originates from M0's binary log has M0's timestamp for
            that event. This enables MySQL to replicate
            <a class="link" href="data-types.html#datetime" title="11.3.1 The DATE, DATETIME, and TIMESTAMP Types"><code class="literal">TIMESTAMP</code></a> successfully.
            However, the problem for
            <code class="literal">Seconds_Behind_Master</code> is that if M1 also
            receives direct updates from clients, the
            <code class="literal">Seconds_Behind_Master</code> value randomly
            fluctuates because sometimes the last event from M1
            originates from M0 and sometimes is the result of a direct
            update on M1.
          </p><p>
            When using a multi-threaded slave (MySQL 5.6.3 and later),
            you should keep in mind that this value is based on
            <code class="literal">Exec_Master_Log_Pos</code>, and so may not
            reflect the position of the most recently committed
            transaction.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_IO_Errno</code>,
            <code class="literal">Last_IO_Error</code>
          </p><p>
            The error number and error message of the most recent error
            that caused the I/O thread to stop. An error number of 0 and
            message of the empty string mean <span class="quote">“<span class="quote">no error.</span>”</span> If
            the <code class="literal">Last_IO_Error</code> value is not empty, the
            error values also appear in the slave's error log.
          </p><p>
            Beginning with MySQL 5.6.1, I/O error information includes a
            timestamp showing when the most recent I/O thread error
            occurred. This timestamp uses the format <code class="literal">YYMMDD
            HH:MM:SS</code>.
          </p><p>
            Previous to MySQL 5.6.3, this timestamp was prefixed to the
            error message text shown in the
            <code class="literal">Last_IO_Error</code> column. In MySQL 5.6.3 and
            later, the timestamp appears instead in the
            <code class="literal">Last_SQL_Error_Timestamp</code> column.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_SQL_Errno</code>,
            <code class="literal">Last_SQL_Error</code>
          </p><p>
            The error number and error message of the most recent error
            that caused the SQL thread to stop. An error number of 0 and
            message of the empty string mean <span class="quote">“<span class="quote">no error.</span>”</span> If
            the <code class="literal">Last_SQL_Error</code> value is not empty,
            the error values also appear in the slave's error log.
          </p><p>
            Beginning with MySQL 5.6.1, SQL error information includes a
            timestamp showing when the most recent SQL thread error
            occurred. This timestamp uses the format <code class="literal">YYMMDD
            HH:MM:SS</code>.
          </p><p>
            Previous to MySQL 5.6.3, this timestamp was prefixed to the
            error message text shown in the
            <code class="literal">Last_SQL_Error</code> column. In MySQL 5.6.3 and
            later, the timestamp appears instead in the
            <code class="literal">Last_SQL_Error_Timestamp</code> column.
          </p><p>
            Issuing <a class="link" href="sql-syntax.html#reset-master" title="13.4.1.2 RESET MASTER Syntax"><code class="literal">RESET MASTER</code></a> or
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> resets the values
            shown in these columns.
          </p></li><li class="listitem"><p>
            <code class="literal">Replicate_Ignore_Server_Ids</code>
          </p><p>
            In MySQL 5.6, you set a slave to ignore events
            from 0 or more masters using the
            <code class="literal">IGNORE_SERVER_IDS</code> option of the
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a> statement.
            By default this is blank, and is usually modified only when
            using a circular or other multi-master replication setup.
            The message shown for
            <code class="literal">Replicate_Ignore_Server_Ids</code> when not
            blank consists of a comma-delimited list of one or more
            numbers, indicating the server IDs to be ignored. For
            example:
          </p><pre class="programlisting">
	Replicate_Ignore_Server_Ids: 2, 6, 9
</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
              <code class="literal">Ignored_server_ids</code> also shows the
              server IDs to be ignored, but is a space-delimited list,
              which is preceded by the total number of server IDs to be
              ignored. For example, if a <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE
              MASTER TO</code></a> statement containing the
              <code class="literal">IGNORE_SERVER_IDS = (2,6,9)</code> option has
              been issued to tell a slave to ignore masters having the
              server ID 2, 6, or 9, that information appears as:
            </p><pre class="programlisting">
	Ignored_server_ids: 3 2 6 9
</pre><p>
              where <code class="literal">3</code> is the total number of server
              IDs being ignored.
</p>
</div>
<p>
            <code class="literal">Replicate_Ignore_Server_Ids</code> filtering is
            performed by the I/O thread, rather than by the SQL thread,
            which means that events which are filtered out are not
            written to the relay log. This differs from the filtering
            actions taken by server options such
            <a class="link" href="replication.html#option_mysqld_replicate-do-table"><code class="option">--replicate-do-table</code></a>, which
            apply to the SQL thread.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Server_Id</code>
          </p><p>
            The <a class="link" href="server-administration.html#sysvar_server_id"><code class="literal">server_id</code></a> value from
            the master.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_UUID</code>
          </p><p>
            The <a class="link" href="replication.html#sysvar_server_uuid"><code class="literal">server_uuid</code></a> value from
            the master. This field was added in MySQL 5.6.0.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Info_File</code>
          </p><p>
            The location of the <code class="filename">master.info</code> file.
            This field was added in MySQL 5.6.0.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL_Delay</code>
          </p><p>
            The number of seconds that the slave must lag the master.
            This field was added in MySQL 5.6.0.
          </p></li><li class="listitem"><p>
            <code class="literal">SQL_Remaining_Delay</code>
          </p><p>
            When <code class="literal">Slave_SQL_Running_State</code> is
            <code class="literal">Waiting until MASTER_DELAY seconds after master
            executed event</code>, this field contains the number of
            delay seconds remaining. At other times, this field is
            <code class="literal">NULL</code>. This field was added in MySQL
            5.6.0.
          </p></li><li class="listitem"><p>
            <code class="literal">Slave_SQL_Running_State</code>
          </p><p>
            The state of the SQL thread (analogous to
            <code class="literal">Slave_IO_State</code>). The value is identical
            to the <code class="literal">State</code> value of the SQL thread as
            displayed by <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW
            PROCESSLIST</code></a>;
            <a class="xref" href="optimization.html#slave-sql-thread-states" title="8.14.7 Replication Slave SQL Thread States">Section 8.14.7, “Replication Slave SQL Thread States”</a>, provides a
            listing of possible states. This field was added in MySQL
            5.6.0.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Retry_Count</code>
          </p><p>
            The number of times the slave can attempt to reconnect to
            the master in the event of a lost connection. This value can
            be set using the <code class="literal">MASTER_RETRY_COUNT</code>
            option of the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER
            TO</code></a> statement (preferred) or the older
            <a class="link" href="replication.html#option_mysqld_master-retry-count"><code class="option">--master-retry-count</code></a> server
            option (still supported for backward compatibility). This
            field was added in MySQL 5.6.1.
          </p></li><li class="listitem"><p>
            <code class="literal">Master_Bind</code>
          </p><p>
            The network interface that the slave is bound to, if any.
            This is set using the <code class="literal">MASTER_BIND</code> option
            for the <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>
            statement.
          </p><p>
            This column was added in MySQL 5.6.2.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_IO_Error_Timestamp</code>
          </p><p>
            A timestamp in <code class="literal">YYMMDD HH:MM:SS</code> format
            that shows when the most recent I/O error took place.
          </p><p>
            This column was added in MySQL 5.6.3. Previously in MySQL
            5.6, this timestamp was prepended to the error text shown in
            <code class="literal">Last_IO_Error</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Last_SQL_Error_Timestamp</code>
          </p><p>
            A timestamp in <code class="literal">YYMMDD HH:MM:SS</code> format
            that shows when the most recent SQL error occurred.
          </p><p>
            This column was added in MySQL 5.6.3. Previously in MySQL
            5.6, this timestamp was prepended to the error text shown in
            <code class="literal">Last_SQL_Error</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Retrieved_Gtid_Set</code>
          </p><p>
            The set of global transaction IDs corresponding to all
            transactions received by this slave. Empty if GTIDs are not
            in use.
          </p><p>
            This is the set of all GTIDs that exist or have existed in
            the relay logs. Each GTID is added as soon as the
            <code class="literal">Gtid_log_event</code> is received. This can
            cause partially transmitted transactions to have their GTIDs
            included in the set.
          </p><p>
            When all relay logs are lost due to executing
            <a class="link" href="sql-syntax.html#reset-slave" title="13.4.2.3 RESET SLAVE Syntax"><code class="literal">RESET SLAVE</code></a> or
            <a class="link" href="sql-syntax.html#change-master-to" title="13.4.2.1 CHANGE MASTER TO Syntax"><code class="literal">CHANGE MASTER TO</code></a>, or due to
            the effects of the
            <a class="link" href="replication.html#option_mysqld_relay-log-recovery"><code class="option">--relay-log-recovery</code></a> option,
            the set is cleared. When
            <a class="link" href="server-administration.html#sysvar_relay_log_purge"><code class="literal">relay_log_purge = 1</code></a>, the
            newest relay log is always kept, and the set is not cleared.
          </p><p>
            This column was added in MySQL 5.6.5.
          </p><p>
            Prior to MySQL 5.6.10, this value was printed using
            uppercase. In MySQL 5.6.10 and later, it is always printed
            using lowercase. (Bug #15869441)
          </p></li><li class="listitem"><p>
            <code class="literal">Executed_Gtid_Set</code>
          </p><p>
            The set of global transaction IDs written in the binary log.
            This is the same as the value for the global
            <a class="link" href="replication.html#sysvar_gtid_executed"><code class="literal">gtid_executed</code></a> system
            variable (named <a class="link" href="replication.html#sysvar_gtid_done"><code class="literal">gtid_done</code></a>
            prior to MySQL 5.6.9) on this server, as well as the value
            for <code class="literal">Executed_Gtid_Set</code> in the output of
            <a class="link" href="sql-syntax.html#show-master-status" title="13.7.5.24 SHOW MASTER STATUS Syntax"><code class="literal">SHOW MASTER STATUS</code></a> on this
            server. Empty if GTIDs are not in use.
          </p><p>
            This column was added in MySQL 5.6.5.
          </p><p>
            Prior to MySQL 5.6.10, this value was printed using
            uppercase. In MySQL 5.6.10 and later, it is always printed
            using lowercase. (Bug #15869441)
          </p></li><li class="listitem"><p>
            <code class="literal">Auto_Position</code>
          </p><p>
            1 if autopositioning is in use; otherwise 0.
          </p><p>
            This column was added in MySQL 5.6.10. (Bug #15992220)
</p></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-status"></a>13.7.5.36 SHOW STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140890672"></a><a class="indexterm" name="idm139737140889600"></a><pre class="programlisting">
SHOW [GLOBAL | SESSION] STATUS
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><a class="indexterm" name="idm139737140884480"></a><p>
        <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> provides server
        status information (see
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 Server Status Variables">Section 5.1.6, “Server Status Variables”</a>). This statement does
        not require any privilege. It requires only the ability to
        connect to the server.
      </p><p>
        Status variable information is also available from these
        sources:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="information-schema.html#variables-table" title="21.9 The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables"><code class="literal">GLOBAL_STATUS</code></a>
            and
            <a class="link" href="information-schema.html#variables-table" title="21.9 The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables"><code class="literal">SESSION_STATUS</code></a>
            tables. See <a class="xref" href="information-schema.html#status-table" title="21.8 The INFORMATION_SCHEMA GLOBAL_STATUS and SESSION_STATUS Tables">Section 21.8, “The INFORMATION_SCHEMA GLOBAL_STATUS and SESSION_STATUS Tables”</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin extended-status</strong></span></a> command.
            See <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p></li></ul>
</div>
<p>
        For <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a>, a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which variable names to match. A <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW STATUS</code></a> accepts an optional
        <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code> variable
        scope modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With a <code class="literal">GLOBAL</code> modifier, the statement
            displays the global status values. A global status variable
            may represent status for some aspect of the server itself
            (for example, <code class="literal">Aborted_connects</code>), or the
            aggregated status over all connections to MySQL (for
            example, <code class="literal">Bytes_received</code> and
            <code class="literal">Bytes_sent</code>). If a variable has no global
            value, the session value is displayed.
          </p></li><li class="listitem"><p>
            With a <code class="literal">SESSION</code> modifier, the statement
            displays the status variable values for the current
            connection. If a variable has no session value, the global
            value is displayed. <code class="literal">LOCAL</code> is a synonym
            for <code class="literal">SESSION</code>.
          </p></li><li class="listitem"><p>
            If no modifier is present, the default is
            <code class="literal">SESSION</code>.
</p></li></ul>
</div>
<p>
        The scope for each status variable is listed at
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 Server Status Variables">Section 5.1.6, “Server Status Variables”</a>.
      </p><p>
        Each invocation of the <a class="link" href="sql-syntax.html#show-status" title="13.7.5.36 SHOW STATUS Syntax"><code class="literal">SHOW
        STATUS</code></a> statement uses an internal temporary table and
        increments the global
        <a class="link" href="server-administration.html#statvar_Created_tmp_tables"><code class="literal">Created_tmp_tables</code></a> value.
      </p><p>
        Partial output is shown here. The list of names and values may
        differ for your server. The meaning of each variable is given in
        <a class="xref" href="server-administration.html#server-status-variables" title="5.1.6 Server Status Variables">Section 5.1.6, “Server Status Variables”</a>.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS;</code></strong>
+--------------------------+------------+
| Variable_name            | Value      |
+--------------------------+------------+
| Aborted_clients          | 0          |
| Aborted_connects         | 0          |
| Bytes_received           | 155372598  |
| Bytes_sent               | 1176560426 |
| Connections              | 30023      |
| Created_tmp_disk_tables  | 0          |
| Created_tmp_tables       | 8340       |
| Created_tmp_files        | 60         |
...
| Open_tables              | 1          |
| Open_files               | 2          |
| Open_streams             | 0          |
| Opened_tables            | 44600      |
| Questions                | 2026873    |
...
| Table_locks_immediate    | 1920382    |
| Table_locks_waited       | 0          |
| Threads_cached           | 0          |
| Threads_created          | 30022      |
| Threads_connected        | 1          |
| Threads_running          | 1          |
| Uptime                   | 80380      |
+--------------------------+------------+
</pre><p>
        With a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, the statement
        displays only rows for those variables with names that match the
        pattern:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW STATUS LIKE 'Key%';</code></strong>
+--------------------+----------+
| Variable_name      | Value    |
+--------------------+----------+
| Key_blocks_used    | 14955    |
| Key_read_requests  | 96854827 |
| Key_reads          | 162040   |
| Key_write_requests | 7589728  |
| Key_writes         | 3813196  |
+--------------------+----------+
</pre>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-table-status"></a>13.7.5.37 SHOW TABLE STATUS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140841920"></a><a class="indexterm" name="idm139737140840464"></a><a class="indexterm" name="idm139737140838976"></a><pre class="programlisting">
SHOW TABLE STATUS [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> works likes
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.5.38 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a>, but provides a lot
        of information about each non-<code class="literal">TEMPORARY</code>
        table. You can also get this list using the <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        --status <em class="replaceable"><code>db_name</code></em></strong></span></a> command.
        The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present,
        indicates which table names to match. The
        <code class="literal">WHERE</code> clause can be given to select rows
        using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        This statement also displays information about views.
      </p><p>
        <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a> output has the
        following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Name</code>
          </p><p>
            The name of the table.
          </p></li><li class="listitem"><p>
            <code class="literal">Engine</code>
          </p><p>
            The storage engine for the table. See
            <a class="xref" href="storage-engines.html" title="Chapter 15 Alternative Storage Engines">Chapter 15, <i>Alternative Storage Engines</i></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Version</code>
          </p><p>
            The version number of the table's <code class="filename">.frm</code>
            file.
          </p></li><li class="listitem"><p>
            <code class="literal">Row_format</code>
          </p><p>
            The row-storage format (<code class="literal">Fixed</code>,
            <code class="literal">Dynamic</code>, <code class="literal">Compressed</code>,
            <code class="literal">Redundant</code>, <code class="literal">Compact</code>).
            For <code class="literal">MyISAM</code> tables,
            (<code class="literal">Dynamic</code> corresponds to what
            <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -dvv</strong></span></a> reports as
            <code class="literal">Packed</code>. The format of
            <code class="literal">InnoDB</code> tables is reported as
            <code class="literal">Redundant</code> or <code class="literal">Compact</code>.
            For the <code class="literal">Barracuda</code> file format of the
            <code class="literal">InnoDB Plugin</code>, the format may be
            <code class="literal">Compressed</code> or <code class="literal">Dynamic</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Rows</code>
          </p><p>
            The number of rows. Some storage engines, such as
            <code class="literal">MyISAM</code>, store the exact count. For other
            storage engines, such as <code class="literal">InnoDB</code>, this
            value is an approximation, and may vary from the actual
            value by as much as 40 to 50%. In such cases, use
            <code class="literal">SELECT COUNT(*)</code> to obtain an accurate
            count.
          </p><p>
            The <code class="literal">Rows</code> value is <code class="literal">NULL</code>
            for tables in the <code class="literal">INFORMATION_SCHEMA</code>
            database.
          </p></li><li class="listitem"><p>
            <code class="literal">Avg_row_length</code>
          </p><p>
            The average row length.
          </p></li><li class="listitem"><p>
            <code class="literal">Data_length</code>
          </p><p>
            The length of the data file.
          </p></li><li class="listitem"><p>
            <code class="literal">Max_data_length</code>
          </p><p>
            The maximum length of the data file. This is the total
            number of bytes of data that can be stored in the table,
            given the data pointer size used.
          </p></li><li class="listitem"><p>
            <code class="literal">Index_length</code>
          </p><p>
            The length of the index file.
          </p></li><li class="listitem"><p>
            <code class="literal">Data_free</code>
          </p><p>
            The number of allocated but unused bytes.
          </p><p>
            This information is also shown for <code class="literal">InnoDB</code>
            tables (previously, it was in the <code class="literal">Comment</code>
            value). <code class="literal">InnoDB</code> tables report the free
            space of the tablespace to which the table belongs. For a
            table located in the shared tablespace, this is the free
            space of the shared tablespace. If you are using multiple
            tablespaces and the table has its own tablespace, the free
            space is for only that table. Free space means the number of
            bytes in completely free extents minus a safety margin. Even
            if free space displays as 0, it may be possible to insert
            rows as long as new extents need not be allocated.
          </p><p>
            For partitioned tables, this value is only an estimate and
            may not be absolutely correct. A more accurate method of
            obtaining this information in such cases is to query the
            <code class="literal">INFORMATION_SCHEMA.PARTITIONS</code> table, as
            shown in this example:
          </p><pre class="programlisting">
SELECT    SUM(DATA_FREE)
    FROM  INFORMATION_SCHEMA.PARTITIONS
    WHERE TABLE_SCHEMA = 'mydb'
    AND   TABLE_NAME   = 'mytable';
</pre><p>
            For more information, see
            <a class="xref" href="information-schema.html#partitions-table" title="21.13 The INFORMATION_SCHEMA PARTITIONS Table">Section 21.13, “The INFORMATION_SCHEMA PARTITIONS Table”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">Auto_increment</code>
          </p><p>
            The next <code class="literal">AUTO_INCREMENT</code> value.
          </p></li><li class="listitem"><p>
            <code class="literal">Create_time</code>
          </p><p>
            When the table was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Update_time</code>
          </p><p>
            When the data file was last updated. For some storage
            engines, this value is <code class="literal">NULL</code>. For example,
            <code class="literal">InnoDB</code> stores multiple tables in its
            <a class="link" href="glossary.html#glos_system_tablespace" title="system tablespace">system
            tablespace</a> and the data file timestamp does not
            apply. Even with
            <a class="link" href="glossary.html#glos_file_per_table" title="file-per-table">file-per-table</a>
            mode with each <code class="literal">InnoDB</code> table in a separate
            <code class="literal">.ibd</code> file,
            <a class="link" href="glossary.html#glos_change_buffering" title="change buffering">change
            buffering</a> can delay the write to the data file, so
            the file modification time is different from the time of the
            last insert, update, or delete. For
            <code class="literal">MyISAM</code>, the data file timestamp is used;
            however, on Windows the timestamp is not updated by updates
            so the value is inaccurate.
          </p></li><li class="listitem"><p>
            <code class="literal">Check_time</code>
          </p><p>
            When the table was last checked. Not all storage engines
            update this time, in which case the value is always
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Collation</code>
          </p><p>
            The table's character set and collation.
          </p></li><li class="listitem"><p>
            <code class="literal">Checksum</code>
          </p><p>
            The live checksum value (if any).
          </p></li><li class="listitem"><p>
            <code class="literal">Create_options</code>
          </p><p>
            Extra options used with <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE
            TABLE</code></a>. The original options supplied when
            <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> is called are
            retained and the options reported here may differ from the
            active table settings and options.
          </p></li><li class="listitem"><p>
            <code class="literal">Comment</code>
          </p><p>
            The comment used when creating the table (or information as
            to why MySQL could not access the table information).
</p></li></ul>
</div>
<p>
        For <code class="literal">MEMORY</code> tables, the
        <code class="literal">Data_length</code>,
        <code class="literal">Max_data_length</code>, and
        <code class="literal">Index_length</code> values approximate the actual
        amount of allocated memory. The allocation algorithm reserves
        memory in large amounts to reduce the number of allocation
        operations.
      </p><p>
        For <a class="link" href="mysql-cluster.html" title="Chapter 18 MySQL Cluster NDB 7.3 and MySQL Cluster NDB 7.4"><code class="literal">NDB</code></a> tables, the output of this
        statement shows appropriate values for the
        <code class="literal">Avg_row_length</code> and
        <code class="literal">Data_length</code> columns, with the exception that
        <a class="link" href="data-types.html#blob" title="11.4.3 The BLOB and TEXT Types"><code class="literal">BLOB</code></a> columns are not taken into
        account
      </p><p>
        For views, all the fields displayed by <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW
        TABLE STATUS</code></a> are <code class="literal">NULL</code> except that
        <code class="literal">Name</code> indicates the view name and
        <code class="literal">Comment</code> says <code class="literal">view</code>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-tables"></a>13.7.5.38 SHOW TABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140737744"></a><a class="indexterm" name="idm139737140734928"></a><pre class="programlisting">
SHOW [FULL] TABLES [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.5.38 SHOW TABLES Syntax"><code class="literal">SHOW TABLES</code></a> lists the
        non-<code class="literal">TEMPORARY</code> tables in a given database. You
        can also get this list using the <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow
        <em class="replaceable"><code>db_name</code></em></strong></span></a> command. The
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which table names to match. The <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        Matching performed by the <code class="literal">LIKE</code> clause is
        dependent on the setting of the
        <a class="link" href="server-administration.html#sysvar_lower_case_table_names"><code class="literal">lower_case_table_names</code></a> system
        variable.
      </p><p>
        This statement also lists any views in the database. The
        <code class="literal">FULL</code> modifier is supported such that
        <a class="link" href="sql-syntax.html#show-tables" title="13.7.5.38 SHOW TABLES Syntax"><code class="literal">SHOW FULL
        TABLES</code></a> displays a second output column. Values for the
        second column are <code class="literal">BASE TABLE</code> for a table and
        <code class="literal">VIEW</code> for a view.
      </p><p>
        If you have no privileges for a base table or view, it does not
        show up in the output from <a class="link" href="sql-syntax.html#show-tables" title="13.7.5.38 SHOW TABLES Syntax"><code class="literal">SHOW
        TABLES</code></a> or <a class="link" href="programs.html#mysqlshow" title="4.5.6 mysqlshow — Display Database, Table, and Column Information"><span class="command"><strong>mysqlshow db_name</strong></span></a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-triggers"></a>13.7.5.39 SHOW TRIGGERS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140711408"></a><a class="indexterm" name="idm139737140710336"></a><a class="indexterm" name="idm139737140709264"></a><pre class="programlisting">
SHOW TRIGGERS [{FROM | IN} <em class="replaceable"><code>db_name</code></em>]
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><p>
        <a class="link" href="sql-syntax.html#show-triggers" title="13.7.5.39 SHOW TRIGGERS Syntax"><code class="literal">SHOW TRIGGERS</code></a> lists the triggers
        currently defined for tables in a database (the default database
        unless a <code class="literal">FROM</code> clause is given). This
        statement returns results only for databases and tables for
        which you have the <a class="link" href="security.html#priv_trigger"><code class="literal">TRIGGER</code></a>
        privilege. The <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if
        present, indicates which table names to match (not trigger
        names) and causes the statement to display triggers for those
        tables. The <code class="literal">WHERE</code> clause can be given to
        select rows using more general conditions, as discussed in
        <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        For the trigger <code class="literal">ins_sum</code> as defined in
        <a class="xref" href="stored-programs-views.html#triggers" title="20.3 Using Triggers">Section 20.3, “Using Triggers”</a>, the output of this statement is as
        shown here:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW TRIGGERS LIKE 'acc%'\G</code></strong>
*************************** 1. row ***************************
             Trigger: ins_sum
               Event: INSERT
               Table: account
           Statement: SET @sum = @sum + NEW.amount
              Timing: BEFORE
             Created: NULL
            sql_mode: NO_ENGINE_SUBSTITUTION
             Definer: me@localhost
character_set_client: utf8
collation_connection: utf8_general_ci
  Database Collation: latin1_swedish_ci
</pre><p>
        <a class="link" href="sql-syntax.html#show-triggers" title="13.7.5.39 SHOW TRIGGERS Syntax"><code class="literal">SHOW TRIGGERS</code></a> output has the
        following columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">Trigger</code>: The trigger name.
          </p></li><li class="listitem"><p>
            <code class="literal">Event</code>: The type of operation that causes
            trigger activation. The value is
            <code class="literal">'INSERT'</code>, <code class="literal">'UPDATE'</code>, or
            <code class="literal">'DELETE'</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Table</code>: The table for which the trigger is
            defined.
          </p></li><li class="listitem"><p>
            <code class="literal">Statement</code>: The trigger body; that is, the
            statement executed when the trigger activates.
          </p></li><li class="listitem"><p>
            <code class="literal">Timing</code>: Whether the trigger activates
            before or after the triggering event. The value is
            <code class="literal">'BEFORE'</code> or <code class="literal">'AFTER'</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">Created</code>: Currently, the value of this
            column is always <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">sql_mode</code>: The SQL mode in effect when the
            trigger executes.
          </p></li><li class="listitem"><p>
            <code class="literal">Definer</code>: The account of the user who
            created the trigger, in
            <code class="literal">'<em class="replaceable"><code>user_name</code></em>'@'<em class="replaceable"><code>host_name</code></em>'</code>
            format.
          </p></li><li class="listitem"><p>
            <code class="literal">character_set_client</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_character_set_client"><code class="literal">character_set_client</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">collation_connection</code>: The session value
            of the <a class="link" href="server-administration.html#sysvar_collation_connection"><code class="literal">collation_connection</code></a>
            system variable when the trigger was created.
          </p></li><li class="listitem"><p>
            <code class="literal">Database Collation</code>: The collation of the
            database with which the trigger is associated.
</p></li></ul>
</div>
<p>
        You can also obtain information about trigger objects from
        <code class="literal">INFORMATION_SCHEMA</code>, which contains a
        <a class="link" href="information-schema.html#triggers-table" title="21.26 The INFORMATION_SCHEMA TRIGGERS Table"><code class="literal">TRIGGERS</code></a> table. See
        <a class="xref" href="information-schema.html#triggers-table" title="21.26 The INFORMATION_SCHEMA TRIGGERS Table">Section 21.26, “The INFORMATION_SCHEMA TRIGGERS Table”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-variables"></a>13.7.5.40 SHOW VARIABLES Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140660672"></a><a class="indexterm" name="idm139737140659600"></a><a class="indexterm" name="idm139737140658528"></a><a class="indexterm" name="idm139737140657040"></a><pre class="programlisting">
SHOW [GLOBAL | SESSION] VARIABLES
    [LIKE '<em class="replaceable"><code>pattern</code></em>' | WHERE <em class="replaceable"><code>expr</code></em>]
</pre><a class="indexterm" name="idm139737140651920"></a><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> shows the values
        of MySQL system variables (see
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>). This statement does
        not require any privilege. It requires only the ability to
        connect to the server.
      </p><p>
        System variable information is also available from these
        sources:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            The
            <a class="link" href="information-schema.html#variables-table" title="21.9 The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables"><code class="literal">GLOBAL_VARIABLES</code></a>
            and
            <a class="link" href="information-schema.html#variables-table" title="21.9 The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables"><code class="literal">SESSION_VARIABLES</code></a>
            tables. See <a class="xref" href="information-schema.html#variables-table" title="21.9 The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables">Section 21.9, “The INFORMATION_SCHEMA GLOBAL_VARIABLES and SESSION_VARIABLES Tables”</a>.
          </p></li><li class="listitem"><p>
            The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin variables</strong></span></a> command. See
            <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p></li></ul>
</div>
<p>
        For <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a>, a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, if present, indicates
        which variable names to match. A <code class="literal">WHERE</code> clause
        can be given to select rows using more general conditions, as
        discussed in <a class="xref" href="information-schema.html#extended-show" title="21.32 Extensions to SHOW Statements">Section 21.32, “Extensions to SHOW Statements”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> accepts an
        optional <code class="literal">GLOBAL</code> or <code class="literal">SESSION</code>
        variable scope modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            With a <code class="literal">GLOBAL</code> modifier, the statement
            displays global system variable values. These are the values
            used to initialize the corresponding session variables for
            new connections to MySQL. If a variable has no global value,
            no value is displayed.
          </p></li><li class="listitem"><p>
            With a <code class="literal">SESSION</code> modifier, the statement
            displays the system varaible values that are in effect for
            the current connection. If a variable has no session value,
            the global value is displayed. <code class="literal">LOCAL</code> is a
            synonym for <code class="literal">SESSION</code>.
          </p></li><li class="listitem"><p>
            If no modifier is present, the default is
            <code class="literal">SESSION</code>.
</p></li></ul>
</div>
<p>
        The scope for each system variable is listed at
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-variables" title="13.7.5.40 SHOW VARIABLES Syntax"><code class="literal">SHOW VARIABLES</code></a> is subject to a
        version-dependent display-width limit. For variables with very
        long values that are not completely displayed, use
        <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> as a workaround. For
        example:
      </p><pre class="programlisting">
SELECT @@GLOBAL.innodb_data_file_path;
</pre><p>
        Most system variables can be set at server startup (read-only
        variables such as
        <a class="link" href="server-administration.html#sysvar_version_comment"><code class="literal">version_comment</code></a> are
        exceptions). Many can be changed at runtime with the
        <a class="link" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax"><code class="literal">SET</code></a>
        statement. See <a class="xref" href="server-administration.html#using-system-variables" title="5.1.5 Using System Variables">Section 5.1.5, “Using System Variables”</a>, and
        <a class="xref" href="sql-syntax.html#set-statement" title="13.7.4 SET Syntax">Section 13.7.4, “SET Syntax”</a>.
      </p><p>
        Partial output is shown here. The list of names and values may
        differ for your server.
        <a class="xref" href="server-administration.html#server-system-variables" title="5.1.4 Server System Variables">Section 5.1.4, “Server System Variables”</a>, describes the meaning
        of each variable, and <a class="xref" href="optimization.html#server-parameters" title="8.12.2 Tuning Server Parameters">Section 8.12.2, “Tuning Server Parameters”</a>,
        provides information about tuning them.
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES;</code></strong>
+-----------------------------------------+---------------------------+
| Variable_name                           | Value                     |
+-----------------------------------------+---------------------------+
| auto_increment_increment                | 1                         |
| auto_increment_offset                   | 1                         |
| autocommit                              | ON                        |
| automatic_sp_privileges                 | ON                        |
| back_log                                | 50                        |
| basedir                                 | /home/jon/bin/mysql-5.5   |
| big_tables                              | OFF                       |
| binlog_cache_size                       | 32768                     |
| binlog_direct_non_transactional_updates | OFF                       |
| binlog_format                           | STATEMENT                 |
| binlog_stmt_cache_size                  | 32768                     |
| bulk_insert_buffer_size                 | 8388608                   |
...
| max_allowed_packet                      | 4194304                   |
| max_binlog_cache_size                   | 18446744073709547520      |
| max_binlog_size                         | 1073741824                |
| max_binlog_stmt_cache_size              | 18446744073709547520      |
| max_connect_errors                      | 100                       |
| max_connections                         | 151                       |
| max_delayed_threads                     | 20                        |
| max_error_count                         | 64                        |
| max_heap_table_size                     | 16777216                  |
| max_insert_delayed_threads              | 20                        |
| max_join_size                           | 18446744073709551615      |
...

| thread_handling                         | one-thread-per-connection |
| thread_stack                            | 262144                    |
| time_format                             | %H:%i:%s                  |
| time_zone                               | SYSTEM                    |
| timed_mutexes                           | OFF                       |
| timestamp                               | 1316689732                |
| tmp_table_size                          | 16777216                  |
| tmpdir                                  | /tmp                      |
| transaction_alloc_block_size            | 8192                      |
| transaction_prealloc_size               | 4096                      |
| tx_isolation                            | REPEATABLE-READ           |
| unique_checks                           | ON                        |
| updatable_views_with_limit              | YES                       |
| version                                 | 5.5.17-log                |
| version_comment                         | Source distribution       |
| version_compile_machine                 | x86_64                    |
| version_compile_os                      | Linux                     |
| wait_timeout                            | 28800                     |
| warning_count                           | 0                         |
+-----------------------------------------+---------------------------+
</pre><p>
        With a <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause, the statement
        displays only rows for those variables with names that match the
        pattern. To obtain the row for a specific variable, use a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause as shown:
      </p><pre class="programlisting">
SHOW VARIABLES LIKE 'max_join_size';
SHOW SESSION VARIABLES LIKE 'max_join_size';
</pre><p>
        To get a list of variables whose name match a pattern, use the
        <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span> wildcard character in a
        <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> clause:
      </p><pre class="programlisting">
SHOW VARIABLES LIKE '%size%';
SHOW GLOBAL VARIABLES LIKE '%size%';
</pre><p>
        Wildcard characters can be used in any position within the
        pattern to be matched. Strictly speaking, because
        <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span> is a wildcard that matches
        any single character, you should escape it as
        <span class="quote">“<span class="quote"><code class="literal">\_</code></span>”</span> to match it literally. In
        practice, this is rarely necessary.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="show-warnings"></a>13.7.5.41 SHOW WARNINGS Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140593152"></a><a class="indexterm" name="idm139737140592080"></a><pre class="programlisting">
SHOW WARNINGS [LIMIT [<em class="replaceable"><code>offset</code></em>,] <em class="replaceable"><code>row_count</code></em>]
SHOW COUNT(*) WARNINGS
</pre><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> is a diagnostic
        statement that displays information about the conditions
        (errors, warnings, and notes) resulting from executing a
        statement in the current session. Warnings are generated for DML
        statements such as <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
        <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>, and
        <a class="link" href="sql-syntax.html#load-data" title="13.2.6 LOAD DATA INFILE Syntax"><code class="literal">LOAD DATA
        INFILE</code></a> as well as DDL statements such as
        <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> and
        <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>.
      </p><p>
        The <code class="literal">LIMIT</code> clause has the same syntax as for
        the <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement. See
        <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> is also used
        following <a class="link" href="optimization.html#explain-extended" title="8.8.3 EXPLAIN EXTENDED Output Format"><code class="literal">EXPLAIN EXTENDED</code></a>, to
        display the extra information generated by
        <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> when the
        <code class="literal">EXTENDED</code> keyword is used. See
        <a class="xref" href="optimization.html#explain-extended" title="8.8.3 EXPLAIN EXTENDED Output Format">Section 8.8.3, “EXPLAIN EXTENDED Output Format”</a>.
      </p><p>
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW WARNINGS</code></a> displays
        information about the conditions resulting from the most recent
        statement in the current session that generated messages. It
        shows nothing if the most recent statement used a table and
        generated no messages. (That is, statements that use a table but
        generate no messages clear the message list.) Statements that do
        not use tables and do not generate messages have no effect on
        the message list.
      </p><p>
        The <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW COUNT(*)
        WARNINGS</code></a> diagnostic statement displays the total
        number of errors, warnings, and notes. You can also retrieve
        this number from the
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> system variable:
      </p><pre class="programlisting">
SHOW COUNT(*) WARNINGS;
SELECT @@warning_count;
</pre><p>
        A related diagnostic statement, <a class="link" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax"><code class="literal">SHOW
        ERRORS</code></a>, shows only error conditions (it excludes
        warnings and notes), and
        <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW COUNT(*)
        ERRORS</code></a> statement displays the total number of errors.
        See <a class="xref" href="sql-syntax.html#show-errors" title="13.7.5.18 SHOW ERRORS Syntax">Section 13.7.5.18, “SHOW ERRORS Syntax”</a>. <a class="link" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax"><code class="literal">GET
        DIAGNOSTICS</code></a> can be used to examine information for
        individual conditions. See <a class="xref" href="sql-syntax.html#get-diagnostics" title="13.6.7.3 GET DIAGNOSTICS Syntax">Section 13.6.7.3, “GET DIAGNOSTICS Syntax”</a>.
      </p><p>
        Here is a simple example that shows data-conversion warnings for
        <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CREATE TABLE t1 (a TINYINT NOT NULL, b CHAR(4));</code></strong>
Query OK, 0 rows affected (0.05 sec)

mysql&gt; <strong class="userinput"><code>INSERT INTO t1 VALUES(10,'mysql'), (NULL,'test'), (300,'xyz');</code></strong>
Query OK, 3 rows affected, 3 warnings (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 3

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS\G</code></strong>
*************************** 1. row ***************************
  Level: Warning
   Code: 1265
Message: Data truncated for column 'b' at row 1
*************************** 2. row ***************************
  Level: Warning
   Code: 1048
Message: Column 'a' cannot be null
*************************** 3. row ***************************
  Level: Warning
   Code: 1264
Message: Out of range value for column 'a' at row 3
3 rows in set (0.00 sec)
</pre><p>
        The <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> system
        variable controls the maximum number of error, warning, and note
        messages for which the server stores information, and thus the
        number of messages that <a class="link" href="sql-syntax.html#show-warnings" title="13.7.5.41 SHOW WARNINGS Syntax"><code class="literal">SHOW
        WARNINGS</code></a> displays. To change the number of messages
        the server can store, change the value of
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>. The default is
        64.
      </p><p>
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> controls only
        how many messages are stored, not how many are counted. The
        value of <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> is not
        limited by <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>,
        even if the number of messages generated exceeds
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a>. The following
        example demonstrates this. The <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER
        TABLE</code></a> statement produces three warning messages
        (strict SQL mode is disabled for the example to prevent an error
        from occuring after a single conversion issue). Only one message
        is stored and displayed because
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> has been set to
        1, but all three are counted (as shown by the value of
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a>):
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SHOW VARIABLES LIKE 'max_error_count';</code></strong>
+-----------------+-------+
| Variable_name   | Value |
+-----------------+-------+
| max_error_count | 64    |
+-----------------+-------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET max_error_count=1, sql_mode = '';</code></strong>
Query OK, 0 rows affected (0.00 sec)

mysql&gt; <strong class="userinput"><code>ALTER TABLE t1 MODIFY b CHAR;</code></strong>
Query OK, 3 rows affected, 3 warnings (0.00 sec)
Records: 3  Duplicates: 0  Warnings: 3

mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+---------+------+----------------------------------------+
| Level   | Code | Message                                |
+---------+------+----------------------------------------+
| Warning | 1263 | Data truncated for column 'b' at row 1 |
+---------+------+----------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SELECT @@warning_count;</code></strong>
+-----------------+
| @@warning_count |
+-----------------+
|               3 |
+-----------------+
1 row in set (0.01 sec)
</pre><p>
        To disable message storage, set
        <a class="link" href="server-administration.html#sysvar_max_error_count"><code class="literal">max_error_count</code></a> to 0. In this
        case, <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> still
        indicates how many warnings occurred, but messages are not
        stored and cannot be displayed.
      </p><p>
        The <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> system variable
        controls whether note messages increment
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> and whether the
        server stores them. By default,
        <a class="link" href="server-administration.html#sysvar_sql_notes"><code class="literal">sql_notes</code></a> is 1, but if set to
        0, notes do not increment
        <a class="link" href="server-administration.html#sysvar_warning_count"><code class="literal">warning_count</code></a> and the server
        does not store them:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET sql_notes = 1;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected, 1 warning (0.00 sec)
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
+-------+------+------------------------------------+
| Level | Code | Message                            |
+-------+------+------------------------------------+
| Note  | 1051 | Unknown table 'test.no_such_table' |
+-------+------+------------------------------------+
1 row in set (0.00 sec)

mysql&gt; <strong class="userinput"><code>SET sql_notes = 0;</code></strong>
mysql&gt; <strong class="userinput"><code>DROP TABLE IF EXISTS test.no_such_table;</code></strong>
Query OK, 0 rows affected (0.00 sec)
mysql&gt; <strong class="userinput"><code>SHOW WARNINGS;</code></strong>
Empty set (0.00 sec)
</pre><p>
        The MySQL server sends to each client a count indicating the
        total number of errors, warnings, and notes resulting from the
        most recent statement executed by that client. From the C API,
        this value can be obtained by calling
        <a class="link" href="connectors-apis.html#mysql-warning-count" title="23.8.7.73 mysql_warning_count()"><code class="literal">mysql_warning_count()</code></a>. See
        <a class="xref" href="connectors-apis.html#mysql-warning-count" title="23.8.7.73 mysql_warning_count()">Section 23.8.7.73, “mysql_warning_count()”</a>.
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="other-administrative-sql"></a>13.7.6 Other Administrative Statements</h3>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#binlog">13.7.6.1 BINLOG Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#cache-index">13.7.6.2 CACHE INDEX Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#flush">13.7.6.3 FLUSH Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#kill">13.7.6.4 KILL Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#load-index">13.7.6.5 LOAD INDEX INTO CACHE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#reset">13.7.6.6 RESET Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="binlog"></a>13.7.6.1 BINLOG Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140512784"></a><pre class="programlisting">
BINLOG '<em class="replaceable"><code>str</code></em>'
</pre><p>
        <a class="link" href="sql-syntax.html#binlog" title="13.7.6.1 BINLOG Syntax"><code class="literal">BINLOG</code></a> is an internal-use
        statement. It is generated by the <a class="link" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files"><span class="command"><strong>mysqlbinlog</strong></span></a>
        program as the printable representation of certain events in
        binary log files. (See <a class="xref" href="programs.html#mysqlbinlog" title="4.6.8 mysqlbinlog — Utility for Processing Binary Log Files">Section 4.6.8, “<span class="command"><strong>mysqlbinlog</strong></span> — Utility for Processing Binary Log Files”</a>.) The
        <code class="literal">'<em class="replaceable"><code>str</code></em>'</code> value is a
        base 64-encoded string the that server decodes to determine the
        data change indicated by the corresponding event. This statement
        requires the <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege.
      </p><p>
        As of MySQL 5.6, this statement can execute only format
        description events and row events. Previously it could execute
        all types of events.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="cache-index"></a>13.7.6.2 CACHE INDEX Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140499648"></a><a class="indexterm" name="idm139737140498576"></a><a class="indexterm" name="idm139737140497088"></a><pre class="programlisting">
CACHE INDEX
  <em class="replaceable"><code>tbl_index_list</code></em> [, <em class="replaceable"><code>tbl_index_list</code></em>] ...
  [PARTITION (<em class="replaceable"><code>partition_list</code></em> | ALL)]
  IN <em class="replaceable"><code>key_cache_name</code></em>

<em class="replaceable"><code>tbl_index_list</code></em>:
  <em class="replaceable"><code>tbl_name</code></em> [[INDEX|KEY] (<em class="replaceable"><code>index_name</code></em>[, <em class="replaceable"><code>index_name</code></em>] ...)]

<em class="replaceable"><code>partition_list</code></em>:
  <em class="replaceable"><code>partition_name</code></em>[, <em class="replaceable"><code>partition_name</code></em>][, ...]
</pre><p>
        The <a class="link" href="sql-syntax.html#cache-index" title="13.7.6.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> statement assigns
        table indexes to a specific key cache. It is used only for
        <code class="literal">MyISAM</code> tables. After the indexes have been
        assigned, they can be preloaded into the cache if desired with
        <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a>.
      </p><p>
        The following statement assigns indexes from the tables
        <code class="literal">t1</code>, <code class="literal">t2</code>, and
        <code class="literal">t3</code> to the key cache named
        <code class="literal">hot_cache</code>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CACHE INDEX t1, t2, t3 IN hot_cache;</code></strong>
+---------+--------------------+----------+----------+
| Table   | Op                 | Msg_type | Msg_text |
+---------+--------------------+----------+----------+
| test.t1 | assign_to_keycache | status   | OK       |
| test.t2 | assign_to_keycache | status   | OK       |
| test.t3 | assign_to_keycache | status   | OK       |
+---------+--------------------+----------+----------+
</pre><p>
        The syntax of <a class="link" href="sql-syntax.html#cache-index" title="13.7.6.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> enables
        you to specify that only particular indexes from a table should
        be assigned to the cache. The current implementation assigns all
        the table's indexes to the cache, so there is no reason to
        specify anything other than the table name.
      </p><p>
        The key cache referred to in a <a class="link" href="sql-syntax.html#cache-index" title="13.7.6.2 CACHE INDEX Syntax"><code class="literal">CACHE
        INDEX</code></a> statement can be created by setting its size
        with a parameter setting statement or in the server parameter
        settings. For example:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>SET GLOBAL keycache1.key_buffer_size=128*1024;</code></strong>
</pre><p>
        Key cache parameters can be accessed as members of a structured
        system variable. See
        <a class="xref" href="server-administration.html#structured-system-variables" title="5.1.5.1 Structured System Variables">Section 5.1.5.1, “Structured System Variables”</a>.
      </p><p>
        A key cache must exist before you can assign indexes to it:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>CACHE INDEX t1 IN non_existent_cache;</code></strong>
ERROR 1284 (HY000): Unknown key cache 'non_existent_cache'
</pre><p>
        By default, table indexes are assigned to the main (default) key
        cache created at the server startup. When a key cache is
        destroyed, all indexes assigned to it become assigned to the
        default key cache again.
      </p><p>
        Index assignment affects the server globally: If one client
        assigns an index to a given cache, this cache is used for all
        queries involving the index, no matter which client issues the
        queries.
      </p><p>
        In MySQL 5.6, this statement is also supported for
        partitioned <code class="literal">MyISAM</code> tables. You can assign one
        or more indexes for one, several, or all partitions to a given
        key cache. For example, you can do the following:
      </p><pre class="programlisting">
CREATE TABLE pt (c1 INT, c2 VARCHAR(50), INDEX i(c1))
    PARTITION BY HASH(c1)
    PARTITIONS 4;

SET GLOBAL kc_fast.key_buffer_size = 128 * 1024;
SET GLOBAL kc_slow.key_buffer_size = 128 * 1024;

CACHE INDEX pt PARTITION (p0) IN kc_fast;
CACHE INDEX pt PARTITION (p1, p3) IN kc_slow;
</pre><p>
        The previous set of statements performs the following actions:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Creates a partitioned table with 4 partitions; these
            partitions are automatically named <code class="literal">p0</code>,
            ..., <code class="literal">p3</code>; this table has an index named
            <code class="literal">i</code> on column <code class="literal">c1</code>.
          </p></li><li class="listitem"><p>
            Creates 2 key caches named <code class="literal">kc_fast</code> and
            <code class="literal">kc_slow</code>
          </p></li><li class="listitem"><p>
            Assigns the index for partition <code class="literal">p0</code> to the
            <code class="literal">kc_fast</code> key cache and the index for
            partitions <code class="literal">p1</code> and <code class="literal">p3</code>
            to the <code class="literal">kc_slow</code> key cache; the index for
            the remaining partition (<code class="literal">p2</code>) uses the
            server's default key cache.
</p></li></ul>
</div>
<p>
        If you wish instead to assign the indexes for all partitions in
        table <code class="literal">pt</code> to a single key cache named
        <code class="literal">kc_all</code>, you can use either one of the
        following 2 statements:
      </p><pre class="programlisting">
CACHE INDEX pt PARTITION (ALL) IN kc_all;

CACHE INDEX pt IN kc_all;
</pre><p>
        The two statements just shown are equivalent, and issuing either
        one of them has exactly the same effect. In other words, if you
        wish to assign indexes for all partitions of a partitioned table
        to the same key cache, then the <code class="literal">PARTITION
        (ALL)</code> clause is optional.
      </p><p>
        When assigning indexes for multiple partitions to a key cache,
        the partitions do not have to be contiguous, and you are not
        required to list their names in any particular order. Indexes
        for any partitions that are not explicitly assigned to a key
        cache automatically use the server's default key cache.
      </p><p>
        In MySQL 5.6, index preloading is also supported
        for partitioned <code class="literal">MyISAM</code> tables. For more
        information, see <a class="xref" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax">Section 13.7.6.5, “LOAD INDEX INTO CACHE Syntax”</a>.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="flush"></a>13.7.6.3 FLUSH Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140443792"></a><a class="indexterm" name="idm139737140442720"></a><a class="indexterm" name="idm139737140441648"></a><a class="indexterm" name="idm139737140440160"></a><pre class="programlisting">
FLUSH [NO_WRITE_TO_BINLOG | LOCAL]
    <em class="replaceable"><code>flush_option</code></em> [, <em class="replaceable"><code>flush_option</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement has several
        variant forms that clear or reload various internal caches,
        flush tables, or acquire locks. To execute
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>, you must have the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege. Specific flush
        options might require additional privileges, as described later.
      </p><p>
        By default, the server writes
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statements to the binary
        log so that they replicate to replication slaves. To suppress
        logging, specify the optional
        <code class="literal">NO_WRITE_TO_BINLOG</code> keyword or its alias
        <code class="literal">LOCAL</code>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH LOGS</code></a>,
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH READ
          LOCK</code></a> (with or without a table list), and
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES
          <em class="replaceable"><code>tbl_name</code></em> ... FOR EXPORT</code></a>
          are not written to the binary log in any case because they
          would cause problems if replicated to a slave.
</p>
</div>
<p>
        Sending a <code class="literal">SIGHUP</code> signal to the server causes
        several flush operations to occur that are similar to various
        forms of the <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement. See
        <a class="xref" href="server-administration.html#server-signal-response" title="5.1.11 Server Response to Signals">Section 5.1.11, “Server Response to Signals”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement causes an
        implicit commit. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> statement is similar to
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>. See
        <a class="xref" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax">Section 13.7.6.6, “RESET Syntax”</a>, for information about using the
        <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> statement with replication.
      </p><p>
        <em class="replaceable"><code>flush_option</code></em> can be any of the
        following items.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">DES_KEY_FILE</code>
          </p><p>
            Reloads the DES keys from the file that was specified with
            the <a class="link" href="server-administration.html#option_mysqld_des-key-file"><code class="option">--des-key-file</code></a> option at
            server startup time.
          </p></li><li class="listitem"><p>
            <code class="literal">HOSTS</code>
          </p><p>
            Empties the host cache. You should flush the host cache if
            some of your hosts change IP address or if the error message
            <code class="literal">Host '<em class="replaceable"><code>host_name</code></em>' is
            blocked</code> occurs. (See
            <a class="xref" href="error-handling.html#blocked-host" title="B.5.2.6 Host 'host_name' is blocked">Section B.5.2.6, “Host 'host_name' is blocked”</a>.) When more than
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> errors
            occur successively for a given host while connecting to the
            MySQL server, MySQL assumes that something is wrong and
            blocks the host from further connection requests. Flushing
            the host cache enables further connection attempts from the
            host. The default value of
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> is 100
            (10 before MySQL 5.6.6). To avoid this error message, start
            the server with
            <a class="link" href="server-administration.html#sysvar_max_connect_errors"><code class="literal">max_connect_errors</code></a> set to a
            large value.
          </p></li><li class="listitem"><p>
            <code class="literal">[<em class="replaceable"><code>log_type</code></em>]
            LOGS</code>
          </p><p>
            With no <em class="replaceable"><code>log_type</code></em> option,
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH LOGS</code></a>
            closes and reopens all log files. If binary logging is
            enabled, the sequence number of the binary log file is
            incremented by one relative to the previous file.
          </p><p>
            <code class="literal">FLUSH LOGS</code> has no effect on tables used
            for the general query log or for the slow query log (see
            <a class="xref" href="server-administration.html#log-destinations" title="5.2.1 Selecting General Query and Slow Query Log Output Destinations">Section 5.2.1, “Selecting General Query and Slow Query Log Output Destinations”</a>). It also has no effect
            on tables used for the binary or relay log
            (<a class="link" href="replication.html#option_mysqld_master-info-repository"><code class="option">--master-info-repository</code></a> and
            <a class="link" href="replication.html#option_mysqld_relay-log-info-repository"><code class="option">--relay-log-info-repository</code></a>
            server options).
          </p><p>
            With a <em class="replaceable"><code>log_type</code></em> option, only the
            specified log type is flushed. These
            <em class="replaceable"><code>log_type</code></em> options are permitted:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <code class="literal">BINARY</code> closes and reopens the binary
                log files.
              </p></li><li class="listitem"><p>
                <code class="literal">ENGINE</code> closes and reopens any
                flushable logs for installed storage engines. Currently,
                this causes <a class="link" href="innodb-storage-engine.html" title="Chapter 14 The InnoDB Storage Engine"><code class="literal">InnoDB</code></a> to flush
                its logs to disk.
              </p></li><li class="listitem"><p>
                <code class="literal">ERROR</code> closes and reopens the error
                log file.
              </p></li><li class="listitem"><p>
                <code class="literal">GENERAL</code> closes and reopens the
                general query log file.
              </p></li><li class="listitem"><p>
                <code class="literal">RELAY</code> closes and reopens the relay
                log files.
              </p></li><li class="listitem"><p>
                <code class="literal">SLOW</code> closes and reopens the slow
                query log file.
</p></li></ul>
</div>
</li><li class="listitem"><p>
            <code class="literal">PRIVILEGES</code>
          </p><p>
            Reloads the privileges from the grant tables in the
            <code class="literal">mysql</code> database.
          </p><p>
            The server caches information in memory as a result of
            <a class="link" href="sql-syntax.html#grant" title="13.7.1.4 GRANT Syntax"><code class="literal">GRANT</code></a>,
            <a class="link" href="sql-syntax.html#create-user" title="13.7.1.2 CREATE USER Syntax"><code class="literal">CREATE USER</code></a>,
            <a class="link" href="sql-syntax.html#create-server" title="13.1.16 CREATE SERVER Syntax"><code class="literal">CREATE SERVER</code></a>, and
            <a class="link" href="sql-syntax.html#install-plugin" title="13.7.3.3 INSTALL PLUGIN Syntax"><code class="literal">INSTALL PLUGIN</code></a> statements.
            This memory is not released by the corresponding
            <a class="link" href="sql-syntax.html#revoke" title="13.7.1.6 REVOKE Syntax"><code class="literal">REVOKE</code></a>,
            <a class="link" href="sql-syntax.html#drop-user" title="13.7.1.3 DROP USER Syntax"><code class="literal">DROP USER</code></a>,
            <a class="link" href="sql-syntax.html#drop-server" title="13.1.27 DROP SERVER Syntax"><code class="literal">DROP SERVER</code></a>, and
            <a class="link" href="sql-syntax.html#uninstall-plugin" title="13.7.3.4 UNINSTALL PLUGIN Syntax"><code class="literal">UNINSTALL PLUGIN</code></a> statements,
            so for a server that executes many instances of the
            statements that cause caching, there will be an increase in
            memory use. This cached memory can be freed with
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            PRIVILEGES</code></a>.
          </p></li><li class="listitem"><p>
            <code class="literal">QUERY CACHE</code>
          </p><p>
            Defragment the query cache to better utilize its memory.
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH QUERY
            CACHE</code></a> does not remove any queries from the cache,
            unlike <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> or <code class="literal">RESET QUERY CACHE</code>.
          </p></li><li class="listitem"><p>
            <code class="literal">STATUS</code>
          </p><p>
            This option adds the current thread's session status
            variable values to the global values and resets the session
            values to zero. Some global variables may be reset to zero
            as well. It also resets the counters for key caches (default
            and named) to zero and sets
            <a class="link" href="server-administration.html#statvar_Max_used_connections"><code class="literal">Max_used_connections</code></a> to
            the current number of open connections. This is something
            you should use only when debugging a query. See
            <a class="xref" href="introduction.html#bug-reports" title="1.6 How to Report Bugs or Problems">Section 1.6, “How to Report Bugs or Problems”</a>.
          </p></li><li class="listitem"><p>
            <code class="literal">TABLES</code>
          </p><p>
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> flushes tables, and, depending on the
            variant used, acquires locks. The permitted syntax is
            discussed later in this section.
          </p></li><li class="listitem"><p>
            <code class="literal">USER_RESOURCES</code>
          </p><p>
            Resets all per-hour user resources to zero. This enables
            clients that have reached their hourly connection, query, or
            update limits to resume activity immediately.
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            USER_RESOURCES</code></a> does not apply to the limit on
            maximum simultaneous connections. See
            <a class="xref" href="security.html#user-resources" title="6.3.4 Setting Account Resource Limits">Section 6.3.4, “Setting Account Resource Limits”</a>.
</p></li></ul>
</div>
<p>
        The <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin</strong></span></a> utility provides a
        command-line interface to some flush operations, using commands
        such as <code class="literal">flush-hosts</code>,
        <code class="literal">flush-logs</code>,
        <code class="literal">flush-privileges</code>,
        <code class="literal">flush-status</code>, and
        <code class="literal">flush-tables</code>. See
        <a class="xref" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server">Section 4.5.2, “<span class="command"><strong>mysqladmin</strong></span> — Client for Administering a MySQL Server”</a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          It is not possible to issue
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statements within stored
          functions or triggers. However, you may use
          <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> in stored procedures, so
          long as these are not called from stored functions or
          triggers. See <a class="xref" href="restrictions.html#stored-program-restrictions" title="D.1 Restrictions on Stored Programs">Section D.1, “Restrictions on Stored Programs”</a>.
</p>
</div>
<p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
</p>
<h5><a name="idm139737140333856"></a>FLUSH TABLES Syntax</h5>
<p>
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>
        has several forms, described following. If any variant of the
        <code class="literal">TABLES</code> option is used in a
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement, it must be the
        only option used. <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
        TABLE</code></a> is a synonym for
        <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES</code></a>.
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">FLUSH TABLES</code>
          </p><p>
            Closes all open tables, forces all tables in use to be
            closed, and flushes the query cache.
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> also removes all query results from the
            query cache, like the <code class="literal">RESET QUERY CACHE</code>
            statement.
          </p><p>
            In MySQL 5.6,
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> is not permitted when there is an active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>. To flush and lock tables, use
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES
            <em class="replaceable"><code>tbl_name</code></em> ... WITH READ
            LOCK</code></a> instead.
          </p></li><li class="listitem"><p>
            <code class="literal">FLUSH TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ...</code>
          </p><p>
            With a list of one or more comma-separated table names, this
            statement is like
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> with no names except that the server
            flushes only the named tables. No error occurs if a named
            table does not exist.
          </p></li><li class="listitem"><p>
            <code class="literal">FLUSH TABLES WITH READ LOCK</code>
          </p><p>
            Closes all open tables and locks all tables for all
            databases with a global read lock. This is a very convenient
            way to get backups if you have a file system such as Veritas
            or ZFS that can take snapshots in time. Use
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the lock.
          </p><p>
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> acquires a global read lock and not
            table locks, so it is not subject to the same behavior as
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> and
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> with respect to table locking and implicit
            commits:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a> implicitly commits any active
                transaction only if any tables currently have been
                locked with <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a>.
                The commit does not occur for
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a> following
                <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
                READ LOCK</code></a> because the latter statement does
                not acquire table locks.
              </p></li><li class="listitem"><p>
                Beginning a transaction causes table locks acquired with
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to be
                released, as though you had executed
                <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
                TABLES</code></a>. Beginning a transaction does not
                release a global read lock acquired with
                <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
                READ LOCK</code></a>.
</p></li></ul>
</div>
<p>
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES WITH
            READ LOCK</code></a> does not prevent the server from
            inserting rows into the log tables (see
            <a class="xref" href="server-administration.html#log-destinations" title="5.2.1 Selecting General Query and Slow Query Log Output Destinations">Section 5.2.1, “Selecting General Query and Slow Query Log Output Destinations”</a>).
          </p></li><li class="listitem"><p>
            <code class="literal">FLUSH TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ... WITH READ
            LOCK</code>
          </p><p>
            This statement flushes and acquires read locks for the named
            tables. The statement first acquires exclusive metadata
            locks for the tables, so it waits for transactions that have
            those tables open to complete. Then the statement flushes
            the tables from the table cache, reopens the tables,
            acquires table locks (like
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>), and downgrades the metadata locks from
            exclusive to shared. After the statement acquires locks and
            downgrades the metadata locks, other sessions can read but
            not modify the tables.
          </p><p>
            Because this statement acquires table locks, you must have
            the <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a> privilege for
            each table, in addition to the
            <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege that is
            required to use any <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>
            statement.
          </p><p>
            This statement applies only to existing base tables. If a
            name refers to a base table, that table is used. If it
            refers to a <code class="literal">TEMPORARY</code> table, it is
            ignored. If a name applies to a view, an
            <a class="link" href="error-handling.html#error_er_wrong_object"><code class="literal">ER_WRONG_OBJECT</code></a> error
            occurs. Otherwise, an
            <a class="link" href="error-handling.html#error_er_no_such_table"><code class="literal">ER_NO_SUCH_TABLE</code></a> error
            occurs.
          </p><p>
            Use <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the locks,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to release the
            locks and acquire other locks, or
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> to release the locks and begin a new
            transaction.
          </p><p>
            This variant of <code class="literal">FLUSH</code> enables tables to
            be flushed and locked in a single operation. It provides a
            workaround for the restriction in MySQL 5.6
            that <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH
            TABLES</code></a> is not permitted when there is an active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES ...
            READ</code></a>.
          </p><p>
            This statement does not perform an implicit
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a>, so an error results if you use the
            statement while there is any active
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> or use it a
            second time without first releasing the locks acquired.
          </p><p>
            If a flushed table was opened with
            <a class="link" href="sql-syntax.html#handler" title="13.2.4 HANDLER Syntax"><code class="literal">HANDLER</code></a>, the handler is
            implicitly flushed and loses its position.
          </p></li><li class="listitem"><p>
            <code class="literal">FLUSH TABLES <em class="replaceable"><code>tbl_name</code></em> [,
            <em class="replaceable"><code>tbl_name</code></em>] ... FOR
            EXPORT</code>
          </p><p>
            This <code class="literal">FLUSH TABLES</code> variant applies to
            <code class="literal">InnoDB</code> tables. It is available as of
            MySQL 5.6.6. The statement ensures that changes to the named
            tables have been flushed to disk so that binary table copies
            can be made while the server is running.
          </p><p>
            The statement works like this:
</p>
<div class="orderedlist">
<ol class="orderedlist" type="1"><li class="listitem"><p>
                It acquires shared metadata locks for the named tables.
                The statement blocks as long as other sessions have
                active transactions that have modified those tables or
                hold table locks for them. When the locks have been
                acquired, the statement blocks transactions that attempt
                to update the tables while permitting read-only
                operations to continue.
              </p></li><li class="listitem"><p>
                It checks whether all storage engines for the tables
                support <code class="literal">FOR EXPORT</code>. If any do not, an
                <a class="link" href="error-handling.html#error_er_illegal_ha"><code class="literal">ER_ILLEGAL_HA</code></a> error
                occurs and the statement fails.
              </p></li><li class="listitem"><p>
                The statement notifies the storage engine for each table
                to make the table ready for export. The storage engine
                must ensure that any pending changes are written to
                disk.
              </p></li><li class="listitem"><p>
                The statement puts the session in lock-tables mode so
                that the metadata locks acquired earlier are not
                released when the <code class="literal">FOR EXPORT</code>
                statement completes.
</p></li></ol>
</div>
<p>
            The <code class="literal">FLUSH TABLES ... FOR EXPORT</code> statement
            requires that you have the
            <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> privilege for each
            table. Because this statement acquires table locks, you must
            also have the <a class="link" href="security.html#priv_lock-tables"><code class="literal">LOCK TABLES</code></a>
            privilege for each table, in addition to the
            <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege that is
            required to use any <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a>
            statement.
          </p><p>
            This statement applies only to existing base tables. If a
            name refers to a base table, that table is used. If it
            refers to a <code class="literal">TEMPORARY</code> table, it is
            ignored. If a name applies to a view, an
            <a class="link" href="error-handling.html#error_er_wrong_object"><code class="literal">ER_WRONG_OBJECT</code></a> error
            occurs. Otherwise, an
            <a class="link" href="error-handling.html#error_er_no_such_table"><code class="literal">ER_NO_SUCH_TABLE</code></a> error
            occurs.
          </p><p>
            <code class="literal">InnoDB</code> supports <code class="literal">FOR
            EXPORT</code> for tables that have their own
            <a class="link" href="glossary.html#glos_ibd_file" title=".ibd file">.ibd file</a> file (that
            is, tables that were created with the
            <a class="link" href="innodb-storage-engine.html#sysvar_innodb_file_per_table"><code class="literal">innodb_file_per_table</code></a>
            setting enabled). <code class="literal">InnoDB</code> ensures when
            notified by the <code class="literal">FOR EXPORT</code> statement that
            any changes have been flushed to disk. This permits a binary
            copy of table contents to be made while the <code class="literal">FOR
            EXPORT</code> statement is in effect because the
            <code class="filename">.ibd</code> file is transaction consistent and
            can be copied while the server is running. <code class="literal">FOR
            EXPORT</code> does not apply to <code class="literal">InnoDB</code>
            system tablespace files, or to <code class="literal">InnoDB</code>
            tables that have any <code class="literal">FULLTEXT</code> indexes.
          </p><p>
            <code class="literal">FLUSH TABLES ...FOR EXPORT</code> does not work
            with partitioned <code class="literal">InnoDB</code> tables prior to
            MySQL 5.6.17, but is supported for such tables in MySQL
            5.6.17 and later. (Bug #16943907)
          </p><p>
            When notified by <code class="literal">FOR EXPORT</code>,
            <code class="literal">InnoDB</code> writes to disk certain kinds of
            data that is normally held in memory or in separate disk
            buffers outside the tablespace files. For each table,
            <code class="literal">InnoDB</code> also produces a file named
            <code class="filename"><em class="replaceable"><code>table_name</code></em>.cfg</code>
            in the same database directory as the table. The
            <code class="filename">.cfg</code> file contains metadata needed to
            reimport the tablespace files later, into the same or
            different server.
          </p><p>
            When the <code class="literal">FOR EXPORT</code> statement completes,
            <code class="literal">InnoDB</code> will have flushed all
            <a class="link" href="glossary.html#glos_dirty_page" title="dirty page">dirty pages</a> to the
            table data files. Any
            <a class="link" href="glossary.html#glos_change_buffer" title="change buffer">change buffer</a>
            entries are merged prior to flushing. At this point, the
            tables are locked and quiescent: The tables are in a
            transactionally consistent state on disk and you can copy
            the <code class="filename">.ibd</code> tablespace files along with
            the corresponding <code class="filename">.cfg</code> files to get a
            consistent snapshot of those tables.
          </p><p>
            For the procedure to reimport the copied table data into a
            MySQL instance, see <a class="xref" href="innodb-storage-engine.html#tablespace-copying" title="14.4.6 Copying File-Per-Table Tablespaces to Another Server">Section 14.4.6, “Copying File-Per-Table Tablespaces to Another Server”</a>.
          </p><p>
            After you are done with the tables, use
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">UNLOCK
            TABLES</code></a> to release the locks,
            <a class="link" href="sql-syntax.html#lock-tables" title="13.3.5 LOCK TABLES and UNLOCK TABLES Syntax"><code class="literal">LOCK TABLES</code></a> to release the
            locks and acquire other locks, or
            <a class="link" href="sql-syntax.html#commit" title="13.3.1 START TRANSACTION, COMMIT, and ROLLBACK Syntax"><code class="literal">START
            TRANSACTION</code></a> to release the locks and begin a new
            transaction.
          </p><p>
            While any of these statements is in effect within the
            session, attempts to use
            <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES ... FOR
            EXPORT</code></a> produce an error:
          </p><pre class="programlisting">
FLUSH TABLES ... WITH READ LOCK
FLUSH TABLES ... FOR EXPORT
LOCK TABLES ... READ
LOCK TABLES ... WRITE
</pre><p>
            While <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH TABLES
            ... FOR EXPORT</code></a> is in effect within the session,
            attempts to use any of these statements produce an error:
          </p><pre class="programlisting">
FLUSH TABLES WITH READ LOCK
FLUSH TABLES ... WITH READ LOCK
FLUSH TABLES ... FOR EXPORT
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="kill"></a>13.7.6.4 KILL Syntax</h4>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140209248"></a><a class="indexterm" name="idm139737140208176"></a><pre class="programlisting">
KILL [CONNECTION | QUERY] <em class="replaceable"><code>processlist_id</code></em>
</pre><p>
        Each connection to <a class="link" href="programs.html#mysqld" title="4.3.1 mysqld — The MySQL Server"><span class="command"><strong>mysqld</strong></span></a> runs in a separate
        thread. You can kill a thread with the <code class="literal">KILL
        <em class="replaceable"><code>processlist_id</code></em></code> statement.
      </p><p>
        Thread processlist identifiers can be determined from the
        <code class="literal">ID</code> column of the
        <a class="link" href="information-schema.html#processlist-table" title="21.15 The INFORMATION_SCHEMA PROCESSLIST Table"><code class="literal">INFORMATION_SCHEMA.PROCESSLIST</code></a>
        table, the <code class="literal">Id</code> column of
        <a class="link" href="sql-syntax.html#show-processlist" title="13.7.5.30 SHOW PROCESSLIST Syntax"><code class="literal">SHOW PROCESSLIST</code></a> output, and the
        <code class="literal">PROCESSLIST_ID</code> column of the Performance
        Schema <a class="link" href="performance-schema.html#threads-table" title="22.9.10.3 The threads Table"><code class="literal">threads</code></a> table. The value for
        the current thread is returned by the
        <a class="link" href="functions.html#function_connection-id"><code class="literal">CONNECTION_ID()</code></a> function.
      </p><p>
        <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a> permits an optional
        <code class="literal">CONNECTION</code> or <code class="literal">QUERY</code>
        modifier:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL
            CONNECTION</code></a> is the same as
            <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a> with no modifier: It
            terminates the connection associated with the given
            <em class="replaceable"><code>processlist_id</code></em>, after terminating
            any statement the connection is executing.
          </p></li><li class="listitem"><p>
            <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL QUERY</code></a>
            terminates the statement the connection is currently
            executing, but leaves the connection itself intact.
</p></li></ul>
</div>
<p>
        If you have the <a class="link" href="security.html#priv_process"><code class="literal">PROCESS</code></a>
        privilege, you can see all threads. If you have the
        <a class="link" href="security.html#priv_super"><code class="literal">SUPER</code></a> privilege, you can kill all
        threads and statements. Otherwise, you can see and kill only
        your own threads and statements.
      </p><p>
        You can also use the <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin processlist</strong></span></a>
        and <a class="link" href="programs.html#mysqladmin" title="4.5.2 mysqladmin — Client for Administering a MySQL Server"><span class="command"><strong>mysqladmin kill</strong></span></a> commands to examine and
        kill threads.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
          You cannot use <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a> with the
          Embedded MySQL Server library because the embedded server
          merely runs inside the threads of the host application. It
          does not create any connection threads of its own.
</p>
</div>
<p>
        When you use <a class="link" href="sql-syntax.html#kill" title="13.7.6.4 KILL Syntax"><code class="literal">KILL</code></a>, a
        thread-specific kill flag is set for the thread. In most cases,
        it might take some time for the thread to die because the kill
        flag is checked only at specific intervals:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            During <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> operations, for
            <code class="literal">ORDER BY</code> and <code class="literal">GROUP BY</code>
            loops, the flag is checked after reading a block of rows. If
            the kill flag is set, the statement is aborted.
          </p></li><li class="listitem"><p>
            During <a class="link" href="sql-syntax.html#alter-table" title="13.1.7 ALTER TABLE Syntax"><code class="literal">ALTER TABLE</code></a>
            operations, the kill flag is checked before each block of
            rows are read from the original table. If the kill flag was
            set, the statement is aborted and the temporary table is
            deleted.
          </p></li><li class="listitem"><p>
            During <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a> or
            <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a> operations, the kill
            flag is checked after each block read and after each updated
            or deleted row. If the kill flag is set, the statement is
            aborted. If you are not using transactions, the changes are
            not rolled back.
          </p></li><li class="listitem"><p>
            <a class="link" href="functions.html#function_get-lock"><code class="literal">GET_LOCK()</code></a> aborts and returns
            <code class="literal">NULL</code>.
          </p></li><li class="listitem"><p>
            An <a class="link" href="sql-syntax.html#insert-delayed" title="13.2.5.2 INSERT DELAYED Syntax"><code class="literal">INSERT DELAYED</code></a> thread
            quickly flushes (inserts) all rows it has in memory and then
            terminates.
          </p></li><li class="listitem"><p>
            If the thread is in the table lock handler (state:
            <code class="literal">Locked</code>), the table lock is quickly
            aborted.
          </p></li><li class="listitem"><p>
            If the thread is waiting for free disk space in a write
            call, the write is aborted with a <span class="quote">“<span class="quote">disk full</span>”</span>
            error message.
</p></li></ul>
</div>
<div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
<div class="admon-title">
Warning
</div>
<p>
          Killing a <a class="link" href="sql-syntax.html#repair-table" title="13.7.2.5 REPAIR TABLE Syntax"><code class="literal">REPAIR TABLE</code></a> or
          <a class="link" href="sql-syntax.html#optimize-table" title="13.7.2.4 OPTIMIZE TABLE Syntax"><code class="literal">OPTIMIZE TABLE</code></a> operation on a
          <code class="literal">MyISAM</code> table results in a table that is
          corrupted and unusable. Any reads or writes to such a table
          fail until you optimize or repair it again (without
          interruption).
</p>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="load-index"></a>13.7.6.5 LOAD INDEX INTO CACHE Syntax</h4>

</div>

</div>

</div>
<pre class="programlisting">
LOAD INDEX INTO CACHE
  <em class="replaceable"><code>tbl_index_list</code></em> [, <em class="replaceable"><code>tbl_index_list</code></em>] ...

<em class="replaceable"><code>tbl_index_list</code></em>:
  <em class="replaceable"><code>tbl_name</code></em>
    [PARTITION (<em class="replaceable"><code>partition_list</code></em> | ALL)]
    [[INDEX|KEY] (<em class="replaceable"><code>index_name</code></em>[, <em class="replaceable"><code>index_name</code></em>] ...)]
    [IGNORE LEAVES]

<em class="replaceable"><code>partition_list</code></em>:
    <em class="replaceable"><code>partition_name</code></em>[, <em class="replaceable"><code>partition_name</code></em>][, ...]
</pre><p>
        The <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a> statement preloads a table index into the key
        cache to which it has been assigned by an explicit
        <a class="link" href="sql-syntax.html#cache-index" title="13.7.6.2 CACHE INDEX Syntax"><code class="literal">CACHE INDEX</code></a> statement, or into
        the default key cache otherwise.
      </p><p>
        <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE</code></a> is used only for <code class="literal">MyISAM</code>
        tables. In MySQL 5.6, it is also supported for
        partitioned <code class="literal">MyISAM</code> tables; in addition,
        indexes on partitioned tables can be preloaded for one, several,
        or all partitions.
      </p><p>
        The <code class="literal">IGNORE LEAVES</code> modifier causes only blocks
        for the nonleaf nodes of the index to be preloaded.
      </p><p>
        <code class="literal">IGNORE LEAVES</code> is also supported for
        partitioned <code class="literal">MyISAM</code> tables.
      </p><p>
        The following statement preloads nodes (index blocks) of indexes
        for the tables <code class="literal">t1</code> and <code class="literal">t2</code>:
      </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>LOAD INDEX INTO CACHE t1, t2 IGNORE LEAVES;</code></strong>
+---------+--------------+----------+----------+
| Table   | Op           | Msg_type | Msg_text |
+---------+--------------+----------+----------+
| test.t1 | preload_keys | status   | OK       |
| test.t2 | preload_keys | status   | OK       |
+---------+--------------+----------+----------+
</pre><p>
        This statement preloads all index blocks from
        <code class="literal">t1</code>. It preloads only blocks for the nonleaf
        nodes from <code class="literal">t2</code>.
      </p><p>
        The syntax of <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD
        INDEX INTO CACHE</code></a> enables you to specify that only
        particular indexes from a table should be preloaded. The current
        implementation preloads all the table's indexes into the cache,
        so there is no reason to specify anything other than the table
        name.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
      </p><p>
        In MySQL 5.6, it is possible to preload indexes on
        specific partitions of partitioned <code class="literal">MyISAM</code>
        tables. For example, of the following 2 statements, the first
        preloads indexes for partition <code class="literal">p0</code> of a
        partitioned table <code class="literal">pt</code>, while the second
        preloads the indexes for partitions <code class="literal">p1</code> and
        <code class="literal">p3</code> of the same table:
      </p><pre class="programlisting">
LOAD INDEX INTO CACHE pt PARTITION (p0);
LOAD INDEX INTO CACHE pt PARTITION (p1, p3);
</pre><p>
        To preload the indexes for all partitions in table
        <code class="literal">pt</code>, you can use either one of the following 2
        statements:
      </p><pre class="programlisting">
LOAD INDEX INTO CACHE pt PARTITION (ALL);

LOAD INDEX INTO CACHE pt;
</pre><p>
        The two statements just shown are equivalent, and issuing either
        one of them has exactly the same effect. In other words, if you
        wish to preload indexes for all partitions of a partitioned
        table, then the <code class="literal">PARTITION (ALL)</code> clause is
        optional.
      </p><p>
        When preloading indexes for multiple partitions, the partitions
        do not have to be contiguous, and you are not required to list
        their names in any particular order.
      </p><p>
        <a class="link" href="sql-syntax.html#load-index" title="13.7.6.5 LOAD INDEX INTO CACHE Syntax"><code class="literal">LOAD INDEX INTO
        CACHE ... IGNORE LEAVES</code></a> fails unless all indexes in a
        table have the same block size. You can determine index block
        sizes for a table by using <a class="link" href="programs.html#myisamchk" title="4.6.3 myisamchk — MyISAM Table-Maintenance Utility"><span class="command"><strong>myisamchk -dv</strong></span></a> and
        checking the <code class="literal">Blocksize</code> column.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="reset"></a>13.7.6.6 RESET Syntax</h4>

</div>

</div>

</div>
<pre class="programlisting">
RESET <em class="replaceable"><code>reset_option</code></em> [, <em class="replaceable"><code>reset_option</code></em>] ...
</pre><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> statement is used to
        clear the state of various server operations. You must have the
        <a class="link" href="security.html#priv_reload"><code class="literal">RELOAD</code></a> privilege to execute
        <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a>.
      </p><p>
        <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> acts as a stronger version
        of the <a class="link" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax"><code class="literal">FLUSH</code></a> statement. See
        <a class="xref" href="sql-syntax.html#flush" title="13.7.6.3 FLUSH Syntax">Section 13.7.6.3, “FLUSH Syntax”</a>.
      </p><p>
        The <a class="link" href="sql-syntax.html#reset" title="13.7.6.6 RESET Syntax"><code class="literal">RESET</code></a> statement causes an
        implicit commit. See <a class="xref" href="sql-syntax.html#implicit-commit" title="13.3.3 Statements That Cause an Implicit Commit">Section 13.3.3, “Statements That Cause an Implicit Commit”</a>.
      </p><p>
        In MySQL 5.6.11 only, <a class="link" href="replication.html#sysvar_gtid_next"><code class="literal">gtid_next</code></a>
        must be set to <code class="literal">AUTOMATIC</code> before issuing this
        statement. (Bug #16062608, Bug #16715809, Bug #69045)
      </p><p>
        <em class="replaceable"><code>reset_option</code></em> can be any of the
        following:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            <code class="literal">MASTER</code>
          </p><p>
            Deletes all binary logs listed in the index file, resets the
            binary log index file to be empty, and creates a new binary
            log file.
          </p></li><li class="listitem"><p>
            <code class="literal">QUERY CACHE</code>
          </p><p>
            Removes all query results from the query cache.
          </p></li><li class="listitem"><p>
            <code class="literal">SLAVE</code>
          </p><p>
            Makes the slave forget its replication position in the
            master binary logs. Also resets the relay log by deleting
            any existing relay log files and beginning a new one.
</p></li></ul>
</div>

</div>

</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="sql-syntax-utility"></a>13.8 MySQL Utility Statements</h2>

</div>

</div>

</div>
<div class="toc">
<dl class="toc"><dt><span class="section"><a href="sql-syntax.html#describe">13.8.1 DESCRIBE Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#explain">13.8.2 EXPLAIN Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#help">13.8.3 HELP Syntax</a></span></dt><dt><span class="section"><a href="sql-syntax.html#use">13.8.4 USE Syntax</a></span></dt></dl>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="describe"></a>13.8.1 DESCRIBE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140080832"></a><a class="indexterm" name="idm139737140079760"></a><p>
      The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statements are synonyms,
      used either to obtain information about table structure or query
      execution plans. For more information, see
      <a class="xref" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax">Section 13.7.5.6, “SHOW COLUMNS Syntax”</a>, and <a class="xref" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax">Section 13.8.2, “EXPLAIN Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="explain"></a>13.8.2 EXPLAIN Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737140073088"></a><a class="indexterm" name="idm139737140072016"></a><pre class="programlisting">
{EXPLAIN | DESCRIBE | DESC}
    <em class="replaceable"><code>tbl_name</code></em> [<em class="replaceable"><code>col_name</code></em> | <em class="replaceable"><code>wild</code></em>]

{EXPLAIN | DESCRIBE | DESC}
    [<em class="replaceable"><code>explain_type</code></em>]
    <em class="replaceable"><code>explainable_stmt</code></em>

<em class="replaceable"><code>explain_type</code></em>: {
    EXTENDED
  | PARTITIONS
  | FORMAT = <em class="replaceable"><code>format_name</code></em>
}

<em class="replaceable"><code>format_name</code></em>: {
    TRADITIONAL
  | JSON
}

<em class="replaceable"><code>explainable_stmt</code></em>: {
    SELECT statement
  | DELETE statement
  | INSERT statement
  | REPLACE statement
  | UPDATE statement
}
</pre><p>
      The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statements are synonyms. In
      practice, the <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> keyword is
      more often used to obtain information about table structure,
      whereas <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is used to obtain a
      query execution plan (that is, an explanation of how MySQL would
      execute a query). The following discussion uses the
      <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> and
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> keywords in accordance with
      those uses, but the MySQL parser treats them as completely
      synonymous.
</p>
<h4><a name="idm139737140054448"></a>Obtaining Table Structure Information</h4>
<p>
      <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> provides information about
      the columns in a table:
    </p><pre class="programlisting">
mysql&gt; <strong class="userinput"><code>DESCRIBE City;</code></strong>
+------------+----------+------+-----+---------+----------------+
| Field      | Type     | Null | Key | Default | Extra          |
+------------+----------+------+-----+---------+----------------+
| Id         | int(11)  | NO   | PRI | NULL    | auto_increment |
| Name       | char(35) | NO   |     |         |                |
| Country    | char(3)  | NO   | UNI |         |                |
| District   | char(20) | YES  | MUL |         |                |
| Population | int(11)  | NO   |     | 0       |                |
+------------+----------+------+-----+---------+----------------+
</pre><p>
      <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> is a shortcut for
      <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a>. These statements also
      display information for views. The description for
      <a class="link" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax"><code class="literal">SHOW COLUMNS</code></a> provides more
      information about the output columns. See
      <a class="xref" href="sql-syntax.html#show-columns" title="13.7.5.6 SHOW COLUMNS Syntax">Section 13.7.5.6, “SHOW COLUMNS Syntax”</a>.
    </p><p>
      By default, <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> displays
      information about all columns in the table.
      <em class="replaceable"><code>col_name</code></em>, if given, is the name of a
      column in the table. In this case, the statement displays
      information only for the named column.
      <em class="replaceable"><code>wild</code></em>, if given, is a pattern string. It
      can contain the SQL <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span> and
      <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span> wildcard characters. In this
      case, the statement displays output only for the columns with
      names matching the string. There is no need to enclose the string
      within quotation marks unless it contains spaces or other special
      characters.
    </p><a class="indexterm" name="idm139737140039952"></a><a class="indexterm" name="idm139737140038880"></a><p>
      The <a class="link" href="sql-syntax.html#describe" title="13.8.1 DESCRIBE Syntax"><code class="literal">DESCRIBE</code></a> statement is provided
      for compatibility with Oracle.
    </p><p>
      The <a class="link" href="sql-syntax.html#show-create-table" title="13.7.5.12 SHOW CREATE TABLE Syntax"><code class="literal">SHOW CREATE TABLE</code></a>,
      <a class="link" href="sql-syntax.html#show-table-status" title="13.7.5.37 SHOW TABLE STATUS Syntax"><code class="literal">SHOW TABLE STATUS</code></a>, and
      <a class="link" href="sql-syntax.html#show-index" title="13.7.5.23 SHOW INDEX Syntax"><code class="literal">SHOW INDEX</code></a> statements also provide
      information about tables. See <a class="xref" href="sql-syntax.html#show" title="13.7.5 SHOW Syntax">Section 13.7.5, “SHOW Syntax”</a>.
</p>
<h4><a name="idm139737140030864"></a>Obtaining Execution Plan Information</h4>
<p>
      The <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> statement provides
      information about how MySQL executes statements:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          As of MySQL 5.6.3, permitted explainable statements for
          <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> are
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>,
          <a class="link" href="sql-syntax.html#delete" title="13.2.2 DELETE Syntax"><code class="literal">DELETE</code></a>,
          <a class="link" href="sql-syntax.html#insert" title="13.2.5 INSERT Syntax"><code class="literal">INSERT</code></a>,
          <a class="link" href="sql-syntax.html#replace" title="13.2.8 REPLACE Syntax"><code class="literal">REPLACE</code></a>, and
          <a class="link" href="sql-syntax.html#update" title="13.2.11 UPDATE Syntax"><code class="literal">UPDATE</code></a>. Before MySQL 5.6.3,
          <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> is the only explainable
          statement.
        </p></li><li class="listitem"><p>
          When <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> is used with an
          explainable statement, MySQL displays information from the
          optimizer about the statement execution plan. That is, MySQL
          explains how it would process the statement, including
          information about how tables are joined and in which order.
          For information about using
          <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to obtain execution
          plan information, see <a class="xref" href="optimization.html#explain-output" title="8.8.2 EXPLAIN Output Format">Section 8.8.2, “EXPLAIN Output Format”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="optimization.html#explain-extended" title="8.8.3 EXPLAIN EXTENDED Output Format"><code class="literal">EXPLAIN EXTENDED</code></a> can be used to
          obtain additional execution plan information. See
          <a class="xref" href="optimization.html#explain-extended" title="8.8.3 EXPLAIN EXTENDED Output Format">Section 8.8.3, “EXPLAIN EXTENDED Output Format”</a>.
        </p></li><li class="listitem"><p>
          <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN
          PARTITIONS</code></a> is useful for examining queries involving
          partitioned tables. See <a class="xref" href="partitioning.html#partitioning-info" title="19.3.5 Obtaining Information About Partitions">Section 19.3.5, “Obtaining Information About Partitions”</a>.
        </p></li><li class="listitem"><p>
          As of MySQL 5.6.5, the <code class="literal">FORMAT</code> option can be
          used to select the output format.
          <code class="literal">TRADITIONAL</code> presents the output in tabular
          format. This is the default if no <code class="literal">FORMAT</code>
          option is present. <code class="literal">JSON</code> format displays the
          information in JSON format. With <code class="literal">FORMAT =
          JSON</code>, the output includes extended and partition
          information.
</p></li></ul>
</div>
<p>
      <a class="indexterm" name="idm139737140003040"></a>

      With the help of <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a>, you can
      see where you should add indexes to tables so that the statement
      executes faster by using indexes to find rows. You can also use
      <a class="link" href="sql-syntax.html#explain" title="13.8.2 EXPLAIN Syntax"><code class="literal">EXPLAIN</code></a> to check whether the
      optimizer joins the tables in an optimal order. To give a hint to
      the optimizer to use a join order corresponding to the order in
      which the tables are named in a
      <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a> statement, begin the
      statement with <code class="literal">SELECT STRAIGHT_JOIN</code> rather than
      just <a class="link" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax"><code class="literal">SELECT</code></a>. (See
      <a class="xref" href="sql-syntax.html#select" title="13.2.9 SELECT Syntax">Section 13.2.9, “SELECT Syntax”</a>.)
    </p><p>
      If you have a problem with indexes not being used when you believe
      that they should be, run <a class="link" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax"><code class="literal">ANALYZE
      TABLE</code></a> to update table statistics, such as cardinality of
      keys, that can affect the choices the optimizer makes. See
      <a class="xref" href="sql-syntax.html#analyze-table" title="13.7.2.1 ANALYZE TABLE Syntax">Section 13.7.2.1, “ANALYZE TABLE Syntax”</a>.
</p>
</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="help"></a>13.8.3 HELP Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737139990800"></a><pre class="programlisting">
HELP '<em class="replaceable"><code>search_string</code></em>'
</pre><p>
      The <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement returns online
      information from the MySQL Reference manual. Its proper operation
      requires that the help tables in the <code class="literal">mysql</code>
      database be initialized with help topic information (see
      <a class="xref" href="server-administration.html#server-side-help-support" title="5.1.10 Server-Side Help">Section 5.1.10, “Server-Side Help”</a>).
    </p><p>
      The <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> statement searches the
      help tables for the given search string and displays the result of
      the search. The search string is not case sensitive.
    </p><p>
      The search string can contain the wildcard characters
      <span class="quote">“<span class="quote"><code class="literal">%</code></span>”</span> and
      <span class="quote">“<span class="quote"><code class="literal">_</code></span>”</span>. These have the same meaning
      as for pattern-matching operations performed with the
      <a class="link" href="functions.html#operator_like"><code class="literal">LIKE</code></a> operator. For example,
      <code class="literal">HELP 'rep%'</code> returns a list of topics that begin
      with <code class="literal">rep</code>.
    </p><p>
      The HELP statement understands several types of search strings:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          At the most general level, use <code class="literal">contents</code> to
          retrieve a list of the top-level help categories:
        </p><pre class="programlisting">
HELP 'contents'
</pre></li><li class="listitem"><p>
          For a list of topics in a given help category, such as
          <code class="literal">Data Types</code>, use the category name:
        </p><pre class="programlisting">
HELP 'data types'
</pre></li><li class="listitem"><p>
          For help on a specific help topic, such as the
          <a class="link" href="functions.html#function_ascii"><code class="literal">ASCII()</code></a> function or the
          <a class="link" href="sql-syntax.html#create-table" title="13.1.17 CREATE TABLE Syntax"><code class="literal">CREATE TABLE</code></a> statement, use the
          associated keyword or keywords:
        </p><pre class="programlisting">
HELP 'ascii'
HELP 'create table'
</pre></li></ul>
</div>
<p>
      In other words, the search string matches a category, many topics,
      or a single topic. You cannot necessarily tell in advance whether
      a given search string will return a list of items or the help
      information for a single help topic. However, you can tell what
      kind of response <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> returned by
      examining the number of rows and columns in the result set.
    </p><p>
      The following descriptions indicate the forms that the result set
      can take. Output for the example statements is shown using the
      familiar <span class="quote">“<span class="quote">tabular</span>”</span> or <span class="quote">“<span class="quote">vertical</span>”</span> format
      that you see when using the <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> client.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">

<div class="admon-title">
Note
</div>
<p>
        The <a class="link" href="programs.html#mysql" title="4.5.1 mysql — The MySQL Command-Line Tool"><span class="command"><strong>mysql</strong></span></a> itself reformats
        <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a> result sets in a different
        way.
</p>
</div>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Empty result set
        </p><p>
          No match could be found for the search string.
        </p></li><li class="listitem"><p>
          Result set containing a single row with three columns
        </p><p>
          This means that the search string yielded a hit for the help
          topic. The result has three columns:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">name</code>: The topic name.
            </p></li><li class="listitem"><p>
              <code class="literal">description</code>: Descriptive help text for
              the topic.
            </p></li><li class="listitem"><p>
              <code class="literal">example</code>: Usage example or examples.
              This column might be blank.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'replace'</code>
        </p><p>
          Yields:
        </p><pre class="programlisting">
name: REPLACE
description: Syntax:
REPLACE(str,from_str,to_str)

Returns the string str with all occurrences of the string from_str
replaced by the string to_str. REPLACE() performs a case-sensitive
match when searching for from_str.
example: mysql&gt; SELECT REPLACE('www.mysql.com', 'w', 'Ww');
        -&gt; 'WwWwWw.mysql.com'
</pre></li><li class="listitem"><p>
          Result set containing multiple rows with two columns
        </p><p>
          This means that the search string matched many help topics.
          The result set indicates the help topic names:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">name</code>: The help topic name.
            </p></li><li class="listitem"><p>
              <code class="literal">is_it_category</code>: <code class="literal">Y</code> if
              the name represents a help category, <code class="literal">N</code>
              if it does not. If it does not, the
              <code class="literal">name</code> value when specified as the
              argument to the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a>
              statement should yield a single-row result set containing
              a description for the named item.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'status'</code>
        </p><p>
          Yields:
        </p><pre class="programlisting">
+-----------------------+----------------+
| name                  | is_it_category |
+-----------------------+----------------+
| SHOW                  | N              |
| SHOW ENGINE           | N              |
| SHOW MASTER STATUS    | N              |
| SHOW PROCEDURE STATUS | N              |
| SHOW SLAVE STATUS     | N              |
| SHOW STATUS           | N              |
| SHOW TABLE STATUS     | N              |
+-----------------------+----------------+
</pre></li><li class="listitem"><p>
          Result set containing multiple rows with three columns
        </p><p>
          This means the search string matches a category. The result
          set contains category entries:
</p>
<div class="itemizedlist">
<ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>
              <code class="literal">source_category_name</code>: The help category
              name.
            </p></li><li class="listitem"><p>
              <code class="literal">name</code>: The category or topic name
            </p></li><li class="listitem"><p>
              <code class="literal">is_it_category</code>: <code class="literal">Y</code> if
              the name represents a help category, <code class="literal">N</code>
              if it does not. If it does not, the
              <code class="literal">name</code> value when specified as the
              argument to the <a class="link" href="sql-syntax.html#help" title="13.8.3 HELP Syntax"><code class="literal">HELP</code></a>
              statement should yield a single-row result set containing
              a description for the named item.
</p></li></ul>
</div>
<p>
          Example: <code class="literal">HELP 'functions'</code>
        </p><p>
          Yields:
        </p><pre class="programlisting">
+----------------------+-------------------------+----------------+
| source_category_name | name                    | is_it_category |
+----------------------+-------------------------+----------------+
| Functions            | CREATE FUNCTION         | N              |
| Functions            | DROP FUNCTION           | N              |
| Functions            | Bit Functions           | Y              |
| Functions            | Comparison operators    | Y              |
| Functions            | Control flow functions  | Y              |
| Functions            | Date and Time Functions | Y              |
| Functions            | Encryption Functions    | Y              |
| Functions            | Information Functions   | Y              |
| Functions            | Logical operators       | Y              |
| Functions            | Miscellaneous Functions | Y              |
| Functions            | Numeric Functions       | Y              |
| Functions            | String Functions        | Y              |
+----------------------+-------------------------+----------------+
</pre></li></ul>
</div>

</div>
<div class="section">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="use"></a>13.8.4 USE Syntax</h3>

</div>

</div>

</div>
<a class="indexterm" name="idm139737139920912"></a><a class="indexterm" name="idm139737139919872"></a><pre class="programlisting">
USE <em class="replaceable"><code>db_name</code></em>
</pre><p>
      The <code class="literal">USE <em class="replaceable"><code>db_name</code></em></code>
      statement tells MySQL to use the
      <em class="replaceable"><code>db_name</code></em> database as the default
      (current) database for subsequent statements. The database remains
      the default until the end of the session or another
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statement is issued:
    </p><pre class="programlisting">
USE db1;
SELECT COUNT(*) FROM mytable;   # selects from db1.mytable
USE db2;
SELECT COUNT(*) FROM mytable;   # selects from db2.mytable
</pre><p>
      Making a particular database the default by means of the
      <a class="link" href="sql-syntax.html#use" title="13.8.4 USE Syntax"><code class="literal">USE</code></a> statement does not preclude you
      from accessing tables in other databases. The following example
      accesses the <code class="literal">author</code> table from the
      <code class="literal">db1</code> database and the <code class="literal">editor</code>
      table from the <code class="literal">db2</code> database:
    </p><pre class="programlisting">
USE db1;
SELECT author_name,editor_name FROM author,db2.editor
  WHERE author.editor_id = db2.editor.editor_id;
</pre>
</div>

</div>

</div>
<div class="copyright-footer">

</div>
<div class="navfooter">
<hr>
<table width="100%" summary="Navigation footer">
<tr>
<td width="40%" align="left"><a accesskey="p" href="functions.html">Prev</a></td>
<td width="20%" align="center"><a accesskey="u" href="">Up</a></td>
<td width="40%" align="right"> <a accesskey="n" href="innodb-storage-engine.html">Next</a></td>
</tr>
<tr>
<td width="40%" align="left" valign="top">Chapter 12 Functions and Operators</td>
<td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td>
<td width="40%" align="right" valign="top">Chapter 14 The InnoDB Storage Engine</td>
</tr>
</table>
</div>
</body>
</html>
